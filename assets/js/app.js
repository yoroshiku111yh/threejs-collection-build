!function(){var t={851:function(t,e,n){var i={"./appleAvenue":487,"./appleAvenue.js":487,"./blobBubble2d":896,"./blobBubble2d.js":896,"./crossfadeShader":881,"./crossfadeShader.js":881,"./distortionImage":371,"./distortionImage.js":371,"./gooeyEffects":72,"./gooeyEffects.js":72,"./hoverDistortionRgbImage":194,"./hoverDistortionRgbImage.js":194,"./magicMorphingCube":585,"./magicMorphingCube.js":585,"./meshMorpher":191,"./meshMorpher.js":191,"./pointLightShader":887,"./pointLightShader.js":887,"./rayMarchingBasic":13,"./rayMarchingBasic.js":13,"./soapBubble":462,"./soapBubble.js":462,"./waterSurface":723,"./waterSurface.js":723};function r(t){var e=s(t);return n(e)}function s(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=s,t.exports=r,r.id=851},610:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,{Z:function(){return i}})},991:function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}n.d(e,{Z:function(){return r}})},156:function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{Z:function(){return i}})},608:function(t,e,n){"use strict";function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.d(e,{Z:function(){return i}})},255:function(t,e,n){"use strict";function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}n.d(e,{Z:function(){return r}})},724:function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}n.d(e,{Z:function(){return r}})},487:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return Oi}});var i=n(610),r=n(991),s=n(255),o=n(724),a=n(608),l=n(706),c=n(212);function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var h=function(t){(0,s.Z)(n,t);var e=u(n);function n(t){var r;return(0,i.Z)(this,n),(r=e.call(this,{vertexShader:"#define GLSLIFY 1\nvarying vec3 eyeVector;\nvarying vec3 worldNormal;\nvarying vec3 v_normal;\nvarying vec4 v_worldPostion;\nvarying vec2 vUv;\nuniform float zPosition;\n\nattribute float sides;\nvarying float vSides;\n\nvoid main() {\n    vSides = sides;\n    vUv = uv;\n    v_normal = normalMatrix * normal;\n    vec4 worldPosition = modelMatrix * vec4(position, 1.0);\n    eyeVector = normalize(worldPosition.xyz - cameraPosition);\n    worldNormal = normalize(modelViewMatrix * vec4(normal, 0.0)).xyz;\n    \n\t//gl_Position = projectionMatrix * modelViewMatrix * vec4(sin(position.x*time*0.001), position.y, position.z, 1.0);\n    v_worldPostion = worldPosition;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, zPosition);\n}",fragmentShader:"#define GLSLIFY 1\n\nfloat PI2_0 = 6.28318530718;\n\nvec4 radialRainbow(vec2 st, float tick, vec2 pos) {\n    vec2 toCenter = pos - st;\n    float angle = mod((atan(toCenter.y, toCenter.x) / PI2_0) + 0.5 + sin(tick), 1.0);\n\n  // colors\n    vec4 a = vec4(0.15, 0.58, 0.96, 1.0);\n    vec4 b = vec4(0.29, 1.00, 0.55, 1.0);\n    vec4 c = vec4(1.00, 0.0, 0.85, 1.0);\n    vec4 d = vec4(0.92, 0.20, 0.14, 1.0);\n    vec4 e = vec4(1.00, 0.96, 0.32, 1.0);\n\n    float step = 1.0 / 10.0;\n\n    vec4 color = a;\n\n    color = mix(color, b, smoothstep(step * 1.0, step * 2.0, angle));\n    color = mix(color, a, smoothstep(step * 2.0, step * 3.0, angle));\n    color = mix(color, b, smoothstep(step * 3.0, step * 4.0, angle));\n    color = mix(color, c, smoothstep(step * 4.0, step * 5.0, angle));\n    color = mix(color, d, smoothstep(step * 5.0, step * 6.0, angle));\n    color = mix(color, c, smoothstep(step * 6.0, step * 7.0, angle));\n    color = mix(color, d, smoothstep(step * 7.0, step * 8.0, angle));\n    color = mix(color, e, smoothstep(step * 8.0, step * 9.0, angle));\n    color = mix(color, a, smoothstep(step * 9.0, step * 10.0, angle));\n\n    return color;\n}\n\nconst float PI_1 = 3.141592653589793;\nconst float PI2_1 = 6.28318530718;\n\nmat2 scale_1(vec2 value) {\n  return mat2(value.x, 0.0, 0.0, value.y);\n}\n\nmat2 rotate2d_1(float value){\n  return mat2(cos(value), -sin(value), sin(value), cos(value));\n}\n\nvec3 gradient1(vec2 st, float tick, vec2 pos) {\n  vec3 c1 = vec3(0.98, 0.71, 0.0);\n  vec3 c2 = vec3(0.95, 0.20, 0.14);\n  vec3 c3 = vec3(0.89, 0.12, 0.78);\n  vec3 c4 = vec3(0.30, 0.24, 0.96);\n\n  st.y = 1.0 - st.y;\n\n  vec2 toCenter = vec2(0.55, 0.58) - st;\n  float angle = atan(toCenter.y, toCenter.x) / PI_1;\n\n  vec3 colorA = mix(c1, c2, smoothstep(0.0, 0.5, angle));\n\n  st -= pos;\n  st *= scale_1(vec2(1.4));\n  st *= rotate2d_1(-0.44);\n  st += pos;\n\n  vec3 colorB = mix(c2, c3, smoothstep(0.3, 0.8, st.x));\n  colorB = mix(colorB, c4, smoothstep(0.55, 1.0, st.x));\n\n  return mix(colorA, colorB, smoothstep(0.28, 0.65, st.x));\n}\n\nvec3 gradient2(vec2 st, float tick, vec2 pos) {\n  vec3 c1 = vec3(1.0, 0.8, 0.2);\n  vec3 c2 = vec3(0.92, 0.20, 0.14);\n\n  st -= pos;\n  st *= scale_1(vec2(3.8));\n  st *= rotate2d_1(tick * PI_1);\n  st += pos;\n\n  return mix(c1, c2, st.x);\n}\n\nvec3 gradient3(vec2 st, float tick, vec2 pos) {\n  vec3 c1 = vec3(0.89, 0.12, 0.78);\n  vec3 c2 = vec3(0.29, 0.68, 0.95);\n\n  st -= pos;\n  st *= scale_1(vec2(3.8));\n  st *= rotate2d_1(tick * PI_1);\n  st += pos;\n\n  return mix(c1, c2, st.x);\n}\n\nvec3 gradients(int type, vec2 st, float tick, vec2 pos) {\n  if (type == 1) {\n    return gradient1(st, tick, pos);\n  } else if (type == 2) {\n    return gradient2(st, tick, pos);\n  } else if (type == 3) {\n    return gradient3(st, tick, pos);\n  }\n}\n\nconst float PI_0 = 3.141592653589793;\n\nmat2 scale_0(vec2 value) {\n  return mat2(value.x, 0.0, 0.0, value.y);\n}\n\nmat2 rotate2d_0(float value){\n  return mat2(cos(value), -sin(value), sin(value), cos(value));\n}\n\nvec3 gradientMix2Colors(vec2 st, float tick, vec3 col1, vec3 col2, vec2 pos){\n  vec3 c1 = col1;\n  vec3 c2 = col2;\n\n  st -= pos;\n  st *= scale_0(vec2(3.8));\n  st *= rotate2d_0(tick * PI_0);\n  st += pos;\n\n  return mix(c1, c2, st.x);\n}\n\nfloat borders(vec2 uv, float strokeWidth) {\n  vec2 borderBottomLeft = smoothstep(vec2(0.0), vec2(strokeWidth), uv);\n\n  vec2 borderTopRight = smoothstep(vec2(0.0), vec2(strokeWidth), 1.0 - uv);\n\n  return 1.0 - borderBottomLeft.x * borderBottomLeft.y * borderTopRight.x * borderTopRight.y;\n}\n\nuniform vec3 uResolution;\nuniform float uTick;\nuniform sampler2D uMask1;\nuniform sampler2D uMask2;\nuniform bool isRefract;\n\nuniform float lenghtDisplacement;\nuniform float lengthMaximum;\nuniform vec3 uPos;\nuniform float uBounce;\n\nuniform vec3 colorSide1[2];\nuniform vec3 colorSide2[2];\nuniform vec3 colorSide3[2];\nuniform vec3 colorSide4[2];\nuniform vec3 colorSide5[2];\nuniform vec3 colorSide6[2];\n\nconst float PI2 = 6.28318530718;\n\nvarying vec3 worldNormal;\nvarying vec3 eyeVector;\nvarying vec2 vUv;\nvarying float vSides;\nvarying vec4 v_worldPostion;\n\nfloat Fresnel(vec3 eyeVector, vec3 worldNormal) {\n    return pow(1.0 + dot(eyeVector, worldNormal), 3.0);\n}\n\nvoid main() {\n    float a = 0.85;\n    vec2 st = gl_FragCoord.xy / uResolution.xy;\n    float boxSide = floor(vSides + 0.1);\n    vec3 normal = worldNormal;\n\n    if(isRefract) {\n        vec3 refracted = refract(eyeVector, normal, 1.0 / 1.0);\n        st += refracted.xy;\n    }\n\n    vec3 frontFace = vec3(0, 1, 1);\n    vec3 rightFace = vec3(0, 0, 1);\n    vec3 backFace = vec3(0, 1, 0);\n    vec3 leftFace = vec3(0, 1, 1);\n    vec3 topFace = vec3(1, 0, 0);\n    vec3 bottomFace = vec3(1, 0, 1);\n\n    float f = Fresnel(eyeVector, normal);\n    //////////////\n    vec2 posLogoColor = vec2(0.25);\n    ///////////////\n\n    vec2 toCenter = vUv ;\n    float angle = (atan(toCenter.y, toCenter.x) / PI2) + 0.5;\n    float u_displacementLength = lenghtDisplacement / 100.;\n    float displacement = borders(vUv, u_displacementLength) + borders(vUv, u_displacementLength * 2.143) * 0.3;\n    vec4 displace = vec4(angle, displacement, 0.0, 1.0);\n    float maximum = lengthMaximum / 1000.;\n    float displace_k = displace.g * maximum;\n    vec2 newUv = st; /// st - uPos*0.4\n    newUv += displace_k;\n    newUv += displace_k;\n    /////\n    float speed = 4.;\n    vec4 col1 = vec4(gradientMix2Colors(vUv, uTick*speed, colorSide1[0], colorSide1[1], posLogoColor), 1.0);\n    vec4 col2 = vec4(gradientMix2Colors(vUv, uTick*speed, colorSide2[0], colorSide2[1], posLogoColor), 1.0);\n    vec4 col3 = vec4(gradientMix2Colors(vUv, uTick*speed, colorSide3[0], colorSide3[1], posLogoColor), 1.0);\n    vec4 col4 = vec4(gradientMix2Colors(vUv, uTick*speed, colorSide4[0], colorSide4[1], posLogoColor), 1.0);\n    vec4 col5 = vec4(gradientMix2Colors(vUv, uTick*speed, colorSide5[0], colorSide5[1], posLogoColor), 1.0);\n    vec4 col6 = vec4(gradientMix2Colors(vUv, uTick*speed, colorSide6[0], colorSide6[1], posLogoColor), 1.0);\n    vec4 col;\n    //////////////\n\n    vec4 mask1 = texture2D(uMask1, newUv + vec2(0.0, uBounce));\n    vec4 mask2 = texture2D(uMask2, newUv + + vec2(0.0, uBounce));\n\n    // ////////////\n    if(boxSide == 0.) {\n        col = col1;\n        col.a = mask1.r;\n    }\n    if(boxSide == 1.) {\n        col = col2;\n        col.a = mask2.r;\n    }\n    if(boxSide == 2.) {\n        col = col3;\n        col.a = mask2.r;\n    }\n    if(boxSide == 3.) {\n        col = col4;\n        col.a = mask1.r;\n    }\n    if(boxSide == 4.) {\n        col = col5;\n        col.a = mask1.r;\n    }\n    if(boxSide == 5.) {\n        col = col6;\n        col.a = mask2.r;\n    }\n    col.rgb = mix(col.rgb, vec3(0.0), f);\n    if(f > 1.0) {\n        discard;\n    }\n    if(col.a < 0.5) {\n        discard;\n    }\n    gl_FragColor = col;\n}"})).uniforms=t,r.transparent=!0,r.side=c.ehD,r.getUniform=function(){return r.uniforms},r}return n}(c.jyz),d=n(218);function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var f=function(t){(0,s.Z)(n,t);var e=p(n);function n(t){var r;return(0,i.Z)(this,n),(r=e.call(this,{vertexShader:"#define GLSLIFY 1\nvarying vec3 eyeVector;\nvarying vec3 worldNormal;\nvarying vec3 v_normal;\nvarying vec2 vUv;\nuniform float zPosition;\n\nattribute float sides;\nvarying float vSides;\n\nvoid main() {\n    vSides = sides;\n    vUv = uv;\n    v_normal = normalMatrix * normal;\n    vec4 worldPosition = modelMatrix * vec4(position, 1.0);\n    eyeVector = normalize(worldPosition.xyz - cameraPosition);\n    worldNormal = normalize(modelViewMatrix * vec4(normal, 0.0)).xyz;\n\n\t//gl_Position = projectionMatrix * modelViewMatrix * vec4(sin(position.x*time*0.001), position.y, position.z, 1.0);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, zPosition);\n}",fragmentShader:"#define GLSLIFY 1\n\nfloat PI2_0 = 6.28318530718;\n\nvec4 radialRainbow(vec2 st, float tick, vec2 pos) {\n    vec2 toCenter = pos - st;\n    float angle = mod((atan(toCenter.y, toCenter.x) / PI2_0) + 0.5 + sin(tick), 1.0);\n\n  // colors\n    vec4 a = vec4(0.15, 0.58, 0.96, 1.0);\n    vec4 b = vec4(0.29, 1.00, 0.55, 1.0);\n    vec4 c = vec4(1.00, 0.0, 0.85, 1.0);\n    vec4 d = vec4(0.92, 0.20, 0.14, 1.0);\n    vec4 e = vec4(1.00, 0.96, 0.32, 1.0);\n\n    float step = 1.0 / 10.0;\n\n    vec4 color = a;\n\n    color = mix(color, b, smoothstep(step * 1.0, step * 2.0, angle));\n    color = mix(color, a, smoothstep(step * 2.0, step * 3.0, angle));\n    color = mix(color, b, smoothstep(step * 3.0, step * 4.0, angle));\n    color = mix(color, c, smoothstep(step * 4.0, step * 5.0, angle));\n    color = mix(color, d, smoothstep(step * 5.0, step * 6.0, angle));\n    color = mix(color, c, smoothstep(step * 6.0, step * 7.0, angle));\n    color = mix(color, d, smoothstep(step * 7.0, step * 8.0, angle));\n    color = mix(color, e, smoothstep(step * 8.0, step * 9.0, angle));\n    color = mix(color, a, smoothstep(step * 9.0, step * 10.0, angle));\n\n    return color;\n}\n\nconst float PI_0 = 3.141592653589793;\nconst float PI2_1 = 6.28318530718;\n\nmat2 scale_0(vec2 value) {\n  return mat2(value.x, 0.0, 0.0, value.y);\n}\n\nmat2 rotate2d_0(float value){\n  return mat2(cos(value), -sin(value), sin(value), cos(value));\n}\n\nvec3 gradient1(vec2 st, float tick, vec2 pos) {\n  vec3 c1 = vec3(0.98, 0.71, 0.0);\n  vec3 c2 = vec3(0.95, 0.20, 0.14);\n  vec3 c3 = vec3(0.89, 0.12, 0.78);\n  vec3 c4 = vec3(0.30, 0.24, 0.96);\n\n  st.y = 1.0 - st.y;\n\n  vec2 toCenter = vec2(0.55, 0.58) - st;\n  float angle = atan(toCenter.y, toCenter.x) / PI_0;\n\n  vec3 colorA = mix(c1, c2, smoothstep(0.0, 0.5, angle));\n\n  st -= pos;\n  st *= scale_0(vec2(1.4));\n  st *= rotate2d_0(-0.44);\n  st += pos;\n\n  vec3 colorB = mix(c2, c3, smoothstep(0.3, 0.8, st.x));\n  colorB = mix(colorB, c4, smoothstep(0.55, 1.0, st.x));\n\n  return mix(colorA, colorB, smoothstep(0.28, 0.65, st.x));\n}\n\nvec3 gradient2(vec2 st, float tick, vec2 pos) {\n  vec3 c1 = vec3(1.0, 0.8, 0.2);\n  vec3 c2 = vec3(0.92, 0.20, 0.14);\n\n  st -= pos;\n  st *= scale_0(vec2(3.8));\n  st *= rotate2d_0(tick * PI_0);\n  st += pos;\n\n  return mix(c1, c2, st.x);\n}\n\nvec3 gradient3(vec2 st, float tick, vec2 pos) {\n  vec3 c1 = vec3(0.89, 0.12, 0.78);\n  vec3 c2 = vec3(0.29, 0.68, 0.95);\n\n  st -= pos;\n  st *= scale_0(vec2(3.8));\n  st *= rotate2d_0(tick * PI_0);\n  st += pos;\n\n  return mix(c1, c2, st.x);\n}\n\nvec3 gradients(int type, vec2 st, float tick, vec2 pos) {\n  if (type == 1) {\n    return gradient1(st, tick, pos);\n  } else if (type == 2) {\n    return gradient2(st, tick, pos);\n  } else if (type == 3) {\n    return gradient3(st, tick, pos);\n  }\n}\n\nconst float PI_1 = 3.141592653589793;\n\nmat2 scale_1(vec2 value) {\n  return mat2(value.x, 0.0, 0.0, value.y);\n}\n\nmat2 rotate2d_1(float value){\n  return mat2(cos(value), -sin(value), sin(value), cos(value));\n}\n\nvec3 gradientMix2Colors(vec2 st, float tick, vec3 col1, vec3 col2, vec2 pos){\n  vec3 c1 = col1;\n  vec3 c2 = col2;\n\n  st -= pos;\n  st *= scale_1(vec2(3.8));\n  st *= rotate2d_1(tick * PI_1);\n  st += pos;\n\n  return mix(c1, c2, st.x);\n}\n\nfloat borders(vec2 uv, float strokeWidth) {\n  vec2 borderBottomLeft = smoothstep(vec2(0.0), vec2(strokeWidth), uv);\n\n  vec2 borderTopRight = smoothstep(vec2(0.0), vec2(strokeWidth), 1.0 - uv);\n\n  return 1.0 - borderBottomLeft.x * borderBottomLeft.y * borderTopRight.x * borderTopRight.y;\n}\n\n//https://www.shadertoy.com/view/wl2SzR\n\n#define FIELD 10.0\n#define HEIGHT 0.7\n#define ITERATION 2.0\n#define POPUP_TONE_R .2 \n#define POPUP_TONE_G .4\n#define POPUP_TONE_B .8\n#define TONE vec4(POPUP_TONE_R, POPUP_TONE_G, POPUP_TONE_B, 0)\n#define SPEED 0.5\n\nfloat eq(vec2 p,float t){\n\tfloat x = sin( p.y-t +cos(t+p.x*.8) ) * cos(p.x-t);\n\tx *= acos(x);\n\treturn - x * abs(x-.05) * p.x/p.y*4.9;\n}\n\nvec4 causticAmoebas(vec2 uv, float uTick){\n    vec2  p = FIELD*(uv  +.9);\n    float t = uTick*10.*SPEED;\n    float hs = FIELD*(HEIGHT+cos(t)*1.9);\n\tfloat x = eq(p,t);\n    float y = p.y-x*0.1;\n    vec4 X = vec4(1.0);\n    vec4 O;\n    for(float i=0.; i<ITERATION; ++i){\n        p.x *= 1.5;\n        X = x + vec4(0, eq(p,t+i+1.), eq(p,t+i+2.) ,0);\n        x = X.z += X.y;\n        O += TONE / abs(y-X-hs);\n    }\n    return O;\n}\n\n//https://www.shadertoy.com/view/XtGyDR\n\nvec3 MIX(vec3 x, vec3 y) {\n    return abs(x - y);\n}\n\nfloat CV(vec3 c, vec2 uv, vec3 iResolution) {\n    float size = 640. / iResolution.x * 0.003;\n    return 1.0 - clamp(size * (length(c.xy - uv) - c.z), 0., 1.);\n}\n\nvec4 causticCrystal(vec3 iResolution, float iTime, vec2 uv, vec3 colorModify, bool isNoUseModify) {\n    vec4 O = vec4(0., 0., 0., 1);\n    for(float i = 0.; i < 60.; i += 4.5) {\n        vec3 c = vec3(sin(i * 0.57 + 7. + iTime * .7), sin(i * 0.59 - 15. - iTime * .65), sin(i * 0.6 + iTime * .9)) * 0.75 + 0.75;\n        if(!isNoUseModify){\n            c = colorModify;\n        }\n        float cv = CV(\n            vec3(\n                sin(iTime * 0.5 + i / 4.5) * (iResolution.x / 2. - 60.) + iResolution.x / 2., \n                sin(iTime * 0.73 + i / 3.) * (iResolution.y / 2. - 60.) + iResolution.y / 2., \n                0.0), \n            uv, \n            iResolution);\n        O.rgb = MIX(O.rgb, c*cv);\n    }\n    return O;\n}\n\nfloat pointLight (vec2 uv_0, float h_0, float i_0){\n    return i_0 * h_0 * pow(dot(uv_0, uv_0) + h_0*h_0, -1.5);\n}\n\nfloat linTosrgb(float val){\n    if(val < 0.0031308){\n        return val * 12.92;\n    }\n    else{\n        return 1.065 * pow(val, 1.0/2.4) - 0.055;\n    }\n}\n\nvec4 pointLightPhysic(vec2 uv, float iTime, float power){\n    //float power = 0.005;\n    float spring = 0.1;\n    float h = pow(sin(iTime/3.), 2.)* spring + 0.001;\n    float v = pointLight(uv + vec2(0.25), h, power);\n    v = linTosrgb(v);\n    return vec4(v);\n}\n\n// https://www.shadertoy.com/view/4tsSR7\n\nvec3 spectral_colour_1460171947(float l) // RGB <0,1> <- lambda l <400,700> [nm]\n{\n    float r = 0.0, g = 0.0, b = 0.0;\n    if((l >= 400.0) && (l < 410.0)) {\n        float t = (l - 400.0) / (410.0 - 400.0);\n        r = +(0.33 * t) - (0.20 * t * t);\n    } else if((l >= 410.0) && (l < 475.0)) {\n        float t = (l - 410.0) / (475.0 - 410.0);\n        r = 0.14 - (0.13 * t * t);\n    } else if((l >= 545.0) && (l < 595.0)) {\n        float t = (l - 545.0) / (595.0 - 545.0);\n        r = +(1.98 * t) - (t * t);\n    } else if((l >= 595.0) && (l < 650.0)) {\n        float t = (l - 595.0) / (650.0 - 595.0);\n        r = 0.98 + (0.06 * t) - (0.40 * t * t);\n    } else if((l >= 650.0) && (l < 700.0)) {\n        float t = (l - 650.0) / (700.0 - 650.0);\n        r = 0.65 - (0.84 * t) + (0.20 * t * t);\n    }\n    if((l >= 415.0) && (l < 475.0)) {\n        float t = (l - 415.0) / (475.0 - 415.0);\n        g = +(0.80 * t * t);\n    } else if((l >= 475.0) && (l < 590.0)) {\n        float t = (l - 475.0) / (590.0 - 475.0);\n        g = 0.8 + (0.76 * t) - (0.80 * t * t);\n    } else if((l >= 585.0) && (l < 639.0)) {\n        float t = (l - 585.0) / (639.0 - 585.0);\n        g = 0.82 - (0.80 * t);\n    }\n    if((l >= 400.0) && (l < 475.0)) {\n        float t = (l - 400.0) / (475.0 - 400.0);\n        b = +(2.20 * t) - (1.50 * t * t);\n    } else if((l >= 475.0) && (l < 560.0)) {\n        float t = (l - 475.0) / (560.0 - 475.0);\n        b = 0.7 - (t) + (0.30 * t * t);\n    }\n\n    return vec3(r, g, b);\n}\n\nvec4 solubleRainbow(vec2 fragCoord, vec3 iResolution, float iTime) {\n    vec4 fragColor = vec4(vec3(0.0), 1.0);\n    float power = 3.5;\n    vec2 p = (power * fragCoord.xy - iResolution.xy) / min(iResolution.x, iResolution.y);\n\n    p *= 2.0;\n\n    for(int i = 0; i < 8; i++) {\n        vec2 newp = vec2(p.y + cos(p.x + iTime) - sin(p.y * cos(iTime * 0.2)), p.x - sin(p.y - iTime) - cos(p.x * sin(iTime * 0.3)));\n        p = newp;\n    }\n\n    fragColor = vec4(spectral_colour_1460171947(p.y * 50.0 + 500.0 + sin(iTime * 0.6)), 1.0);\n    return fragColor;\n}\n\n// https://www.shadertoy.com/view/3s3BWr\n\n// Copyright 2019 Google LLC.\n// SPDX-License-Identifier: Apache-2.0\n\n// Polynomial approximation in GLSL for the Turbo colormap\n// Original LUT: https://gist.github.com/mikhailov-work/ee72ba4191942acecc03fe6da94fc73f\n\n// Authors:\n//   Colormap Design: Anton Mikhailov (mikhailov@google.com)\n//   GLSL Approximation: Ruofei Du (ruofei@google.com)\n\nfloat saturate (float x_0) {\n    return min(1.0, max(0.0,x_0));\n}\n\nvec3 TurboColormap(in float x) {\n  const vec4 kRedVec4 = vec4(0.13572138, 4.61539260, -42.66032258, 132.13108234);\n  const vec4 kGreenVec4 = vec4(0.09140261, 2.19418839, 4.84296658, -14.18503333);\n  const vec4 kBlueVec4 = vec4(0.10667330, 12.64194608, -60.58204836, 110.36276771);\n  const vec2 kRedVec2 = vec2(-152.94239396, 59.28637943);\n  const vec2 kGreenVec2 = vec2(4.27729857, 2.82956604);\n  const vec2 kBlueVec2 = vec2(-89.90310912, 27.34824973);\n  \n  x = saturate(x);\n  vec4 v4 = vec4( 1.0, x, x * x, x * x * x);\n  vec2 v2 = v4.zw * v4.z;\n  return vec3(\n    dot(v4, kRedVec4)   + dot(v2, kRedVec2),\n    dot(v4, kGreenVec4) + dot(v2, kGreenVec2),\n    dot(v4, kBlueVec4)  + dot(v2, kBlueVec2)\n  );\n}\n\nfloat dim(float x) {\n\treturn -4. * pow(x - .5, 2.) + 1.;    \n}\n\nvec3 dimmedTurbo(float x) {\n    return TurboColormap(x) * dim(x);\n}\n\nvec4 turboColorMapInit (vec2 uv_1, float iTime_0){\n    vec3 col = mix(\n        dimmedTurbo(mod(uv_1.x - iTime_0 * .04, 1.)),\n        dimmedTurbo(1. - mod(uv_1.x + iTime_0 * .15, 1.)),\n        uv_1.y\n    );\n    return vec4(col, 1.0);\n}\n\n// https://www.shadertoy.com/view/7lffzl\n\n// vec4 blobRainbowEventMouse(vec2 uv, vec2 iMouse, vec2 iResolution, float iTime){ // maybe use for research later\n//     vec4 fragColor;\n//     vec2 mouseRel = iMouse.xy / iResolution.xy;//vec2(1280.,720.);\n//     vec2 relCenter = vec2(0.5,0.5);\n    \n    \n//     // Rotation Direction\n//     vec3 baseValue = vec3(0,2,4);\n//     vec3 initialRotationDirection = baseValue;\n\n//     // Brightness\n//     float distanceFromCenter = length(mouseRel.xy-relCenter);\n//     float relCenterRadius = 0.1;\n//     float distanceSensitivity = 20.;\n//     float inTheZone = max(relCenterRadius,distanceFromCenter) - relCenterRadius;\n//     float brightness = 1. - distanceSensitivity*inTheZone;\n    \n//     // Circle\n//     float distanceFromMouse = 5.*length(uv - mouseRel);\n//     float fuzzyFactor1 = 5.;\n//     float fuzzyFactor2 = 1.6;\n//     float centerBright = 5.;\n//     vec3 circleArea = vec3(centerBright*brightness + fuzzyFactor1*pow(distanceFromMouse,fuzzyFactor2));\n\n//     // Time varying pixel color\n//     vec3 timeVarying = cos(iTime+uv.xyx+initialRotationDirection);\n    \n//     vec3 col = 0.5 + distanceFromCenter*circleArea *0.03 + 0.5*timeVarying;\n    \n//     // Output to screen\n//     return fragColor = vec4(col,1.0);\n// }\n\nvec3 blobRainbow( vec2 uv, float iTime, vec2 posPin, float distanceMulti, bool noUseModify, vec3 colorModify) //out vec4 fragColor, in vec2 fragCoord\n{\n    vec2 relCenter = vec2(0.5,0.5);\n    \n    \n    // Rotation Direction\n    vec3 baseValue = vec3(0,2,4);\n    vec3 initialRotationDirection = baseValue;\n\n    // Brightness\n    float distanceFromCenter = length(posPin.xy - relCenter);\n    float relCenterRadius = 0.1;\n    float distanceSensitivity = 20.;\n    float inTheZone = max(relCenterRadius,distanceFromCenter) - relCenterRadius;\n    float brightness = 1. - distanceSensitivity*inTheZone;\n    \n    // Circle\n    float distanceFromMouse = distanceMulti*length(uv - posPin);\n    float fuzzyFactor1 = 5.;\n    float fuzzyFactor2 = 1.6;\n    float centerBright = 5.;\n    vec3 circleArea = vec3(centerBright*brightness + fuzzyFactor1*pow(distanceFromMouse,fuzzyFactor2));\n\n    // Time varying pixel color\n    vec3 timeVarying = cos(iTime+uv.xyx+initialRotationDirection);\n    vec3 col;\n    if(noUseModify){\n        col = distanceFromCenter*circleArea *0.03 + 0.5*timeVarying;\n    }\n    else{\n        col = distanceFromCenter*circleArea *0.03 + 0.5*colorModify;\n    }\n    // Output to screen\n    return col;\n}\n\n// https://www.shadertoy.com/view/MdlXz8\n\n// Found this on GLSL sandbox. I really liked it, changed a few things and made it tileable.\n// :)\n// by David Hoskins.\n// Original water turbulence effect by joltz0r\n\n// Redefine below to see the tiling...\n//#define SHOW_TILING\n\n#define TAU 6.28318530718\n#define MAX_ITER 5\n\nvec3 tileableWater(vec2 uv, float iTime, vec2 iResolution, vec3 bgColor) {\n    float time = iTime * .5 + 23.0;\n    // uv should be the 0-1 uv of texture...\n\t//vec2 uv = fragCoord.xy / iResolution.xy;\n#ifdef SHOW_TILING\n    vec2 p = mod(uv * TAU * 2.0, TAU) - 250.0;\n#else\n    vec2 p = mod(uv * TAU, TAU) - 250.0;\n#endif\n    vec2 i = vec2(p);\n    float c = 1.0;\n    float inten = .005;\n\n    for(int n = 0; n < MAX_ITER; n++) {\n        float t = time * (1.0 - (3.5 / float(n + 1)));\n        i = p + vec2(cos(t - i.x) + sin(t + i.y), sin(t - i.y) + cos(t + i.x));\n        c += 1.0 / length(vec2(p.x / (sin(i.x + t) / inten), p.y / (cos(i.y + t) / inten)));\n    }\n    c /= float(MAX_ITER);\n    c = 1.17 - pow(c, 1.4);\n    vec3 colour = vec3(pow(abs(c), 8.0));\n    colour = clamp(colour + bgColor, 0.0, 1.0);\n\n\t#ifdef SHOW_TILING\n\t// Flash tile borders...\n    vec2 pixel = 2.0 / iResolution.xy;\n    uv *= 2.0;\n    float f = floor(mod(iTime * .5, 2.0)); \t// Flash value.\n    vec2 first = step(pixel, uv) * f;\t\t   \t// Rule out first screen pixels and flash.\n    uv = step(fract(uv), pixel);\t\t\t\t// Add one line of pixels per tile.\n    colour = mix(colour, vec3(1.0, 1.0, 0.0), (uv.x + uv.y) * first.x * first.y); // Yellow line\n\t#endif\n\n    return colour;\n}\n\nuniform vec3 uResolution;\nuniform float uTick;\nuniform bool isUseEnvMap;\n\nuniform vec3 uPos;\n\nconst float PI2 = 6.28318530718;\n\nvarying vec3 worldNormal;\nvarying vec3 eyeVector;\nvarying vec2 vUv;\n\nvarying float vSides;\n\n//uniform sampler2D uMapTexture;\nuniform vec2 uPositionLight;\nuniform float uLightPower;\n\nuniform samplerCube uEnvMap;\nuniform float uOpacity;\n\nuniform int uCausticType;\n\nuniform vec3 colorGlass[2];\nuniform bool isNoUseModifyColors;\n\nuniform vec3 colorBorder[2];\nuniform bool isNoUseModifyColorsBorder;\n\nfloat Fresnel(vec3 eyeVector, vec3 worldNormal) {\n    return pow(1.0 + dot(eyeVector, worldNormal), 1.0);\n}\n\nvoid main() {\n    vec2 st = gl_FragCoord.xy / uResolution.xy;\n    vec2 st2 = st;\n    vec3 normal = worldNormal;\n    vec2 posColor = vec2(0.5);\n    float f = Fresnel(eyeVector, normal);\n\n    vec3 refracted = refract(eyeVector, normal, 1.0 / 1.0);\n    st += refracted.xy;\n\n    //vec4 borderColor = vec4(gradients(1, vUv, uTick*1.15), 1.0);\n    vec3 colorBorderModify = gradientMix2Colors(st, uTick*5., colorBorder[0], colorBorder[1], vec2(0.75));\n    vec4 borderColor = radialRainbow(st, uTick, posColor);\n    if(!isNoUseModifyColorsBorder){\n        borderColor = vec4(colorBorderModify, 1.0);\n    }\n    float depth = clamp(smoothstep(-1.0, 1.0, 1.0), 0.6, 0.9);\n    borderColor *= vec4(borders(vUv, 0.012)*depth);\n    float opacityOfFresnel = uOpacity/100.*f + 0.01;\n    //\n    vec2 thetaphi = ((st * 2.0) - vec2(1.0)) * vec2(3.1415926535897932384626433832795, 1.5707963267948966192313216916398); \n    vec3 rayDirection = vec3(cos(thetaphi.y) * cos(thetaphi.x), sin(thetaphi.y), cos(thetaphi.y) * sin(thetaphi.x));\n\tvec4 _cubeMap = textureCube(uEnvMap, rayDirection);\n    _cubeMap.a = opacityOfFresnel;\n    /////\n    vec3 colorModify = gradientMix2Colors(st, uTick*5., colorGlass[0], colorGlass[1], vec2(0.75));\n    vec4 col;\n    if(uCausticType == 0){\n        col = causticCrystal(uResolution, uTick*5., gl_FragCoord.xy, colorModify, isNoUseModifyColors);\n    }\n    if(uCausticType == 1){\n        col = causticAmoebas(st2, uTick*5.);\n    }\n    if(uCausticType == 2){\n        col = solubleRainbow(gl_FragCoord.xy, uResolution, uTick*5.);\n    }\n    if(uCausticType == 3){\n        col = turboColorMapInit(st2, uTick*10.);\n    }\n    if(uCausticType == 4){\n        vec3 col1 = blobRainbow(st, uTick*5., vec2(0.25, 0.25), 10., isNoUseModifyColors, colorModify);\n        col1 = 0.75 - col1;\n        col = vec4(col1, 1.0);\n    }\n    if(uCausticType == 5){\n        float tick = uTick * 5.;\n        vec3 bgColor = vec3(sin(0.57 + 7. + tick * .7), sin(0.59 - 15. - tick * .65), sin( 0.6 + tick * .9)) * 0.5;\n        if(!isNoUseModifyColors){\n            bgColor = colorModify;\n        }\n        vec3 col1 = tileableWater(st2, tick, uResolution.xy, bgColor);\n        col = vec4(col1, 1.0);\n    }\n    col.a = opacityOfFresnel;\n    //\n    vec2 positionLight = st - uPositionLight;\n    vec4 pointLight1 = pointLightPhysic(positionLight, uTick*5., uLightPower/ 100.);\n    ///\n    if(isUseEnvMap){\n        gl_FragColor = borderColor + _cubeMap;\n    }\n    else{\n        gl_FragColor = vec4(pointLight1.rgb, pointLight1.a) + borderColor + col;\n    }\n}"})).uniforms=t,r.transparent=!0,r.side=c.ehD,r.getUniform=function(){return r.uniforms},r}return n}(c.jyz);function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var v,g,x,y,_,b,w,M=function(t){(0,s.Z)(n,t);var e=m(n);function n(t){var r,s=t.$container,o=t.size,a=void 0===o?{}:o,l=t.options,u=void 0===l?{}:l,h=t.transition,p=void 0===h?null:h,f=t.cubeMap,m=void 0===f?null:f,v=t.optionsColorSideLogo,g=void 0===v?null:v,x=t.optionsColorGlassCube,y=void 0===x?null:x,_=t.optionsColorBorder,b=void 0===_?null:_;return(0,i.Z)(this,n),(r=e.call(this,s,a.width,a.height,!0)).options=u,r.optionsColorSideLogo=g,r.optionsColorGlassCube=y,r.optionsColorBorder=b,r.transition=p,r.resolution=(0,d.iQ)({W:r.W,H:r.H}),r.maskLogoSrc=document.getElementById("maskLogo").dataset.src,r.maskLogoTextSrc=document.getElementById("maskLogoText").dataset.src,r.mapBumpSrc=document.getElementById("map-bump-env").dataset.src,r.loader=new c.dpR,r.groupCube=new c.ZAu,r.cubeMap=m,r.init(),r}return(0,r.Z)(n,[{key:"init",value:function(){this.start(),this.renderer.autoClear=!1,this.initPerspectiveCamera(),this.initOrthographicCamera(),this.camera.position.z=this.options.zCameraPer,this.orthoCamera.position.z=this.options.zCameraOrtho,this.zPositionCube=this.options.zPositionCube,this.isRotate=this.options.isRotate,this.mainScene.add(this.groupCube),this.causticType=this.options.causticType,this.createFbo(),this.createLogoPlane(),this.createLogoTextPlane(),this.createCubeBorder(),this.createCube(),this.update()}},{key:"initOrthographicCamera",value:function(){this.orthoCamera=new c.iKG(this.W/-2,this.W/2,this.H/2,this.H/-2,1,1e3),this.orthoCamera.layers.set(1),this.mainScene.add(this.orthoCamera)}},{key:"createFbo",value:function(){this.envFbo=new c.dd2(this.W*this.resolution.z,this.H*this.resolution.z),this.sceneTarget=new c.xsS,this.envFbo2=new c.dd2(this.W*this.resolution.z,this.H*this.resolution.z),this.sceneTarget2=new c.xsS}},{key:"createLogoPlane",value:function(){var t=new c._12(1,1,1,1),e=new c.vBJ({map:this.loader.load(this.maskLogoSrc)});this.planeLogo=new c.Kj0(t,e),this.planeLogo.layers.set(1);var n=this.options.scale1||1;this.planeLogo.scale.set(1071*n,1830*n),this.planeLogo.position.x=this.groupCube.position.x,this.planeLogo.position.y=this.groupCube.position.y,this.sceneTarget.add(this.planeLogo)}},{key:"createLogoTextPlane",value:function(){var t=new c._12(1,1,1,1),e=new c.vBJ({map:this.loader.load(this.maskLogoTextSrc)});this.planeLogoText=new c.Kj0(t,e),this.planeLogoText.layers.set(1);var n=this.options.scale2||1;this.planeLogoText.scale.set(5682*n,1830*n),this.planeLogoText.position.x=this.groupCube.position.x,this.planeLogoText.position.y=this.groupCube.position.y,this.sceneTarget2.add(this.planeLogoText)}},{key:"updateCallback",value:function(){this.cubeMesh&&(this.cubeMesh.material.uniforms.uTick.value+=.001),this.cubeBorderMesh&&(this.cubeBorderMesh.material.uniforms.uTick.value+=.001),this.renderer.clear(),this.renderer.setRenderTarget(this.envFbo),this.renderer.render(this.sceneTarget,this.orthoCamera),this.renderer.setRenderTarget(null),this.renderer.setRenderTarget(this.envFbo2),this.renderer.render(this.sceneTarget2,this.orthoCamera),this.renderer.setRenderTarget(null),this.renderer.clearDepth(),this.transition&&this.transition()}},{key:"getColorLogoSideCube",value:function(){if(!this.optionsColorSideLogo)return!1;var t={},e=this.optionsColorSideLogo,n=e.side1,i=e.side2,r=e.side3,s=e.side4,o=e.side5,a=e.side6;return t.side1={},t.side1.color1=this.colorToVector(n.color1),t.side1.color2=this.colorToVector(n.color2),t.side2={},t.side2.color1=this.colorToVector(i.color1),t.side2.color2=this.colorToVector(i.color2),t.side3={},t.side3.color1=this.colorToVector(r.color1),t.side3.color2=this.colorToVector(r.color2),t.side4={},t.side4.color1=this.colorToVector(s.color1),t.side4.color2=this.colorToVector(s.color2),t.side5={},t.side5.color1=this.colorToVector(o.color1),t.side5.color2=this.colorToVector(o.color2),t.side6={},t.side6.color1=this.colorToVector(a.color1),t.side6.color2=this.colorToVector(a.color2),t}},{key:"createCube",value:function(){var t=new c.DvJ(1,1,1,1);t.setAttribute("sides",new c.a$l(this.createArraySidesCube(),1));var e=this.getColorLogoSideCube();this.mat=new h({uPos:{value:this.groupCube.position},uType:{value:1},uBounce:{value:0},uResolution:{value:{x:this.resolution.x*this.resolution.z,y:this.resolution.y*this.resolution.z,z:this.resolution.z}},uTick:{value:0},uMask1:{value:this.envFbo.texture},uMask2:{value:this.envFbo2.texture},isRefract:{value:!1},lenghtDisplacement:{value:null!==this.options.lenghtDisplacement?this.options.lenghtDisplacement:0},zPosition:{value:1},lengthMaximum:{value:null!==this.options.lengthMaximum?this.options.lengthMaximum:2.2},colorSide1:{value:[e.side1.color1,e.side1.color2]},colorSide2:{value:[e.side2.color1,e.side2.color2]},colorSide3:{value:[e.side3.color1,e.side3.color2]},colorSide4:{value:[e.side4.color1,e.side4.color2]},colorSide5:{value:[e.side5.color1,e.side5.color2]},colorSide6:{value:[e.side6.color1,e.side6.color2]}}),this.cubeMesh=new c.Kj0(t,this.mat),this.cubeMesh.position.z=this.zPositionCube-.05,this.groupCube.add(this.cubeMesh)}},{key:"createCubeBorder",value:function(){var t=new c.DvJ(1,1,1,1);this.mat=new f({uPos:{value:this.groupCube.position},uResolution:{value:{x:this.resolution.x*this.resolution.z,y:this.resolution.y*this.resolution.z,z:this.resolution.z}},isUseEnvMap:{value:!0},uCausticType:{value:this.causticType},uOpacity:{value:this.options.opacityGlass},uTick:{value:0},zPosition:{value:1},uEnvMap:{value:this.cubeMap},uMapTexture:{value:this.loader.load(this.mapBumpSrc)},uPositionLight:{value:new c.FM8(this.options.positionLight.x,this.options.positionLight.y)},uLightPower:{value:this.options.lightPower},colorGlass:{value:[new c.Ilk(this.optionsColorGlassCube.color1),new c.Ilk(this.optionsColorGlassCube.color2)]},colorBorder:{value:[new c.Ilk(this.optionsColorBorder.color1),new c.Ilk(this.optionsColorBorder.color2)]},isNoUseModifyColors:{value:this.optionsColorGlassCube.notUse},isNoUseModifyColorsBorder:{value:this.optionsColorBorder.notUse}}),this.cubeBorderMesh=new c.Kj0(t,this.mat),this.cubeBorderMesh.position.z=this.zPositionCube,this.groupCube.add(this.cubeBorderMesh)}},{key:"colorToVector",value:function(t){return new c.Ilk(t)}},{key:"createArraySidesCube",value:function(){return[].concat([0,0,0,0],[1,1,1,1],[2,2,2,2],[3,3,3,3],[4,4,4,4],[5,5,5,5])}},{key:"resize",value:function(){var t=this;window.addEventListener("resize",(function(){t.W=window.innerWidth,t.H=window.innerHeight,t.resolution=(0,d.iQ)({W:t.W,H:t.H}),t.renderer.setSize(t.W,t.H),t.camera.aspect=t.W/t.H,t.camera.updateProjectionMatrix(),t.orthoCamera.left=t.W/-2,t.orthoCamera.right=t.W/2,t.orthoCamera.top=t.H/2,t.orthoCamera.bottom=t.H/-2,t.orthoCamera.updateProjectionMatrix(),t.cubeMesh.material.uniforms.uResolution.value={x:t.resolution.x*t.resolution.z,y:t.resolution.y*t.resolution.z,z:t.resolution.z},t.cubeBorderMesh.material.uniforms.uResolution.value={x:t.resolution.x*t.resolution.z,y:t.resolution.y*t.resolution.z,z:t.resolution.z},t.envFbo.setSize(t.W*t.resolution.z,t.H*t.resolution.z),t.envFbo2.setSize(t.W*t.resolution.z,t.H*t.resolution.z)}))}}]),n}(l.Z),S=n(498),C=n(317),T={},P=180/Math.PI,A=Math.PI/180,E=Math.atan2,L=/([A-Z])/g,D=/(left|right|width|margin|padding|x)/i,k=/[\s,\(]\S/,R={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},I=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},z=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},O=function(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)},N=function(t,e){var n=e.s+e.c*t;e.set(e.t,e.p,~~(n+(n<0?-.5:.5))+e.u,e)},F=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},B=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},U=function(t,e,n){return t.style[e]=n},V=function(t,e,n){return t.style.setProperty(e,n)},H=function(t,e,n){return t._gsap[e]=n},j=function(t,e,n){return t._gsap.scaleX=t._gsap.scaleY=n},W=function(t,e,n,i,r){var s=t._gsap;s.scaleX=s.scaleY=n,s.renderTransform(r,s)},G=function(t,e,n,i,r){var s=t._gsap;s[e]=n,s.renderTransform(r,s)},q="transform",X=q+"Origin",Z=function(t,e){var n=g.createElementNS?g.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):g.createElement(t);return n.style?n:g.createElement(t)},Y=function t(e,n,i){var r=getComputedStyle(e);return r[n]||r.getPropertyValue(n.replace(L,"-$1").toLowerCase())||r.getPropertyValue(n)||!i&&t(e,J(n)||n,1)||""},K="O,Moz,ms,Ms,Webkit".split(","),J=function(t,e,n){var i=(e||_).style,r=5;if(t in i&&!n)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);r--&&!(K[r]+t in i););return r<0?null:(3===r?"ms":r>=0?K[r]:"")+t},$=function(){"undefined"!=typeof window&&window.document&&(v=window,g=v.document,x=g.documentElement,_=Z("div")||{style:{}},Z("div"),q=J(q),X=q+"Origin",_.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",w=!!J("perspective"),y=1)},Q=function t(e){var n,i=Z("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=this.parentNode,s=this.nextSibling,o=this.style.cssText;if(x.appendChild(i),i.appendChild(this),this.style.display="block",e)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=t}catch(t){}else this._gsapBBox&&(n=this._gsapBBox());return r&&(s?r.insertBefore(this,s):r.appendChild(this)),x.removeChild(i),this.style.cssText=o,n},tt=function(t,e){for(var n=e.length;n--;)if(t.hasAttribute(e[n]))return t.getAttribute(e[n])},et=function(t){var e;try{e=t.getBBox()}catch(n){e=Q.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===Q||(e=Q.call(t,!0)),!e||e.width||e.x||e.y?e:{x:+tt(t,["x","cx","x1"])||0,y:+tt(t,["y","cy","y1"])||0,width:0,height:0}},nt=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!et(t))},it=function(t,e){if(e){var n=t.style;e in T&&e!==X&&(e=q),n.removeProperty?("ms"!==e.substr(0,2)&&"webkit"!==e.substr(0,6)||(e="-"+e),n.removeProperty(e.replace(L,"-$1").toLowerCase())):n.removeAttribute(e)}},rt=function(t,e,n,i,r,s){var o=new C.Fo(t._pt,e,n,0,1,s?B:F);return t._pt=o,o.b=i,o.e=r,t._props.push(n),o},st={deg:1,rad:1,turn:1},ot=function t(e,n,i,r){var s,o,a,l,c=parseFloat(i)||0,u=(i+"").trim().substr((c+"").length)||"px",h=_.style,d=D.test(n),p="svg"===e.tagName.toLowerCase(),f=(p?"client":"offset")+(d?"Width":"Height"),m=100,v="px"===r,x="%"===r;return r===u||!c||st[r]||st[u]?c:("px"!==u&&!v&&(c=t(e,n,i,"px")),l=e.getCTM&&nt(e),!x&&"%"!==u||!T[n]&&!~n.indexOf("adius")?(h[d?"width":"height"]=m+(v?u:r),o=~n.indexOf("adius")||"em"===r&&e.appendChild&&!p?e:e.parentNode,l&&(o=(e.ownerSVGElement||{}).parentNode),o&&o!==g&&o.appendChild||(o=g.body),(a=o._gsap)&&x&&a.width&&d&&a.time===C.xr.time?(0,C.Pr)(c/a.width*m):((x||"%"===u)&&(h.position=Y(e,"position")),o===e&&(h.position="static"),o.appendChild(_),s=_[f],o.removeChild(_),h.position="absolute",d&&x&&((a=(0,C.DY)(o)).time=C.xr.time,a.width=o[f]),(0,C.Pr)(v?s*c/m:s&&c?m/s*c:0))):(s=l?e.getBBox()[d?"width":"height"]:e[f],(0,C.Pr)(x?c/s*m:c/100*s)))},at=function(t,e,n,i){var r;return y||$(),e in R&&"transform"!==e&&~(e=R[e]).indexOf(",")&&(e=e.split(",")[0]),T[e]&&"transform"!==e?(r=xt(t,i),r="transformOrigin"!==e?r[e]:r.svg?r.origin:yt(Y(t,X))+" "+r.zOrigin+"px"):(!(r=t.style[e])||"auto"===r||i||~(r+"").indexOf("calc("))&&(r=ht[e]&&ht[e](t,e,n)||Y(t,e)||(0,C.Ok)(t,e)||("opacity"===e?1:0)),n&&!~(r+"").trim().indexOf(" ")?ot(t,e,r,n)+n:r},lt=function(t,e,n,i){if(!n||"none"===n){var r=J(e,t,1),s=r&&Y(t,r,1);s&&s!==n?(e=r,n=s):"borderColor"===e&&(n=Y(t,"borderTopColor"))}var o,a,l,c,u,h,d,p,f,m,v,g=new C.Fo(this._pt,t.style,e,0,1,C.Ks),x=0,y=0;if(g.b=n,g.e=i,n+="","auto"===(i+="")&&(t.style[e]=i,i=Y(t,e)||i,t.style[e]=n),o=[n,i],(0,C.kr)(o),i=o[1],l=(n=o[0]).match(C.d4)||[],(i.match(C.d4)||[]).length){for(;a=C.d4.exec(i);)d=a[0],f=i.substring(x,a.index),u?u=(u+1)%5:"rgba("!==f.substr(-5)&&"hsla("!==f.substr(-5)||(u=1),d!==(h=l[y++]||"")&&(c=parseFloat(h)||0,v=h.substr((c+"").length),"="===d.charAt(1)&&(d=(0,C.cy)(c,d)+v),p=parseFloat(d),m=d.substr((p+"").length),x=C.d4.lastIndex-m.length,m||(m=m||C.Fc.units[e]||v,x===i.length&&(i+=m,g.e+=m)),v!==m&&(c=ot(t,e,h,m)||0),g._pt={_next:g._pt,p:f||1===y?f:",",s:c,c:p-c,m:u&&u<4||"zIndex"===e?Math.round:0});g.c=x<i.length?i.substring(x,i.length):""}else g.r="display"===e&&"none"===i?B:F;return C.bQ.test(i)&&(g.e=0),this._pt=g,g},ct={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},ut=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var n,i,r,s=e.t,o=s.style,a=e.u,l=s._gsap;if("all"===a||!0===a)o.cssText="",i=1;else for(r=(a=a.split(",")).length;--r>-1;)n=a[r],T[n]&&(i=1,n="transformOrigin"===n?X:q),it(s,n);i&&(it(s,q),l&&(l.svg&&s.removeAttribute("transform"),xt(s,1),l.uncache=1))}},ht={clearProps:function(t,e,n,i,r){if("isFromStart"!==r.data){var s=t._pt=new C.Fo(t._pt,e,n,0,0,ut);return s.u=i,s.pr=-10,s.tween=r,t._props.push(n),1}}},dt=[1,0,0,1,0,0],pt={},ft=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},mt=function(t){var e=Y(t,q);return ft(e)?dt:e.substr(7).match(C.SI).map(C.Pr)},vt=function(t,e){var n,i,r,s,o=t._gsap||(0,C.DY)(t),a=t.style,l=mt(t);return o.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(r=t.transform.baseVal.consolidate().matrix).a,r.b,r.c,r.d,r.e,r.f]).join(",")?dt:l:(l!==dt||t.offsetParent||t===x||o.svg||(r=a.display,a.display="block",(n=t.parentNode)&&t.offsetParent||(s=1,i=t.nextSibling,x.appendChild(t)),l=mt(t),r?a.display=r:it(t,"display"),s&&(i?n.insertBefore(t,i):n?n.appendChild(t):x.removeChild(t))),e&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},gt=function(t,e,n,i,r,s){var o,a,l,c=t._gsap,u=r||vt(t,!0),h=c.xOrigin||0,d=c.yOrigin||0,p=c.xOffset||0,f=c.yOffset||0,m=u[0],v=u[1],g=u[2],x=u[3],y=u[4],_=u[5],b=e.split(" "),w=parseFloat(b[0])||0,M=parseFloat(b[1])||0;n?u!==dt&&(a=m*x-v*g)&&(l=w*(-v/a)+M*(m/a)-(m*_-v*y)/a,w=w*(x/a)+M*(-g/a)+(g*_-x*y)/a,M=l):(w=(o=et(t)).x+(~b[0].indexOf("%")?w/100*o.width:w),M=o.y+(~(b[1]||b[0]).indexOf("%")?M/100*o.height:M)),i||!1!==i&&c.smooth?(y=w-h,_=M-d,c.xOffset=p+(y*m+_*g)-y,c.yOffset=f+(y*v+_*x)-_):c.xOffset=c.yOffset=0,c.xOrigin=w,c.yOrigin=M,c.smooth=!!i,c.origin=e,c.originIsAbsolute=!!n,t.style[X]="0px 0px",s&&(rt(s,c,"xOrigin",h,w),rt(s,c,"yOrigin",d,M),rt(s,c,"xOffset",p,c.xOffset),rt(s,c,"yOffset",f,c.yOffset)),t.setAttribute("data-svg-origin",w+" "+M)},xt=function(t,e){var n=t._gsap||new C.l1(t);if("x"in n&&!e&&!n.uncache)return n;var i,r,s,o,a,l,c,u,h,d,p,f,m,v,g,x,y,_,b,M,S,T,L,D,k,R,I,z,O,N,F,B,U=t.style,V=n.scaleX<0,H="px",j="deg",W=Y(t,X)||"0";return i=r=s=l=c=u=h=d=p=0,o=a=1,n.svg=!(!t.getCTM||!nt(t)),v=vt(t,n.svg),n.svg&&(D=(!n.uncache||"0px 0px"===W)&&!e&&t.getAttribute("data-svg-origin"),gt(t,D||W,!!D||n.originIsAbsolute,!1!==n.smooth,v)),f=n.xOrigin||0,m=n.yOrigin||0,v!==dt&&(_=v[0],b=v[1],M=v[2],S=v[3],i=T=v[4],r=L=v[5],6===v.length?(o=Math.sqrt(_*_+b*b),a=Math.sqrt(S*S+M*M),l=_||b?E(b,_)*P:0,(h=M||S?E(M,S)*P+l:0)&&(a*=Math.abs(Math.cos(h*A))),n.svg&&(i-=f-(f*_+m*M),r-=m-(f*b+m*S))):(B=v[6],N=v[7],I=v[8],z=v[9],O=v[10],F=v[11],i=v[12],r=v[13],s=v[14],c=(g=E(B,O))*P,g&&(D=T*(x=Math.cos(-g))+I*(y=Math.sin(-g)),k=L*x+z*y,R=B*x+O*y,I=T*-y+I*x,z=L*-y+z*x,O=B*-y+O*x,F=N*-y+F*x,T=D,L=k,B=R),u=(g=E(-M,O))*P,g&&(x=Math.cos(-g),F=S*(y=Math.sin(-g))+F*x,_=D=_*x-I*y,b=k=b*x-z*y,M=R=M*x-O*y),l=(g=E(b,_))*P,g&&(D=_*(x=Math.cos(g))+b*(y=Math.sin(g)),k=T*x+L*y,b=b*x-_*y,L=L*x-T*y,_=D,T=k),c&&Math.abs(c)+Math.abs(l)>359.9&&(c=l=0,u=180-u),o=(0,C.Pr)(Math.sqrt(_*_+b*b+M*M)),a=(0,C.Pr)(Math.sqrt(L*L+B*B)),g=E(T,L),h=Math.abs(g)>2e-4?g*P:0,p=F?1/(F<0?-F:F):0),n.svg&&(D=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!ft(Y(t,q)),D&&t.setAttribute("transform",D))),Math.abs(h)>90&&Math.abs(h)<270&&(V?(o*=-1,h+=l<=0?180:-180,l+=l<=0?180:-180):(a*=-1,h+=h<=0?180:-180)),e=e||n.uncache,n.x=i-((n.xPercent=i&&(!e&&n.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-i)?-50:0)))?t.offsetWidth*n.xPercent/100:0)+H,n.y=r-((n.yPercent=r&&(!e&&n.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-r)?-50:0)))?t.offsetHeight*n.yPercent/100:0)+H,n.z=s+H,n.scaleX=(0,C.Pr)(o),n.scaleY=(0,C.Pr)(a),n.rotation=(0,C.Pr)(l)+j,n.rotationX=(0,C.Pr)(c)+j,n.rotationY=(0,C.Pr)(u)+j,n.skewX=h+j,n.skewY=d+j,n.transformPerspective=p+H,(n.zOrigin=parseFloat(W.split(" ")[2])||0)&&(U[X]=yt(W)),n.xOffset=n.yOffset=0,n.force3D=C.Fc.force3D,n.renderTransform=n.svg?Tt:w?Ct:bt,n.uncache=0,n},yt=function(t){return(t=t.split(" "))[0]+" "+t[1]},_t=function(t,e,n){var i=(0,C.Wy)(e);return(0,C.Pr)(parseFloat(e)+parseFloat(ot(t,"x",n+"px",i)))+i},bt=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,Ct(t,e)},wt="0deg",Mt="0px",St=") ",Ct=function(t,e){var n=e||this,i=n.xPercent,r=n.yPercent,s=n.x,o=n.y,a=n.z,l=n.rotation,c=n.rotationY,u=n.rotationX,h=n.skewX,d=n.skewY,p=n.scaleX,f=n.scaleY,m=n.transformPerspective,v=n.force3D,g=n.target,x=n.zOrigin,y="",_="auto"===v&&t&&1!==t||!0===v;if(x&&(u!==wt||c!==wt)){var b,w=parseFloat(c)*A,M=Math.sin(w),S=Math.cos(w);w=parseFloat(u)*A,b=Math.cos(w),s=_t(g,s,M*b*-x),o=_t(g,o,-Math.sin(w)*-x),a=_t(g,a,S*b*-x+x)}m!==Mt&&(y+="perspective("+m+St),(i||r)&&(y+="translate("+i+"%, "+r+"%) "),(_||s!==Mt||o!==Mt||a!==Mt)&&(y+=a!==Mt||_?"translate3d("+s+", "+o+", "+a+") ":"translate("+s+", "+o+St),l!==wt&&(y+="rotate("+l+St),c!==wt&&(y+="rotateY("+c+St),u!==wt&&(y+="rotateX("+u+St),h===wt&&d===wt||(y+="skew("+h+", "+d+St),1===p&&1===f||(y+="scale("+p+", "+f+St),g.style[q]=y||"translate(0, 0)"},Tt=function(t,e){var n,i,r,s,o,a=e||this,l=a.xPercent,c=a.yPercent,u=a.x,h=a.y,d=a.rotation,p=a.skewX,f=a.skewY,m=a.scaleX,v=a.scaleY,g=a.target,x=a.xOrigin,y=a.yOrigin,_=a.xOffset,b=a.yOffset,w=a.forceCSS,M=parseFloat(u),S=parseFloat(h);d=parseFloat(d),p=parseFloat(p),(f=parseFloat(f))&&(p+=f=parseFloat(f),d+=f),d||p?(d*=A,p*=A,n=Math.cos(d)*m,i=Math.sin(d)*m,r=Math.sin(d-p)*-v,s=Math.cos(d-p)*v,p&&(f*=A,o=Math.tan(p-f),r*=o=Math.sqrt(1+o*o),s*=o,f&&(o=Math.tan(f),n*=o=Math.sqrt(1+o*o),i*=o)),n=(0,C.Pr)(n),i=(0,C.Pr)(i),r=(0,C.Pr)(r),s=(0,C.Pr)(s)):(n=m,s=v,i=r=0),(M&&!~(u+"").indexOf("px")||S&&!~(h+"").indexOf("px"))&&(M=ot(g,"x",u,"px"),S=ot(g,"y",h,"px")),(x||y||_||b)&&(M=(0,C.Pr)(M+x-(x*n+y*r)+_),S=(0,C.Pr)(S+y-(x*i+y*s)+b)),(l||c)&&(o=g.getBBox(),M=(0,C.Pr)(M+l/100*o.width),S=(0,C.Pr)(S+c/100*o.height)),o="matrix("+n+","+i+","+r+","+s+","+M+","+S+")",g.setAttribute("transform",o),w&&(g.style[q]=o)},Pt=function(t,e,n,i,r){var s,o,a=360,l=(0,C.r9)(r),c=parseFloat(r)*(l&&~r.indexOf("rad")?P:1)-i,u=i+c+"deg";return l&&("short"===(s=r.split("_")[1])&&(c%=a)!==c%180&&(c+=c<0?a:-360),"cw"===s&&c<0?c=(c+36e9)%a-~~(c/a)*a:"ccw"===s&&c>0&&(c=(c-36e9)%a-~~(c/a)*a)),t._pt=o=new C.Fo(t._pt,e,n,i,c,z),o.e=u,o.u="deg",t._props.push(n),o},At=function(t,e){for(var n in e)t[n]=e[n];return t},Et=function(t,e,n){var i,r,s,o,a,l,c,u=At({},n._gsap),h=n.style;for(r in u.svg?(s=n.getAttribute("transform"),n.setAttribute("transform",""),h[q]=e,i=xt(n,1),it(n,q),n.setAttribute("transform",s)):(s=getComputedStyle(n)[q],h[q]=e,i=xt(n,1),h[q]=s),T)(s=u[r])!==(o=i[r])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(r)<0&&(a=(0,C.Wy)(s)!==(c=(0,C.Wy)(o))?ot(n,r,s,c):parseFloat(s),l=parseFloat(o),t._pt=new C.Fo(t._pt,i,r,a,l-a,I),t._pt.u=c||0,t._props.push(r));At(i,u)};(0,C.fS)("padding,margin,Width,Radius",(function(t,e){var n="Top",i="Right",r="Bottom",s="Left",o=(e<3?[n,i,r,s]:[n+s,n+i,r+i,r+s]).map((function(n){return e<2?t+n:"border"+n+t}));ht[e>1?"border"+t:t]=function(t,e,n,i,r){var s,a;if(arguments.length<4)return s=o.map((function(e){return at(t,e,n)})),5===(a=s.join(" ")).split(s[0]).length?s[0]:a;s=(i+"").split(" "),a={},o.forEach((function(t,e){return a[t]=s[e]=s[e]||s[(e-1)/2|0]})),t.init(e,a,r)}}));var Lt,Dt,kt,Rt={name:"css",register:$,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,n,i,r){var s,o,a,l,c,u,h,d,p,f,m,v,g,x,_,b,w,M,S,P=this._props,A=t.style,E=n.vars.startAt;for(h in y||$(),e)if("autoRound"!==h&&(o=e[h],!C.$i[h]||!(0,C.if)(h,e,n,i,t,r)))if(c=typeof o,u=ht[h],"function"===c&&(c=typeof(o=o.call(n,i,t,r))),"string"===c&&~o.indexOf("random(")&&(o=(0,C.UI)(o)),u)u(this,t,h,o,n)&&(_=1);else if("--"===h.substr(0,2))s=(getComputedStyle(t).getPropertyValue(h)+"").trim(),o+="",C.GN.lastIndex=0,C.GN.test(s)||(d=(0,C.Wy)(s),p=(0,C.Wy)(o)),p?d!==p&&(s=ot(t,h,s,p)+p):d&&(o+=d),this.add(A,"setProperty",s,o,i,r,0,0,h),P.push(h);else if("undefined"!==c){if(E&&h in E?(s="function"==typeof E[h]?E[h].call(n,i,t,r):E[h],(0,C.r9)(s)&&~s.indexOf("random(")&&(s=(0,C.UI)(s)),(0,C.Wy)(s+"")||(s+=C.Fc.units[h]||(0,C.Wy)(at(t,h))||""),"="===(s+"").charAt(1)&&(s=at(t,h))):s=at(t,h),l=parseFloat(s),(f="string"===c&&"="===o.charAt(1)&&o.substr(0,2))&&(o=o.substr(2)),a=parseFloat(o),h in R&&("autoAlpha"===h&&(1===l&&"hidden"===at(t,"visibility")&&a&&(l=0),rt(this,A,"visibility",l?"inherit":"hidden",a?"inherit":"hidden",!a)),"scale"!==h&&"transform"!==h&&~(h=R[h]).indexOf(",")&&(h=h.split(",")[0])),m=h in T)if(v||((g=t._gsap).renderTransform&&!e.parseTransform||xt(t,e.parseTransform),x=!1!==e.smoothOrigin&&g.smooth,(v=this._pt=new C.Fo(this._pt,A,q,0,1,g.renderTransform,g,0,-1)).dep=1),"scale"===h)this._pt=new C.Fo(this._pt,g,"scaleY",g.scaleY,(f?(0,C.cy)(g.scaleY,f+a):a)-g.scaleY||0),P.push("scaleY",h),h+="X";else{if("transformOrigin"===h){w=void 0,M=void 0,S=void 0,w=(b=o).split(" "),M=w[0],S=w[1]||"50%","top"!==M&&"bottom"!==M&&"left"!==S&&"right"!==S||(b=M,M=S,S=b),w[0]=ct[M]||M,w[1]=ct[S]||S,o=w.join(" "),g.svg?gt(t,o,0,x,0,this):((p=parseFloat(o.split(" ")[2])||0)!==g.zOrigin&&rt(this,g,"zOrigin",g.zOrigin,p),rt(this,A,h,yt(s),yt(o)));continue}if("svgOrigin"===h){gt(t,o,1,x,0,this);continue}if(h in pt){Pt(this,g,h,l,f?(0,C.cy)(l,f+o):o);continue}if("smoothOrigin"===h){rt(this,g,"smooth",g.smooth,o);continue}if("force3D"===h){g[h]=o;continue}if("transform"===h){Et(this,o,t);continue}}else h in A||(h=J(h)||h);if(m||(a||0===a)&&(l||0===l)&&!k.test(o)&&h in A)a||(a=0),(d=(s+"").substr((l+"").length))!==(p=(0,C.Wy)(o)||(h in C.Fc.units?C.Fc.units[h]:d))&&(l=ot(t,h,s,p)),this._pt=new C.Fo(this._pt,m?g:A,h,l,(f?(0,C.cy)(l,f+a):a)-l,m||"px"!==p&&"zIndex"!==h||!1===e.autoRound?I:N),this._pt.u=p||0,d!==p&&"%"!==p&&(this._pt.b=s,this._pt.r=O);else if(h in A)lt.call(this,t,h,s,f?f+o:o);else{if(!(h in t)){(0,C.lC)(h,o);continue}this.add(t,h,s||t[h],f?f+o:o,i,r)}P.push(h)}_&&(0,C.JV)(this)},get:at,aliases:R,getSetter:function(t,e,n){var i=R[e];return i&&i.indexOf(",")<0&&(e=i),e in T&&e!==X&&(t._gsap.x||at(t,"x"))?n&&b===n?"scale"===e?j:H:(b=n||{})&&("scale"===e?W:G):t.style&&!(0,C.m2)(t.style[e])?U:~e.indexOf("-")?V:(0,C.S5)(t,e)},core:{_removeProperty:it,_getMatrix:vt}};C.p8.utils.checkPrefix=J,Lt="x,y,z,scale,scaleX,scaleY,xPercent,yPercent",Dt="rotation,rotationX,rotationY,skewX,skewY",kt=(0,C.fS)(Lt+","+Dt+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(t){T[t]=1})),(0,C.fS)(Dt,(function(t){C.Fc.units[t]="deg",pt[t]=1})),R[kt[13]]=Lt+","+Dt,(0,C.fS)("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(t){var e=t.split(":");R[e[1]]=kt[e[0]]})),(0,C.fS)("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(t){C.Fc.units[t]="px"})),C.p8.registerPlugin(Rt);var It=C.p8.registerPlugin(Rt)||C.p8;It.core.Tween;function zt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ot,Nt,Ft,Bt,Ut,Vt,Ht,jt,Wt,Gt,qt,Xt,Zt=function(){return Ot||"undefined"!=typeof window&&(Ot=window.gsap)&&Ot.registerPlugin&&Ot},Yt=1,Kt=[],Jt=[],$t=[],Qt=Date.now,te=function(t,e){return e},ee=function(t,e){return~$t.indexOf(t)&&$t[$t.indexOf(t)+1][e]},ne=function(t){return!!~Gt.indexOf(t)},ie=function(t,e,n,i,r){return t.addEventListener(e,n,{passive:!i,capture:!!r})},re=function(t,e,n){return t.removeEventListener(e,n)},se="scrollLeft",oe="scrollTop",ae=function(){return qt&&qt.isPressed||Jt.cache++},le=function(t){return function(e){return e||0===e?(Yt&&(Ft.history.scrollRestoration="manual"),t(e),t.v=e,t.c=Jt.cache,qt&&qt.isPressed&&te("ss",e)):(Jt.cache!==t.c||te("ref"))&&(t.c=Jt.cache,t.v=t()),t.v}},ce={s:se,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:le((function(t){return arguments.length?Ft.scrollTo(t,ue.sc()):Ft.pageXOffset||Bt.scrollLeft||Ut.scrollLeft||Vt.scrollLeft||0}))},ue={s:oe,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:ce,sc:le((function(t){return arguments.length?Ft.scrollTo(ce.sc(),t):Ft.pageYOffset||Bt.scrollTop||Ut.scrollTop||Vt.scrollTop||0}))},he=function(t){return Ot.utils.toArray(t)[0]||("string"==typeof t&&!1!==Ot.config().nullTargetWarn?void 0:null)},de=function(t,e){var n=e.s,i=e.sc,r=Jt.indexOf(t),s=i===ue.sc?1:2;return!~r&&(r=Jt.push(t)-1),Jt[r+s]||(Jt[r+s]=ee(t,n)||(ne(t)?i:le((function(e){return arguments.length?t[n]=e:t[n]}))))},pe=function(t,e,n){var i=t,r=t,s=Qt(),o=s,a=e||50,l=Math.max(500,3*a),c=function(t,e){var l=Qt();e||l-s>a?(r=i,i=t,o=s,s=l):n?i+=t:i=r+(t-r)/(l-o)*(s-o)};return{update:c,reset:function(){r=i=n?0:i,o=s=0},getVelocity:function(t){var e=o,a=r,u=Qt();return(t||0===t)&&t!==i&&c(t),s===o||u-o>l?0:(i+(n?a:-a))/((n?u:s)-e)*1e3}}},fe=function(t,e){return e&&!t._gsapAllow&&t.preventDefault(),t.changedTouches?t.changedTouches[0]:t},me=function(t){var e=Math.max.apply(Math,t),n=Math.min.apply(Math,t);return Math.abs(e)>=Math.abs(n)?e:n},ve=function(){var t,e,n,i;(Wt=Ot.core.globals().ScrollTrigger)&&Wt.core&&(t=Wt.core,e=t.bridge||{},n=t._scrollers,i=t._proxies,n.push.apply(n,Jt),i.push.apply(i,$t),Jt=n,$t=i,te=function(t,n){return e[t](n)})},ge=function(t){return(Ot=t||Zt())&&"undefined"!=typeof document&&document.body&&(Ft=window,Bt=document,Ut=Bt.documentElement,Vt=Bt.body,Gt=[Ft,Bt,Ut,Vt],Ot.utils.clamp,jt="onpointerenter"in Vt?"pointer":"mouse",Ht=xe.isTouch=Ft.matchMedia&&Ft.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in Ft||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,Xt=xe.eventTypes=("ontouchstart"in Ut?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in Ut?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout((function(){return Yt=0}),500),ve(),Nt=1),Nt};ce.op=ue,Jt.cache=0;var xe=function(){function t(t){this.init(t)}var e,n,i;return t.prototype.init=function(t){Nt||ge(Ot),Wt||ve();var e=t.tolerance,n=t.dragMinimum,i=t.type,r=t.target,s=t.lineHeight,o=t.debounce,a=t.preventDefault,l=t.onStop,c=t.onStopDelay,u=t.ignore,h=t.wheelSpeed,d=t.event,p=t.onDragStart,f=t.onDragEnd,m=t.onDrag,v=t.onPress,g=t.onRelease,x=t.onRight,y=t.onLeft,_=t.onUp,b=t.onDown,w=t.onChangeX,M=t.onChangeY,S=t.onChange,C=t.onToggleX,T=t.onToggleY,P=t.onHover,A=t.onHoverEnd,E=t.onMove,L=t.ignoreCheck,D=t.isNormalizer,k=t.onGestureStart,R=t.onGestureEnd,I=t.onWheel,z=t.onEnable,O=t.onDisable,N=t.onClick,F=t.scrollSpeed,B=t.capture,U=t.allowClicks,V=t.lockAxis,H=t.onLockAxis;this.target=r=he(r)||Ut,this.vars=t,u&&(u=Ot.utils.toArray(u)),e=e||0,n=n||0,h=h||1,F=F||1,i=i||"wheel,touch,pointer",o=!1!==o,s||(s=parseFloat(Ft.getComputedStyle(Vt).lineHeight)||22);var j,W,G,q,X,Z,Y,K=this,J=0,$=0,Q=de(r,ce),tt=de(r,ue),et=Q(),nt=tt(),it=~i.indexOf("touch")&&!~i.indexOf("pointer")&&"pointerdown"===Xt[0],rt=ne(r),st=r.ownerDocument||Bt,ot=[0,0,0],at=[0,0,0],lt=0,ct=function(){return lt=Qt()},ut=function(t,e){return(K.event=t)&&u&&~u.indexOf(t.target)||e&&it&&"touch"!==t.pointerType||L&&L(t,e)},ht=function(){var t=K.deltaX=me(ot),n=K.deltaY=me(at),i=Math.abs(t)>=e,r=Math.abs(n)>=e;S&&(i||r)&&S(K,t,n,ot,at),i&&(x&&K.deltaX>0&&x(K),y&&K.deltaX<0&&y(K),w&&w(K),C&&K.deltaX<0!=J<0&&C(K),J=K.deltaX,ot[0]=ot[1]=ot[2]=0),r&&(b&&K.deltaY>0&&b(K),_&&K.deltaY<0&&_(K),M&&M(K),T&&K.deltaY<0!=$<0&&T(K),$=K.deltaY,at[0]=at[1]=at[2]=0),(q||G)&&(E&&E(K),H&&Z&&H(K),G&&(m(K),G=!1),q=Z=!1),X&&(I(K),X=!1),j=0},dt=function(t,e,n){ot[n]+=t,at[n]+=e,K._vx.update(t),K._vy.update(e),o?j||(j=requestAnimationFrame(ht)):ht()},pt=function(t,e){"y"!==Y&&(ot[2]+=t,K._vx.update(t,!0)),"x"!==Y&&(at[2]+=e,K._vy.update(e,!0)),V&&!Y&&(K.axis=Y=Math.abs(t)>Math.abs(e)?"x":"y",Z=!0),o?j||(j=requestAnimationFrame(ht)):ht()},ft=function(t){if(!ut(t,1)){var e=(t=fe(t,a)).clientX,i=t.clientY,r=e-K.x,s=i-K.y,o=K.isDragging;K.x=e,K.y=i,(o||Math.abs(K.startX-e)>=n||Math.abs(K.startY-i)>=n)&&(m&&(G=!0),o||(K.isDragging=!0),pt(r,s),o||p&&p(K))}},mt=K.onPress=function(t){ut(t,1)||(K.axis=Y=null,W.pause(),K.isPressed=!0,t=fe(t),J=$=0,K.startX=K.x=t.clientX,K.startY=K.y=t.clientY,K._vx.reset(),K._vy.reset(),ie(D?r:st,Xt[1],ft,a,B),K.deltaX=K.deltaY=0,v&&v(K))},vt=function(t){if(!ut(t,1)){re(D?r:st,Xt[1],ft);var e=K.isDragging&&(Math.abs(K.x-K.startX)>3||Math.abs(K.y-K.startY)>3),n=fe(t);e||(K._vx.reset(),K._vy.reset(),a&&U&&Ot.delayedCall(.05,(function(){if(Qt()-lt>300&&!t.defaultPrevented)if(t.target.click)t.target.click();else if(st.createEvent){var e=st.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,Ft,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(e)}}))),K.isDragging=K.isGesturing=K.isPressed=!1,l&&!D&&W.restart(!0),f&&e&&f(K),g&&g(K,e)}},gt=function(t){return t.touches&&t.touches.length>1&&(K.isGesturing=!0)&&k(t,K.isDragging)},xt=function(){return(K.isGesturing=!1)||R(K)},yt=function(t){if(!ut(t)){var e=Q(),n=tt();dt((e-et)*F,(n-nt)*F,1),et=e,nt=n,l&&W.restart(!0)}},_t=function(t){if(!ut(t)){t=fe(t,a),I&&(X=!0);var e=(1===t.deltaMode?s:2===t.deltaMode?Ft.innerHeight:1)*h;dt(t.deltaX*e,t.deltaY*e,0),l&&!D&&W.restart(!0)}},bt=function(t){if(!ut(t)){var e=t.clientX,n=t.clientY,i=e-K.x,r=n-K.y;K.x=e,K.y=n,q=!0,(i||r)&&pt(i,r)}},wt=function(t){K.event=t,P(K)},Mt=function(t){K.event=t,A(K)},St=function(t){return ut(t)||fe(t,a)&&N(K)};W=K._dc=Ot.delayedCall(c||.25,(function(){K._vx.reset(),K._vy.reset(),W.pause(),l&&l(K)})).pause(),K.deltaX=K.deltaY=0,K._vx=pe(0,50,!0),K._vy=pe(0,50,!0),K.scrollX=Q,K.scrollY=tt,K.isDragging=K.isGesturing=K.isPressed=!1,K.enable=function(t){return K.isEnabled||(ie(rt?st:r,"scroll",ae),i.indexOf("scroll")>=0&&ie(rt?st:r,"scroll",yt,a,B),i.indexOf("wheel")>=0&&ie(r,"wheel",_t,a,B),(i.indexOf("touch")>=0&&Ht||i.indexOf("pointer")>=0)&&(ie(r,Xt[0],mt,a,B),ie(st,Xt[2],vt),ie(st,Xt[3],vt),U&&ie(r,"click",ct,!1,!0),N&&ie(r,"click",St),k&&ie(st,"gesturestart",gt),R&&ie(st,"gestureend",xt),P&&ie(r,jt+"enter",wt),A&&ie(r,jt+"leave",Mt),E&&ie(r,jt+"move",bt)),K.isEnabled=!0,t&&t.type&&mt(t),z&&z(K)),K},K.disable=function(){K.isEnabled&&(Kt.filter((function(t){return t!==K&&ne(t.target)})).length||re(rt?st:r,"scroll",ae),K.isPressed&&(K._vx.reset(),K._vy.reset(),re(D?r:st,Xt[1],ft)),re(rt?st:r,"scroll",yt),re(r,"wheel",_t),re(r,Xt[0],mt),re(st,Xt[2],vt),re(st,Xt[3],vt),re(r,"click",ct),re(r,"click",St),re(st,"gesturestart",gt),re(st,"gestureend",xt),re(r,jt+"enter",wt),re(r,jt+"leave",Mt),re(r,jt+"move",bt),K.isEnabled=K.isPressed=K.isDragging=!1,O&&O(K))},K.kill=function(){K.disable();var t=Kt.indexOf(K);t>=0&&Kt.splice(t,1),qt===K&&(qt=0)},Kt.push(K),D&&ne(r)&&(qt=K),K.enable(d)},e=t,(n=[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}])&&zt(e.prototype,n),i&&zt(e,i),t}();xe.version="3.10.3",xe.create=function(t){return new xe(t)},xe.register=ge,xe.getAll=function(){return Kt.slice()},xe.getById=function(t){return Kt.filter((function(e){return e.vars.id===t}))[0]},Zt()&&Ot.registerPlugin(xe);var ye,_e,be,we,Me,Se,Ce,Te,Pe,Ae,Ee,Le,De,ke,Re,Ie,ze,Oe,Ne,Fe,Be,Ue,Ve,He,je,We,Ge,qe,Xe,Ze,Ye,Ke,Je=1,$e=Date.now,Qe=$e(),tn=0,en=0,nn=function(){return ke=1},rn=function(){return ke=0},sn=function(t){return t},on=function(t){return Math.round(1e5*t)/1e5||0},an=function(){return"undefined"!=typeof window},ln=function(){return ye||an()&&(ye=window.gsap)&&ye.registerPlugin&&ye},cn=function(t){return!!~Ce.indexOf(t)},un=function(t){return ee(t,"getBoundingClientRect")||(cn(t)?function(){return _i.width=be.innerWidth,_i.height=be.innerHeight,_i}:function(){return Rn(t)})},hn=function(t,e){var n=e.s,i=e.d2,r=e.d,s=e.a;return(n="scroll"+i)&&(s=ee(t,n))?s()-un(t)()[r]:cn(t)?(Me[n]||Se[n])-(be["inner"+i]||Me["client"+i]||Se["client"+i]):t[n]-t["offset"+i]},dn=function(t,e){for(var n=0;n<Ne.length;n+=3)(!e||~e.indexOf(Ne[n+1]))&&t(Ne[n],Ne[n+1],Ne[n+2])},pn=function(t){return"string"==typeof t},fn=function(t){return"function"==typeof t},mn=function(t){return"number"==typeof t},vn=function(t){return"object"==typeof t},gn=function(t){return fn(t)&&t()},xn=function(t,e){return function(){var n=gn(t),i=gn(e);return function(){gn(n),gn(i)}}},yn=function(t,e,n){return t&&t.progress(e?0:1)&&n&&t.pause()},_n=function(t,e){if(t.enabled){var n=e(t);n&&n.totalTime&&(t.callbackAnimation=n)}},bn=Math.abs,wn="left",Mn="right",Sn="bottom",Cn="width",Tn="height",Pn="padding",An="margin",En="Width",Ln="px",Dn=function(t){return be.getComputedStyle(t)},kn=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},Rn=function(t,e){var n=e&&"matrix(1, 0, 0, 1, 0, 0)"!==Dn(t)[Re]&&ye.to(t,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),i=t.getBoundingClientRect();return n&&n.progress(0).kill(),i},In=function(t,e){var n=e.d2;return t["offset"+n]||t["client"+n]||0},zn=function(t){var e,n=[],i=t.labels,r=t.duration();for(e in i)n.push(i[e]/r);return n},On=function(t){var e=ye.utils.snap(t),n=Array.isArray(t)&&t.slice(0).sort((function(t,e){return t-e}));return n?function(t,i,r){var s;if(void 0===r&&(r=.001),!i)return e(t);if(i>0){for(t-=r,s=0;s<n.length;s++)if(n[s]>=t)return n[s];return n[s-1]}for(s=n.length,t+=r;s--;)if(n[s]<=t)return n[s];return n[0]}:function(n,i,r){void 0===r&&(r=.001);var s=e(n);return!i||Math.abs(s-n)<r||s-n<0==i<0?s:e(i<0?n-t:n+t)}},Nn=function(t,e,n,i){return n.split(",").forEach((function(n){return t(e,n,i)}))},Fn=function(t,e,n,i,r){return t.addEventListener(e,n,{passive:!i,capture:!!r})},Bn=function(t,e,n){return t.removeEventListener(e,n)},Un=function(t,e,n){return n&&n.wheelHandler&&t(e,"wheel",n)},Vn={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},Hn={toggleActions:"play",anticipatePin:0},jn={top:0,left:0,center:.5,bottom:1,right:1},Wn=function(t,e){if(pn(t)){var n=t.indexOf("="),i=~n?+(t.charAt(n-1)+1)*parseFloat(t.substr(n+1)):0;~n&&(t.indexOf("%")>n&&(i*=e/100),t=t.substr(0,n-1)),t=i+(t in jn?jn[t]*e:~t.indexOf("%")?parseFloat(t)*e/100:parseFloat(t)||0)}return t},Gn=function(t,e,n,i,r,s,o,a){var l=r.startColor,c=r.endColor,u=r.fontSize,h=r.indent,d=r.fontWeight,p=we.createElement("div"),f=cn(n)||"fixed"===ee(n,"pinType"),m=-1!==t.indexOf("scroller"),v=f?Se:n,g=-1!==t.indexOf("start"),x=g?l:c,y="border-color:"+x+";font-size:"+u+";color:"+x+";font-weight:"+d+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return y+="position:"+((m||a)&&f?"fixed;":"absolute;"),(m||a||!f)&&(y+=(i===ue?Mn:Sn)+":"+(s+parseFloat(h))+"px;"),o&&(y+="box-sizing:border-box;text-align:left;width:"+o.offsetWidth+"px;"),p._isStart=g,p.setAttribute("class","gsap-marker-"+t+(e?" marker-"+e:"")),p.style.cssText=y,p.innerText=e||0===e?t+"-"+e:t,v.children[0]?v.insertBefore(p,v.children[0]):v.appendChild(p),p._offset=p["offset"+i.op.d2],qn(p,0,i,g),p},qn=function(t,e,n,i){var r={display:"block"},s=n[i?"os2":"p2"],o=n[i?"p2":"os2"];t._isFlipped=i,r[n.a+"Percent"]=i?-100:0,r[n.a]=i?"1px":0,r["border"+s+En]=1,r["border"+o+En]=0,r[n.p]=e+"px",ye.set(t,r)},Xn=[],Zn={},Yn=function(){return $e()-tn>34&&pi()},Kn=function(){Ve&&Ve.isPressed||(Jt.cache++,qe||(qe=requestAnimationFrame(pi)),tn||ri("scrollStart"),tn=$e())},Jn=function(){We=be.innerWidth,je=be.innerHeight},$n=function(){Jt.cache++,!De&&!Ue&&!we.fullscreenElement&&(!He||We!==be.innerWidth||Math.abs(be.innerHeight-je)>.25*be.innerHeight)&&Te.restart(!0)},Qn={},ti=[],ei=[],ni=function(t){var e,n=ye.ticker.frame,i=[],r=0;if(Ze!==n||Je){for(ai();r<ei.length;r+=4)(e=be.matchMedia(ei[r]).matches)!==ei[r+3]&&(ei[r+3]=e,e?i.push(r):ai(1,ei[r])||fn(ei[r+2])&&ei[r+2]());for(oi(),r=0;r<i.length;r++)e=i[r],Xe=ei[e],ei[e+2]=ei[e+1](t);Xe=0,_e&&ui(0,1),Ze=n,ri("matchMedia")}},ii=function t(){return Bn(Ci,"scrollEnd",t)||ui(!0)},ri=function(t){return Qn[t]&&Qn[t].map((function(t){return t()}))||ti},si=[],oi=function(t){for(var e=0;e<si.length;e+=5)t&&si[e+4]!==t||(si[e].style.cssText=si[e+1],si[e].getBBox&&si[e].setAttribute("transform",si[e+2]||""),si[e+3].uncache=1)},ai=function(t,e){var n;for(Ie=0;Ie<Xn.length;Ie++)n=Xn[Ie],e&&n.media!==e||(t?n.kill(1):n.revert());e&&oi(e),e||ri("revert")},li=function(){return Jt.cache++&&Jt.forEach((function(t){return"function"==typeof t&&(t.rec=0)}))},ci=0,ui=function(t,e){if(!tn||t){Ye=!0;var n=ri("refreshInit");Fe&&Ci.sort(),e||ai(),Xn.slice(0).forEach((function(t){return t.refresh()})),Xn.forEach((function(t){return"max"===t.vars.end&&t.setPositions(t.start,hn(t.scroller,t._dir))})),n.forEach((function(t){return t&&t.render&&t.render(-1)})),li(),Te.pause(),ci++,Ye=!1,ri("refresh")}else Fn(Ci,"scrollEnd",ii)},hi=0,di=1,pi=function(){if(!Ye){Ke&&Ke.update(0),Ci.isUpdating=!0;var t=Xn.length,e=$e(),n=e-Qe>=50,i=t&&Xn[0].scroll();if(di=hi>i?-1:1,hi=i,n&&(tn&&!ke&&e-tn>200&&(tn=0,ri("scrollEnd")),Ee=Qe,Qe=e),di<0){for(Ie=t;Ie-- >0;)Xn[Ie]&&Xn[Ie].update(0,n);di=1}else for(Ie=0;Ie<t;Ie++)Xn[Ie]&&Xn[Ie].update(0,n);Ci.isUpdating=!1}qe=0},fi=[wn,"top",Sn,Mn,"marginBottom","marginRight","marginTop","marginLeft","display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],mi=fi.concat([Cn,Tn,"boxSizing","maxWidth","maxHeight","position",An,Pn,"paddingTop","paddingRight","paddingBottom","paddingLeft"]),vi=function(t,e,n,i){if(t.parentNode!==e){for(var r,s=fi.length,o=e.style,a=t.style;s--;)o[r=fi[s]]=n[r];o.position="absolute"===n.position?"absolute":"relative","inline"===n.display&&(o.display="inline-block"),a.bottom=a.right=o.flexBasis="auto",o.overflow="visible",o.boxSizing="border-box",o.width=In(t,ce)+Ln,o.height=In(t,ue)+Ln,o.padding=a.margin=a.top=a.left="0",xi(i),a.width=a.maxWidth=n.width,a.height=a.maxHeight=n.height,a.padding=n.padding,t.parentNode.insertBefore(e,t),e.appendChild(t)}},gi=/([A-Z])/g,xi=function(t){if(t){var e,n,i=t.t.style,r=t.length,s=0;for((t.t._gsap||ye.core.getCache(t.t)).uncache=1;s<r;s+=2)n=t[s+1],e=t[s],n?i[e]=n:i[e]&&i.removeProperty(e.replace(gi,"-$1").toLowerCase())}},yi=function(t){for(var e=mi.length,n=t.style,i=[],r=0;r<e;r++)i.push(mi[r],n[mi[r]]);return i.t=t,i},_i={left:0,top:0},bi=function(t,e,n,i,r,s,o,a,l,c,u,h,d){fn(t)&&(t=t(a)),pn(t)&&"max"===t.substr(0,3)&&(t=h+("="===t.charAt(4)?Wn("0"+t.substr(3),n):0));var p,f,m,v=d?d.time():0;if(d&&d.seek(0),mn(t))o&&qn(o,n,i,!0);else{fn(e)&&(e=e(a));var g,x,y,_,b=t.split(" ");m=he(e)||Se,(g=Rn(m)||{})&&(g.left||g.top)||"none"!==Dn(m).display||(_=m.style.display,m.style.display="block",g=Rn(m),_?m.style.display=_:m.style.removeProperty("display")),x=Wn(b[0],g[i.d]),y=Wn(b[1]||"0",n),t=g[i.p]-l[i.p]-c+x+r-y,o&&qn(o,y,i,n-y<20||o._isStart&&y>20),n-=n-y}if(s){var w=t+n,M=s._isStart;p="scroll"+i.d2,qn(s,w,i,M&&w>20||!M&&(u?Math.max(Se[p],Me[p]):s.parentNode[p])<=w+1),u&&(l=Rn(o),u&&(s.style[i.op.p]=l[i.op.p]-i.op.m-s._offset+Ln))}return d&&m&&(p=Rn(m),d.seek(h),f=Rn(m),d._caScrollDist=p[i.p]-f[i.p],t=t/d._caScrollDist*h),d&&d.seek(v),d?t:Math.round(t)},wi=/(webkit|moz|length|cssText|inset)/i,Mi=function(t,e,n,i){if(t.parentNode!==e){var r,s,o=t.style;if(e===Se){for(r in t._stOrig=o.cssText,s=Dn(t))+r||wi.test(r)||!s[r]||"string"!=typeof o[r]||"0"===r||(o[r]=s[r]);o.top=n,o.left=i}else o.cssText=t._stOrig;ye.core.getCache(t).uncache=1,e.appendChild(t)}},Si=function(t,e){var n,i,r=de(t,e),s="_scroll"+e.p2,o=function e(o,a,l,c,u){var h=e.tween,d=a.onComplete,p={};return l=l||r(),u=c&&u||0,c=c||o-l,h&&h.kill(),n=Math.round(l),a[s]=o,a.modifiers=p,p[s]=function(t){return(t=on(r()))!==n&&t!==i&&Math.abs(t-n)>2&&Math.abs(t-i)>2?(h.kill(),e.tween=0):t=l+c*h.ratio+u*h.ratio*h.ratio,i=n,n=on(t)},a.onComplete=function(){e.tween=0,d&&d.call(h)},h=e.tween=ye.to(t,a)};return t[s]=r,r.wheelHandler=function(){return o.tween&&o.tween.kill()&&(o.tween=0)},Fn(t,"wheel",r.wheelHandler),o},Ci=function(){function t(e,n){_e||t.register(ye),this.init(e,n)}return t.prototype.init=function(e,n){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),en){var i,r,s,o,a,l,c,u,h,d,p,f,m,v,g,x,y,_,b,w,M,S,C,T,P,A,E,L,D,k,R,I,z,O,N,F,B,U,V,H,j,W=e=kn(pn(e)||mn(e)||e.nodeType?{trigger:e}:e,Hn),G=W.onUpdate,q=W.toggleClass,X=W.id,Z=W.onToggle,Y=W.onRefresh,K=W.scrub,J=W.trigger,$=W.pin,Q=W.pinSpacing,tt=W.invalidateOnRefresh,et=W.anticipatePin,nt=W.onScrubComplete,it=W.onSnapComplete,rt=W.once,st=W.snap,ot=W.pinReparent,at=W.pinSpacer,lt=W.containerAnimation,ct=W.fastScrollEnd,ut=W.preventOverlaps,ht=e.horizontal||e.containerAnimation&&!1!==e.horizontal?ce:ue,dt=!K&&0!==K,pt=he(e.scroller||be),ft=ye.core.getCache(pt),mt=cn(pt),vt="fixed"===("pinType"in e?e.pinType:ee(pt,"pinType")||mt&&"fixed"),gt=[e.onEnter,e.onLeave,e.onEnterBack,e.onLeaveBack],xt=dt&&e.toggleActions.split(" "),yt="markers"in e?e.markers:Hn.markers,_t=mt?0:parseFloat(Dn(pt)["border"+ht.p2+En])||0,bt=this,wt=e.onRefreshInit&&function(){return e.onRefreshInit(bt)},Mt=function(t,e,n){var i=n.d,r=n.d2,s=n.a;return(s=ee(t,"getBoundingClientRect"))?function(){return s()[i]}:function(){return(e?be["inner"+r]:t["client"+r])||0}}(pt,mt,ht),St=function(t,e){return!e||~$t.indexOf(t)?un(t):function(){return _i}}(pt,mt),Ct=0,Tt=0,Pt=de(pt,ht);if(bt.media=Xe,bt._dir=ht,et*=45,bt.scroller=pt,bt.scroll=lt?lt.time.bind(lt):Pt,o=Pt(),bt.vars=e,n=n||e.animation,"refreshPriority"in e&&(Fe=1,-9999===e.refreshPriority&&(Ke=bt)),ft.tweenScroll=ft.tweenScroll||{top:Si(pt,ue),left:Si(pt,ce)},bt.tweenTo=i=ft.tweenScroll[ht.p],bt.scrubDuration=function(t){(R=mn(t)&&t)?k?k.duration(t):k=ye.to(n,{ease:"expo",totalProgress:"+=0.001",duration:R,paused:!0,onComplete:function(){return nt&&nt(bt)}}):(k&&k.progress(1).kill(),k=0)},n&&(n.vars.lazy=!1,n._initted||!1!==n.vars.immediateRender&&!1!==e.immediateRender&&n.render(0,!0,!0),bt.animation=n.pause(),n.scrollTrigger=bt,bt.scrubDuration(K),L=0,X||(X=n.vars.id)),Xn.push(bt),st&&(vn(st)&&!st.push||(st={snapTo:st}),"scrollBehavior"in Se.style&&ye.set(mt?[Se,Me]:pt,{scrollBehavior:"auto"}),s=fn(st.snapTo)?st.snapTo:"labels"===st.snapTo?function(t){return function(e){return ye.utils.snap(zn(t),e)}}(n):"labelsDirectional"===st.snapTo?(V=n,function(t,e){return On(zn(V))(t,e.direction)}):!1!==st.directional?function(t,e){return On(st.snapTo)(t,$e()-Tt<500?0:e.direction)}:ye.utils.snap(st.snapTo),I=st.duration||{min:.1,max:2},I=vn(I)?Ae(I.min,I.max):Ae(I,I),z=ye.delayedCall(st.delay||R/2||.1,(function(){var t=Pt(),e=$e()-Tt<500,r=i.tween;if(!(e||Math.abs(bt.getVelocity())<10)||r||ke||Ct===t)bt.isActive&&Ct!==t&&z.restart(!0);else{var o=(t-l)/m,a=n&&!dt?n.totalProgress():o,u=e?0:(a-D)/($e()-Ee)*1e3||0,h=ye.utils.clamp(-o,1-o,bn(u/2)*u/.185),d=o+(!1===st.inertia?0:h),p=Ae(0,1,s(d,bt)),f=Math.round(l+p*m),v=st,g=v.onStart,x=v.onInterrupt,y=v.onComplete;if(t<=c&&t>=l&&f!==t){if(r&&!r._initted&&r.data<=bn(f-t))return;!1===st.inertia&&(h=p-o),i(f,{duration:I(bn(.185*Math.max(bn(d-a),bn(p-a))/u/.05||0)),ease:st.ease||"power3",data:bn(f-t),onInterrupt:function(){return z.restart(!0)&&x&&x(bt)},onComplete:function(){bt.update(),Ct=Pt(),L=D=n&&!dt?n.totalProgress():bt.progress,it&&it(bt),y&&y(bt)}},t,h*m,f-t-h*m),g&&g(bt,i.tween)}}})).pause()),X&&(Zn[X]=bt),(U=(J=bt.trigger=he(J||$))&&J._gsap&&J._gsap.stRevert)&&(U=U(bt)),$=!0===$?J:he($),pn(q)&&(q={targets:J,className:q}),$&&(!1===Q||Q===An||(Q=!(!Q&&"flex"===Dn($.parentNode).display)&&Pn),bt.pin=$,!1!==e.force3D&&ye.set($,{force3D:!0}),(r=ye.core.getCache($)).spacer?v=r.pinState:(at&&((at=he(at))&&!at.nodeType&&(at=at.current||at.nativeElement),r.spacerIsNative=!!at,at&&(r.spacerState=yi(at))),r.spacer=y=at||we.createElement("div"),y.classList.add("pin-spacer"),X&&y.classList.add("pin-spacer-"+X),r.pinState=v=yi($)),bt.spacer=y=r.spacer,E=Dn($),C=E[Q+ht.os2],b=ye.getProperty($),w=ye.quickSetter($,ht.a,Ln),vi($,y,E),x=yi($)),yt){f=vn(yt)?kn(yt,Vn):Vn,d=Gn("scroller-start",X,pt,ht,f,0),p=Gn("scroller-end",X,pt,ht,f,0,d),_=d["offset"+ht.op.d2];var At=he(ee(pt,"content")||pt);u=this.markerStart=Gn("start",X,At,ht,f,_,0,lt),h=this.markerEnd=Gn("end",X,At,ht,f,_,0,lt),lt&&(B=ye.quickSetter([u,h],ht.a,Ln)),vt||$t.length&&!0===ee(pt,"fixedMarkers")||(j=Dn(H=mt?Se:pt).position,H.style.position="absolute"===j||"fixed"===j?j:"relative",ye.set([d,p],{force3D:!0}),P=ye.quickSetter(d,ht.a,Ln),A=ye.quickSetter(p,ht.a,Ln))}if(lt){var Et=lt.vars.onUpdate,Lt=lt.vars.onUpdateParams;lt.eventCallback("onUpdate",(function(){bt.update(0,0,1),Et&&Et.apply(Lt||[])}))}bt.previous=function(){return Xn[Xn.indexOf(bt)-1]},bt.next=function(){return Xn[Xn.indexOf(bt)+1]},bt.revert=function(t){var e=!1!==t||!bt.enabled,i=De;e!==bt.isReverted&&(e&&(bt.scroll.rec||!De||!Ye||(bt.scroll.rec=Pt()),N=Math.max(Pt(),bt.scroll.rec||0),O=bt.progress,F=n&&n.progress()),u&&[u,h,d,p].forEach((function(t){return t.style.display=e?"none":"block"})),e&&(De=1),bt.update(e),De=i,$&&(e?function(t,e,n){xi(n);var i=t._gsap;if(i.spacerIsNative)xi(i.spacerState);else if(t.parentNode===e){var r=e.parentNode;r&&(r.insertBefore(t,e),r.removeChild(e))}}($,y,v):(!ot||!bt.isActive)&&vi($,y,Dn($),T)),bt.isReverted=e)},bt.refresh=function(r,s){if(!De&&bt.enabled||s)if($&&r&&tn)Fn(t,"scrollEnd",ii);else{!Ye&&wt&&wt(bt),De=1,Tt=$e(),i.tween&&(i.tween.kill(),i.tween=0),k&&k.pause(),tt&&n&&n.time(-.01,!0).invalidate(),bt.isReverted||bt.revert();for(var f,_,w,C,P,A,E,L,D,R,I=Mt(),B=St(),U=lt?lt.duration():hn(pt,ht),V=0,H=0,j=e.end,W=e.endTrigger||J,G=e.start||(0!==e.start&&J?$?"0 0":"0 100%":0),q=bt.pinnedContainer=e.pinnedContainer&&he(e.pinnedContainer),X=J&&Math.max(0,Xn.indexOf(bt))||0,Z=X;Z--;)(A=Xn[Z]).end||A.refresh(0,1)||(De=1),!(E=A.pin)||E!==J&&E!==$||A.isReverted||(R||(R=[]),R.unshift(A),A.revert()),A!==Xn[Z]&&(X--,Z--);for(fn(G)&&(G=G(bt)),l=bi(G,J,I,ht,Pt(),u,d,bt,B,_t,vt,U,lt)||($?-.001:0),fn(j)&&(j=j(bt)),pn(j)&&!j.indexOf("+=")&&(~j.indexOf(" ")?j=(pn(G)?G.split(" ")[0]:"")+j:(V=Wn(j.substr(2),I),j=pn(G)?G:l+V,W=J)),c=Math.max(l,bi(j||(W?"100% 0":U),W,I,ht,Pt()+V,h,p,bt,B,_t,vt,U,lt))||-.001,m=c-l||(l-=.01)&&.001,V=0,Z=X;Z--;)(E=(A=Xn[Z]).pin)&&A.start-A._pinPush<l&&!lt&&A.end>0&&(f=A.end-A.start,E!==J&&E!==q||mn(G)||(V+=f*(1-A.progress)),E===$&&(H+=f));if(l+=V,c+=V,bt._pinPush=H,u&&V&&((f={})[ht.a]="+="+V,q&&(f[ht.p]="-="+Pt()),ye.set([u,h],f)),$)f=Dn($),C=ht===ue,w=Pt(),M=parseFloat(b(ht.a))+H,!U&&c>1&&((mt?Se:pt).style["overflow-"+ht.a]="scroll"),vi($,y,f),x=yi($),_=Rn($,!0),L=vt&&de(pt,C?ce:ue)(),Q&&((T=[Q+ht.os2,m+H+Ln]).t=y,(Z=Q===Pn?In($,ht)+m+H:0)&&T.push(ht.d,Z+Ln),xi(T),vt&&Pt(N)),vt&&((P={top:_.top+(C?w-l:L)+Ln,left:_.left+(C?L:w-l)+Ln,boxSizing:"border-box",position:"fixed"}).width=P.maxWidth=Math.ceil(_.width)+Ln,P.height=P.maxHeight=Math.ceil(_.height)+Ln,P.margin=P.marginTop=P.marginRight=P.marginBottom=P.marginLeft="0",P.padding=f.padding,P.paddingTop=f.paddingTop,P.paddingRight=f.paddingRight,P.paddingBottom=f.paddingBottom,P.paddingLeft=f.paddingLeft,g=function(t,e,n){for(var i,r=[],s=t.length,o=n?8:0;o<s;o+=2)i=t[o],r.push(i,i in e?e[i]:t[o+1]);return r.t=t.t,r}(v,P,ot)),n?(D=n._initted,Be(1),n.render(n.duration(),!0,!0),S=b(ht.a)-M+m+H,m!==S&&g.splice(g.length-2,2),n.render(0,!0,!0),D||n.invalidate(),Be(0)):S=m;else if(J&&Pt()&&!lt)for(_=J.parentNode;_&&_!==Se;)_._pinOffset&&(l-=_._pinOffset,c-=_._pinOffset),_=_.parentNode;R&&R.forEach((function(t){return t.revert(!1)})),bt.start=l,bt.end=c,o=a=Pt(),lt||(o<N&&Pt(N),bt.scroll.rec=0),bt.revert(!1),z&&(Ct=-1,bt.isActive&&Pt(l+m*O),z.restart(!0)),De=0,n&&dt&&(n._initted||F)&&n.progress()!==F&&n.progress(F,!0).render(n.time(),!0,!0),(O!==bt.progress||lt)&&(n&&!dt&&n.totalProgress(O,!0),bt.progress=O,bt.update(0,0,1)),$&&Q&&(y._pinOffset=Math.round(bt.progress*S)),Y&&Y(bt)}},bt.getVelocity=function(){return(Pt()-a)/($e()-Ee)*1e3||0},bt.endAnimation=function(){yn(bt.callbackAnimation),n&&(k?k.progress(1):n.paused()?dt||yn(n,bt.direction<0,1):yn(n,n.reversed()))},bt.labelToScroll=function(t){return n&&n.labels&&(l||bt.refresh()||l)+n.labels[t]/n.duration()*m||0},bt.getTrailing=function(t){var e=Xn.indexOf(bt),n=bt.direction>0?Xn.slice(0,e).reverse():Xn.slice(e+1);return(pn(t)?n.filter((function(e){return e.vars.preventOverlaps===t})):n).filter((function(t){return bt.direction>0?t.end<=l:t.start>=c}))},bt.update=function(t,e,r){if(!lt||r||t){var s,u,h,p,f,v,_,b=bt.scroll(),T=t?0:(b-l)/m,E=T<0?0:T>1?1:T||0,R=bt.progress;if(e&&(a=o,o=lt?Pt():b,st&&(D=L,L=n&&!dt?n.totalProgress():E)),et&&!E&&$&&!De&&!Je&&tn&&l<b+(b-a)/($e()-Ee)*et&&(E=1e-4),E!==R&&bt.enabled){if(p=(f=(s=bt.isActive=!!E&&E<1)!==(!!R&&R<1))||!!E!=!!R,bt.direction=E>R?1:-1,bt.progress=E,p&&!De&&(u=E&&!R?0:1===E?1:1===R?2:3,dt&&(h=!f&&"none"!==xt[u+1]&&xt[u+1]||xt[u],_=n&&("complete"===h||"reset"===h||h in n))),ut&&(f||_)&&(_||K||!n)&&(fn(ut)?ut(bt):bt.getTrailing(ut).forEach((function(t){return t.endAnimation()}))),dt||(!k||De||Je?n&&n.totalProgress(E,!!De):((lt||Ke&&Ke!==bt)&&k.render(k._dp._time-k._start),k.resetTo?k.resetTo("totalProgress",E,n._tTime/n._tDur):(k.vars.totalProgress=E,k.invalidate().restart()))),$)if(t&&Q&&(y.style[Q+ht.os2]=C),vt){if(p){if(v=!t&&E>R&&c+1>b&&b+1>=hn(pt,ht),ot)if(t||!s&&!v)Mi($,y);else{var I=Rn($,!0),O=b-l;Mi($,Se,I.top+(ht===ue?O:0)+Ln,I.left+(ht===ue?0:O)+Ln)}xi(s||v?g:x),S!==m&&E<1&&s||w(M+(1!==E||v?0:S))}}else w(on(M+S*E));st&&!i.tween&&!De&&!Je&&z.restart(!0),q&&(f||rt&&E&&(E<1||!Ge))&&Pe(q.targets).forEach((function(t){return t.classList[s||rt?"add":"remove"](q.className)})),G&&!dt&&!t&&G(bt),p&&!De?(dt&&(_&&("complete"===h?n.pause().totalProgress(1):"reset"===h?n.restart(!0).pause():"restart"===h?n.restart(!0):n[h]()),G&&G(bt)),!f&&Ge||(Z&&f&&_n(bt,Z),gt[u]&&_n(bt,gt[u]),rt&&(1===E?bt.kill(!1,1):gt[u]=0),f||gt[u=1===E?1:3]&&_n(bt,gt[u])),ct&&!s&&Math.abs(bt.getVelocity())>(mn(ct)?ct:2500)&&(yn(bt.callbackAnimation),k?k.progress(1):yn(n,!E,1))):dt&&G&&!De&&G(bt)}if(A){var N=lt?b/lt.duration()*(lt._caScrollDist||0):b;P(N+(d._isFlipped?1:0)),A(N)}B&&B(-b/lt.duration()*(lt._caScrollDist||0))}},bt.enable=function(e,n){bt.enabled||(bt.enabled=!0,Fn(pt,"resize",$n),Fn(mt?we:pt,"scroll",Kn),wt&&Fn(t,"refreshInit",wt),!1!==e&&(bt.progress=O=0,o=a=Ct=Pt()),!1!==n&&bt.refresh())},bt.getTween=function(t){return t&&i?i.tween:k},bt.setPositions=function(t,e){$&&(M+=t-l,S+=e-t-m),bt.start=l=t,bt.end=c=e,m=e-t,bt.update()},bt.disable=function(e,n){if(bt.enabled&&(!1!==e&&bt.revert(),bt.enabled=bt.isActive=!1,n||k&&k.pause(),N=0,r&&(r.uncache=1),wt&&Bn(t,"refreshInit",wt),z&&(z.pause(),i.tween&&i.tween.kill()&&(i.tween=0)),!mt)){for(var s=Xn.length;s--;)if(Xn[s].scroller===pt&&Xn[s]!==bt)return;Bn(pt,"resize",$n),Bn(pt,"scroll",Kn)}},bt.kill=function(t,i){bt.disable(t,i),k&&!i&&k.kill(),X&&delete Zn[X];var s=Xn.indexOf(bt);s>=0&&Xn.splice(s,1),s===Ie&&di>0&&Ie--,s=0,Xn.forEach((function(t){return t.scroller===bt.scroller&&(s=1)})),s||(bt.scroll.rec=0),n&&(n.scrollTrigger=null,t&&n.render(-1),i||n.kill()),u&&[u,h,d,p].forEach((function(t){return t.parentNode&&t.parentNode.removeChild(t)})),Ke===bt&&(Ke=0),$&&(r&&(r.uncache=1),s=0,Xn.forEach((function(t){return t.pin===$&&s++})),s||(r.spacer=0)),e.onKill&&e.onKill(bt)},bt.enable(!1,!1),U&&U(bt),n&&n.add&&!m?ye.delayedCall(.01,(function(){return l||c||bt.refresh()}))&&(m=.01)&&(l=c=0):bt.refresh()}else this.update=this.refresh=this.kill=sn},t.register=function(e){return _e||(ye=e||ln(),an()&&window.document&&t.enable(),_e=en),_e},t.defaults=function(t){if(t)for(var e in t)Hn[e]=t[e];return Hn},t.disable=function(t,e){en=0,Xn.forEach((function(n){return n[e?"kill":"disable"](t)})),Bn(be,"wheel",Kn),Bn(we,"scroll",Kn),clearInterval(Le),Bn(we,"touchcancel",sn),Bn(Se,"touchstart",sn),Nn(Bn,we,"pointerdown,touchstart,mousedown",nn),Nn(Bn,we,"pointerup,touchend,mouseup",rn),Te.kill(),dn(Bn);for(var n=0;n<Jt.length;n+=3)Un(Bn,Jt[n],Jt[n+1]),Un(Bn,Jt[n],Jt[n+2])},t.enable=function(){if(be=window,we=document,Me=we.documentElement,Se=we.body,ye&&(Pe=ye.utils.toArray,Ae=ye.utils.clamp,Be=ye.core.suppressOverwrites||sn,ye.core.globals("ScrollTrigger",t),Se)){en=1,xe.register(ye),t.isTouch=xe.isTouch,Fn(be,"wheel",Kn),Ce=[be,we,Me,Se],t.matchMedia({"(orientation: portrait)":function(){return Jn(),Jn}}),Fn(we,"scroll",Kn);var e,n,i=Se.style,r=i.borderTopStyle;for(i.borderTopStyle="solid",e=Rn(Se),ue.m=Math.round(e.top+ue.sc())||0,ce.m=Math.round(e.left+ce.sc())||0,r?i.borderTopStyle=r:i.removeProperty("border-top-style"),Le=setInterval(Yn,250),ye.delayedCall(.5,(function(){return Je=0})),Fn(we,"touchcancel",sn),Fn(Se,"touchstart",sn),Nn(Fn,we,"pointerdown,touchstart,mousedown",nn),Nn(Fn,we,"pointerup,touchend,mouseup",rn),Re=ye.utils.checkPrefix("transform"),mi.push(Re),_e=$e(),Te=ye.delayedCall(.2,ui).pause(),Ne=[we,"visibilitychange",function(){var t=be.innerWidth,e=be.innerHeight;we.hidden?(ze=t,Oe=e):ze===t&&Oe===e||$n()},we,"DOMContentLoaded",ui,be,"load",ui,be,"resize",$n],dn(Fn),Xn.forEach((function(t){return t.enable(0,1)})),n=0;n<Jt.length;n+=3)Un(Bn,Jt[n],Jt[n+1]),Un(Bn,Jt[n],Jt[n+2])}},t.config=function(e){"limitCallbacks"in e&&(Ge=!!e.limitCallbacks);var n=e.syncInterval;n&&clearInterval(Le)||(Le=n)&&setInterval(Yn,n),"ignoreMobileResize"in e&&(He=1===t.isTouch&&e.ignoreMobileResize),"autoRefreshEvents"in e&&(dn(Bn)||dn(Fn,e.autoRefreshEvents||"none"),Ue=-1===(e.autoRefreshEvents+"").indexOf("resize"))},t.scrollerProxy=function(t,e){var n=he(t),i=Jt.indexOf(n),r=cn(n);~i&&Jt.splice(i,r?6:2),e&&(r?$t.unshift(be,e,Se,e,Me,e):$t.unshift(n,e))},t.matchMedia=function(t){var e,n,i,r,s;for(n in t)i=ei.indexOf(n),r=t[n],Xe=n,"all"===n?r():(e=be.matchMedia(n))&&(e.matches&&(s=r()),~i?(ei[i+1]=xn(ei[i+1],r),ei[i+2]=xn(ei[i+2],s)):(i=ei.length,ei.push(n,r,s),e.addListener?e.addListener(ni):e.addEventListener("change",ni)),ei[i+3]=e.matches),Xe=0;return ei},t.clearMatchMedia=function(t){t||(ei.length=0),(t=ei.indexOf(t))>=0&&ei.splice(t,4)},t.isInViewport=function(t,e,n){var i=(pn(t)?he(t):t).getBoundingClientRect(),r=i[n?Cn:Tn]*e||0;return n?i.right-r>0&&i.left+r<be.innerWidth:i.bottom-r>0&&i.top+r<be.innerHeight},t.positionInViewport=function(t,e,n){pn(t)&&(t=he(t));var i=t.getBoundingClientRect(),r=i[n?Cn:Tn],s=null==e?r/2:e in jn?jn[e]*r:~e.indexOf("%")?parseFloat(e)*r/100:parseFloat(e)||0;return n?(i.left+s)/be.innerWidth:(i.top+s)/be.innerHeight},t}();Ci.version="3.10.3",Ci.saveStyles=function(t){return t?Pe(t).forEach((function(t){if(t&&t.style){var e=si.indexOf(t);e>=0&&si.splice(e,5),si.push(t,t.style.cssText,t.getBBox&&t.getAttribute("transform"),ye.core.getCache(t),Xe)}})):si},Ci.revert=function(t,e){return ai(!t,e)},Ci.create=function(t,e){return new Ci(t,e)},Ci.refresh=function(t){return t?$n():(_e||Ci.register())&&ui(!0)},Ci.update=pi,Ci.clearScrollMemory=li,Ci.maxScroll=function(t,e){return hn(t,e?ce:ue)},Ci.getScrollFunc=function(t,e){return de(he(t),e?ce:ue)},Ci.getById=function(t){return Zn[t]},Ci.getAll=function(){return Xn.filter((function(t){return"ScrollSmoother"!==t.vars.id}))},Ci.isScrolling=function(){return!!tn},Ci.snapDirectional=On,Ci.addEventListener=function(t,e){var n=Qn[t]||(Qn[t]=[]);~n.indexOf(e)||n.push(e)},Ci.removeEventListener=function(t,e){var n=Qn[t],i=n&&n.indexOf(e);i>=0&&n.splice(i,1)},Ci.batch=function(t,e){var n,i=[],r={},s=e.interval||.016,o=e.batchMax||1e9,a=function(t,e){var n=[],i=[],r=ye.delayedCall(s,(function(){e(n,i),n=[],i=[]})).pause();return function(t){n.length||r.restart(!0),n.push(t.trigger),i.push(t),o<=n.length&&r.progress(1)}};for(n in e)r[n]="on"===n.substr(0,2)&&fn(e[n])&&"onRefreshInit"!==n?a(0,e[n]):e[n];return fn(o)&&(o=o(),Fn(Ci,"refresh",(function(){return o=e.batchMax()}))),Pe(t).forEach((function(t){var e={};for(n in r)e[n]=r[n];e.trigger=t,i.push(Ci.create(e))})),i};var Ti,Pi=function(t,e,n,i){return e>i?t(i):e<0&&t(0),n>i?(i-e)/(n-e):n<0?e/(e-n):1},Ai=function t(e,n){!0===n?e.style.removeProperty("touch-action"):e.style.touchAction=n?"pan-"+n:"none",e===Me&&t(Se)},Ei={auto:1,scroll:1},Li=function(t){var e,n=t.event,i=t.target,r=t.axis,s=(n.changedTouches?n.changedTouches[0]:n).target,o=s._gsap||ye.core.getCache(s),a=$e();if(!o._isScrollT||a-o._isScrollT>2e3){for(;s&&s.scrollHeight<=s.clientHeight;)s=s.parentNode;o._isScroll=s&&!cn(s)&&s!==i&&(Ei[(e=Dn(s)).overflowY]||Ei[e.overflowX]),o._isScrollT=a}(o._isScroll||"x"===r)&&(n._gsapAllow=!0)},Di=function(t,e,n,i){return xe.create({target:t,capture:!0,debounce:!1,lockAxis:!0,type:e,onWheel:i=i&&Li,onPress:i,onDrag:i,onScroll:i,onEnable:function(){return n&&Fn(we,xe.eventTypes[0],Ri,!1,!0)},onDisable:function(){return Bn(we,xe.eventTypes[0],Ri)}})},ki=/(input|label|select|textarea)/i,Ri=function(t){var e=ki.test(t.target.tagName);(e||Ti)&&(t._gsapAllow=!0,Ti=e)},Ii=function(t){vn(t)||(t={}),t.preventDefault=t.isNormalizer=t.allowClicks=!0,t.type||(t.type="wheel,touch"),t.debounce=!!t.debounce,t.id=t.id||"normalizer";var e,n,i,r,s,o,a,l,c=t,u=c.normalizeScrollX,h=c.momentum,d=c.allowNestedScroll,p=he(t.target)||Me,f=de(p,ue),m=de(p,ce),v=1,g=0,x=fn(h)?function(){return h(e)}:function(){return h||2.8},y=Di(p,t.type,!0,d),_=function(){return i=!1},b=sn,w=sn,M=function(){n=hn(p,ue),w=Ae(0,n),u&&(b=Ae(0,hn(p,ce))),r=ci},S=Ci.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),C=function(){M(),s.isActive()&&s.vars.scrollY>n&&s.resetTo("scrollY",hn(p,ue))};return t.ignoreCheck=function(t){return S&&"touchmove"===t.type&&function(){if(i)return requestAnimationFrame(_),!0;i=!0}()||v>1||e.isGesturing||t.touches&&t.touches.length>1},t.onPress=function(){var t=v;v=be.visualViewport&&be.visualViewport.scale||1,s.pause(),t!==v&&Ai(p,v>1||!u&&"x"),i=!1,o=m(),a=f(),M(),r=ci},t.onRelease=t.onGestureStart=function(t,e){if(e){var n,i,r=x();u&&(i=(n=m())+.05*r*-t.velocityX/.227/v,r*=Pi(m,n,i,hn(p,ce)),s.vars.scrollX=b(i)),i=(n=f())+.05*r*-t.velocityY/.227/v,r*=Pi(f,n,i,hn(p,ue)),s.vars.scrollY=w(i),s.invalidate().duration(r).play(.01)}else l.restart(!0)},t.onWheel=function(){s._ts&&s.pause(),$e()-g>1e3&&(r=0,g=$e())},t.onChange=function(t,e,n,i,s){ci!==r&&M(),e&&u&&m(b(i[2]===e?o+(t.startX-t.x)/v:m()+e-i[1])),n&&f(w(s[2]===n?a+(t.startY-t.y)/v:f()+n-s[1])),pi()},t.onEnable=function(){Ai(p,!u&&"x"),Fn(be,"resize",C),y.enable()},t.onDisable=function(){Ai(p,!0),Bn(be,"resize",C),y.kill()},e=new xe(t),l=e._dc,s=ye.to(e,{ease:"power4",paused:!0,scrollX:u?"+=0.1":"+=0",scrollY:"+=0.1",onComplete:l.vars.onComplete}),e};Ci.sort=function(t){return Xn.sort(t||function(t,e){return-1e6*(t.vars.refreshPriority||0)+t.start-(e.start+-1e6*(e.vars.refreshPriority||0))})},Ci.observe=function(t){return new xe(t)},Ci.normalizeScroll=function(t){if(void 0===t)return Ve;if(!0===t&&Ve)return Ve.enable();if(!1===t)return Ve&&Ve.kill();var e=t instanceof xe?t:Ii(t);return Ve&&Ve.target===e.target&&Ve.kill(),cn(e.target)&&(Ve=e),e},Ci.core={_getVelocityProp:pe,_inputObserver:Di,_scrollers:Jt,_proxies:$t,bridge:{ss:function(){tn||ri("scrollStart"),tn=$e()},ref:function(){return De}}},ln()&&ye.registerPlugin(Ci);var zi=n(342);It.registerPlugin(Ci);var Oi=function(){function t(){(0,i.Z)(this,t),this.$container=document.getElementById("cv-apple-avenue"),this.path=document.getElementById("path-cube-env").dataset.path,this.pane=new S.Pane,this.elmWrapper=".cube-decor__wrapper",this.options={scale1:.135,scale2:.065,lenghtDisplacement:5,lengthMaximum:2.2,zCameraPer:4.5,zCameraOrtho:4.5,speedRotate:.007,zPositionCube:1.45,isRotate:!1,opacityGlass:30,envMap:!1,positionLight:{x:1.24,y:1.24},lightPower:5,caustics:[{text:"Crystal",value:0},{text:"Amoebas",value:1},{text:"Soluble",value:2},{text:"Turbo color map",value:3},{text:"Blob Rainbow",value:4},{text:"Tileable water",value:5}],causticType:0},this.optionsColorSideLogo={side1:{color1:"rgb(227, 31, 199)",color2:"rgb(74, 173, 242)"},side2:{color1:"rgb(227, 31, 199)",color2:"rgb(255, 204, 51)"},side3:{color1:"rgb(255, 204, 51)",color2:"rgb(235, 51, 36)"},side4:{color1:"rgb(255, 204, 51)",color2:"rgb(235, 51, 36)"},side5:{color1:"rgb(255, 255, 255)",color2:"rgb(255, 255, 255)"},side6:{color1:"rgb(227, 31, 199)",color2:"rgb(255, 204, 51)"}},this.optionsColorGlassCube={color1:"rgb(255, 255, 255)",color2:"rgb(255, 255, 255)",notUse:!1},this.optionsColorBorder={color1:"rgb(255, 255, 255)",color2:"rgb(255, 255, 255)",notUse:!0},this.bounce={min:0,max:.025,current:0},this.gui(),window.bodyScrollBar||(window.bodyScrollBar=this.bodyScrollBar,window.ScrollTrigger=Ci),this.init(),this.loadCubeMap(),this.tweenBounce(),this.initSmoothScroll(),this.timeLineScrollTrigger(),this.scene.transition=this.animate.bind(this)}return(0,r.Z)(t,[{key:"loadCubeMap",value:function(){var t=this;this.cubeMap=new zi.J({path:this.path,resolve:function(e){t.scene.cubeBorderMesh&&(t.scene.cubeBorderMesh.material.uniforms.uEnvMap.value=e)}})}},{key:"init",value:function(){this.scene=new M({$container:this.$container,options:this.options,optionsColorSideLogo:this.optionsColorSideLogo,optionsColorGlassCube:this.optionsColorGlassCube,optionsColorBorder:this.optionsColorBorder,size:{width:900,height:900}})}},{key:"tweenBounce",value:function(){var t=C.Q3.to(this.bounce,2,{current:this.bounce.max,ease:C.EA.easeInOut});t.repeat(-1).yoyo(!0)}},{key:"animate",value:function(){if(this.scene.cubeMesh){var t=this.scene.cubeMesh.material.uniforms;t.lenghtDisplacement.value=this.options.lenghtDisplacement,t.lengthMaximum.value=this.options.lengthMaximum,t.uBounce.value=this.bounce.current,this.options.isRotate&&(this.scene.cubeMesh.rotation.x+=this.options.speedRotate,this.scene.cubeMesh.rotation.y+=this.options.speedRotate),this.guiColorLogoUpdate()}if(this.scene.cubeBorderMesh){var e=this.scene.cubeBorderMesh.material.uniforms;this.options.isRotate&&(this.scene.cubeBorderMesh.rotation.x+=this.options.speedRotate,this.scene.cubeBorderMesh.rotation.y+=this.options.speedRotate),e.uOpacity.value=this.options.opacityGlass,e.isUseEnvMap.value=this.options.envMap,e.uPositionLight.value=this.options.positionLight,e.uLightPower.value=this.options.lightPower,this.guiColorGlassUpdate(),this.guiColorBorderUpdate()}}},{key:"guiColorGlassUpdate",value:function(){var t=this.scene.colorToVector(this.optionsColorGlassCube.color1),e=this.scene.colorToVector(this.optionsColorGlassCube.color2),n=this.scene.cubeBorderMesh.material;n.uniforms.colorGlass.value=[t,e],n.uniforms.isNoUseModifyColors.value=this.optionsColorGlassCube.notUse}},{key:"guiColorBorderUpdate",value:function(){var t=this.scene.colorToVector(this.optionsColorBorder.color1),e=this.scene.colorToVector(this.optionsColorBorder.color2),n=this.scene.cubeBorderMesh.material;n.uniforms.colorBorder.value=[t,e],n.uniforms.isNoUseModifyColorsBorder.value=this.optionsColorBorder.notUse}},{key:"guiColorLogoUpdate",value:function(){var t=this.scene.getColorLogoSideCube(),e=this.scene.cubeMesh.material;e.uniforms.colorSide1.value=[t.side1.color1,t.side1.color2],e.uniforms.colorSide2.value=[t.side2.color1,t.side2.color2],e.uniforms.colorSide3.value=[t.side3.color1,t.side3.color2],e.uniforms.colorSide4.value=[t.side4.color1,t.side4.color2],e.uniforms.colorSide5.value=[t.side5.color1,t.side5.color2],e.uniforms.colorSide6.value=[t.side6.color1,t.side6.color2]}},{key:"gui",value:function(){this.pane.addInput(this.options,"lengthMaximum",{min:0,max:10}),this.pane.addInput(this.options,"opacityGlass",{min:0,max:30}),this.pane.addBlade({view:"list",label:"Caustic",options:this.options.caustics,value:this.options.causticType}),this.pane.addInput(this.options,"isRotate"),this.pane.addInput(this.options,"envMap"),this.pane.addInput(this.options.positionLight,"x",{min:0,max:1.5}),this.pane.addInput(this.options.positionLight,"y",{min:0,max:1.5}),this.pane.addInput(this.options,"lightPower",{min:0,max:10}),this.paneOnChange(),this.paneFolderColorBorder(),this.paneFolderColorGlass(),this.paneFolderColorLogo()}},{key:"paneFolderColorBorder",value:function(){this.folderColorBorder=this.pane.addFolder({title:"Color border cube",expanded:!0}),this.folderColorBorder.addInput(this.optionsColorBorder,"color1"),this.folderColorBorder.addInput(this.optionsColorBorder,"color2"),this.folderColorBorder.addInput(this.optionsColorBorder,"notUse")}},{key:"paneFolderColorGlass",value:function(){this.folderColorGlass=this.pane.addFolder({title:"Color glass cube",expanded:!0}),this.folderColorGlass.addInput(this.optionsColorGlassCube,"color1"),this.folderColorGlass.addInput(this.optionsColorGlassCube,"color2"),this.folderColorGlass.addInput(this.optionsColorGlassCube,"notUse")}},{key:"paneFolderColorLogo",value:function(){this.folderColors1=this.pane.addFolder({title:"Logo color face 1",expanded:!1}),this.folderColors1.addInput(this.optionsColorSideLogo.side1,"color1"),this.folderColors1.addInput(this.optionsColorSideLogo.side1,"color2"),this.folderColors1=this.pane.addFolder({title:"Logo color face 2",expanded:!1}),this.folderColors1.addInput(this.optionsColorSideLogo.side2,"color1"),this.folderColors1.addInput(this.optionsColorSideLogo.side2,"color2"),this.folderColors1=this.pane.addFolder({title:"Logo color face 3",expanded:!1}),this.folderColors1.addInput(this.optionsColorSideLogo.side3,"color1"),this.folderColors1.addInput(this.optionsColorSideLogo.side3,"color2"),this.folderColors1=this.pane.addFolder({title:"Logo color face 4",expanded:!1}),this.folderColors1.addInput(this.optionsColorSideLogo.side4,"color1"),this.folderColors1.addInput(this.optionsColorSideLogo.side4,"color2"),this.folderColors1=this.pane.addFolder({title:"Logo color face 5",expanded:!0}),this.folderColors1.addInput(this.optionsColorSideLogo.side5,"color1"),this.folderColors1.addInput(this.optionsColorSideLogo.side5,"color2"),this.folderColors1=this.pane.addFolder({title:"Logo color face 6",expanded:!1}),this.folderColors1.addInput(this.optionsColorSideLogo.side6,"color1"),this.folderColors1.addInput(this.optionsColorSideLogo.side6,"color2")}},{key:"paneOnChange",value:function(){var t=this;this.pane.on("change",(function(e){"Caustic"===e.target.label&&(t.options.causticType=e.value,t.scene.cubeBorderMesh.material.uniforms.uCausticType.value=e.value)}))}},{key:"initSmoothScroll",value:function(){document.querySelector("body").classList.add("smooth-scroll-wrapper-body");var t=document.querySelector("body"),e=Scrollbar.init(t,{damping:.08,delegateTo:document,alwaysShowTracks:!0});Ci.scrollerProxy(t,{scrollTop:function(t){return arguments.length&&(e.scrollTop=t),e.scrollTop}}),e.addListener(Ci.update),Ci.defaults({scroller:t})}},{key:"timeLineScrollTrigger",value:function(){var t=It.timeline({scrollTrigger:{trigger:this.elmWrapper,start:"top top",endTrigger:".js-end-trigger",pin:!1,scrub:1,markers:!1}});t.from(this.elmWrapper,{x:"112%",y:"-12%"}),t.to(this.elmWrapper,{x:"-2%",y:"99%"})}}]),t}()},896:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return x}});var i=n(610),r=n(991),s=n(212),o=n(255),a=n(724),l=n(608);function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,l.Z)(t);if(e){var r=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var u=function(t){(0,o.Z)(n,t);var e=c(n);function n(t){var r,s=t.$container,o=t.size;return(0,i.Z)(this,n),(r=e.call(this,s,o.width,o.height)).init(),r}return(0,r.Z)(n,[{key:"init",value:function(){this.initDefault()}},{key:"initDefault",value:function(){this.start(),this.initCamera(),this.update()}},{key:"resize",value:function(t){this.camera.aspect=t.width/t.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(t.width,t.height)}}]),n}(n(706).Z),h=n(482);function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,l.Z)(t);if(e){var r=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var p=function(t){(0,o.Z)(n,t);var e=d(n);function n(t){var r,s=t.uniforms,o=t.fragmentShader;return(0,i.Z)(this,n),(r=e.call(this,{vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:o})).uniforms=s,r.getUniforms=function(){return r.uniforms},r.transparent=!0,r}return n}(s.jyz),f=n(317);function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,l.Z)(t);if(e){var r=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var v=function(t){(0,o.Z)(n,t);var e=m(n);function n(t){var r,s=t.planeSize,o=t.objUniforms,a=t.moveTexture,l=t.clockDelta;return(0,i.Z)(this,n),(r=e.call(this,{planeSize:s,objUniforms:o,moveTexture:a,clockDelta:l})).animateIntroDone=!1,r.init(),r}return(0,r.Z)(n,[{key:"animationIntro",value:function(t){var e=t.radius,n=void 0===e?0:e,i=t.duration,r=void 0===i?0:i;this.animateIntroDone||(f.Q3.to(this.uniforms.uRadius,{value:n,ease:f.eJ.easeInOut,duration:r}),this.animateIntroDone=!0)}}]),n}(function(){function t(e){var n=e.planeSize,r=e.objUniforms,o=e.moveTexture,a=e.clockDelta;(0,i.Z)(this,t),this.clock=new s.SUY,this.clockDelta=a,this.textureMovingX=!1,this.textureMovingY=!1,this.directionX=1,this.directionY=1,this.planeSize=n,this.objUniforms=r,this.moveTexture=o,this.introDone=!1,this.init()}return(0,r.Z)(t,[{key:"init",value:function(){this.createPlane()}},{key:"resize",value:function(t){var e=t.width,n=t.height;this.mesh.scale.set(e,n,1)}},{key:"setUniformMaterial",value:function(){var t,e;this.uniforms={uPlaneSize:{value:new s.FM8(this.planeSize.width,this.planeSize.height)},uImageSize:{value:new s.FM8((null===(t=this.objUniforms)||void 0===t?void 0:t.textureWidth)||1e3,(null===(e=this.objUniforms)||void 0===e?void 0:e.textureWidth)||896)},uTime:{value:0},uAlpha:{value:this.objUniforms.alpha},uRadius:{value:this.objUniforms.radius},uSpikes:{value:this.objUniforms.spikes},uTexture:{value:this.objUniforms.texture||(new s.dpR).load("https://i.imgur.com/Ni0AIZj.jpg")},uTexture2:{value:null},isMouse:{value:!1},uTextureMoveX:{value:0},uTextureMoveY:{value:0},uDisFactor:{value:0}}}},{key:"createPlane",value:function(){var t=new s._12(this.planeSize.width,this.planeSize.height,1,1);this.setUniformMaterial();var e=new p({uniforms:this.uniforms,fragmentShader:"#define GLSLIFY 1\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\nfloat circle(in vec2 st, in float r, vec2 pos) {\n    float dist = distance(st, pos);\n    return 1.0 - smoothstep(r - r * 0.001, r + r * 0.001, dist);\n}\nfloat circle(in vec2 st, in float r) {\n    float dist = distance(st, vec2(0.5));\n    return 1.0 - smoothstep(r - r * 0.001, r + r * 0.001, dist);\n}\n\n// https://gist.github.com/companje/29408948f1e8be54dd5733a74ca49bb9\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n    return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\n// background-size: cover for an image texture in a GLSL shader\n// https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44\nvec2 getCoverUv(vec2 uv, vec2 resolution, vec2 texResolution) {\n    vec2 s = resolution; // Screen\n    vec2 i = texResolution; // Image\n    float rs = s.x / s.y;\n    float ri = i.x / i.y;\n    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);\n    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;\n    vec2 coverUv = uv * s / new + offset;\n    return coverUv;\n}\n\nuniform vec3 uColor;\nuniform vec2 uPlaneSize;\nuniform vec2 uImageSize;\nuniform float uTextureMoveX;\nuniform float uTextureMoveY;\nuniform float uMouseRadius;\nuniform float uTime;\nuniform sampler2D uTexture;\nuniform sampler2D uTexture2;\nuniform float uSpikes;\nuniform float uRadius;\nuniform float uAlpha;\nuniform float uDisFactor;\n\nuniform bool isMouse;\nuniform vec2 uMousePos;\n\nvarying vec2 vUv;\n\nvec4 mouseGooey(in vec4 color, in bool isMouse, in vec2 uv, in float uSpikes, in float uTime, in vec2 uMousePos) {\n    if(isMouse) { // use in research\n        // generate cursor blob noise (slow down uTime)\n        float mouseBlobNoise = snoise(vec3(uv.x * uSpikes, uv.y * uSpikes, uTime * 0.3));\n\n        float mouseRadius = uMouseRadius;\n        // increase mouse radius based on distance from center vec2(0.5)\n        mouseRadius = mouseRadius * (1.0 + smoothstep(0.15, 0.45, distance(uMousePos, vec2(0.5))));\n\n        // apply noise to mouseRadius\n        float cursorRadius = map(mouseBlobNoise, 0.0, 1.0, mouseRadius - (mouseRadius * 0.2), mouseRadius);\n\n        // draw cursor circle blob at mouse pos\n        vec3 cursorColor = mix(color.rgb, uColor, circle(uv, cursorRadius, uMousePos));\n        color = vec4(cursorColor, 1.0);\n    }\n    return color;\n}\n\nvoid main() {\n    vec2 uv = vUv;\n    vec2 coverUv = getCoverUv(uv, uPlaneSize, uImageSize);\n\n    // apply image texture\n    vec2 posTexture = coverUv + vec2(uTextureMoveX, uTextureMoveY);\n\n    vec4 _texture = texture2D(uTexture, posTexture);\n    vec4 _texture2 = texture2D(uTexture2, posTexture);\n    vec4 color = mix(_texture, _texture2, uDisFactor);\n    //color = mouseGooey(color, isMouse, uv, uSpikes, uTime, uMousePos);\n    // use another circle blob as mask on the color's alpha channel (black === alpha of 0)\n    float imageBlobNoise = snoise(vec3(uv.x * uSpikes, uv.y * uSpikes, uTime * 1.0));\n    float radius = map(imageBlobNoise, 0.0, 1.0, uRadius * 0.9, uRadius);\n    float mask = circle(uv, radius);\n    color.a = mask;\n    if(color.a < 1.0) {\n        discard;\n    }\n\n    gl_FragColor = color;\n    gl_FragColor.a = uAlpha;\n}\n"});this.uniforms=e.getUniforms(),this.mesh=new s.Kj0(t,e)}},{key:"getMesh",value:function(){return this.mesh}},{key:"update",value:function(){this.uniforms.uTime.value+=this.clock.getDelta(),this.animateMoveTexture()}},{key:"setSpikes",value:function(t){f.Q3.to(this.uniforms.uSpikes,{value:t,duration:.5})}},{key:"setDirection",value:function(t,e){this.moveTexture.direction&&(this.moveTexture.direction.x=t,this.moveTexture.direction.y=e)}},{key:"animateMoveTexture",value:function(){var t=this;this.textureMovingX||(this.textureMovingX=!0,f.Q3.to(this.uniforms.uTextureMoveX,{value:this.moveTexture.randomXFn(this.moveTexture.direction.x),duration:3,ease:f.Yv.easeInOut,onComplete:function(){t.textureMovingX=!1}})),this.textureMovingY||(this.textureMovingY=!0,f.Q3.to(this.uniforms.uTextureMoveY,{value:this.moveTexture.randomYFn(this.moveTexture.direction.y),duration:3,ease:f.Yv.easeInOut,onComplete:function(){t.textureMovingY=!1}}))}},{key:"updateTexture",value:function(t,e){t&&(this.uniforms.uTexture.value=t),e&&(this.uniforms.uTexture2.value=e)}},{key:"setDisFactor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;t&&(e=1),this.uniforms.uDisFactor.value=e}},{key:"transitionIn",value:function(t){f.Q3.to(this.uniforms.uDisFactor,{value:1,duration:.25,ease:f.Yv.easeInOut,onComplete:function(){t&&t()}})}}]),t}()),g=n(755),x=function(){function t(){(0,i.Z)(this,t),this.clock=new s.SUY,this.clockDelta=this.clock.getDelta(),this.processingVal=1,this.spikesVal=.5,this.speedVal=15,this.hoverTexture=null,this.changingTexture=!1,this.mouse=new s.FM8,this.init(),this.setUpdateCallback(),this.update(),this.resize(),this.animateIntro(),this.eventHoverGetTexture()}return(0,r.Z)(t,[{key:"init",value:function(){this.testScene=new u({$container:document.getElementById("blob-bubble-cv"),size:{width:window.innerWidth,height:window.innerHeight}}),this.testScene.mainScene.background=new s.Ilk("#5d7faf"),this.groupBlob=new s.ZAu,this.testScene.mainScene.add(this.groupBlob);var t=(0,h.ad)(.02,.05,!1),e=(0,h.ad)(.02,.05,!1);this.bubbleIntro=new v({planeSize:{width:3,height:3},objUniforms:{radius:.12,spikes:1.5,alpha:.25},moveTexture:{randomXFn:t,randomYFn:e,direction:{x:1,y:1}}}),this.groupBlob.add(this.bubbleIntro.getMesh()),this.bubbleIntro2=new v({planeSize:{width:3,height:3},objUniforms:{radius:.1,spikes:1.5,alpha:.75},moveTexture:{randomXFn:t,randomYFn:e,direction:{x:1,y:1}}}),this.groupBlob.add(this.bubbleIntro2.getMesh()),this.bubbleIntro3=new v({planeSize:{width:3,height:3},objUniforms:{radius:.08,spikes:1.5,alpha:1},moveTexture:{randomXFn:t,randomYFn:e,direction:{x:1,y:1}}}),this.groupBlob.add(this.bubbleIntro3.getMesh())}},{key:"setUpdateCallback",value:function(){var t=this;this.testScene.updateCallback=function(){t.bubbleIntro.update(),t.bubbleIntro2.update(),t.bubbleIntro3.update();var e=(0,h.bd)([1,-1,-1,1]),n=(0,h.bd)([-1,1,-1,-1]);t.bubbleIntro.setDirection(e,n),t.bubbleIntro2.setDirection(e,n),t.bubbleIntro3.setDirection(e,n)}}},{key:"update",value:function(){this.testScene.update()}},{key:"resize",value:function(){var t=this;window.addEventListener("resize",(function(){t.testScene.resize({width:window.innerWidth,height:window.innerHeight})}))}},{key:"animateIntro",value:function(){var t=this;setTimeout((function(){t.bubbleIntro.animationIntro({radius:.5,duration:.75}),t.bubbleIntro2.animationIntro({radius:.45,duration:.95}),t.bubbleIntro3.animationIntro({radius:.43,duration:1.05})}),1e3)}},{key:"eventHoverGetTexture",value:function(){var t=this;g(".js-hover-bubble-texture").on("mouseenter",(function(e){var n=e.currentTarget;if(t.hoverTexture=(new s.dpR).load(n.dataset.src),!t.changingTexture){t.changingTexture=!0;var i=(0,h.bd)([3,5]);t.bubbleIntro.setDisFactor(),t.bubbleIntro.updateTexture(null,t.hoverTexture),t.bubbleIntro.transitionIn((function(){t.bubbleIntro.updateTexture(t.hoverTexture,null),t.changingTexture=!1})),t.bubbleIntro.setSpikes(i),t.bubbleIntro2.setDisFactor(),t.bubbleIntro2.updateTexture(null,t.hoverTexture),t.bubbleIntro2.transitionIn((function(){t.bubbleIntro2.updateTexture(t.hoverTexture,null),t.changingTexture=!1})),t.bubbleIntro2.setSpikes(i),t.bubbleIntro3.setDisFactor(),t.bubbleIntro3.updateTexture(null,t.hoverTexture),t.bubbleIntro3.transitionIn((function(){t.bubbleIntro3.updateTexture(t.hoverTexture,null),t.changingTexture=!1})),t.bubbleIntro3.setSpikes(i),t.setPosWhenMouseMove(e),t.moveGroupBlob()}})),g(".js-hover-bubble-texture").on("mouseleave",(function(e){t.changingTexture||(t.hoverTexture=null,t.bubbleIntro.setSpikes(1.5),t.bubbleIntro2.setSpikes(1.5),t.bubbleIntro3.setSpikes(1.5))}))}},{key:"setPosWhenMouseMove",value:function(t){f.Q3.to(this.mouse,0,{x:t.clientX/window.innerWidth*2*2-2,y:-t.clientY/window.innerHeight*2*2/2+1})}},{key:"moveGroupBlob",value:function(){f.Q3.to(this.groupBlob.position,.65,{x:this.mouse.x,y:this.mouse.y})}}]),t}()},881:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return v}});var i=n(610),r=n(991),s=n(255),o=n(724),a=n(608),l=n(212),c=n(706);function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var h=function(t){(0,s.Z)(n,t);var e=u(n);function n(t){var r;return(0,i.Z)(this,n),(r=e.call(this,{vertexShader:"#define GLSLIFY 1\nuniform float time;\n\nvarying vec3 eyeVector;\nvarying vec3 worldNormal;\n\nvoid main() {\n    vec4 worldPosition = modelMatrix * vec4(position, 1.0);\n    eyeVector = normalize(worldPosition.xyz - cameraPosition);\n    worldNormal = normalize(modelViewMatrix * vec4(normal, 0.0)).xyz;\n\n\t//gl_Position = projectionMatrix * modelViewMatrix * vec4(sin(position.x*time*0.001), position.y, position.z, 1.0);\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"#define GLSLIFY 1\n// multi-side refraction : https://codesandbox.io/s/w0ntb?file=/src/refraction-material/fragment.glsl:644-1536\n//crossfade : https://www.shadertoy.com/view/Ntt3Rs\n\nuniform sampler2D envMap;\nuniform sampler2D envMap2;\nuniform sampler2D maskTex;\nuniform vec2 resolution;\nuniform float ior;\nuniform float uTime;\n\nvarying vec3 worldNormal;\nvarying vec3 viewDirection;\nvarying vec3 eyeVector;\n\nfloat Fresnel(vec3 eyeVector, vec3 worldNormal) {\n\treturn pow( 1.0 + dot( eyeVector, worldNormal), 3.0 );\n}\n\nfloat crossfadelength = 1.;\nfloat textureZoom = .3;\n\nvoid main() {\n\t//water is 1.33 and diamond has an IOR of 2.42.\n\tfloat iorVal = ior;\n\t\n\t// get screen coordinates\n\tvec2 uv = gl_FragCoord.xy / resolution;\n    ////////////\n    float time = sin(uTime)* .5 + .5;\n    float progress = time;\n    progress *= (1. + crossfadelength);\n    progress -= crossfadelength;\n\n    \n    float mask = smoothstep(uv.x - crossfadelength, uv.x, progress);\n    \n    ////////////\n\n\tvec3 normal = worldNormal;\n\t// calculate refraction and add to the screen coordinates\n\tvec3 refracted = refract(eyeVector, normal, 1.0/iorVal);\n\tuv += refracted.xy;\n    ////// crossfade\n    \n    float noise = texture2D(maskTex, uv*textureZoom).b;\n    noise *= mask;\n    noise += mask;\n    noise = clamp(noise, 0., 1.);\n\n    vec3 texture1 = texture2D(envMap, uv).rgb;\n    vec3 texture2 = texture2D(envMap2, uv).rgb;\n\n    vec3 col = mix(texture1, texture2, noise);\n\n    //////\n\t// calculate the Fresnel ratio\n\tfloat f = Fresnel(eyeVector, normal);\n\n    col = mix(col, vec3(1.0), f);\n\tgl_FragColor = vec4(col, 1.0);\n}"})).uniforms=t,r.transparent=!0,r.getUniform=function(){return r.uniforms},r}return n}(l.jyz),d=n(787),p=n(218);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var m=function(t){(0,s.Z)(n,t);var e=f(n);function n(t){var r,s=t.$container,o=t.size,a=void 0===o?{}:o;return(0,i.Z)(this,n),(r=e.call(this,s,a.width,a.height)).loaderTexture=new l.dpR,r.init(),r}return(0,r.Z)(n,[{key:"init",value:function(){this.start(),this.renderer.setClearColor("#686663"),this.initPerspectiveCamera(),this.createModel(),this.update()}},{key:"createModel",value:function(){var t=new l.cJO(1,0),e=this.loaderTexture.load(d.Il),n=this.loaderTexture.load(d.IY),i=this.loaderTexture.load(d.cN),r=new h({envMap:{value:n},envMap2:{value:i},maskTex:{value:e},resolution:{value:(0,p.m8)({W:this.W,H:this.H})},ior:{value:.98},uTime:{value:0}});this.uniforms=r.getUniform(),this.model=new l.Kj0(t,r),this.mainScene.add(this.model)}},{key:"updateCallback",value:function(){this.model.rotation.x+=.005,this.model.rotation.y+=.005,this.uniforms.uTime.value+=.01}}]),n}(c.Z),v=function t(){(0,i.Z)(this,t),this.$container=document.getElementById("cv-crossfade-shader"),this.scene=new m({$container:this.$container})}},371:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return w}});var i=n(610),r=n(991),s=n(317),o=n(482),a=n(255),l=n(724),c=n(608),u=n(212),h=n(706);function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,c.Z)(t);if(e){var r=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var p=!1,f=function(t){(0,a.Z)(n,t);var e=d(n);function n(t){var r,s=t.$container,o=t.size;return(0,i.Z)(this,n),r=e.call(this,s,o.width,o.height),p||(p=!0),r.init(),r}return(0,r.Z)(n,[{key:"initCamera",value:function(){this.camera=new u.iKG(this.W/-2,this.W/2,this.H/2,this.H/-2,1,1e3),this.camera.position.z=1}},{key:"init",value:function(){this.start(),this.initCamera(),this.renderer.setPixelRatio(2)}},{key:"resize",value:function(t){this.renderer.setSize(t.width,t.height)}}]),n}(h.Z),m=n(156);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){(0,m.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,c.Z)(t);if(e){var r=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var y=function(t){(0,a.Z)(n,t);var e=x(n);function n(t,r){var s;return(0,i.Z)(this,n),(s=e.call(this,{vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}"})).fragmentShader=r?"#define GLSLIFY 1\nvarying vec2 vUv;\nuniform float dispFactor;\nuniform float dpr;\nuniform sampler2D disp;\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform float angle1;\nuniform float angle2;\nuniform float intensity1;\nuniform float intensity2;\nuniform vec4 res;\nuniform vec2 parent;\nmat2 getRotM(float angle) {\n    float s = sin(angle);\n    float c = cos(angle);\n    return mat2(c, -s, s, c);\n}\nvoid main() {\n    vec4 disp = texture2D(disp, vUv);\n    vec2 dispVec = vec2(disp.r, disp.g);\n    vec2 uv = 0.5 * gl_FragCoord.xy / (res.xy);\n    vec2 myUV = (uv - vec2(0.5)) * res.zw + vec2(0.5);\n    vec2 distortedPosition1 = myUV + getRotM(angle1) * dispVec * intensity1 * dispFactor;\n    vec2 distortedPosition2 = myUV + getRotM(angle2) * dispVec * intensity2 * (1.0 - dispFactor);\n    vec4 _texture1 = texture2D(texture1, distortedPosition1);\n    vec4 _texture2 = texture2D(texture2, distortedPosition2);\n    gl_FragColor = mix(_texture1, _texture2, dispFactor);\n}\n":"#define GLSLIFY 1\nvarying vec2 vUv;\nuniform float angle1;\nuniform float angle2;\nuniform float intensity1;\nuniform float intensity2;\nuniform vec4 res;\nuniform sampler2D texture1;\nuniform sampler2D texture2;\n\nuniform float dispFactor;\n\nmat2 getRotM(float angle) {\n    float s = sin(angle);\n    float c = cos(angle);\n    return mat2(c, -s, s, c);\n}\n\nvoid main() {\n\n    //vec2 uv = vUv;\n    vec4 _currentImage;\n    vec4 _nextImage;\n    float intensity = 0.3;\n    \n    vec2 uv = 0.5 * gl_FragCoord.xy / (res.xy);\n    vec2 myUV = (uv - vec2(0.5)) * res.zw + vec2(0.5);\n\n    vec4 orig1 = texture2D(texture1, myUV);\n    vec4 orig2 = texture2D(texture2, myUV);\n    vec2 dispVec1 = vec2(orig1.r, orig1.g); \n    vec2 dispVec2 = vec2(orig2.r, orig2.g);\n\n    vec2 distortedPos1 = myUV + getRotM(angle1)* dispVec1* intensity1* dispFactor;\n    vec2 distortedPos2 = myUV + getRotM(angle2)* dispVec2* intensity2* (1.0 - dispFactor);\n\n    _currentImage = texture2D(texture1, distortedPos1);\n    _nextImage = texture2D(texture2, distortedPos2);\n\n    vec4 finalTexture = mix(_currentImage, _nextImage, dispFactor);\n\n    gl_FragColor = finalTexture;\n\n}",s.uniforms=g(g({},{dpr:{type:"f",value:window.devicePixelRatio}}),t),s.transparent=!0,s.opacity=1,s.getUniform=function(){return s.uniforms},s}return n}(u.jyz),_=function(){function t(e){(0,i.Z)(this,t),this.data=e,this.loader=new u.dpR,this.init()}return(0,r.Z)(t,[{key:"init",value:function(){var t=this.data.textures;this.setFilterPrevNextTexture(t[0],t[1]),this.disp=this.loadDisplaceImage();var e=this.getAspect(),n=e.a1,i=e.a2;this.aspect1=n,this.aspect2=i}},{key:"loadVideoTexture",value:function(){}},{key:"setFilterPrevNextTexture",value:function(t,e){t.magFilter=e.magFilter=u.wem,t.minFilter=e.minFilter=u.wem,this.texturePrev=t,this.textureNext=e}},{key:"updatePrevNextTexture",value:function(t,e){this.uniforms.texture1.value=t,this.uniforms.texture2.value=e}},{key:"loadDisplaceImage",value:function(){var t=this.data.displacementImage,e=this.loader.load(t);return e.magFilter=e.minFilter=u.wem,e}},{key:"getAspect",value:function(){var t,e,n=this.data,i=n.parent,r=n.imagesRatio;return i.offsetHeight/i.offsetWidth<r?(t=1,e=i.offsetHeight/i.offsetWidth/r):(t=i.offsetWidth/i.offsetHeight*r,e=1),{a1:t,a2:e}}},{key:"getMaterial",value:function(){var t=this.data,e=t.intensity1,n=t.intensity2,i=t.intensity,r=t.angle1,s=t.angle2,o=t.parent,a=t.isDisplacement;return new y({intensity1:{type:"f",value:e||i},intensity2:{type:"f",value:n||i},dispFactor:{type:"f",value:0},angle1:{type:"f",value:r},angle2:{type:"f",value:s},texture1:{type:"t",value:this.texturePrev},texture2:{type:"t",value:this.textureNext},disp:{type:"t",value:this.disp},res:{type:"vec4",value:new u.Ltg(o.offsetWidth,o.offsetHeight,this.aspect1,this.aspect2)},dpr:{type:"f",value:window.devicePixelRatio}},a)}},{key:"createMesh",value:function(){var t=this.data.parent,e=new u.BKK(t.offsetWidth,t.offsetHeight,1);return this.material=this.getMaterial(),this.uniforms=this.material.getUniform(),new u.Kj0(e,this.material)}},{key:"transitionIn",value:function(t){var e=this.data,n=e.speedIn,i=e.easing;s.Q3.to(this.uniforms.dispFactor,n,{value:1,ease:i,onComplete:function(){t&&t()}})}},{key:"transitionOut",value:function(t){var e=this.data,n=e.speedOut,i=e.easing;s.Q3.to(this.uniforms.dispFactor,n,{value:0,ease:i,onComplete:function(){t&&t()}})}},{key:"setDispFactor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;0!==t&&(t=1),this.uniforms.dispFactor.value=t}},{key:"resize",value:function(){var t=this.data.parent,e=this.getAspect(),n=e.a1,i=e.a2;this.uniforms.res.value=new u.Ltg(t.offsetWidth,t.offsetHeight,n,i)}}]),t}(),b=n(755),w=function(){function t(){(0,i.Z)(this,t),this.scenes=[],this.meshes=[],this.dataObj=[],this.$parent=document.querySelectorAll(".js-distortion-img-wrapper"),this.init()}return(0,r.Z)(t,[{key:"init",value:function(){this.createSceneListItem(),this.eventClickNextSlide(),this.eventClickPrevSlide(),this.eventHover()}},{key:"createSceneListItem",value:function(){for(var t=this,e=function(e){for(var n=t.$parent[e],i=n.querySelectorAll(".js-distortion-img"),r=document.getElementById("cv-distortion-img-".concat(e+1)),a=[],l=0;l<i.length;l++)a.push({src:i[l].getAttribute("src"),name:i[l].dataset.name||null});var c={$container:r,parentId:n.getAttribute("id"),parent:n,width:n.clientWidth,height:n.clientHeight,imagesRatio:+n.dataset.ratio||1,intensity:+n.dataset.intensity||1,speedIn:+n.dataset.speedin||1.6,speedOut:+n.dataset.speedout||1.2,easing:n.dataset.easing||s.Au.easeOut,hover:n.dataset.hover||!0,images:a,displacementImage:n.dataset.displacement,isDisplacement:!!n.dataset.displacement,commonAngle:(0,o.Id)(+n.dataset.deg)||(0,o.Id)(45),angle1:(0,o.Id)(+n.dataset.deg1)||(0,o.Id)(45),angle2:(0,o.Id)(+n.dataset.deg2)||3*-(0,o.Id)(45)};(0,o.wz)(a,(function(e){t.dataObj.push(c),t.startRender(e)}))},n=0;n<this.$parent.length;n++)e(n)}},{key:"startRender",value:function(t){for(var e=0;e<this.dataObj.length;e++)if(!this.scenes[e]){var n=this.dataObj[e];n.textures=t;var i=new f({$container:n.$container,size:{width:n.width,height:n.height}}),r=new _(n),s=r.createMesh();i.mainScene.add(s),this.scenes[e]=i,this.meshes[n.parentId]=r,i.update(),this.resize(i,r,n.parent)}}},{key:"eventClickNextSlide",value:function(){var t=this;b(".js-next-slide").click((function(e){var n=e.currentTarget,i=b(n).closest(".js-distortion-img-wrapper"),r=i.find(".js-distortion-img.active"),s=r.next(".js-distortion-img");if(0!==s.length){var o=i.attr("id");i.find(".js-distortion-img").removeClass("active"),s.addClass("active");var a=t.meshes[o];t.updatePrevNextUniforms(a,r[0].dataset.name,s[0].dataset.name),a.setDispFactor(),n.setAttribute("disabled",!0),a.transitionIn((function(){n.removeAttribute("disabled")}))}}))}},{key:"eventClickPrevSlide",value:function(){var t=this;b(".js-prev-slide").click((function(e){var n=e.currentTarget,i=b(n).closest(".js-distortion-img-wrapper"),r=i.find(".js-distortion-img.active"),s=r.prev(".js-distortion-img");if(0!==s.length){var o=i.attr("id");i.find(".js-distortion-img").removeClass("active"),s.addClass("active");var a=t.meshes[o];t.updatePrevNextUniforms(a,s[0].dataset.name,r[0].dataset.name),a.setDispFactor(1),n.setAttribute("disabled",!0),a.transitionOut((function(){n.removeAttribute("disabled")}))}}))}},{key:"updatePrevNextUniforms",value:function(t,e,n){var i=(0,o.fu)(t.data.textures,e),r=(0,o.fu)(t.data.textures,n);t.setFilterPrevNextTexture(i,r),t.updatePrevNextTexture(i,r)}},{key:"resize",value:function(t,e,n){window.addEventListener("resize",(function(){t.resize({width:n.offsetWidth,height:n.offsetHeight}),e.resize()}))}},{key:"eventHover",value:function(){var t=this;b(".js-distortion-img-wrapper.-hover").on("mouseenter",(function(e){var n=e.currentTarget.getAttribute("id");t.meshes[n].transitionIn()})),b(".js-distortion-img-wrapper.-hover").on("mouseleave",(function(e){var n=e.currentTarget.getAttribute("id");t.meshes[n].transitionOut()}))}}]),t}()},72:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return w}});var i=n(610),r=n(991),s=n(482),o=n(156),a=n(212),l=n(255),c=n(724),u=n(608);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){(0,o.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.Z)(t);if(e){var r=(0,u.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}var f=function(t){(0,l.Z)(n,t);var e=p(n);function n(t,r){var s;return(0,i.Z)(this,n),(s=e.call(this,{vertexShader:"#define GLSLIFY 1\nvarying vec2 v_uv;\n\nvoid main() {\n    v_uv = uv;\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:t})).uniforms=d(d({},{u_progressHover:{value:0},u_progressClick:{value:0},u_alpha:{value:1},u_time:{value:(new a.SUY).getElapsedTime()}}),r),s.transparent=!0,s.defines={PI:Math.PI,PR:window.devicePixelRatio.toFixed(1)},s.getUniform=function(){return s.uniforms},s}return n}(a.jyz),m=n(317);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){(0,o.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var x=function(){function t(e){var n=e.scene,r=e.tile,s=e.effectShape,o=e.uniforms,l=void 0===o?{}:o,c=e.duration,u=void 0===c?.15:c;(0,i.Z)(this,t),this.scene=n,this.mainImage=r.imgDom,this.tile=r,this.texture,this.textureHover,this.uniforms=l,this.effectShape=s,this.duration=u,this.isPrivate=!0,this.clock=new a.SUY,this.sizes=new a.FM8,this.offset=new a.FM8,this.mouse=new a.FM8,this.loader=new a.dpR,this.preLoad(this.tile.imgSrc,this.tile.hoverSrc)}return(0,r.Z)(t,[{key:"preLoad",value:function(t,e){var n=this;this.loader.load(t,(function(t){n.texture=t,n.loaded()}),void 0,(function(t){})),this.loader.load(e,(function(t){n.textureHover=t,n.loaded()}),void 0,(function(t){}))}},{key:"loaded",value:function(){this.texture&&this.textureHover&&(this.mainImage.classList.add("opacity--0"),this.texture.center.set(.5,.5),this.textureHover.center.set(.5,.5),this.planeGeometry(),this.bindEvent())}},{key:"planeGeometry",value:function(){this.getBounds();var t={width:this.isPrivate?this.sizes.width:window.innerWidth,height:this.isPrivate?this.sizes.height:window.innerHeight};this.uniforms=g(g({},this.tile.dataUniform),{u_map:{type:"t",value:this.texture},u_hovermap:{type:"t",value:this.textureHover},u_mouse:{value:this.mouse},u_res:{value:new a.FM8(t.width,t.height)},u_ratio:{value:(0,s.Dc)(this.sizes,this.texture.image)},u_hoverratio:{value:(0,s.Dc)(this.sizes,this.textureHover.image)}}),this.geo=new a.BKK(1,1,1,1),this.material=new f(this.effectShape,this.uniforms),this.uniforms=this.material.getUniform(),this.mesh=new a.Kj0(this.geo,this.material),this.mesh.position.x=this.offset.x,this.mesh.position.y=this.offset.y,this.mesh.scale.set(this.sizes.x,this.sizes.y,1),this.scene.mainScene.add(this.mesh)}},{key:"getBounds",value:function(){var t=this.tile.imgDom.getBoundingClientRect(),e=t.width,n=t.height,i=t.left,r=t.top;this.sizes.equals(new a.FM8(e,n))||this.sizes.set(e,n),this.isPrivate||this.offset.equals(new a.FM8(i-window.innerWidth/2+e/2,-r+window.innerHeight/2-n/2))||this.offset.set(i-window.innerWidth/2+e/2,-r+window.innerHeight/2-n/2)}},{key:"bindEvent",value:function(){var t=this;this.mainImage.addEventListener("mousemove",(function(e){t.onPointerMove(e)})),this.mainImage.addEventListener("mouseenter",(function(){t.onPointerEnter()})),this.mainImage.addEventListener("mouseleave",(function(){t.onPointerLeave()}))}},{key:"onPointerLeave",value:function(){var t=this;this.mesh&&m.Q3.to(this.uniforms.u_progressHover,this.duration,{value:0,ease:m.Lp.easeInOut,onComplete:function(){t.isHovering=!1}})}},{key:"onPointerEnter",value:function(){this.isHovering=!0,m.Q3.to(this.uniforms.u_progressHover,this.duration,{value:1})}},{key:"onPointerMove",value:function(t){var e=this.mainImage.getBoundingClientRect(),n=e.left,i=e.top;this.isPrivate?m.Q3.to(this.mouse,this.duration,{x:t.clientX-n,y:t.clientY-i}):m.Q3.to(this.mouse,this.duration,{x:t.clientX,y:t.clientY})}},{key:"move",value:function(){this.getBounds(),m.Q3.set(this.mesh.position,{x:this.offset.x,y:this.offset.y});m.Q3.to(this.mesh.scale,.3,{x:this.sizes.x-0,y:this.sizes.y-0,z:1})}},{key:"update",value:function(){this.mesh&&(this.move(),this.isHovering&&(this.uniforms.u_time.value+=this.clock.getDelta()))}}]),t}();function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.Z)(t);if(e){var r=(0,u.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}var _=function(t){(0,l.Z)(n,t);var e=y(n);function n(t){var r,s=t.$container,o=t.size,a=t.cameraOption;return(0,i.Z)(this,n),(r=e.call(this,s,o.width,o.height)).camereOption=a,r.perspective=800,r.init(),r}return(0,r.Z)(n,[{key:"init",value:function(){this.start(),this.initCamera()}},{key:"initCamera",value:function(){var t=2*Math.atan(this.H/2/this.perspective)*180/Math.PI;this.camera=new a.cPb(t,this.W/this.H,this.camereOption.near,this.camereOption.far),this.camera.position.set(0,0,this.perspective)}},{key:"setUpdateCallback",value:function(t){this.updateCallback=t}}]),n}(n(706).Z),b={gooey:"#define GLSLIFY 1\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\nuniform sampler2D u_map;\nuniform sampler2D u_hovermap;\n\nuniform float u_alpha;\nuniform float u_time;\nuniform float u_progressHover;\nuniform float u_progressClick;\n\nuniform vec2 u_res;\nuniform vec2 u_mouse;\nuniform vec2 u_ratio;\nuniform vec2 u_hoverratio;\n\nuniform float u_radius1;\nuniform float u_radius2;\n\nuniform vec4 u_colorMask;\nuniform bool u_addborder;\nvarying vec2 v_uv;\n\nfloat circle(in vec2 _st, in float _radius, in float blurriness) {\n    vec2 dist = _st;\n    return 1. - smoothstep(_radius - (_radius * blurriness), _radius + (_radius * blurriness), dot(dist, dist) * 4.);\n}\n\nvoid main() {\n    vec2 resolution = u_res * PR;\n    float time = u_time * .05;\n    float progress = u_progressClick;\n\n    float progressHover = u_progressHover;\n    vec2 uv = v_uv;\n    vec2 uv_h = v_uv;\n\n    vec2 st = gl_FragCoord.xy / resolution.xy - vec2(.5);\n    st.y *= resolution.y / resolution.x;\n\n    vec2 mouse = vec2((u_mouse.x / u_res.x) * 2. - 1., -(u_mouse.y / u_res.y) * 2. + 1.) * -.5;\n    mouse.y *= resolution.y / resolution.x;\n\n    vec2 cpos = st + mouse;\n\n    float grd = .1 * progressHover;\n\n    float sqr = 100. * ((smoothstep(0., grd, uv.x) - smoothstep(1. - grd, 1., uv.x)) * (smoothstep(0., grd, uv.y) - smoothstep(1. - grd, 1., uv.y))) - 10.;\n\n    float c = circle(cpos, u_radius1 * progressHover + progress * .8, 2.) * 50.;\n    float c2 = circle(cpos, u_radius2 * progressHover + progress * .5, 2.);\n\n    float offX = uv.x + sin(uv.y + time * 2.);\n    float offY = uv.y - time * .2 - cos(time * 2.) * .1;\n    float nc = (snoise(vec3(offX, offY, time * .5) * 8.)) * progressHover;\n    float nh = (snoise(vec3(offX, offY, time * .5) * 2.)) * .1;\n\n    c2 = smoothstep(.1, .8, c2 * 5. + nc * 3. - 1.);\n\n    uv_h -= vec2(.5);\n    uv_h *= 1. - u_progressHover * .1;\n    uv_h += vec2(.5);\n\n    uv_h *= u_hoverratio;\n\n    uv -= vec2(.5);\n    uv *= 1. - u_progressHover * .2;\n    uv += mouse * .1 * u_progressHover;\n    uv *= u_ratio;\n    uv += vec2(.5);\n\n  //vec4 color=vec4(1, 1, 1, 0);\n    vec4 color = u_colorMask;\n\n    vec4 image = texture2D(u_map, uv);\n    vec4 hover = texture2D(u_hovermap, uv_h + vec2(nh) * progressHover * (1. - progress));\n    hover = mix(hover, color * hover, .8 * (1. - progress));\n\n    float finalMask = smoothstep(.0, .1, sqr - c);\n\n    image = mix(image, hover, clamp(c2 + progress, 0., 1.));\n    if(u_addborder) {\n        gl_FragColor = vec4(image.rgb, u_alpha * finalMask);\n    } else {\n        gl_FragColor = vec4(image.rgb, u_alpha);\n    }\n}\n",shape:"#define GLSLIFY 1\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\nuniform sampler2D u_map;\nuniform sampler2D u_hovermap;\nuniform sampler2D u_shape;\n\nuniform float u_time;\nuniform float u_alpha;\n\nuniform vec2 u_res;\nuniform vec2 u_ratio;\nuniform vec2 u_hoverratio;\nuniform vec2 u_mouse;\nuniform float u_progressHover;\nuniform float u_progressClick;\nuniform float u_sizeShape;\nvarying vec2 v_uv;\n\nvoid main() {\n    vec2 resolution = u_res * PR;\n    vec2 uv = v_uv;\n    vec2 uv_h = v_uv;\n    float time = u_time * 0.05;\n    float progress = u_progressClick;\n    float progressHover = u_progressHover;\n\n    vec2 st = gl_FragCoord.xy / resolution.xy - vec2(.5);\n    st.y *= resolution.y / resolution.x;\n\n    vec2 mouse = vec2((u_mouse.x / u_res.x) * 2. - 1., -(u_mouse.y / u_res.y) * 2. + 1.) * -.5;\n    mouse.y *= resolution.y / resolution.x;\n\n    uv -= vec2(0.5);\n    uv *= 1. - u_progressHover * 0.03;\n    uv *= u_ratio;\n    uv += vec2(0.5);\n\n    vec2 shapeUv = (st + mouse) * u_sizeShape;\n    shapeUv *= 1.5 - (progressHover + progress) * 0.8;\n    shapeUv /= progressHover;\n    shapeUv += vec2(.5);\n\n    vec4 shape = texture2D(u_shape, shapeUv);\n\n    float s = (shape.r) * 3. * (1. - progress);\n    float offX = uv.x + time;\n    float offY = uv.y + time * .2 + cos(time * 2.);\n    float n = snoise(vec3(offX, offY, time) * 5.) + 2.;\n\n    uv_h -= vec2(0.5);\n    uv_h *= 1. - progressHover * 0.05;\n    uv_h *= u_hoverratio;\n    uv_h += vec2(0.5);\n\n    vec4 image = texture2D(u_map, uv + mouse * 0.05 * progressHover * (1. - progress));\n    vec4 hover = texture2D(u_hovermap, uv_h + mouse * 0.5 * progressHover * (1. - progress));\n\n    float pct = smoothstep(.99, 1., clamp(n - s, 0., 1.) + progress);\n\n    vec4 finalImage = mix(image, hover, pct);\n\n    gl_FragColor = vec4(finalImage.rgb, u_alpha);\n  // gl_FragColor = vec4(vec3(pct), 1.);\n}\n",trippy:"#define GLSLIFY 1\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\nuniform sampler2D u_map;\nuniform sampler2D u_hovermap;\n\nuniform float u_alpha;\nuniform float u_time;\nuniform float u_progressHover;\nuniform float u_progressClick;\n\nuniform vec2 u_res;\nuniform vec2 u_mouse;\nuniform vec2 u_ratio;\nuniform vec2 u_hoverratio;\n\nuniform float u_radius;\n\nvarying vec2 v_uv;\n\nfloat circle(in vec2 _st, in float _radius, in float blurriness) {\n    vec2 dist = _st;\n    return 1. - smoothstep(_radius - (_radius * blurriness), _radius + (_radius * blurriness), dot(dist, dist) * 4.0);\n}\n\nvoid main() {\n    vec2 resolution = u_res * PR;\n    float time = u_time * 0.05;\n    float progress = u_progressClick;\n\n    float progressHover = u_progressHover;\n    vec2 uv = v_uv;\n    vec2 uv_h = v_uv;\n\n    vec2 st = gl_FragCoord.xy / resolution.xy - vec2(.5);\n    st.y *= resolution.y / resolution.x;\n\n    vec2 mouse = vec2((u_mouse.x / u_res.x) * 2. - 1., -(u_mouse.y / u_res.y) * 2. + 1.) * -.5;\n    mouse.y *= resolution.y / resolution.x;\n\n    vec2 cpos = st + mouse;\n\n    float c = circle(cpos, u_radius * progressHover + progress * 0.8, 2.);\n\n    float offX = uv.x + sin(uv.y + time * 2.);\n    float offY = uv.y - time * .2 - cos(time * 2.) * 0.1;\n    float nc = (snoise(vec3(offX, offY, time * .5) * 8.)) * progressHover;\n    float nh = (snoise(vec3(offX, offY, time * .5) * 2.)) * .03;\n\n    uv_h -= vec2(0.5);\n    uv_h *= 1. - u_progressHover * 0.1;\n    uv_h += vec2(0.5);\n\n    uv_h *= u_hoverratio;\n\n    uv -= vec2(0.5);\n    uv *= 1. - u_progressHover * 0.2;\n    uv *= u_ratio;\n    uv += vec2(0.5);\n\n    vec4 image = texture2D(u_hovermap, uv_h);\n    vec4 imageDistorted = texture2D(u_map, uv + vec2(nh) * progressHover);\n\n    float finalMask = smoothstep(.99, 1., pow(c, 2.) * 4. + nc * (1. - progress));\n\n    vec4 finalImage = mix(imageDistorted, image, clamp(finalMask + progress, 0., 1.));\n\n    gl_FragColor = vec4(finalImage.rgb, u_alpha);\n}\n",wave:"#define GLSLIFY 1\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\nuniform sampler2D u_map;\nuniform sampler2D u_hovermap;\n\nuniform float u_alpha;\nuniform float u_time;\nuniform float u_progressHover;\nuniform float u_progressClick;\n\nuniform vec2 u_res;\nuniform vec2 u_mouse;\nuniform vec2 u_ratio;\nuniform vec2 u_hoverratio;\n\nvarying vec2 v_uv;\n\nfloat circle(in vec2 _st, in float _radius, in float blurriness){\n    vec2 dist = _st - vec2(0.5);\n\t  return 1. - smoothstep(_radius-(_radius*blurriness), _radius+(_radius*blurriness), dot(dist,dist)*4.0);\n}\n\nvoid main() {\n  vec2 resolution = u_res * PR;\n  float time = u_time * 0.05;\n  float progress = u_progressClick;\n  float progressHover = u_progressHover;\n  vec2 uv = v_uv;\n  vec2 uv_h = v_uv;\n\n  vec2 st = gl_FragCoord.xy / resolution.xy - vec2(.5);\n  st.y *= resolution.y / resolution.x;\n\n  vec2 mouse = vec2((u_mouse.x / u_res.x) * 2. - 1.,-(u_mouse.y / u_res.y) * 2. + 1.) * -.5;\n  mouse.y *= resolution.y / resolution.x;\n\n  float offX = uv.x * .3 - time * 0.3;\n  float offY = uv.y + sin(uv.x * 5.) * .1 - sin(time * 0.5) + snoise(vec3(uv.x, uv.y, time) * 0.5);\n  offX += snoise(vec3(offX, offY, time) * 5.) * .3;\n  offY += snoise(vec3(offX, offX, time * 0.3)) * .1;\n  float nc = (snoise(vec3(offX, offY, time * .5) * 8.)) * progressHover;\n  float nh = (snoise(vec3(offX, offY, time * .5 ) * 2.)) * .03;\n\n  nh *= smoothstep(nh, 0.5, 0.6);\n\n  uv_h -= vec2(0.5);\n  uv_h *= u_hoverratio;\n  uv_h += vec2(0.5);\n\n  uv -= vec2(0.5);\n  uv *= u_ratio;\n  uv += vec2(0.5);\n\n  vec4 image = texture2D(u_map, uv_h + vec2(nc + nh) * progressHover);\n  vec4 hover = texture2D(u_hovermap, uv + vec2(nc + nh) * progressHover * (1. - progress));\n\n  vec4 finalImage = mix(image, hover, clamp(nh * (1. - progress) + progressHover, 0., 1.));\n\n  gl_FragColor = vec4(finalImage.rgb, u_alpha);\n}\n",reveal:"#define GLSLIFY 1\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\nuniform sampler2D u_map;\nuniform sampler2D u_hovermap;\n\nuniform float u_time;\nuniform float u_alpha;\n\nuniform vec2 u_res;\nuniform vec2 u_ratio;\nuniform vec2 u_hoverratio;\nuniform vec2 u_mouse;\nuniform float u_progressHover;\nuniform float u_progressClick;\n\nuniform float u_radius;\n\nvarying vec2 v_uv;\n\nfloat circle(in vec2 _st, in float _radius, in float blurriness){\n    vec2 dist = _st;\n\t  return 1. - smoothstep(_radius-(_radius*blurriness), _radius+(_radius*blurriness), dot(dist,dist)*4.0);\n}\n\nvoid main() {\n  vec2 resolution = u_res * PR;\n  vec2 uv = v_uv;\n  vec2 uv_h = v_uv;\n  float time = u_time * 0.05;\n  float progress = u_progressClick;\n  float progressHover = u_progressHover;\n\n  vec2 st = gl_FragCoord.xy / resolution.xy - vec2(.5);\n  st.y *= resolution.y / resolution.x;\n\n  vec2 mouse = vec2((u_mouse.x / u_res.x) * 2. - 1.,-(u_mouse.y / u_res.y) * 2. + 1.) * -.5;\n  mouse.y *= resolution.y / resolution.x;\n\n  float shape = (uv.x + uv.y - 2. + progressHover * 2.7 + progress * 2.7) * 2.;\n  float offX = uv.x + uv.y;\n  float offY = uv.y - uv.x;\n  float n = snoise(vec3(offX, offY, time) * 8.) * .5;\n\n  float grd = 0.1 * progressHover;\n\n  float sqr = 100. * ((smoothstep(0., grd, uv.x) - smoothstep(1. - grd, 1., uv.x)) * (smoothstep(0., grd, uv.y) - smoothstep(1. - grd, 1., uv.y))) - 10.;\n\n  uv_h -= vec2(0.5);\n  uv_h *= 1. - progressHover * 0.1;\n  uv_h += vec2(0.5);\n\n  uv_h *= u_hoverratio;\n\n  uv -= vec2(0.5);\n  uv *= 1. - progressHover * 0.2;\n  uv *= u_ratio;\n  uv += vec2(0.5);\n\n  vec2 cpos = st + mouse;\n\n  float c = circle(cpos, u_radius * progressHover + progress * 0.8, 2.) * 50.;\n\n  vec4 image = texture2D(u_map, uv);\n  vec4 hover = texture2D(u_hovermap, uv_h + mouse * 0.1 * progressHover);\n\n  float pct = smoothstep(.99, 1., n + shape);\n\n  float finalMask = smoothstep(.0, .1, sqr - c);\n\n  vec4 finalImage = mix(image, hover, pct);\n\n  gl_FragColor = vec4(finalImage.rgb, u_alpha * finalMask) ;\n}\n"},w=function(){function t(){(0,i.Z)(this,t),this.tilesSelector=".gooey-tile",this.tiles=[],this.tilesRendered=[],this.sceneTiles=[],this.init()}return(0,r.Z)(t,[{key:"init",value:function(){this.grabAllTile(),this.createSceneEachTile(),this.renderTiles(),this.requestAnimationSceneTiles()}},{key:"grabAllTile",value:function(){for(var t=document.querySelectorAll(this.tilesSelector),e=0;e<t.length;e++){var n=t[e].querySelector(".js-tile"),i={id:"tile".concat(e),idCanvas:"stage".concat(e),imgSrc:n.src,hoverSrc:n.dataset.hover,effect:n.getAttribute("data-effect"),dataUniform:(0,s.EF)(n.getAttribute("data-uniform")),width:n.width,height:n.height,imgDom:n};this.tiles.push(i)}}},{key:"createSceneEachTile",value:function(){for(var t=0;t<this.tiles.length;t++){var e=this.tiles[t],n=e.idCanvas,i=e.width,r=e.height,s=document.getElementById(n),o=new _({$container:s,size:{width:i,height:r},cameraOption:{far:1e4,near:1}});this.sceneTiles.push(o)}}},{key:"renderTiles",value:function(){for(var t=0;t<this.tiles.length;t++){var e=b[this.tiles[t].effect];if(e){var n=new x({scene:this.sceneTiles[t],tile:this.tiles[t],effectShape:e,duration:.5});this.tilesRendered.push(n)}}}},{key:"requestAnimationSceneTiles",value:function(){for(var t=this,e=function(e){var n=t.sceneTiles[e];n.setUpdateCallback((function(){t.tilesRendered[e].update()})),n.update()},n=0;n<this.tilesRendered.length;n++)e(n)}}]),t}()},194:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return x}});var i=n(610),r=n(991),s=n(255),o=n(724),a=n(608),l=n(212),c=n(317);function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var h=function(t){(0,s.Z)(n,t);var e=u(n);function n(t){var r;return(0,i.Z)(this,n),(r=e.call(this,{vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\nuniform sampler2D uTexture;\nuniform vec2 uOffset;\n\nfloat M_PI = 3.141529;\n\nvec3 deformationCurve(vec3 position, vec2 uv, vec2 offset){\n    position.x = position.x + (sin(uv.y * M_PI) * offset.x);\n    position.y = position.y + (sin(uv.x * M_PI) * offset.y);\n    return position;\n}\n\nvoid main() {\n    vUv = uv;\n    vec3 newPos = deformationCurve(position, uv, uOffset);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(newPos, 1.0);\n}",fragmentShader:"#define GLSLIFY 1\n// background-size: cover for an image texture in a GLSL shader\n// https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44\nvec2 getCoverUv(vec2 uv, vec2 resolution, vec2 texResolution) {\n    vec2 s = resolution; // Screen\n    vec2 i = texResolution; // Image\n    float rs = s.x / s.y;\n    float ri = i.x / i.y;\n    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);\n    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;\n    vec2 coverUv = uv * s / new + offset;\n    return coverUv;\n}\n\nuniform sampler2D uTexture;\nuniform float uAlpha;\nuniform vec2 uOffset;\n\nuniform vec2 uContainSize;\nuniform vec2 uTextureSize;\nuniform float uDisFactor;\n\nvarying vec2 vUv;\n\nvec3 rgbShift(sampler2D textureImage, vec2 uv, vec2 offset){\n    float r = texture2D(textureImage, uv + offset).r;\n    vec2 gb = texture2D(textureImage, uv).gb;\n    return vec3(r, gb);\n}\n\nvoid main() {\n    vec2 coverUv = getCoverUv(vUv, uContainSize, uTextureSize);\n    vec2 translate2d = vec2(0.0);\n    vec2 myUv = coverUv + translate2d; \n    vec3 color = rgbShift(uTexture, myUv, uOffset);\n    gl_FragColor = vec4(color, uAlpha);\n}\n"})).uniforms=t,r.transparent=!0,r.getUniform=function(){return r.uniforms},r}return n}(l.jyz),d=n(706);function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}document.getElementById("test-img").src;var f="https://i.imgur.com/LY4VlUM.jpeg";function m(t,e,n){return t*(1-n)+e*n}var v=function(t){(0,s.Z)(n,t);var e=p(n);function n(t){var r,s=t.$container,o=t.size;return(0,i.Z)(this,n),(r=e.call(this,s,o.width,o.height)).loader=new l.dpR,r.sizePlane={w:250,h:350},r.updateSizePlane={w:250,h:350},r.offset=new l.FM8,r.mouse=new l.FM8,r.textureHover=r.loader.load(f),r.uniforms={uAlpha:{value:0},uOffset:{value:new l.FM8},uTexture:{value:r.textureHover},uDisFactor:{value:0},uContainSize:{value:new l.FM8(r.sizePlane.w,r.sizePlane.h)},uTextureSize:{value:new l.FM8(768,1024)},uTextureUrl:{value:f}},r.perspective=1e3,r.minPerspective=.1,r.maxPerspective=1e3,r.isHover=!1,r.init(),r}return(0,r.Z)(n,[{key:"init",value:function(){this.start(),this.initCamera(),this.createPlaneMesh(),this.mainScene.add(this.planeMesh),this.update(),this.events()}},{key:"initCamera",value:function(){var t=2*Math.atan(this.H/2/this.perspective)*180/Math.PI;this.camera=new l.cPb(t,this.W/this.H,this.minPerspective,this.maxPerspective),this.camera.position.set(0,0,this.perspective)}},{key:"createPlaneMesh",value:function(){var t=new l._12(1,1,20,20),e=new h(this.uniforms);this.planeMesh=new l.Kj0(t,e),this.planeMesh.scale.set(this.sizePlane.w,this.sizePlane.h,1),this.planeMesh.position.set(this.offset.x,this.offset.y,0)}},{key:"onMouseMove",value:function(){var t=this;window.addEventListener("mousemove",(function(e){t.mouse.x=e.clientX,t.mouse.y=e.clientY}))}},{key:"updateCallback",value:function(){this.offset.x=m(this.offset.x,this.mouse.x,.1),this.offset.y=m(this.offset.y,this.mouse.y,.1),this.planeMesh.position.set(this.offset.x-this.W/2,-this.offset.y+this.H/2,0),this.uniforms.uOffset.value.x=5e-4*(this.mouse.x-this.offset.x),this.uniforms.uOffset.value.y=5e-4*(this.mouse.y-this.offset.y),this.isHover&&(this.sizePlane.w=m(this.sizePlane.w,this.updateSizePlane.w,.1),this.sizePlane.h=m(this.sizePlane.h,this.updateSizePlane.h,.1),this.planeMesh.scale.set(this.sizePlane.w,this.sizePlane.h,1),this.uniforms.uContainSize.value=new l.FM8(this.sizePlane.w,this.sizePlane.h))}},{key:"updateSizeTexture",value:function(t){var e=t.plane,n=(t.img,t.texture);n.matrixAutoUpdate=!1;var i=e.w/e.h,r=n.image.width/n.image.height;return i<r?n.matrix.setUvTransform(0,0,i/r,1,0,.5,.5):n.matrix.setUvTransform(0,0,1,r/i,0,.5,.5),n}},{key:"events",value:function(){this.onMouseMove()}},{key:"onMouseHover",value:function(t){var e=t.url,n=t.size;if(this.uniforms.uTextureUrl.value!=e){var i=this.loader.load(e);this.uniforms.uTextureUrl.value=e,this.uniforms.uTexture.value=i,this.updateSizePlane=n,this.isHover=!0,this.uniforms.uAlpha.value=0,c.Q3.to(this.uniforms.uAlpha,.35,{value:1})}}},{key:"onMouseOut",value:function(){this.isHover=!1,this.uniforms.uTextureUrl.value=null,c.Q3.to(this.uniforms.uAlpha,.35,{value:0})}}]),n}(d.Z),g=n(755),x=function(){function t(){(0,i.Z)(this,t),this.init()}return(0,r.Z)(t,[{key:"init",value:function(){this.initScene(),this.eventHoverIn(),this.eventHoverOut()}},{key:"initScene",value:function(){this.sceneImage=new v({$container:document.getElementById("cv-hover-distortion"),size:{width:window.innerWidth,height:window.innerHeight}})}},{key:"eventHoverIn",value:function(){var t=this;g(".js-hover").on("mouseover",(function(e){var n=e.currentTarget,i=n.dataset.img,r=JSON.parse(n.dataset.size);t.sceneImage.onMouseHover({url:i,size:r})}))}},{key:"eventHoverOut",value:function(){var t=this;g(".js-hover").on("mouseout",(function(e){t.sceneImage.onMouseOut()}))}}]),t}()},585:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return f}});var i=n(610),r=n(991),s=n(255),o=n(724),a=n(608),l=n(212),c=n(706);function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var h=function(t){(0,s.Z)(n,t);var e=u(n);function n(t){var r;return(0,i.Z)(this,n),(r=e.call(this,{vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"#define GLSLIFY 1\n/// https://www.shadertoy.com/view/Xd3cR7\n\n#define PI  3.14159\n#define TAU 6.28318\n\nvarying vec2 vUv;\n\nconst float MAX_DISTANCE = 100.;\nconst float EPSILON = .0001;\nconst int NUM_MARCHES = 255;\nconst float BOX_EXTENTS = 2.;\nconst float RADIUS = .5;\nconst float RADIUS_COMPONENT = .35355; // sqrt(RADIUS^2 / 2)\n\nuniform float iTime;\nuniform sampler2D iChannel1;\nuniform sampler2D iChannel0;\n\nfloat udRoundBox( vec3 p, vec3 b, float r )\n{\n  return length(max(abs(p)-b,0.0))-r;\n}\n\nmat3 rotateY(float rads)\n{\n    return mat3(\n        vec3(cos(rads), 0., sin(rads)),\n        vec3(0., 1., 0.),\n        vec3(-sin(rads), 0., cos(rads))\n    );\n}\n\nfloat sceneSDF(vec3 p, mat3 modelMatrix)\n{\n    p *= modelMatrix;\n    return udRoundBox(p, vec3(BOX_EXTENTS), RADIUS);\n}\n\nfloat getGrey(vec3 p){ return p.x*0.299 + p.y*0.587 + p.z*0.114; }\n\nvec3 tex3D( sampler2D tex, vec3 p, vec3 n, mat3 mat)\n{\n   \tn *= mat;\n\n    n = max((abs(n) - 0.2)*7., 0.001);\n    n /= (n.x + n.y + n.z );  \n    \n\treturn (texture(tex, p.yz)*n.x + texture(tex, p.zx)*n.y + texture(tex, p.xy)*n.z).xyz;\n}\n\nvec3 bump( sampler2D tex, in vec3 p, in vec3 nor, float bumpfactor, mat3 mat){\n   \n    const float eps = 0.001;\n    vec3 grad = vec3( getGrey(tex3D(tex, vec3(p.x-eps, p.y, p.z), nor, mat)),\n                      getGrey(tex3D(tex, vec3(p.x, p.y-eps, p.z), nor, mat)),\n                      getGrey(tex3D(tex, vec3(p.x, p.y, p.z-eps), nor, mat)));\n    grad = (grad - getGrey(tex3D(tex,  p , nor, mat))) / eps; \n\n    return normalize( nor + grad*bumpfactor );\n\t\n}\n\nvec3 phong(vec3 normal, vec3 light, vec3 view)\n{\n    const vec3 ambientColor = vec3(1., 1., 1.);\n    const vec3 diffuseColor = vec3(1., 1., 1.);\n    const vec3 specularColor = vec3(1., 1., 1.);\n    const float shininess = 16.;\n    const float ambientStrength = .25;\n    \n    vec3 diffuse = max(dot(normal, light), 0.) * diffuseColor;\n    // light is negated because the first argument to reflect is the incident vector\n    vec3 specular = pow(max(dot(reflect(-light, normal), view), 0.), shininess) * specularColor;\n    vec3 ambient = ambientStrength * ambientColor;\n    \n    return diffuse + specular + ambient;\n}\n\nvec3 gradient(vec3 pos, mat3 mat)\n{\n    const vec3 dx = vec3(EPSILON, 0., 0.);\n    const vec3 dy = vec3(0., EPSILON, 0.);\n    const vec3 dz = vec3(0., 0., EPSILON);\n    \n    return normalize(vec3(\n    \tsceneSDF(pos + dx, mat) - sceneSDF(pos - dx, mat),\n        sceneSDF(pos + dy, mat) - sceneSDF(pos - dy, mat),\n        sceneSDF(pos + dz, mat) - sceneSDF(pos - dz, mat)\n    ));\n}\n\nfloat distanceToShape(vec3 pos, vec3 dir, mat3 modelMatrix)\n{\n    float tot = 0.;\n    for(int i = 0; i < NUM_MARCHES; i++) {\n        float dist = sceneSDF(pos, modelMatrix);\n        if (dist < EPSILON || tot > MAX_DISTANCE) {\n        \treturn tot;\n        }\n        \n        tot += dist;\n        pos += dir * dist;\n    }\n    return MAX_DISTANCE;\n}\n\nmat4 lookAt(vec3 eye, vec3 target, vec3 up)\n{\n    vec3 f = normalize(target - eye);\n    vec3 r = normalize(cross(f, up));\n    vec3 u = normalize(cross(r, f));\n    \n    return mat4(\n        vec4(r, 0.),\n        vec4(u, 0.),\n        vec4(-f, 0.),\n        vec4(0., 0., 0., 1.));\n}\n\n// 0 = same side, 1 = opposite side, 2 = x-adjacent, 3 = y-adjacent\nfloat getSide(vec3 p, mat3 modelMatrix)\n{\n    p = transpose(modelMatrix) * p;\n    \n    if (p.z > BOX_EXTENTS + RADIUS_COMPONENT) \n    {\n    \treturn 0.;\n    }\n    else if (p.z < -BOX_EXTENTS - RADIUS_COMPONENT)\n    {\n    \treturn 1.;\n    }\n    else if (abs(p.x) > BOX_EXTENTS + RADIUS_COMPONENT)\n    {\n    \treturn 2.;\n    }\n    \n    return 3.;\n}\n\nvec3 getColor(vec3 pos, vec3 eye, float texScale, mat3 mat)\n{\n    const float speed = 1.;\n    const float repeat = 2.5;\n    const float thickness = .015;\n    const float thicknessModifier = 8.;\n    const float gridTileWidth = .5;\n    const float bumpAmount = .01;\n    const vec3 lightPos = vec3(-3., 5., 5.);\n    \n    float t = mod(iTime, repeat) * speed;\n    float side = getSide(pos, mat);\n    vec3 originalPos = pos;\n    pos = transpose(mat) * pos;\n    vec2 uv;\n    \n    if (side == 0.) uv = pos.xy;\n    else if (side == 2.) uv = vec2(2. * BOX_EXTENTS - pos.z, pos.y);\n    else if (side == 3.) uv = vec2(pos.x, (2. * BOX_EXTENTS - pos.z));\n    else if (abs(pos.x) > abs(pos.y)) uv = vec2(3. * BOX_EXTENTS + BOX_EXTENTS - abs(pos.x), pos.y);\n    else uv = vec2(pos.x, 3. * BOX_EXTENTS + BOX_EXTENTS - abs(pos.y));\n    \n\tvec2 node = round(uv / vec2(gridTileWidth)) * gridTileWidth;\n    float nodeOffset = 1. - t - (1. - distance(node, vec2(0.)) / thicknessModifier);\n    float uvOffset = 1. - t - (1. - distance(uv, vec2(0.)) / thicknessModifier);\n\n    vec2 dist = abs(uv - node) - vec2(nodeOffset);\n    float num = min(abs(dist.x), abs(dist.y));\n    \n    float lerpAmount = clamp(uvOffset / (gridTileWidth / 2.), 0., 1.);\n    \n    bool swap = floor(mod(iTime / repeat, 2.)) == 0.;\n\n    vec3 norm = swap ? \n        \t\t\tmix(bump(iChannel1, pos * texScale, gradient(originalPos, mat), bumpAmount, mat),\n                    \tbump(iChannel0, pos * texScale, gradient(originalPos, mat), bumpAmount, mat),\n                    \tlerpAmount) : \n    \t\t\t\tmix(bump(iChannel0, pos * texScale, gradient(originalPos, mat), bumpAmount, mat),\n                    \tbump(iChannel1, pos * texScale, gradient(originalPos, mat), bumpAmount, mat),\n                    \tlerpAmount);\n    \n    \n    vec3 light = phong(norm, normalize(lightPos - pos), normalize(eye - pos));\n    vec3 col = swap ? \n        \t\t\tmix(tex3D(iChannel1, pos * texScale, norm, mat),\n                   \t\ttex3D(iChannel0, pos * texScale, norm, mat),\n                   \t\tlerpAmount) * light :\n    \t\t\t\tmix(tex3D(iChannel0, pos * texScale, norm, mat),\n                   \t\ttex3D(iChannel1, pos * texScale, norm, mat),\n                   \t\tlerpAmount) * light;\n    \n    \n    col.r += mix(0., step(num, thickness), max(0., sign(dist.y + dist.x)));\n\treturn col;\n}\n\nvoid main() //out vec4 fragColor, in vec2 fragCoord\n{\n    const float texScale = 1./10.;\n    const mat3 identity = mat3(1., 0., 0., 0., 1., 0., 0., 0., 1.);\n    \n    //vec2 uv = (2. * fragCoord - iResolution.xy) / iResolution.y;\n    vec2 uv = vUv - vec2(0.5, 0.5);\n\n    //vec3 eye = vec3(-6., 5., 6.5);\n    vec3 eye = vec3( 0., 0., 10.);\n    vec3 ray = normalize(vec3(uv, -1.));\n    \n    mat3 modelMatrix = rotateY(iTime / 2.);\n    \n    mat4 viewMat = lookAt(eye, vec3(0.), vec3(0., 1., 0.));\n    ray = (viewMat * vec4(ray, 1.)).xyz;\n    \n    float dist = distanceToShape(eye, ray, modelMatrix);\n    vec3 pos = eye + ray * dist;\n    \n    gl_FragColor = vec4(vec3(0.), 1.);\n    if (dist < MAX_DISTANCE) {\n        gl_FragColor.rgb = getColor(pos, eye, texScale, modelMatrix);\n    }\n}\n\n// void main(){\n//     vec3 color = vec3(0.0);\n//     gl_FragColor = vec4(color, 1.0);\n// }"})).uniforms=t,r.transparent=!0,r.DoubleSide=!0,r.getUniforms=function(){return r.uniforms},r}return n}(l.jyz);function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var p=function(t){(0,s.Z)(n,t);var e=d(n);function n(t){var r,s=t.$container,o=t.size,a=t.texSrc1,c=t.texSrc2;return(0,i.Z)(this,n),(r=e.call(this,s,o.width,o.height)).loader=new l.dpR,r.texSrc1=a,r.texSrc2=c,r.init(),r}return(0,r.Z)(n,[{key:"init",value:function(){this.start(),this.initOrthographicCamera(),this.setTextures({texSrc1:this.texSrc1,texSrc2:this.texSrc2}),this.createPlane(),this.update()}},{key:"createPlane",value:function(){var t=new l._12(1,1,1,1),e=new h({iTime:{value:0},iChannel1:{value:this.text1},iChannel0:{value:this.text2}});this.uniforms=e.getUniforms(),this.plane=new l.Kj0(t,e),this.plane.scale.set(this.W,this.H),this.plane.position.set(0,0,0),this.mainScene.add(this.plane)}},{key:"setTextures",value:function(t){var e=t.texSrc1,n=t.texSrc2;this.text1=this.loader.load(e),this.text2=this.loader.load(n)}},{key:"updateCallback",value:function(){this.uniforms.iTime.value+=.01}}]),n}(c.Z),f=function t(){(0,i.Z)(this,t),this.$container=document.getElementById("cv-morph-cube"),this.scene=new p({$container:this.$container,size:{},texSrc1:"https://i.imgur.com/jbCWdRR.jpg",texSrc2:"https://i.imgur.com/QNliu8O.jpg"})}},191:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return x}});var i=n(610),r=n(991),s=n(255),o=n(724),a=n(608),l=n(212),c=n(706),u=n(929);n(317);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var d=function(t){(0,s.Z)(n,t);var e=h(n);function n(t){var r,s=t.$container,o=t.size,a=void 0===o?{}:o,l=t.models;return(0,i.Z)(this,n),(r=e.call(this,s,a.width,a.height)).geometries=[],r.vertexOffset=[],r.models=l,r.init(),r}return(0,r.Z)(n,[{key:"init",value:function(){this.start(),this.renderer.setClearColor(u.P),this.initPerspectiveCamera(),this.addDirectionLight(),this.test(),this.update()}},{key:"test",value:function(){for(var t=this.models[1].geometry.clone(),e=new l.xoR({color:16711680,flatShading:!0}),n=[],i=[],r=[],s=t.attributes.position.count,o=t.attributes.position,a=t.attributes.normal,c=t.attributes.uv,u=0;u<Math.round(.5*s);u++){var h=o.getX(u),d=o.getY(u),p=o.getZ(u);r.push(h,d,p),h=a.getX(u),d=a.getY(u),p=a.getZ(u),n.push(h,d,p),h=c.getX(u),d=c.getY(u),p=c.getZ(u),i.push(h,d,p)}t.attributes.position=new l.a$l(r,3),t.attributes.normal=new l.a$l(n,3),t.attributes.uv=new l.a$l(i,3);var f=new l.Kj0(t,e);this.mainScene.add(f)}},{key:"addDirectionLight",value:function(){this.light=new l.Ox3(16773341,1),this.light.position.set(0,5,10),this.mainScene.add(this.light)}},{key:"addFiles",value:function(){var t=this.models[0].geometry.clone(),e=this.models[1].geometry.clone(),n=new l.xoR({color:16711680,flatShading:!0}),i=this.setMorpherTarget(t,e);this.mesh=new l.Kj0(i,n),this.mainScene.add(this.mesh)}},{key:"setMorpherTarget",value:function(t,e){var n=t.attributes,i=e.attributes,r=n.position.count,s=i.position.count;t.morphAttributes.position=[];for(var o=[],a=0;a<r;a++){var c=a<s?a:s-1,u=i.position.getX(c),h=i.position.getY(c),d=i.position.getZ(c);o.push(u,h,d)}return t.morphAttributes.position[0]=new l.a$l(o,3),t}},{key:"updateCallback",value:function(){}}]),n}(c.Z),p=n(607),f=n.n(p),m=(n(121),n(472),n(556),n(319)),v=n.n(m),g=n(457),x=function(){function t(){(0,i.Z)(this,t),this.$container=document.getElementById("cv-mesh-morpher"),this.srcModels=[f(),v()],this.models=[],this.isLoadedModels=!1,this.loadAllModels()}return(0,r.Z)(t,[{key:"loadAllModels",value:function(){for(var t=this,e=0;e<this.srcModels.length;e++){var n=this.srcModels[e];new g.n({src:n,resolve:function(e){var n=e.children[0];t.models.push(n),t.models.length===t.srcModels.length&&t.init()}})}}},{key:"init",value:function(){this.scene=new d({$container:this.$container,models:this.models})}}]),t}()},887:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return p}});var i=n(610),r=n(991),s=n(255),o=n(724),a=n(608);function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var c=function(t){(0,s.Z)(n,t);var e=l(n);function n(t){var r,s=t.$container,o=t.size;return(0,i.Z)(this,n),(r=e.call(this,s,o.width,o.height)).init(),r}return(0,r.Z)(n,[{key:"init",value:function(){this.start(),this.initCamera()}},{key:"setUpdateCallback",value:function(t){t&&(this.updateCallback=t)}}]),n}(n(706).Z),u=n(212);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var d=function(t){(0,s.Z)(n,t);var e=h(n);function n(t){var r;return(0,i.Z)(this,n),(r=e.call(this,{vertexShader:"#define GLSLIFY 1\nvarying vec3 vPos;\nvarying vec3 vNormal;\nvoid main() {\n    vPos = (modelMatrix * vec4(position, 1.0)).xyz;\n    vNormal = normalMatrix * normal;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"#define GLSLIFY 1\nuniform vec3 diffuse;\nvarying vec3 vPos;\nvarying vec3 vNormal;\nstruct PointLight {\n    vec3 position;\n    vec3 color;\n};\nuniform PointLight pointLights[NUM_POINT_LIGHTS];\nvoid main() {\n    vec4 addedLights = vec4(0.1, 0.1, 0.1, 1.0);\n    for(int l = 0; l < NUM_POINT_LIGHTS; l++) {\n        vec3 adjustedLight = pointLights[l].position + cameraPosition;\n        vec3 lightDirection = normalize(vPos - adjustedLight);\n        addedLights.rgb += clamp(dot(-lightDirection, vNormal), 0.0, 1.0) * pointLights[l].color;\n    }\n    //gl_FragColor = mix(vec4(diffuse.x, diffuse.y, diffuse.z, 1.0), addedLights, addedLights);\n    gl_FragColor = addedLights;\n}"})).uniforms=t,r.lights=!0,r.getUniforms=function(){return r.uniforms},r}return n}(u.jyz),p=function(){function t(){(0,i.Z)(this,t),this.$container=document.getElementById("point-light-cv"),this.scene=new c({$container:this.$container,size:{width:window.innerWidth,height:window.innerHeight}}),this.mainScene=this.scene.mainScene,this.init()}return(0,r.Z)(t,[{key:"init",value:function(){this.box=this.createBox(),this.mainScene.add(this.box),this.light=this.createLight(),this.mainScene.add(this.light),this.mainScene.background=new u.Ilk("rgba(0, 0, 0,1)"),this.scene.setUpdateCallback(this.updateCallback.bind(this)),this.scene.update()}},{key:"createLight",value:function(){var t=new u.cek(16711680),e=new u.xo$(.05,16,8);return t.add(new u.Kj0(e,new u.vBJ({color:16711680}))),t.position.set(10,5,-10),t}},{key:"createBox",value:function(){var t=new u.DvJ(2,2,2),e=u.rDY.merge([u.rBU.lights,{diffuse:{type:"c",value:new u.Ilk(16711935)}}]),n=new d(e),i=new u.Kj0(t,n);return i.position.z=-10,i}},{key:"updateCallback",value:function(){this.box.rotation.x+=.005,this.box.rotation.y+=.005}}]),t}()},13:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return f}});var i=n(610),r=n(991),s=n(255),o=n(724),a=n(608),l=n(212),c=n(706);function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var h=function(t){(0,s.Z)(n,t);var e=u(n);function n(t){var r;return(0,i.Z)(this,n),(r=e.call(this,{vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"#define GLSLIFY 1\nuniform float time;\nuniform float progress;\nuniform int totalOrb;\nuniform vec3 colorOrb;\nuniform vec4 resolution;\nuniform vec2 mouse;\nuniform bool isMouseLeave;\nvarying vec2 vUv;\nfloat PI = 3.141592653589793238;\n\n// Credit : \n// https://iquilezles.org/articles/distfunctions/\n\nfloat sdBox(vec3 p, vec3 b) {\n    vec3 q = abs(p) - b;\n    return length(max(q, 0.0)) + min(max(q.x, max(q.y, q.z)), 0.0);\n}\n\n// Credit : \n// https://iquilezles.org/articles/distfunctions/\n\nfloat sdSphere(vec3 p, float r) {\n    return length(p) - r;\n}\n\nfloat fresnelFn(vec3 eye, vec3 normal) {\n  return pow(1.0 + dot(eye, normal), 3.0);\n}\n\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1. - c;\n\n    return mat4(oc * axis.x * axis.x + c, oc * axis.x * axis.y - axis.z * s, oc * axis.z * axis.x + axis.y * s, 0., oc * axis.x * axis.y + axis.z * s, oc * axis.y * axis.y + c, oc * axis.y * axis.z - axis.x * s, 0., oc * axis.z * axis.x - axis.y * s, oc * axis.y * axis.z + axis.x * s, oc * axis.z * axis.z + c, 0., 0., 0., 0., 1.);\n}\n\nvec3 rotate(vec3 v, vec3 axis, float angle) {\n    mat4 m = rotationMatrix(axis, angle);\n    return (m * vec4(v, 1.)).xyz;\n}\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nfloat smin(float a, float b, float k) {\n    float h = clamp(.5 + .5 * (b - a) / k, 0., 1.);\n    return mix(b, a, h) - k * h * (1. - h);\n}\n\nvec2 sdf(vec3 p ) {\n    float type = 0.;\n    int total = totalOrb;\n    vec3 p1 = rotate(p, vec3(1.), time / 5.);\n    float box = smin(sdBox(p1, vec3(.2)), sdSphere(p, .2), .3);\n\n    float realSphere = sdSphere(p1, .3);\n    float final = mix(box, realSphere, .5 + .5 * sin(time / 3.));\n    \n    for(int i = 0; i < total; i++) {\n        float randOffset = rand(vec2(i, 0));\n        float progr = 1. - fract(time / 3. + randOffset * 3.);\n        vec3 pos = vec3(sin(randOffset * 2. * PI), cos(randOffset * 2. * PI), 0.);\n        float goToCenter = sdSphere(p - pos * progr, .1);\n        final = smin(final, goToCenter, .3);\n    }\n    float radiusMouseSphere = 0.;\n    if(isMouseLeave == false){\n        radiusMouseSphere = .1 + .05 * sin(time);\n    }\n    float mouseSphere = sdSphere(p - vec3(mouse * resolution.zw * 2., 0.), radiusMouseSphere);\n\n    if(mouseSphere < final)\n        type = 1.;\n\n    return vec2(smin(final, mouseSphere, .1), type);\n}\n\nvec3 calcNormal1(in vec3 p) {\n    const float eps = .0001;\n    const vec2 h = vec2(0.5, -0.5) * eps;\n    return normalize(vec3(sdf(p + h.xyy).x - sdf(p - h.xyy).x, sdf(p + h.yxy).x - sdf(p - h.yxy).x, sdf(p + h.yyx).x - sdf(p - h.yyx).x));\n}\n\nvoid main() {\n    float dist = length(vUv - vec2(.5));\n    vec3 bg = mix(vec3(.3), vec3(.0), dist);\n    vec2 newUV = (vUv - vec2(.5)) * resolution.zw + vec2(.5);\n    vec3 camPos = vec3(0., 0., 2.);\n    vec3 ray = normalize(vec3((vUv - vec2(.5)) * resolution.zw, -1.));\n\n    vec3 rayPos = camPos;\n    float t = 0.;\n    float tMax = 5.;\n\n    float type = 1.;\n\n    for(int i = 0; i < 256; ++i) {\n        vec3 pos = camPos + t * ray;\n        float h = sdf(pos).x;\n        type = sdf(pos).y;\n        if(h < .0001 || t > tMax)\n            break;\n\n        t += h;\n    }\n    vec3 color = bg;\n    if(t < tMax) {\n        vec3 pos = camPos + t * ray;\n        color = vec3(1.);\n        vec3 normal = calcNormal1(pos);\n        color = normal;\n\n        color = colorOrb;\n\n        float fresnel = fresnelFn(ray, normal);\n        color = mix(color, bg, fresnel);\n    }\n    gl_FragColor = vec4(color, 1.);\n}"})).uniforms=t,r.transparent=!0,r.getUniform=function(){return r.uniforms},r}return n}(l.jyz);function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var p=function(t){(0,s.Z)(n,t);var e=d(n);function n(t){var r,s=t.$container,o=t.size,a=void 0===o?{}:o;return(0,i.Z)(this,n),(r=e.call(this,s,a.width,a.height)).frustumSize=1,r.time=0,r.speed=.05,r.isPlaying=!0,r.isMouseLeave=!0,r.mouse=new l.FM8,r.resolution=new l.Ltg,r.init(),r}return(0,r.Z)(n,[{key:"initCamera",value:function(){this.camera=new l.iKG(this.frustumSize/-2,this.frustumSize/2,this.frustumSize/2,this.frustumSize/-2,-1e3,1e3),this.camera.position.set(0,0,2)}},{key:"init",value:function(){this.start(),this.renderer.setClearColor(0,1),this.initCamera(),this.addPlane(),this.resize(),this.mouseEvents(),this.eventResize(),this.update()}},{key:"eventResize",value:function(){window.addEventListener("resize",this.resize.bind(this))}},{key:"resize",value:function(){var t,e;this.W=window.innerWidth,this.H=window.innerHeight,this.renderer.setSize(this.W,this.H),this.camera.aspect=this.W/this.H,this.imageAspect=1,this.H/this.W>this.imageAspect?(t=this.W/this.H*this.imageAspect,e=1):(t=1,e=this.H/this.W/this.imageAspect),this.uniforms.resolution.value.x=this.W,this.uniforms.resolution.value.y=this.H,this.uniforms.resolution.value.z=t,this.uniforms.resolution.value.w=e;var n=this.camera.position.z;this.camera.fov=180/Math.PI*2*Math.atan(1/(2*n)),this.camera.updateProjectionMatrix()}},{key:"addPlane",value:function(){var t=new h({time:{value:0},progress:{value:0},mouse:{value:this.mouse},resolution:{value:this.resolution},totalOrb:{value:5},colorOrb:{value:new l.Pa4(.75,.16,.16)},isMouseLeave:{value:this.isMouseLeave}});this.uniforms=t.getUniform();var e=new l._12(1,1,1,1);this.plane=new l.Kj0(e,t),this.mainScene.add(this.plane)}},{key:"stop",value:function(){this.isPlaying=!1}},{key:"play",value:function(){this.isPlaying=!0}},{key:"mouseEvents",value:function(){var t=this;document.addEventListener("mousemove",(function(e){t.mouse.x=e.pageX/t.W-.5,t.mouse.y=-e.pageY/t.H+.5,t.isMouseLeave=!1})),document.addEventListener("mouseleave",(function(){t.isMouseLeave=!0}))}},{key:"updateCallback",value:function(){this.isPlaying&&(this.time+=this.speed,this.uniforms.time.value=this.time,this.uniforms.progress.value=this.progress,this.uniforms.isMouseLeave.value=this.isMouseLeave)}}]),n}(c.Z),f=function t(){(0,i.Z)(this,t),this.$container=document.getElementById("cv-ray-marching"),this.scene=new p({$container:this.$container})}},462:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return m}});var i=n(610),r=n(991),s=n(255),o=n(724),a=n(608),l=n(212),c=n(706);function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var h=function(t){(0,s.Z)(n,t);var e=u(n);function n(t){var r;return(0,i.Z)(this,n),(r=e.call(this,{vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\nvarying float vBlend;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"#define GLSLIFY 1\n#define MAX_STEPS 256\n#define MAX_DIST 256.\n#define SURF_DIST .0005\n#define Rot(a) mat2(cos(a),-sin(a),sin(a),cos(a))\n#define MATERIAL 0\n\n// background-size: cover for an image texture in a GLSL shader\n// https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44\nvec2 getCoverUv(vec2 uv, vec2 resolution, vec2 texResolution) {\n    vec2 s = resolution; // Screen\n    vec2 i = texResolution; // Image\n    float rs = s.x / s.y;\n    float ri = i.x / i.y;\n    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);\n    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;\n    vec2 coverUv = uv * s / new + offset;\n    return coverUv;\n}\n\nvarying vec2 vUv;\nvarying float vBlend;\nuniform float iTime;\nuniform vec4 iResolution;\nuniform sampler2D iTexture;\nuniform vec2 iTextureSize;\nuniform vec2 iContainSize;\n\nvec3 N33(vec3 p) {\n    vec3 a = fract(p * vec3(123.34, 234.34, 345.65));\n    a += dot(a, a + 34.35);\n    return fract(vec3(a.x * a.y, a.y * a.z, a.z * a.x));\n}\n\nfloat smin(float a, float b, float k) {\n    float h = clamp(0.5 + 0.5 * (b - a) / k, 0., 1.);\n    return mix(b, a, h) - k * h * (1.0 - h);\n}\n\nfloat hash(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nfloat metaball(vec3 p, float i, float t) {\n    vec3 n = N33(vec3(i));\n    vec3 p2 = sin(n * t) * 0.2;\n    vec3 spp = p - p2;\n    float sp = length(spp) - 0.01;\n    return sp;\n}\n\nvec2 GetDist(vec3 p) {\n\n    float k = 0.4; // radius metalball fly total\n    float d = 10.0;\n    float t = iTime * 3.0;\n\n    d = smin(d, metaball(p, 0.3, t), k);\n    d = smin(d, metaball(p, 0.6, t), k);\n    d = smin(d, metaball(p, 0.9, t), k);\n    d = smin(d, metaball(p, 1.2, t), k);\n    d = smin(d, metaball(p, 1.5, t), k);\n\n    vec2 model = vec2(d, MATERIAL);\n    return model;\n}\n\nvec2 RayMarch(vec3 ro, vec3 rd, float side, int stepnum) {\n    vec2 dO = vec2(0.0);\n\n    for(int i = 0; i < stepnum; i++) {\n        vec3 p = ro + rd * dO.x;\n        vec2 dS = GetDist(p);\n        dO.x += dS.x * side;\n        dO.y = dS.y;\n\n        if(dO.x > MAX_DIST || abs(dS.x) < SURF_DIST)\n            break;\n    }\n\n    return dO;\n}\n\nvec3 GetNormal(vec3 p) {\n    float d = GetDist(p).x;\n    vec2 e = vec2(.001, 0);\n\n    vec3 n = d - vec3(GetDist(p - e.xyy).x, GetDist(p - e.yxy).x, GetDist(p - e.yyx).x);\n\n    return normalize(n);\n}\n\nvec3 R(vec2 uv, vec3 p, vec3 l, float z) {\n    vec3 f = normalize(l - p), r = normalize(cross(vec3(0, 1, 0), f)), u = cross(f, r), c = p + f * z, i = c + uv.x * r + uv.y * u, d = normalize(i - p);\n    return d;\n}\n\n// thx iq! https://iquilezles.org/articles/distfunctions2d/\nfloat sdBox(in vec2 p, in vec2 b) {\n    vec2 d = abs(p) - b;\n    return length(max(d, 0.0)) + min(max(d.x, d.y), 0.0);\n}\n\n// vec3 drawBg(vec2 p, vec3 col){\n//     float d = shaderText(p*1.7);\n//     col = mix(col,vec3(0.0),S(d,0.0));\n//     return col;\n// }\n\nvec3 drawBg(vec2 p, vec3 col) {\n    vec4 tex = texture2D(iTexture, p);\n    col = mix(col, tex.rgb, tex.a);\n    return col;\n}\n\nvec3 reflectMaterial(vec2 p, vec3 rd, vec3 n) {\n    vec3 r = reflect(rd, n);\n    float clearGamma = 0.25;\n    vec3 refTex = drawBg(p, vec3(max(0.95, r.y))) + (r * sin(iTime) * clearGamma);\n    return refTex;\n}\n\nvec3 materials(int mat, vec3 n, vec3 rd, vec2 p, vec3 col) {\n    if(mat == MATERIAL) {\n        col = reflectMaterial(p, rd, n);\n    }\n    return col;\n}\n\nvoid main() {\n    //vec2 uv = (fragCoord-.5*iResolution.xy)/iResolution.y;\n    vec2 uv = vUv - vec2(0.5, 0.5);\n    vec2 coverUv = getCoverUv(vUv, iContainSize, iTextureSize);\n    vec2 newUv = coverUv;\n    //vec2 prevUV = uv;\n    //vec2 m =  iMouse.xy/iResolution.xy;\n\n    vec3 ro = vec3(0, 0, -1.0);\n    float zBall = 1.0;\n    vec3 rd = R(uv, ro, vec3(0, 0.0, 0.0), zBall);\n    vec2 d = RayMarch(ro, rd, 1., MAX_STEPS);\n    vec4 col = vec4(1.0);\n    if(d.x < MAX_DIST) {\n        vec3 p = ro + rd * d.x;\n        vec3 n = GetNormal(p);\n        float len = pow(length(n.xy), 3.0);\n        newUv += n.xy * len * 0.02;\n        int mat = int(d.y);\n        col.rgb = materials(mat, n, rd, newUv, col.rgb);\n    } else {\n        //col = tex.rgb;\n        col.rgb = drawBg(coverUv, col.rgb);\n    }\n\n    // gamma correction\n    col.rgb = pow(col.rgb, vec3(0.9545));\n    vec4 final = vec4(col.rgb, 1.0);\n    gl_FragColor = final;\n}"})).blending=l.Xaj,r.blendEquation=l.bGH,r.blendSrc=l.ghN,r.blendDst=l.Hy8,r.depthTest=!0,r.depthWrite=!1,r.uniforms=t,r.transparent=!0,r.getUniform=function(){return r.uniforms},r}return n}(l.jyz),d=n(218);function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var f=function(t){(0,s.Z)(n,t);var e=p(n);function n(t){var r,s=t.$container,o=t.size,a=void 0===o?{}:o,c=t.bannerTexSrc;return(0,i.Z)(this,n),(r=e.call(this,s,a.width,a.height)).loader=new l.dpR,r.bannerTex=r.loader.load(c),r.init(),r}return(0,r.Z)(n,[{key:"init",value:function(){this.start(),this.mainScene.background=new l.Ilk("#ff0000"),this.initCamera(),this.createBuffer(),this.createPlane(),this.update()}},{key:"initCamera",value:function(){this.camera=new l.iKG(this.W/-2,this.W/2,this.H/2,this.H/-2,0,1e3),this.mainScene.add(this.camera)}},{key:"createBuffer",value:function(){this.bufferScene=new l.xsS,this.bufferTexture=new l.dd2(this.W,this.H,{minFilter:l.wem,magFilter:l.TyD})}},{key:"createBanner",value:function(){var t=new l._12(1,1,1,1),e=new l.vBJ({map:this.bannerTex,side:l.ehD});this.banner=new l.Kj0(t,e),this.banner.scale.set(this.W,this.H),this.mainScene.add(this.banner)}},{key:"createPlane",value:function(){var t=new l._12(1,1,1,1),e=new h({iTime:{value:0},iTexture:{value:this.bannerTex},iResolution:{value:(0,d.uG)({W:this.W,H:this.H})},iContainSize:{value:new l.FM8(this.W,this.H)},iTextureSize:{value:new l.FM8(1024,768)}});this.uniforms=e.getUniform(),this.plane=new l.Kj0(t,e),this.plane.scale.set(this.W,this.H),this.mainScene.add(this.plane)}},{key:"updateCallback",value:function(){this.uniforms.iTexture.value=this.bannerTex,this.uniforms.iTime.value+=.02}}]),n}(c.Z),m=function(){function t(){(0,i.Z)(this,t),this.$container=document.getElementById("cv-soap-bubble"),this.bannerTexSrc=document.getElementById("js-banner-soap").src,this.scene=new f({$container:this.$container,bannerTexSrc:this.bannerTexSrc}),this.init()}return(0,r.Z)(t,[{key:"init",value:function(){}}]),t}()},723:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return k}});var i=n(156),r=n(610),s=n(991),o=n(212),a=n(787),l=n(255),c=n(724),u=n(608),h=n(706),d=n(218),p=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.wem,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.uWy;(0,r.Z)(this,t),this.renderer=e,this.size={width:n.width,height:n.height},this.readBuffer=new o.dd2(this.size.width,this.size.height,{wrapS:s,wrapT:s,minFilter:i,magFilter:i,format:o.wk1,type:o.VzW,stencilBuffer:!1}),this.writeBuffer=this.readBuffer.clone()}return(0,s.Z)(t,[{key:"resize",value:function(t){this.size=t;var e=Math.min(devicePixelRatio,2);this.writeBuffer.setSize(this.size.width*e,this.size.height*e),this.swap()}},{key:"swap",value:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t}},{key:"render",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n?this.renderer.render(t,e):(this.renderer.setRenderTarget(this.writeBuffer),this.renderer.clear(),this.renderer.render(t,e),this.renderer.setRenderTarget(null)),this.swap()}}]),t}(),f=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new o.FM8;(0,r.Z)(this,t),this.uniforms=i,this.material=new o.jyz({fragmentShader:e,vertexShader:n,uniforms:i}),this.scale=s,this.scene=new o.xsS,this.plane=new o.Kj0(new o._12(1,1,1,1),this.material),this.plane.scale.set(this.scale.x,this.scale.y,1),this.scene.add(this.plane)}return(0,s.Z)(t,[{key:"resize",value:function(t){this.scale=t,this.plane.scale.set(this.scale.x,this.scale.y,1)}}]),t}(),m="#define GLSLIFY 1\nvarying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}";function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.Z)(t);if(e){var r=(0,u.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}var g=function(t){(0,l.Z)(n,t);var e=v(n);function n(t){var i;return(0,r.Z)(this,n),(i=e.call(this,{vertexShader:"#define GLSLIFY 1\nuniform float time;\n\nvarying vec3 eyeVector;\nvarying vec3 worldNormal;\nvarying vec3 v_normal;\nuniform float zVertex ;\nuniform float zWorldPosition ;\n\nvoid main() {\n    v_normal = normalMatrix * normal;\n    vec4 worldPosition = modelMatrix * vec4(position, zWorldPosition);\n    eyeVector = normalize(worldPosition.xyz - cameraPosition);\n    worldNormal = normalize(modelViewMatrix * vec4(normal, 0.0)).xyz;\n\n\t//gl_Position = projectionMatrix * modelViewMatrix * vec4(sin(position.x*time*0.001), position.y, position.z, 1.0);\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, zVertex);\n}",fragmentShader:"#define GLSLIFY 1\n// multi-side refraction : https://codesandbox.io/s/w0ntb?file=/src/refraction-material/fragment.glsl:644-1536\n\n// https://www.shadertoy.com/view/3dSBDD\n\n#define PI2 6.2831853072 // PI * 2\n#define PI_O_2 1.5707963268 // PI / 2\n\nconst float passes = 7.0;\nconst float radius = 6.0;\nconst float lossiness = 2.0;\nconst float preserveOriginal = 0.0;\n\nvec4 gaussianBlur(sampler2D tex, vec2 uv, vec3 iResolution, float powerBlur) {\n    vec2 pixel = 1.0 / iResolution.xy;\n    float count = 1.0 + preserveOriginal;\n    vec4 color = texture2D(tex, uv) * count;\n    float directionStep = PI2 / passes;\n\n    vec2 off;\n    float c, s, dist, dist2, weight;\n\n    for(float d = 0.0; d < PI2; d += directionStep) {\n        c = cos(d);\n        s = sin(d);\n        dist = 1.0 / max(abs(c), abs(s));\n        dist2 = dist * (2.0 + lossiness);\n        off = vec2(c, s);\n        // radius -> powerBlur\n        for(float i = dist * 1.5; i <= powerBlur; i += dist2) {\n            weight = i / powerBlur; // 1.0 - cos(i / radius * PI_O_2);\n            count += weight;\n            color += texture(tex, uv + off * pixel * i) * weight;\n        }\n    }\n    vec4 fragColor = vec4(0.0);\n    fragColor = color / count;\n    return fragColor;\n}\n\nuniform sampler2D envMap;\nuniform samplerCube envCubeMap;\nuniform vec3 resolution;\nuniform float ior;\nuniform float uTime;\nuniform vec3 colorRefraction;\nuniform vec3 colorReflect;\nuniform bool isRefract;\nuniform bool isHaveEnvCubeMap;\nuniform float bias; // 0.0\nuniform float scale; // 1.0\nuniform float power; // 3.0\n\nuniform float powerBlur;\nuniform float powerRefract;\n\nuniform bool isEnableRefractionColor;\n\nvarying vec3 worldNormal;\nvarying vec3 viewDirection;\nvarying vec3 eyeVector;\nvarying vec3 v_normal;\n\nfloat Fresnel(vec3 eyeVector, vec3 worldNormal, float bias, float scale, float power) {\n\t//return pow(1.0 + dot(eyeVector, worldNormal), 3.0);\n\treturn bias + scale * pow(1.0 + dot(eyeVector, worldNormal), power);\n}\n\nvoid main() {\n\t//water is 1.33 and diamond has an IOR of 2.42.\n\tfloat iorVal = ior;\n\t// get screen coordinates\n\tvec3 _resolution = vec3(resolution.x, resolution.y, resolution.z);\n\tvec2 uv = gl_FragCoord.xy / _resolution.xy;\n\tvec2 texCoord = gl_FragCoord.xy / _resolution.xy;\n\tvec3 normal = worldNormal;\n\t// calculate refraction and add to the screen coordinates\n\tvec3 refracted = refract(eyeVector, normal, 1.0/iorVal);\n\tif(isRefract){\n\t\tuv += refracted.xy*powerRefract;\n\t}\n\n\t// sample the background texture\n\tvec4 tex;\n\tif(isEnableRefractionColor){\n\t\t// tex.r = texture2D(envMap, uv * colorRefraction.r).r;\n\t\t// tex.g = texture2D(envMap, uv * colorRefraction.g).g;\n\t\t// tex.b = texture2D(envMap, uv * colorRefraction.b).b;\n\t\ttex.r = gaussianBlur(envMap, uv* colorRefraction.r, _resolution, powerBlur).r;\n\t\ttex.g = gaussianBlur(envMap, uv* colorRefraction.g, _resolution, powerBlur).g;\n\t\ttex.b = gaussianBlur(envMap, uv* colorRefraction.b, _resolution, powerBlur).b;\n\t}\n\telse{\n\t\t//tex = texture2D(envMap, uv);\n\t\ttex = gaussianBlur(envMap, uv, _resolution, powerBlur);\n\t}\n\tvec4 outputTex = tex;\n\n\t// calculate the Fresnel ratio\n\tfloat f = Fresnel(eyeVector, normal, bias, scale, power);\n\n\t///////////////cube map\n    vec2 thetaphi = ((uv * 2.0) - vec2(1.0)) * vec2(3.1415926535897932384626433832795, 1.5707963267948966192313216916398); \n    vec3 rayDirection = vec3(cos(thetaphi.y) * cos(thetaphi.x), sin(thetaphi.y), cos(thetaphi.y) * sin(thetaphi.x));\n\tvec4 _cubeMap = textureCube(envCubeMap, rayDirection);\n\t//_cubeMap.rgb *= colorReflect;\n\t// mix the refraction color and reflection color\n\tif(isHaveEnvCubeMap == false){\n\t\toutputTex.rgb = mix(outputTex.rgb, colorReflect, f);\n\t}\n\telse{\n\t\toutputTex.rgb = mix(outputTex.rgb, _cubeMap.rgb, f);\n\t}\n\tgl_FragColor = vec4(outputTex.rgb, 1.0);\n}"})).uniforms=t,i.transparent=!0,i.getUniform=function(){return i.uniforms},i}return n}(o.jyz),x=n(929),y=function(t,e,n){var i=e.width/e.height,r=n.width/n.height,s=1,o=i/r;return o>1&&(o=1,s=r/i),t.repeat.set(o,s),t.offset.set((1-o)/2,(1-s)/2),t},_=n(317);function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.Z)(t);if(e){var r=(0,u.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}var w=function(t){(0,l.Z)(n,t);var e=b(n);function n(t){var i,s=t.$container,a=t.size,l=void 0===a?{}:a;return(0,r.Z)(this,n),(i=e.call(this,s,l.width,l.height)).resolution=(0,d.iQ)({W:i.W,H:i.H}),i.mouse=new o.Ltg,i.mouseFollow=new o.FM8,i.pointer=new o.FM8,i.loader=new o.dpR,i.rayCaster=new o.iMs,i.bgWaterSurface=null,i.modelSrc=null,i.isModelNotTransparent=!1,i.textureWaterSurface=null,i.modelName="model-unique",i.bgWall=null,i.bgWallSize=new o.FM8,i}return(0,s.Z)(n,[{key:"setDataUniformsBufferPlane",value:function(){this.dataUniformsBufferPlane={iChannel0:{value:null},iChannel1:{value:this.bgWaterSurface},iResolution:{value:this.resolution}}}},{key:"setDataUniformsBuffer",value:function(){this.dataUniformsBuffer={iResolution:{value:this.resolution},iChannel0:{value:null},iChannel1:{value:null},iMouse:{value:this.mouse},iTime:{value:0},iFrame:{value:0},isAutoRegeneratorWaterDrop:{value:!0}}}},{key:"setDataUniformsModel",value:function(t){var e=t.ior,n=void 0===e?.85:e,i=t.colorReflect,r=void 0===i?new o.Ilk("#FFF"):i,s=t.colorRefraction,a=void 0===s?new o.Ilk("rgb(255, 245, 245)"):s,l=t.isRefract,c=void 0===l||l,u=t.envCubeMap,h=void 0===u?null:u,d=t.isHaveEnvCubeMap,p=void 0!==d&&d,f=t.power,m=void 0===f?3:f,v=t.scale,g=void 0===v?1:v,x=t.bias,y=void 0===x?0:x,_=t.isEnableRefractionColor,b=t.zVertex,w=t.zWorldPosition,M=t.powerBlur,S=t.powerRefract;this.dataUniformsModel={powerRefract:{value:S},powerBlur:{value:M},isEnableRefractionColor:{value:_},power:{value:m},scale:{value:g},bias:{value:y},envCubeMap:{value:h},isHaveEnvCubeMap:{value:p},envMap:{value:null},ior:{value:n},uTime:{value:0},colorReflect:{value:r},colorRefraction:{value:a},resolution:{value:new o.Pa4(this.resolution.x*this.resolution.z,this.resolution.y*this.resolution.z,this.resolution.z)},zVertex:{value:b},zWorldPosition:{value:w},isRefract:{value:c}}}},{key:"init",value:function(){this.start(),this.renderer.autoClear=!1,this.renderer.setClearColor(new o.Ilk(x.P)),this.initPerspectiveCamera(),this.initCamera2(),this.createFbo(),this.createBackground(),this.createBufferA(),this.createBufferPlane(),this.createModel(),window.addEventListener("resize",this.resize.bind(this)),this.update()}},{key:"initCamera2",value:function(){this.orthoCamera=new o.iKG(this.W/-2,this.W/2,this.H/2,this.H/-2,1,1e3),this.orthoCamera.layers.set(1),this.camera.position.z=5,this.orthoCamera.position.z=5}},{key:"createFbo",value:function(){this.envFbo=new o.dd2(this.W*this.resolution.z,this.H*this.resolution.z)}},{key:"createBufferA",value:function(){this.bufferATarget=new p(this.renderer,{width:this.W,height:this.H}),this.bufferA=new f("#define GLSLIFY 1\nvarying vec2 vUv;\nuniform vec3 iResolution;\nuniform sampler2D iChannel0;\nuniform vec4 iMouse;\nuniform float iTime;\nuniform int iFrame;\nuniform bool isAutoRegeneratorWaterDrop;\n\n//#define AUTO\n\n#define STRENGTH     (0.75) // wave of life\n#define MODIFIER     (0.99) // circle\n#define STEP         (3.00) \n\n#define S(e) (texture(iChannel0, p+e).x) // Sample\n\nvec3 getPos() {\n#ifdef AUTO\n    float t = iTime * 5.0;\n    vec2 s = fract(floor(t) * vec2(0.456665, 0.708618)) * iResolution.xy;\n    return vec3(s, 1);\n#else\n    if(iMouse.z > 0.)\n        return vec3(iMouse.xy, 1);\n    return vec3(0);\n#endif /* AUTO */\n}\n\nvoid main() {\n    float d = 0.;\n    vec2 p = gl_FragCoord.xy / iResolution.xy;\n    vec4 c = texture(iChannel0, p);\n    vec3 e = vec3(vec2(STEP) / (iResolution.xy), 0.);\n    /////https://www.shadertoy.com/view/3sB3WW  \n   \t//float s0 = c.y, s1 = S(-e.zy), s2 = S(-e.xz), s3 = S(e.xz), s4 = S(e.zy);\n    /////https://www.shadertoy.com/view/4dK3Ww\n    float s0 = c.y;\n    float s1 = texture(iChannel0, p - e.zy).x;\n    float s2 = texture(iChannel0, p - e.xz).x;\n    float s3 = texture(iChannel0, p + e.xz).x;\n    float s4 = texture(iChannel0, p + e.zy).x;\n\n    vec3 pos = getPos();\n    if(pos.z > 0.5) {\n        d = STRENGTH * smoothstep(2.5, .5, length(pos.xy - gl_FragCoord.xy));\n    } else {\n        if(isAutoRegeneratorWaterDrop) {\n\n        // Simulate rain drops\n            float t = iTime * 2.;\n            vec2 pos = fract(floor(t) * vec2(0.456665, 0.708618)) * iResolution.xy;\n            float amp = 1. - step(.05, fract(t));\n            d = -amp * smoothstep(2.5, .5, length(pos.xy - gl_FragCoord.xy));\n        }\n    }\n\n   \t// Calculate new state\n    d += -(s0 - .5) * 2. + (s1 + s2 + s3 + s4 - 2.);\n    d *= MODIFIER;\n    d *= smoothstep(0., 1.0, float(iFrame >= 20)); // Clean buffer at startup\n    d = d * 0.5 + 0.5;\n    gl_FragColor = vec4(d, c.x, 0, 0); // Save current and previous state\n}",m,this.dataUniformsBuffer,{x:this.W,y:this.H})}},{key:"createBufferPlane",value:function(){this.bufferImageTarget=new p(this.renderer,{width:this.W,height:this.H}),this.bufferImage=new f("#define GLSLIFY 1\n#define TEXTURED 0\n#define WATER_COLOR vec3(0.92, 0.95, 1.0)\n///https://www.shadertoy.com/view/3sB3WW\n\nvarying vec2 vUv;\nuniform vec3 iResolution;\nuniform sampler2D iChannel1;\nuniform sampler2D iChannel0;\n\n// background-size: cover for an image texture in a GLSL shader\n// https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44\nvec2 getCoverUv(vec2 uv, vec2 resolution, vec2 texResolution) {\n    vec2 s = resolution; // Screen\n    vec2 i = texResolution; // Image\n    float rs = s.x / s.y;\n    float ri = i.x / i.y;\n    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);\n    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;\n    vec2 coverUv = uv * s / new + offset;\n    return coverUv;\n}\n\n//#define DEBUG\n\n#define SPECULAR    (12.)\n#define DEPTH       (20.)\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy / iResolution.xy;\n    \n    vec3 waterColor = vec3(0.81, 0.86, 0.96);\n    vec4 col = vec4(0.);\n\n    vec2 tc = texture(iChannel0, uv).xy;\n    col = texture(iChannel1, tc - (0.5 - uv));\n    col.xyz *= waterColor;\n    vec3 n = normalize(vec3(length(dFdx(tc)), length(dFdy(tc)), DEPTH / max(iResolution.x, iResolution.y)));\n    vec3 n_color = vec3(.9,.25,-.1);\n    col.xyz += pow(dot(n, normalize(n_color)), 2.0);\n    gl_FragColor = col;\n\n}",m,this.dataUniformsBufferPlane,{x:this.W,y:this.H})}},{key:"createModel",value:function(){this.materialModel=new g(this.dataUniformsModel),this.materialModel.uniforms.envMap.value=this.envFbo.texture,this.modelMesh=new o.Kj0(new o._12,new o.vBJ),this.modelMesh.name=this.modelName}},{key:"createBackground",value:function(){this.bgWall=y(this.bgWall,{width:this.W,height:this.H},{width:this.bgWallSize.x,height:this.bgWallSize.y}),this.quad=new o.Kj0(new o._12(1,1,1,1),new o.vBJ({map:this.bgWall})),this.quad.layers.set(1),this.quad.scale.set(this.W,this.H,1),this.mainScene.add(this.quad)}},{key:"updateCallback",value:function(){this.renderer.clear(),this.renderModel(),this.renderWaterSurface(),this.rayCasting(),this.transition&&this.transition()}},{key:"renderWaterSurface",value:function(){this.bufferA.uniforms.iTime.value+=.01,this.bufferA.uniforms.iFrame.value+=1,this.dataUniformsModel.uTime.value+=.01,this.bufferA.uniforms.iChannel0.value=this.bufferATarget.readBuffer.texture,this.bufferImage.uniforms.iChannel0.value=this.bufferATarget.readBuffer.texture,this.bufferImage.uniforms.iChannel1.value=this.isModelNotTransparent?this.textureWaterSurface:this.bgWaterSurface,this.bufferATarget.render(this.bufferA.scene,this.camera),this.bufferImageTarget.render(this.bufferImage.scene,this.camera)}},{key:"renderModel",value:function(){this.modelMesh&&(this.renderer.setRenderTarget(this.envFbo),this.renderer.render(this.mainScene,this.orthoCamera),this.bgWaterSurface=this.envFbo.texture,this.renderer.setRenderTarget(null),this.renderer.render(this.mainScene,this.orthoCamera),this.renderer.clearDepth(),this.modelMesh.material=this.materialModel,this.materialModel.uniforms.envMap.value=this.bufferImageTarget.readBuffer.texture)}},{key:"rayCasting",value:function(){this.rayCaster.setFromCamera(this.pointer,this.camera),this.rayCaster.intersectObjects(this.mainScene.children).length>0&&(this.isInteractive=!0)}},{key:"eventMouseDown",value:function(){this.isInteractive&&this.mouse.setZ(1)}},{key:"eventMouseUp",value:function(){this.mouse.setZ(0),this.isInteractive=!1}},{key:"eventMouseMove",value:function(t){var e=t.touches?t.touches[0].clientX:t.clientX,n=t.touches?t.touches[0].clientY:t.clientY,i=e/this.W*2-1,r=-n/this.H*2+1;this.pointer.x=i,this.pointer.y=r,this.mouse.setX(e),this.mouse.setY(this.H-n)}},{key:"resize",value:function(){this.W=window.innerWidth,this.H=window.innerHeight,this.bgWall=y(this.bgWall,{width:this.W,height:this.H},{width:this.bgWallSize.x,height:this.bgWallSize.y}),this.resolution=(0,d.iQ)({W:this.W,H:this.H}),this.renderer.setSize(this.W,this.H),this.camera.aspect=this.W/this.H,this.camera.updateProjectionMatrix(),this.orthoCamera.left=this.W/-2,this.orthoCamera.right=this.W/2,this.orthoCamera.top=this.H/2,this.orthoCamera.bottom=this.H/-2,this.orthoCamera.updateProjectionMatrix(),this.resizeModel(),this.resizeSurface()}},{key:"resizeModel",value:function(){this.envFbo.setSize(this.W*this.resolution.z,this.H*this.resolution.z),this.quad.scale.set(this.W,this.H,1),this.materialModel.uniforms.resolution.value=new o.Pa4(this.resolution.x*this.resolution.z,this.resolution.y*this.resolution.z,this.resolution.z)}},{key:"followMouseFn",value:function(t,e){var n=t.touches?t.touches[0].clientX:t.clientX,i=t.touches?t.touches[0].clientY:t.clientY;_.Q3.to(this.mouseFollow,.5,{x:n/this.W*2*e-1*e,y:-i/this.H*2*e/2+1*e/2}),_.Q3.to(this.modelMesh.position,.5,{x:this.mouseFollow.x,y:this.mouseFollow.y})}},{key:"resizeSurface",value:function(){this.bufferA.resize({x:this.resolution.x,y:this.resolution.y}),this.bufferImage.resize({x:this.resolution.x,y:this.resolution.y})}},{key:"removeModel",value:function(t){var e=this.mainScene.getObjectByName(t);this.mainScene.remove(e)}},{key:"replaceModel",value:function(t,e){this.removeModel(t),e.name=t,this.modelMesh=e,this.mainScene.add(this.modelMesh),this.modelMesh.position.z=this.zPositionModel||1}}]),n}(h.Z),M=n(472),S=n.n(M),C=n(556),T=n.n(C),P=n(319),A=n.n(P),E=n(457),L=n(498),D=n(342),k=function(){function t(){(0,r.Z)(this,t),this.$container=document.getElementById("cv-water-surface"),this.scene=new w({$container:this.$container}),this.pane=new L.Pane,this.pathSrcCubeMapShangHai=document.querySelector("#pathSrcShangHaiCubeMap").dataset.path,this.pathSrcCubeMapOutSide=document.querySelector("#pathSrcCubeMapOutSide").dataset.path,this.pathSrcCubeMapCityNight=document.querySelector("#pathSrcCubeMapCityNight").dataset.path,this.cubeMap=[],this.PARAMS={ior:2,power:3,bias:0,scale:1,"m-clear":!0,"m-refract":!0,"auto-wave":!0,useLightColorEnv:!1,models:[{text:"Glass Whale",value:T()},{text:"Shark",value:S()},{text:"icosahedron",value:A()}],model:A(),cubeMaps:[{text:"Outside building",value:0},{text:"Shanghai night",value:1},{text:"City night",value:2}],cubeMapIndex:0,"enabled-Refraction-color":!1,zPosition:-4.88,zVertex:.46,zWorldPosition:3,blur:4.35,rangeFollow:10,powerRefract:.15},window.innerWidth>767&&this.addPane(),this.enableUploadBannerImage=!0,this.bannerImage=a.YJ,this.bannerImageSize=new o.FM8(1899,838),this.enableUploadBannerImage?this.uploadBannerImage():this.init()}return(0,s.Z)(t,[{key:"uploadBannerImage",value:function(){var t=this;document.getElementById("uploadFile").addEventListener("change",(function(e){var n=e.currentTarget;if(n.files){var i=URL.createObjectURL(n.files[0]),r=document.createElement("img");r.src=i,r.onload=function(){t.bannerImageSize=new o.FM8(r.width,r.height),t.bannerImage=i,t.init()}}}))}},{key:"init",value:function(){var t,e=this;this.loadCubeMap(),this.scene.setDataUniformsBuffer(),this.scene.setDataUniformsBufferPlane(),this.scene.setDataUniformsModel((t={ior:.99,colorReflect:new o.Ilk("#fff"),colorRefraction:new o.Ilk("rgb(255, 245, 245)"),isRefract:this.PARAMS.isRefract,envCubeMap:this.cubeMap[this.PARAMS.cubeMapIndex],isHaveEnvCubeMap:!0,power:this.PARAMS.power,scale:this.PARAMS.scale,bias:this.PARAMS.bias},(0,i.Z)(t,"isHaveEnvCubeMap",!this.PARAMS.useLightColorEnv),(0,i.Z)(t,"isEnableRefractionColor",this.PARAMS["enabled-Refraction-color"]),(0,i.Z)(t,"zVertex",this.PARAMS.zVertex),(0,i.Z)(t,"zWorldPosition",this.PARAMS.zWorldPosition),(0,i.Z)(t,"powerBlur",this.PARAMS.blur),(0,i.Z)(t,"powerRefract",this.PARAMS.powerRefract),t)),this.scene.zPositionModel=this.PARAMS.zPosition,this.scene.bgWall=(new o.dpR).load(this.bannerImage),this.scene.bgWallSize=this.bannerImageSize,this.scene.isModelNotTransparent=!this.PARAMS["m-clear"],this.scene.textureWaterSurface=(new o.dpR).load(a.H_),this.scene.transition=function(){e.scene.modelMesh.rotation.y+=.005,e.isStarted&&e.renderPane()},this.scene.modelName="model-main",this.scene.init(),this.eventMouse(),new E.n({src:this.PARAMS.model,resolve:function(t){var n=t.children[0];e.scene.replaceModel(e.scene.modelName,n),e.startup()}})}},{key:"loadCubeMap",value:function(){var t=this;new D.J({path:this.pathSrcCubeMapOutSide,resolve:function(e){t.cubeMap[0]=e}}),new D.J({path:this.pathSrcCubeMapShangHai,resolve:function(e){t.cubeMap[1]=e}}),new D.J({path:this.pathSrcCubeMapCityNight,resolve:function(e){t.cubeMap[2]=e}})}},{key:"startup",value:function(){var t=this;_.Q3.to(this.scene.dataUniformsModel.ior,2,{value:.99,ease:_.EA.easeInOut,onComplete:function(){t.isStarted=!0}})}},{key:"renderPane",value:function(){this.scene.dataUniformsModel.ior.value=this.PARAMS.ior,this.scene.isModelNotTransparent=!this.PARAMS["m-clear"],this.scene.dataUniformsModel.isRefract.value=this.PARAMS["m-refract"],this.scene.dataUniformsBuffer.isAutoRegeneratorWaterDrop.value=this.PARAMS["auto-wave"],this.scene.dataUniformsModel.power.value=this.PARAMS.power,this.scene.dataUniformsModel.bias.value=this.PARAMS.bias,this.scene.dataUniformsModel.scale.value=this.PARAMS.scale,this.scene.dataUniformsModel.envCubeMap.value=this.cubeMap[this.PARAMS.cubeMapIndex],this.scene.dataUniformsModel.isHaveEnvCubeMap.value=!this.PARAMS.useLightColorEnv,this.scene.dataUniformsModel.isEnableRefractionColor.value=this.PARAMS["enabled-Refraction-color"],this.scene.modelMesh.position.z=this.PARAMS.zPosition,this.scene.dataUniformsModel.zVertex.value=this.PARAMS.zVertex,this.scene.dataUniformsModel.zWorldPosition.value=this.PARAMS.zWorldPosition,this.scene.dataUniformsModel.powerBlur.value=this.PARAMS.blur,this.scene.dataUniformsModel.powerRefract.value=this.PARAMS.powerRefract}},{key:"eventMouse",value:function(){var t=this;"ontouchmove"in window?(window.addEventListener("touchstart",(function(t){})),window.addEventListener("touchmove",(function(e){window.innerWidth>768&&t.scene.followMouseFn(e,t.PARAMS.rangeFollow)})),window.addEventListener("touchend",(function(){}))):(window.addEventListener("mousedown",(function(){})),window.addEventListener("mousemove",(function(e){window.innerWidth>768&&t.scene.followMouseFn(e,t.PARAMS.rangeFollow)})),window.addEventListener("mouseup",(function(){})))}},{key:"addPane",value:function(){var t=this;this.pane.addInput(this.PARAMS,"ior",{min:0,max:3}),this.pane.addInput(this.PARAMS,"power",{min:0,max:3}),this.pane.addInput(this.PARAMS,"bias",{min:0,max:1}),this.pane.addInput(this.PARAMS,"scale",{min:0,max:1}),this.pane.addInput(this.PARAMS,"m-clear"),this.pane.addInput(this.PARAMS,"m-refract"),this.pane.addInput(this.PARAMS,"auto-wave"),this.pane.addInput(this.PARAMS,"useLightColorEnv"),this.pane.addBlade({view:"list",label:"change-model",options:this.PARAMS.models,value:this.PARAMS.model}),this.pane.addBlade({view:"list",label:"change-envLight",options:this.PARAMS.cubeMaps,value:this.PARAMS.cubeMapIndex}),this.pane.addInput(this.PARAMS,"enabled-Refraction-color"),this.pane.addInput(this.PARAMS,"zVertex",{min:0,max:3}),this.pane.addInput(this.PARAMS,"zPosition",{min:-7,max:1}),this.pane.addInput(this.PARAMS,"zWorldPosition",{min:1,max:5}),this.pane.addInput(this.PARAMS,"blur",{min:0,max:50}),this.pane.addInput(this.PARAMS,"rangeFollow",{min:0,max:20}),this.pane.addInput(this.PARAMS,"powerRefract",{min:0,max:2}),this.pane.on("change",(function(e){"change-model"===e.target.label&&t.PARAMS.model!==e.value&&(t.PARAMS.model=e.value,new E.n({src:e.value,resolve:function(e){var n=e.children[0];t.scene.replaceModel(t.scene.modelName,n)}})),"change-envLight"===e.target.label&&t.PARAMS.cubeMapIndex!==e.value&&(t.PARAMS.cubeMapIndex=e.value)}))}}]),t}()},342:function(t,e,n){"use strict";n.d(e,{J:function(){return o}});var i=n(610),r=n(991),s=n(212),o=function(){function t(e){var n=e.path,r=e.resolve;(0,i.Z)(this,t),this.resolve=r,this.path=n,this.init()}return(0,r.Z)(t,[{key:"init",value:function(){var t=this;this.cube=(new s.cBK).setPath(this.path).load(["px.png","nx.png","py.png","ny.png","pz.png","nz.png"],(function(e){t.resolve(e)}),(function(t){}))}}]),t}()},457:function(t,e,n){"use strict";n.d(e,{n:function(){return b}});var i=n(610),r=n(991),s=n(255),o=n(724),a=n(608),l=n(212);function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var r=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var u=/^[og]\s*(.+)?/,h=/^mtllib /,d=/^usemtl /,p=/^usemap /,f=new l.Pa4,m=new l.Pa4,v=new l.Pa4,g=new l.Pa4,x=new l.Pa4;function y(){var t={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,e){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=t,void(this.object.fromDeclaration=!1!==e);var n=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:!1!==e,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(t,e){var n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);var i={index:this.materials.length,name:t||"",mtllib:Array.isArray(e)&&e.length>0?e[e.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(t){var e={index:"number"==typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return e.clone=this.clone.bind(e),e}};return this.materials.push(i),i},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(t){var e=this.currentMaterial();if(e&&-1===e.groupEnd&&(e.groupEnd=this.geometry.vertices.length/3,e.groupCount=e.groupEnd-e.groupStart,e.inherited=!1),t&&this.materials.length>1)for(var n=this.materials.length-1;n>=0;n--)this.materials[n].groupCount<=0&&this.materials.splice(n,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),e}},n&&n.name&&"function"==typeof n.clone){var i=n.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(t,e){var n=parseInt(t,10);return 3*(n>=0?n-1:n+e/3)},parseNormalIndex:function(t,e){var n=parseInt(t,10);return 3*(n>=0?n-1:n+e/3)},parseUVIndex:function(t,e){var n=parseInt(t,10);return 2*(n>=0?n-1:n+e/2)},addVertex:function(t,e,n){var i=this.vertices,r=this.object.geometry.vertices;r.push(i[t+0],i[t+1],i[t+2]),r.push(i[e+0],i[e+1],i[e+2]),r.push(i[n+0],i[n+1],i[n+2])},addVertexPoint:function(t){var e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){var e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,n){var i=this.normals,r=this.object.geometry.normals;r.push(i[t+0],i[t+1],i[t+2]),r.push(i[e+0],i[e+1],i[e+2]),r.push(i[n+0],i[n+1],i[n+2])},addFaceNormal:function(t,e,n){var i=this.vertices,r=this.object.geometry.normals;f.fromArray(i,t),m.fromArray(i,e),v.fromArray(i,n),x.subVectors(v,m),g.subVectors(f,m),x.cross(g),x.normalize(),r.push(x.x,x.y,x.z),r.push(x.x,x.y,x.z),r.push(x.x,x.y,x.z)},addColor:function(t,e,n){var i=this.colors,r=this.object.geometry.colors;void 0!==i[t]&&r.push(i[t+0],i[t+1],i[t+2]),void 0!==i[e]&&r.push(i[e+0],i[e+1],i[e+2]),void 0!==i[n]&&r.push(i[n+0],i[n+1],i[n+2])},addUV:function(t,e,n){var i=this.uvs,r=this.object.geometry.uvs;r.push(i[t+0],i[t+1]),r.push(i[e+0],i[e+1]),r.push(i[n+0],i[n+1])},addDefaultUV:function(){var t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){var e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,n,i,r,s,o,a,l){var c=this.vertices.length,u=this.parseVertexIndex(t,c),h=this.parseVertexIndex(e,c),d=this.parseVertexIndex(n,c);if(this.addVertex(u,h,d),this.addColor(u,h,d),void 0!==o&&""!==o){var p=this.normals.length;u=this.parseNormalIndex(o,p),h=this.parseNormalIndex(a,p),d=this.parseNormalIndex(l,p),this.addNormal(u,h,d)}else this.addFaceNormal(u,h,d);if(void 0!==i&&""!==i){var f=this.uvs.length;u=this.parseUVIndex(i,f),h=this.parseUVIndex(r,f),d=this.parseUVIndex(s,f),this.addUV(u,h,d),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";for(var e=this.vertices.length,n=0,i=t.length;n<i;n++){var r=this.parseVertexIndex(t[n],e);this.addVertexPoint(r),this.addColor(r)}},addLineGeometry:function(t,e){this.object.geometry.type="Line";for(var n=this.vertices.length,i=this.uvs.length,r=0,s=t.length;r<s;r++)this.addVertexLine(this.parseVertexIndex(t[r],n));for(var o=0,a=e.length;o<a;o++)this.addUVLine(this.parseUVIndex(e[o],i))}};return t.startObject("",!1),t}var _=function(t){(0,s.Z)(n,t);var e=c(n);function n(t){var r;return(0,i.Z)(this,n),(r=e.call(this,t)).materials=null,r}return(0,r.Z)(n,[{key:"load",value:function(t,e,n,i){var r=this,s=new l.hH6(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(n){try{e(r.parse(n))}catch(e){i&&i(e),r.manager.itemError(t)}}),n,i)}},{key:"setMaterials",value:function(t){return this.materials=t,this}},{key:"parse",value:function(t){var e=new y;-1!==t.indexOf("\r\n")&&(t=t.replace(/\r\n/g,"\n")),-1!==t.indexOf("\\\n")&&(t=t.replace(/\\\n/g,""));for(var n=t.split("\n"),i="",r="",s=[],o="function"==typeof"".trimLeft,a=0,c=n.length;a<c;a++)if(i=n[a],0!==(i=o?i.trimLeft():i.trim()).length&&"#"!==(r=i.charAt(0)))if("v"===r){var f=i.split(/\s+/);switch(f[0]){case"v":e.vertices.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])),f.length>=7?e.colors.push(parseFloat(f[4]),parseFloat(f[5]),parseFloat(f[6])):e.colors.push(void 0,void 0,void 0);break;case"vn":e.normals.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]));break;case"vt":e.uvs.push(parseFloat(f[1]),parseFloat(f[2]))}}else if("f"===r){for(var m=i.substr(1).trim().split(/\s+/),v=[],g=0,x=m.length;g<x;g++){var _=m[g];if(_.length>0){var b=_.split("/");v.push(b)}}for(var w=v[0],M=1,S=v.length-1;M<S;M++){var C=v[M],T=v[M+1];e.addFace(w[0],C[0],T[0],w[1],C[1],T[1],w[2],C[2],T[2])}}else if("l"===r){var P=i.substring(1).trim().split(" "),A=[],E=[];if(-1===i.indexOf("/"))A=P;else for(var L=0,D=P.length;L<D;L++){var k=P[L].split("/");""!==k[0]&&A.push(k[0]),""!==k[1]&&E.push(k[1])}e.addLineGeometry(A,E)}else if("p"===r){var R=i.substr(1).trim().split(" ");e.addPointGeometry(R)}else if(null!==(s=u.exec(i))){var I=(" "+s[0].substr(1).trim()).substr(1);e.startObject(I)}else if(d.test(i))e.object.startMaterial(i.substring(7).trim(),e.materialLibraries);else if(h.test(i))e.materialLibraries.push(i.substring(7).trim());else if(p.test(i));else if("s"===r){if((s=i.split(" ")).length>1){var z=s[1].trim().toLowerCase();e.object.smooth="0"!==z&&"off"!==z}else e.object.smooth=!0;var O=e.object.currentMaterial();O&&(O.smooth=e.object.smooth)}else if("\0"===i)continue;e.finalize();var N=new l.ZAu;if(N.materialLibraries=[].concat(e.materialLibraries),!0===!(1===e.objects.length&&0===e.objects[0].geometry.vertices.length))for(var F=0,B=e.objects.length;F<B;F++){var U=e.objects[F],V=U.geometry,H=U.materials,j="Line"===V.type,W="Points"===V.type,G=!1;if(0!==V.vertices.length){var q=new l.u9r;q.setAttribute("position",new l.a$l(V.vertices,3)),V.normals.length>0&&q.setAttribute("normal",new l.a$l(V.normals,3)),V.colors.length>0&&(G=!0,q.setAttribute("color",new l.a$l(V.colors,3))),!0===V.hasUVIndices&&q.setAttribute("uv",new l.a$l(V.uvs,2));for(var X=[],Z=0,Y=H.length;Z<Y;Z++){var K=H[Z],J=K.name+"_"+K.smooth+"_"+G,$=e.materials[J];if(null!==this.materials)if($=this.materials.create(K.name),!j||!$||$ instanceof l.nls){if(W&&$&&!($ instanceof l.UY4)){var Q=new l.UY4({size:10,sizeAttenuation:!1});l.F5T.prototype.copy.call(Q,$),Q.color.copy($.color),Q.map=$.map,$=Q}}else{var tt=new l.nls;l.F5T.prototype.copy.call(tt,$),tt.color.copy($.color),$=tt}void 0===$&&(($=j?new l.nls:W?new l.UY4({size:1,sizeAttenuation:!1}):new l.xoR).name=K.name,$.flatShading=!K.smooth,$.vertexColors=G,e.materials[J]=$),X.push($)}var et=void 0;if(X.length>1){for(var nt=0,it=H.length;nt<it;nt++){var rt=H[nt];q.addGroup(rt.groupStart,rt.groupCount,nt)}et=j?new l.ejS(q,X):W?new l.woe(q,X):new l.Kj0(q,X)}else et=j?new l.ejS(q,X[0]):W?new l.woe(q,X[0]):new l.Kj0(q,X[0]);et.name=U.name,N.add(et)}}else if(e.vertices.length>0){var st=new l.UY4({size:1,sizeAttenuation:!1}),ot=new l.u9r;ot.setAttribute("position",new l.a$l(e.vertices,3)),e.colors.length>0&&void 0!==e.colors[0]&&(ot.setAttribute("color",new l.a$l(e.colors,3)),st.vertexColors=!0);var at=new l.woe(ot,st);N.add(at)}return N}}]),n}(l.aNw),b=function(){function t(e){var n=e.src,r=e.resolve,s=e.reject,o=void 0===s?this.rejectFn:s,a=e.processing;(0,i.Z)(this,t),this.src=n,this.resolve=r,this.reject=o,this.processing=a,this.loader=new _,this.load()}return(0,r.Z)(t,[{key:"load",value:function(){var t=this;this.loader.load(this.src,(function(e){t.resolve(e)}),(function(e){t.processing&&t.processing(e)}),(function(e){t.reject(e)}))}},{key:"rejectFn",value:function(t){}}]),t}()},218:function(t,e,n){"use strict";n.d(e,{uG:function(){return r},m8:function(){return s},iQ:function(){return o}});var i=n(212),r=function(t){var e,n,r=t.imageAspect,s=void 0===r?1:r,o=t.W,a=t.H,l=new i.Ltg;return a/o>s?(e=o/a*s,n=1):(e=1,n=a/o/s),l.x=o,l.y=a,l.z=e,l.w=n,l},s=function(t){var e=t.W,n=t.H,r=window.devicePixelRatio;return new i.FM8(e*r,n*r)},o=function(t){var e=t.W,n=t.H,r=window.devicePixelRatio;return new i.Pa4(e,n,r)}},706:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var i=n(610),r=n(991),s=n(212),o=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.innerWidth,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.innerHeight,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,i.Z)(this,t),this.container=e,this.W=n,this.H=r,this.antialias=s,this.perspective=5,this.maxPerspective=100,this.minPerspective=.01,this.degCameraPerspective=45,this.renderedInCallBack=!1}return(0,r.Z)(t,[{key:"start",value:function(){this.mainScene=new s.xsS,this.renderer=new s.CP7({canvas:this.container,alpha:!0,antialias:this.antialias}),this.renderer.setSize(this.W,this.H),this.renderer.setPixelRatio(window.devicePixelRatio)}},{key:"initCamera",value:function(){this.camera=new s.cPb(this.degCameraPerspective,this.W/this.H,this.minPerspective,this.maxPerspective),this.camera.position.set(0,0,this.perspective),this.mainScene.add(this.camera)}},{key:"initPerspectiveCamera",value:function(){this.camera=new s.cPb(this.degCameraPerspective,this.W/this.H,this.minPerspective,this.maxPerspective),this.camera.position.set(0,0,this.perspective),this.mainScene.add(this.camera)}},{key:"initOrthographicCamera",value:function(){this.camera=new s.iKG(this.W/-2,this.W/2,this.H/2,this.H/-2,0,1e3),this.camera.position.set(0,0,0),this.mainScene.add(this.camera)}},{key:"update",value:function(){requestAnimationFrame(this.update.bind(this)),this.updateCallback(),this.camera,this.renderedInCallBack||this.renderer.render(this.mainScene,this.camera)}},{key:"updateCallback",value:function(){}}]),t}()},787:function(t,e,n){"use strict";n.d(e,{Il:function(){return i},cN:function(){return r},H_:function(){return s},IY:function(){return o},YJ:function(){return a}});var i="https://i.imgur.com/NkaHIdi.jpg",r="https://i.imgur.com/jbCWdRR.jpg",s="https://i.imgur.com/hqCBTK8.png",o="https://i.imgur.com/LcoTltO.jpg",a="https://i.imgur.com/sDM4GaI.png"},482:function(t,e,n){"use strict";n.d(e,{bd:function(){return r},ad:function(){return s},Dc:function(){return o},EF:function(){return h},wz:function(){return d},fu:function(){return p},Id:function(){return f}});var i=n(212),r=function(t){return t[t.length*Math.random()|0]},s=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e-t;return n?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return(t+i*Math.random())*e}:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return(t+i)*e}},o=function(t,e){var n=t.x,r=t.y,s=e.width,o=e.height,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=l(a(i.ZX$.degToRad(c)),[n,r]),h={w:u[0]/s,h:u[1]/o},d=1/Math.max(h.w,h.h);return new i.FM8(h.w*d,h.h*d)},a=function(t){return[Math.cos(t),-Math.sin(t),Math.sin(t),Math.cos(t)]},l=function(t,e){var n=t[0],i=t[1],r=t[2],s=t[3],o=e[0],a=e[1];return[Math.abs(o*n+a*r),Math.abs(o*i+a*s)]},c=function(t,e){var n=new i.Ilk(t);return e?new i.Ltg(n.r,n.g,n.b,1):new i.Pa4(n.r,n.g,n.b)},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(null!==t&&0!==t.length)return JSON.parse(t)},h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(null!==t&&0!==t.length){var e={},n=u(t);for(var r in n){var s=n[r];-1!==s.toString().indexOf("colorType-")&&(s=s.replace("colorType-",""),s=c(s,!0)),-1!==s.toString().indexOf("textureType-")&&(s=s.replace("textureType-",""),s=(new i.dpR).load(s)),e[r]={value:s}}return e}},d=function(t,e){for(var n=new i.dpR,r=0,s=[],o=!1,a=function(i){var a=t[i];n.load(a.src,(function(n){r++,n.name=a.name,s[i]=n,r!==t.length||o||e(s)}),void 0,(function(t){o=!0}))},l=0;l<t.length;l++)a(l)},p=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e)return i}},f=function(t){return t*Math.PI/180}},929:function(t,e,n){"use strict";n.d(e,{P:function(){return i}});var i="#565C62"},607:function(t,e,n){t.exports=n.p+"21d08e8a382c5f7e0975fe1601f3982c.obj"},556:function(t,e,n){t.exports=n.p+"19df263ebcd662b29e0ed8801ed31318.obj"},319:function(t,e,n){t.exports=n.p+"080138daa9a8423c54f015caf4ad7c0e.obj"},121:function(t,e,n){t.exports=n.p+"f52495506f436bf22de46a910c488a70.obj"},472:function(t,e,n){t.exports=n.p+"24df31586f17b99a95a3cf0340e84dbe.obj"},317:function(t,e,n){"use strict";function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function r(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}n.d(e,{l1:function(){return Xe},Fo:function(){return bn},p8:function(){return Cn},EA:function(){return Tn},Lp:function(){return Pn},eJ:function(){return An},Yv:function(){return En},Au:function(){return Ln},Q3:function(){return an},Wy:function(){return le},Ok:function(){return Mt},SI:function(){return tt},d4:function(){return et},r9:function(){return j},m2:function(){return q},Ks:function(){return mn},bQ:function(){return it},fS:function(){return St},JV:function(){return _n},kr:function(){return Re},UI:function(){return ye},if:function(){return tn},$i:function(){return vt},xr:function(){return Ie},Fc:function(){return R},Pr:function(){return Ct},lC:function(){return ct},S5:function(){return dn},DY:function(){return wt},GN:function(){return De},cy:function(){return Pt}});var s,o,a,l,c,u,h,d,p,f,m,v,g,x,y,_,b,w,M,S,C,T,P,A,E,L,D,k,R={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},I={duration:.5,overwrite:!1,delay:0},z=1e8,O=1e-8,N=2*Math.PI,F=N/4,B=0,U=Math.sqrt,V=Math.cos,H=Math.sin,j=function(t){return"string"==typeof t},W=function(t){return"function"==typeof t},G=function(t){return"number"==typeof t},q=function(t){return void 0===t},X=function(t){return"object"==typeof t},Z=function(t){return!1!==t},Y=function(){return"undefined"!=typeof window},K=function(t){return W(t)||j(t)},J="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},$=Array.isArray,Q=/(?:-?\.?\d|\.)+/gi,tt=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,et=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,nt=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,it=/[+-]=-?[.\d]+/,rt=/[^,'"\[\]\s]+/gi,st=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ot={},at={},lt=function(t){return(at=It(t,ot))&&Cn},ct=function(t,e){},ut=function(t,e){return!e&&void 0},ht=function(t,e){return t&&(ot[t]=e)&&at&&(at[t]=e)||ot},dt=function(){return 0},pt={},ft=[],mt={},vt={},gt={},xt=30,yt=[],_t="",bt=function(t){var e,n,i=t[0];if(X(i)||W(i)||(t=[t]),!(e=(i._gsap||{}).harness)){for(n=yt.length;n--&&!yt[n].targetTest(i););e=yt[n]}for(n=t.length;n--;)t[n]&&(t[n]._gsap||(t[n]._gsap=new Xe(t[n],e)))||t.splice(n,1);return t},wt=function(t){return t._gsap||bt(de(t))[0]._gsap},Mt=function(t,e,n){return(n=t[e])&&W(n)?t[e]():q(n)&&t.getAttribute&&t.getAttribute(e)||n},St=function(t,e){return(t=t.split(",")).forEach(e)||t},Ct=function(t){return Math.round(1e5*t)/1e5||0},Tt=function(t){return Math.round(1e7*t)/1e7||0},Pt=function(t,e){var n=e.charAt(0),i=parseFloat(e.substr(2));return t=parseFloat(t),"+"===n?t+i:"-"===n?t-i:"*"===n?t*i:t/i},At=function(t,e){for(var n=e.length,i=0;t.indexOf(e[i])<0&&++i<n;);return i<n},Et=function(){var t,e,n=ft.length,i=ft.slice(0);for(mt={},ft.length=0,t=0;t<n;t++)(e=i[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},Lt=function(t,e,n,i){ft.length&&Et(),t.render(e,n,i),ft.length&&Et()},Dt=function(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(rt).length<2?e:j(t)?t.trim():t},kt=function(t){return t},Rt=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},It=function(t,e){for(var n in e)t[n]=e[n];return t},zt=function t(e,n){for(var i in n)"__proto__"!==i&&"constructor"!==i&&"prototype"!==i&&(e[i]=X(n[i])?t(e[i]||(e[i]={}),n[i]):n[i]);return e},Ot=function(t,e){var n,i={};for(n in t)n in e||(i[n]=t[n]);return i},Nt=function(t){var e,n=t.parent||o,i=t.keyframes?(e=$(t.keyframes),function(t,n){for(var i in n)i in t||"duration"===i&&e||"ease"===i||(t[i]=n[i])}):Rt;if(Z(t.inherit))for(;n;)i(t,n.vars.defaults),n=n.parent||n._dp;return t},Ft=function(t,e,n,i,r){void 0===n&&(n="_first"),void 0===i&&(i="_last");var s,o=t[i];if(r)for(s=e[r];o&&o[r]>s;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[n],t[n]=e),e._next?e._next._prev=e:t[i]=e,e._prev=o,e.parent=e._dp=t,e},Bt=function(t,e,n,i){void 0===n&&(n="_first"),void 0===i&&(i="_last");var r=e._prev,s=e._next;r?r._next=s:t[n]===e&&(t[n]=s),s?s._prev=r:t[i]===e&&(t[i]=r),e._next=e._prev=e.parent=null},Ut=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},Vt=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var n=t;n;)n._dirty=1,n=n.parent;return t},Ht=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},jt=function t(e){return!e||e._ts&&t(e.parent)},Wt=function(t){return t._repeat?Gt(t._tTime,t=t.duration()+t._rDelay)*t:0},Gt=function(t,e){var n=Math.floor(t/=e);return t&&n===t?n-1:n},qt=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},Xt=function(t){return t._end=Tt(t._start+(t._tDur/Math.abs(t._ts||t._rts||O)||0))},Zt=function(t,e){var n=t._dp;return n&&n.smoothChildTiming&&t._ts&&(t._start=Tt(n._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),Xt(t),n._dirty||Vt(n,t)),t},Yt=function(t,e){var n;if((e._time||e._initted&&!e._dur)&&(n=qt(t.rawTime(),e),(!e._dur||ae(0,e.totalDuration(),n)-e._tTime>O)&&e.render(n,!0)),Vt(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(n=t;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;t._zTime=-1e-8}},Kt=function(t,e,n,i){return e.parent&&Ut(e),e._start=Tt((G(n)?n:n||t!==o?re(t,n,e):t._time)+e._delay),e._end=Tt(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),Ft(t,e,"_first","_last",t._sort?"_start":0),te(e)||(t._recent=e),i||Yt(t,e),t},Jt=function(t,e){return(ot.ScrollTrigger||ct("scrollTrigger",e))&&ot.ScrollTrigger.create(e,t)},$t=function(t,e,n,i){return en(t,e),t._initted?!n&&t._pt&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&h!==Ie.frame?(ft.push(t),t._lazy=[e,i],1):void 0:1},Qt=function t(e){var n=e.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||t(n))},te=function(t){var e=t.data;return"isFromStart"===e||"isStart"===e},ee=function(t,e,n,i){var r=t._repeat,s=Tt(e)||0,o=t._tTime/t._tDur;return o&&!i&&(t._time*=s/t._dur),t._dur=s,t._tDur=r?r<0?1e10:Tt(s*(r+1)+t._rDelay*r):s,o>0&&!i?Zt(t,t._tTime=t._tDur*o):t.parent&&Xt(t),n||Vt(t.parent,t),t},ne=function(t){return t instanceof Ye?Vt(t):ee(t,t._dur)},ie={_start:0,endTime:dt,totalDuration:dt},re=function t(e,n,i){var r,s,o,a=e.labels,l=e._recent||ie,c=e.duration()>=z?l.endTime(!1):e._dur;return j(n)&&(isNaN(n)||n in a)?(s=n.charAt(0),o="%"===n.substr(-1),r=n.indexOf("="),"<"===s||">"===s?(r>=0&&(n=n.replace(/=/,"")),("<"===s?l._start:l.endTime(l._repeat>=0))+(parseFloat(n.substr(1))||0)*(o?(r<0?l:i).totalDuration()/100:1)):r<0?(n in a||(a[n]=c),a[n]):(s=parseFloat(n.charAt(r-1)+n.substr(r+1)),o&&i&&(s=s/100*($(i)?i[0]:i).totalDuration()),r>1?t(e,n.substr(0,r-1),i)+s:c+s)):null==n?c:+n},se=function(t,e,n){var i,r,s=G(e[1]),o=(s?2:1)+(t<2?0:1),a=e[o];if(s&&(a.duration=e[1]),a.parent=n,t){for(i=a,r=n;r&&!("immediateRender"in i);)i=r.vars.defaults||{},r=Z(r.vars.inherit)&&r.parent;a.immediateRender=Z(i.immediateRender),t<2?a.runBackwards=1:a.startAt=e[o-1]}return new an(e[0],a,e[o+1])},oe=function(t,e){return t||0===t?e(t):e},ae=function(t,e,n){return n<t?t:n>e?e:n},le=function(t,e){return j(t)&&(e=st.exec(t))?e[1]:""},ce=[].slice,ue=function(t,e){return t&&X(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&X(t[0]))&&!t.nodeType&&t!==a},he=function(t,e,n){return void 0===n&&(n=[]),t.forEach((function(t){var i;return j(t)&&!e||ue(t,1)?(i=n).push.apply(i,de(t)):n.push(t)}))||n},de=function(t,e,n){return!j(t)||n||!l&&ze()?$(t)?he(t,n):ue(t)?ce.call(t,0):t?[t]:[]:ce.call((e||c).querySelectorAll(t),0)},pe=function(t){return t.sort((function(){return.5-Math.random()}))},fe=function(t){if(W(t))return t;var e=X(t)?t:{each:t},n=He(e.ease),i=e.from||0,r=parseFloat(e.base)||0,s={},o=i>0&&i<1,a=isNaN(i)||o,l=e.axis,c=i,u=i;return j(i)?c=u={center:.5,edges:.5,end:1}[i]||0:!o&&a&&(c=i[0],u=i[1]),function(t,o,h){var d,p,f,m,v,g,x,y,_,b=(h||e).length,w=s[b];if(!w){if(!(_="auto"===e.grid?0:(e.grid||[1,z])[1])){for(x=-z;x<(x=h[_++].getBoundingClientRect().left)&&_<b;);_--}for(w=s[b]=[],d=a?Math.min(_,b)*c-.5:i%_,p=_===z?0:a?b*u/_-.5:i/_|0,x=0,y=z,g=0;g<b;g++)f=g%_-d,m=p-(g/_|0),w[g]=v=l?Math.abs("y"===l?m:f):U(f*f+m*m),v>x&&(x=v),v<y&&(y=v);"random"===i&&pe(w),w.max=x-y,w.min=y,w.v=b=(parseFloat(e.amount)||parseFloat(e.each)*(_>b?b-1:l?"y"===l?b/_:_:Math.max(_,b/_))||0)*("edges"===i?-1:1),w.b=b<0?r-b:r,w.u=le(e.amount||e.each)||0,n=n&&b<0?Ue(n):n}return b=(w[t]-w.min)/w.max||0,Tt(w.b+(n?n(b):b)*w.v)+w.u}},me=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(n){var i=Math.round(parseFloat(n)/t)*t*e;return(i-i%1)/e+(G(n)?0:le(n))}},ve=function(t,e){var n,i,r=$(t);return!r&&X(t)&&(n=r=t.radius||z,t.values?(t=de(t.values),(i=!G(t[0]))&&(n*=n)):t=me(t.increment)),oe(e,r?W(t)?function(e){return i=t(e),Math.abs(i-e)<=n?i:e}:function(e){for(var r,s,o=parseFloat(i?e.x:e),a=parseFloat(i?e.y:0),l=z,c=0,u=t.length;u--;)(r=i?(r=t[u].x-o)*r+(s=t[u].y-a)*s:Math.abs(t[u]-o))<l&&(l=r,c=u);return c=!n||l<=n?t[c]:e,i||c===e||G(e)?c:c+le(e)}:me(t))},ge=function(t,e,n,i){return oe($(t)?!e:!0===n?!!(n=0):!i,(function(){return $(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(i=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((t-n/2+Math.random()*(e-t+.99*n))/n)*n*i)/i}))},xe=function(t,e,n){return oe(n,(function(n){return t[~~e(n)]}))},ye=function(t){for(var e,n,i,r,s=0,o="";~(e=t.indexOf("random(",s));)i=t.indexOf(")",e),r="["===t.charAt(e+7),n=t.substr(e+7,i-e-7).match(r?rt:Q),o+=t.substr(s,e-s)+ge(r?n:+n[0],r?0:+n[1],+n[2]||1e-5),s=i+1;return o+t.substr(s,t.length-s)},_e=function(t,e,n,i,r){var s=e-t,o=i-n;return oe(r,(function(e){return n+((e-t)/s*o||0)}))},be=function(t,e,n){var i,r,s,o=t.labels,a=z;for(i in o)(r=o[i]-e)<0==!!n&&r&&a>(r=Math.abs(r))&&(s=i,a=r);return s},we=function(t,e,n){var i,r,s=t.vars,o=s[e];if(o)return i=s[e+"Params"],r=s.callbackScope||t,n&&ft.length&&Et(),i?o.apply(r,i):o.call(r)},Me=function(t){return Ut(t),t.scrollTrigger&&t.scrollTrigger.kill(!1),t.progress()<1&&we(t,"onInterrupt"),t},Se=function(t){var e=(t=!t.name&&t.default||t).name,n=W(t),i=e&&!n&&t.init?function(){this._props=[]}:t,r={init:dt,render:vn,add:Qe,kill:xn,modifier:gn,rawVars:0},s={targetTest:0,get:0,getSetter:dn,aliases:{},register:0};if(ze(),t!==i){if(vt[e])return;Rt(i,Rt(Ot(t,r),s)),It(i.prototype,It(r,Ot(t,s))),vt[i.prop=e]=i,t.targetTest&&(yt.push(i),pt[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}ht(e,i),t.register&&t.register(Cn,i,bn)},Ce=255,Te={aqua:[0,Ce,Ce],lime:[0,Ce,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Ce],navy:[0,0,128],white:[Ce,Ce,Ce],olive:[128,128,0],yellow:[Ce,Ce,0],orange:[Ce,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Ce,0,0],pink:[Ce,192,203],cyan:[0,Ce,Ce],transparent:[Ce,Ce,Ce,0]},Pe=function(t,e,n){return(6*(t+=t<0?1:t>1?-1:0)<1?e+(n-e)*t*6:t<.5?n:3*t<2?e+(n-e)*(2/3-t)*6:e)*Ce+.5|0},Ae=function(t,e,n){var i,r,s,o,a,l,c,u,h,d,p=t?G(t)?[t>>16,t>>8&Ce,t&Ce]:0:Te.black;if(!p){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),Te[t])p=Te[t];else if("#"===t.charAt(0)){if(t.length<6&&(i=t.charAt(1),r=t.charAt(2),s=t.charAt(3),t="#"+i+i+r+r+s+s+(5===t.length?t.charAt(4)+t.charAt(4):"")),9===t.length)return[(p=parseInt(t.substr(1,6),16))>>16,p>>8&Ce,p&Ce,parseInt(t.substr(7),16)/255];p=[(t=parseInt(t.substr(1),16))>>16,t>>8&Ce,t&Ce]}else if("hsl"===t.substr(0,3))if(p=d=t.match(Q),e){if(~t.indexOf("="))return p=t.match(tt),n&&p.length<4&&(p[3]=1),p}else o=+p[0]%360/360,a=+p[1]/100,i=2*(l=+p[2]/100)-(r=l<=.5?l*(a+1):l+a-l*a),p.length>3&&(p[3]*=1),p[0]=Pe(o+1/3,i,r),p[1]=Pe(o,i,r),p[2]=Pe(o-1/3,i,r);else p=t.match(Q)||Te.transparent;p=p.map(Number)}return e&&!d&&(i=p[0]/Ce,r=p[1]/Ce,s=p[2]/Ce,l=((c=Math.max(i,r,s))+(u=Math.min(i,r,s)))/2,c===u?o=a=0:(h=c-u,a=l>.5?h/(2-c-u):h/(c+u),o=c===i?(r-s)/h+(r<s?6:0):c===r?(s-i)/h+2:(i-r)/h+4,o*=60),p[0]=~~(o+.5),p[1]=~~(100*a+.5),p[2]=~~(100*l+.5)),n&&p.length<4&&(p[3]=1),p},Ee=function(t){var e=[],n=[],i=-1;return t.split(De).forEach((function(t){var r=t.match(et)||[];e.push.apply(e,r),n.push(i+=r.length+1)})),e.c=n,e},Le=function(t,e,n){var i,r,s,o,a="",l=(t+a).match(De),c=e?"hsla(":"rgba(",u=0;if(!l)return t;if(l=l.map((function(t){return(t=Ae(t,e,1))&&c+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"})),n&&(s=Ee(t),(i=n.c).join(a)!==s.c.join(a)))for(o=(r=t.replace(De,"1").split(et)).length-1;u<o;u++)a+=r[u]+(~i.indexOf(u)?l.shift()||c+"0,0,0,0)":(s.length?s:l.length?l:n).shift());if(!r)for(o=(r=t.split(De)).length-1;u<o;u++)a+=r[u]+l[u];return a+r[o]},De=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(t in Te)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),ke=/hsl[a]?\(/,Re=function(t){var e,n=t.join(" ");if(De.lastIndex=0,De.test(n))return e=ke.test(n),t[1]=Le(t[1],e),t[0]=Le(t[0],e,Ee(t[1])),!0},Ie=(_=Date.now,b=500,w=33,M=_(),S=M,T=C=1e3/240,A=function t(e){var n,i,r,s,o=_()-S,a=!0===e;if(o>b&&(M+=o-w),((n=(r=(S+=o)-M)-T)>0||a)&&(s=++g.frame,x=r-1e3*g.time,g.time=r/=1e3,T+=n+(n>=C?4:C-n),i=1),a||(f=m(t)),i)for(y=0;y<P.length;y++)P[y](r,x,s,e)},g={time:0,frame:0,tick:function(){A(!0)},deltaRatio:function(t){return x/(1e3/(t||60))},wake:function(){u&&(!l&&Y()&&(a=l=window,c=a.document||{},ot.gsap=Cn,(a.gsapVersions||(a.gsapVersions=[])).push(Cn.version),lt(at||a.GreenSockGlobals||!a.gsap&&a||{}),v=a.requestAnimationFrame),f&&g.sleep(),m=v||function(t){return setTimeout(t,T-1e3*g.time+1|0)},p=1,A(2))},sleep:function(){(v?a.cancelAnimationFrame:clearTimeout)(f),p=0,m=dt},lagSmoothing:function(t,e){b=t||1e8,w=Math.min(e,b,0)},fps:function(t){C=1e3/(t||240),T=1e3*g.time+C},add:function(t,e,n){var i=e?function(e,n,r,s){t(e,n,r,s),g.remove(i)}:t;return g.remove(t),P[n?"unshift":"push"](i),ze(),i},remove:function(t,e){~(e=P.indexOf(t))&&P.splice(e,1)&&y>=e&&y--},_listeners:P=[]}),ze=function(){return!p&&Ie.wake()},Oe={},Ne=/^[\d.\-M][\d.\-,\s]/,Fe=/["']/g,Be=function(t){for(var e,n,i,r={},s=t.substr(1,t.length-3).split(":"),o=s[0],a=1,l=s.length;a<l;a++)n=s[a],e=a!==l-1?n.lastIndexOf(","):n.length,i=n.substr(0,e),r[o]=isNaN(i)?i.replace(Fe,"").trim():+i,o=n.substr(e+1).trim();return r},Ue=function(t){return function(e){return 1-t(1-e)}},Ve=function t(e,n){for(var i,r=e._first;r;)r instanceof Ye?t(r,n):!r.vars.yoyoEase||r._yoyo&&r._repeat||r._yoyo===n||(r.timeline?t(r.timeline,n):(i=r._ease,r._ease=r._yEase,r._yEase=i,r._yoyo=n)),r=r._next},He=function(t,e){return t&&(W(t)?t:Oe[t]||function(t){var e,n,i,r,s=(t+"").split("("),o=Oe[s[0]];return o&&s.length>1&&o.config?o.config.apply(null,~t.indexOf("{")?[Be(s[1])]:(e=t,n=e.indexOf("(")+1,i=e.indexOf(")"),r=e.indexOf("(",n),e.substring(n,~r&&r<i?e.indexOf(")",i+1):i)).split(",").map(Dt)):Oe._CE&&Ne.test(t)?Oe._CE("",t):o}(t))||e},je=function(t,e,n,i){void 0===n&&(n=function(t){return 1-e(1-t)}),void 0===i&&(i=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var r,s={easeIn:e,easeOut:n,easeInOut:i};return St(t,(function(t){for(var e in Oe[t]=ot[t]=s,Oe[r=t.toLowerCase()]=n,s)Oe[r+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=Oe[t+"."+e]=s[e]})),s},We=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},Ge=function t(e,n,i){var r=n>=1?n:1,s=(i||(e?.3:.45))/(n<1?n:1),o=s/N*(Math.asin(1/r)||0),a=function(t){return 1===t?1:r*Math.pow(2,-10*t)*H((t-o)*s)+1},l="out"===e?a:"in"===e?function(t){return 1-a(1-t)}:We(a);return s=N/s,l.config=function(n,i){return t(e,n,i)},l},qe=function t(e,n){void 0===n&&(n=1.70158);var i=function(t){return t?--t*t*((n+1)*t+n)+1:0},r="out"===e?i:"in"===e?function(t){return 1-i(1-t)}:We(i);return r.config=function(n){return t(e,n)},r};St("Linear,Quad,Cubic,Quart,Quint,Strong",(function(t,e){var n=e<5?e+1:e;je(t+",Power"+(n-1),e?function(t){return Math.pow(t,n)}:function(t){return t},(function(t){return 1-Math.pow(1-t,n)}),(function(t){return t<.5?Math.pow(2*t,n)/2:1-Math.pow(2*(1-t),n)/2}))})),Oe.Linear.easeNone=Oe.none=Oe.Linear.easeIn,je("Elastic",Ge("in"),Ge("out"),Ge()),E=7.5625,D=1/(L=2.75),je("Bounce",(function(t){return 1-k(1-t)}),k=function(t){return t<D?E*t*t:t<.7272727272727273?E*Math.pow(t-1.5/L,2)+.75:t<.9090909090909092?E*(t-=2.25/L)*t+.9375:E*Math.pow(t-2.625/L,2)+.984375}),je("Expo",(function(t){return t?Math.pow(2,10*(t-1)):0})),je("Circ",(function(t){return-(U(1-t*t)-1)})),je("Sine",(function(t){return 1===t?1:1-V(t*F)})),je("Back",qe("in"),qe("out"),qe()),Oe.SteppedEase=Oe.steps=ot.SteppedEase={config:function(t,e){void 0===t&&(t=1);var n=1/t,i=t+(e?0:1),r=e?1:0;return function(t){return((i*ae(0,.99999999,t)|0)+r)*n}}},I.ease=Oe["quad.out"],St("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(t){return _t+=t+","+t+"Params,"}));var Xe=function(t,e){this.id=B++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:Mt,this.set=e?e.getSetter:dn},Ze=function(){function t(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,ee(this,+t.duration,1,1),this.data=t.data,p||Ie.wake()}var e=t.prototype;return e.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,ee(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,e){if(ze(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(Zt(this,t),!n._dp||n.parent||Yt(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&Kt(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===O||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),Lt(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+Wt(this))%(this._dur+this._rDelay)||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+Wt(this),e):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(t,e){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*n,e):this._repeat?Gt(this._tTime,n)+1:1},e.timeScale=function(t){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===t)return this;var e=this.parent&&this._ts?qt(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||-1e-8===t?0:this._rts,this.totalTime(ae(-this._delay,this._tDur,e),!0),Xt(this),Ht(this)},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(ze(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==O&&(this._tTime-=O)))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return e&&(e._sort||!this.parent)&&Kt(e,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(Z(t)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?qt(e.rawTime(t),this):this._tTime:this._tTime},e.globalTime=function(t){for(var e=this,n=arguments.length?t:e.rawTime();e;)n=e._start+n/(e._ts||1),e=e._dp;return n},e.repeat=function(t){return arguments.length?(this._repeat=t===1/0?-2:t,ne(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(t){if(arguments.length){var e=this._time;return this._rDelay=t,ne(this),e?this.time(e):this}return this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(re(this,t),Z(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,Z(e))},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var t,e=this.parent||this._dp,n=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(t=e.rawTime(!0))>=n&&t<this.endTime(!0)-O))},e.eventCallback=function(t,e,n){var i=this.vars;return arguments.length>1?(e?(i[t]=e,n&&(i[t+"Params"]=n),"onUpdate"===t&&(this._onUpdate=e)):delete i[t],this):i[t]},e.then=function(t){var e=this;return new Promise((function(n){var i=W(t)?t:kt,r=function(){var t=e.then;e.then=null,W(i)&&(i=i(e))&&(i.then||i===e)&&(e.then=t),n(i),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?r():e._prom=r}))},e.kill=function(){Me(this)},t}();Rt(Ze.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var Ye=function(t){function e(e,n){var r;return void 0===e&&(e={}),(r=t.call(this,e)||this).labels={},r.smoothChildTiming=!!e.smoothChildTiming,r.autoRemoveChildren=!!e.autoRemoveChildren,r._sort=Z(e.sortChildren),o&&Kt(e.parent||o,i(r),n),e.reversed&&r.reverse(),e.paused&&r.paused(!0),e.scrollTrigger&&Jt(i(r),e.scrollTrigger),r}r(e,t);var n=e.prototype;return n.to=function(t,e,n){return se(0,arguments,this),this},n.from=function(t,e,n){return se(1,arguments,this),this},n.fromTo=function(t,e,n,i){return se(2,arguments,this),this},n.set=function(t,e,n){return e.duration=0,e.parent=this,Nt(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new an(t,e,re(this,n),1),this},n.call=function(t,e,n){return Kt(this,an.delayedCall(0,t,e),n)},n.staggerTo=function(t,e,n,i,r,s,o){return n.duration=e,n.stagger=n.stagger||i,n.onComplete=s,n.onCompleteParams=o,n.parent=this,new an(t,n,re(this,r)),this},n.staggerFrom=function(t,e,n,i,r,s,o){return n.runBackwards=1,Nt(n).immediateRender=Z(n.immediateRender),this.staggerTo(t,e,n,i,r,s,o)},n.staggerFromTo=function(t,e,n,i,r,s,o,a){return i.startAt=n,Nt(i).immediateRender=Z(i.immediateRender),this.staggerTo(t,e,i,r,s,o,a)},n.render=function(t,e,n){var i,r,s,a,l,c,u,h,d,p,f,m,v=this._time,g=this._dirty?this.totalDuration():this._tDur,x=this._dur,y=t<=0?0:Tt(t),_=this._zTime<0!=t<0&&(this._initted||!x);if(this!==o&&y>g&&t>=0&&(y=g),y!==this._tTime||n||_){if(v!==this._time&&x&&(y+=this._time-v,t+=this._time-v),i=y,d=this._start,c=!(h=this._ts),_&&(x||(v=this._zTime),(t||!e)&&(this._zTime=t)),this._repeat){if(f=this._yoyo,l=x+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*l+t,e,n);if(i=Tt(y%l),y===g?(a=this._repeat,i=x):((a=~~(y/l))&&a===y/l&&(i=x,a--),i>x&&(i=x)),p=Gt(this._tTime,l),!v&&this._tTime&&p!==a&&(p=a),f&&1&a&&(i=x-i,m=1),a!==p&&!this._lock){var b=f&&1&p,w=b===(f&&1&a);if(a<p&&(b=!b),v=b?0:x,this._lock=1,this.render(v||(m?0:Tt(a*l)),e,!x)._lock=0,this._tTime=y,!e&&this.parent&&we(this,"onRepeat"),this.vars.repeatRefresh&&!m&&(this.invalidate()._lock=1),v&&v!==this._time||c!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(x=this._dur,g=this._tDur,w&&(this._lock=2,v=b?x:-1e-4,this.render(v,!0),this.vars.repeatRefresh&&!m&&this.invalidate()),this._lock=0,!this._ts&&!c)return this;Ve(this,m)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(u=function(t,e,n){var i;if(n>e)for(i=t._first;i&&i._start<=n;){if("isPause"===i.data&&i._start>e)return i;i=i._next}else for(i=t._last;i&&i._start>=n;){if("isPause"===i.data&&i._start<e)return i;i=i._prev}}(this,Tt(v),Tt(i)))&&(y-=i-(i=u._start)),this._tTime=y,this._time=i,this._act=!h,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t,v=0),!v&&i&&!e&&(we(this,"onStart"),this._tTime!==y))return this;if(i>=v&&t>=0)for(r=this._first;r;){if(s=r._next,(r._act||i>=r._start)&&r._ts&&u!==r){if(r.parent!==this)return this.render(t,e,n);if(r.render(r._ts>0?(i-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(i-r._start)*r._ts,e,n),i!==this._time||!this._ts&&!c){u=0,s&&(y+=this._zTime=-1e-8);break}}r=s}else{r=this._last;for(var M=t<0?t:i;r;){if(s=r._prev,(r._act||M<=r._end)&&r._ts&&u!==r){if(r.parent!==this)return this.render(t,e,n);if(r.render(r._ts>0?(M-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(M-r._start)*r._ts,e,n),i!==this._time||!this._ts&&!c){u=0,s&&(y+=this._zTime=M?-1e-8:O);break}}r=s}}if(u&&!e&&(this.pause(),u.render(i>=v?0:-1e-8)._zTime=i>=v?1:-1,this._ts))return this._start=d,Xt(this),this.render(t,e,n);this._onUpdate&&!e&&we(this,"onUpdate",!0),(y===g&&this._tTime>=this.totalDuration()||!y&&v)&&(d!==this._start&&Math.abs(h)===Math.abs(this._ts)||this._lock||((t||!x)&&(y===g&&this._ts>0||!y&&this._ts<0)&&Ut(this,1),e||t<0&&!v||!y&&!v&&g||(we(this,y===g&&t>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(y<g&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(t,e){var n=this;if(G(e)||(e=re(this,e,t)),!(t instanceof Ze)){if($(t))return t.forEach((function(t){return n.add(t,e)})),this;if(j(t))return this.addLabel(t,e);if(!W(t))return this;t=an.delayedCall(0,t)}return this!==t?Kt(this,t,e):this},n.getChildren=function(t,e,n,i){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===i&&(i=-z);for(var r=[],s=this._first;s;)s._start>=i&&(s instanceof an?e&&r.push(s):(n&&r.push(s),t&&r.push.apply(r,s.getChildren(!0,e,n)))),s=s._next;return r},n.getById=function(t){for(var e=this.getChildren(1,1,1),n=e.length;n--;)if(e[n].vars.id===t)return e[n]},n.remove=function(t){return j(t)?this.removeLabel(t):W(t)?this.killTweensOf(t):(Bt(this,t),t===this._recent&&(this._recent=this._last),Vt(this))},n.totalTime=function(e,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Tt(Ie.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),t.prototype.totalTime.call(this,e,n),this._forcing=0,this):this._tTime},n.addLabel=function(t,e){return this.labels[t]=re(this,e),this},n.removeLabel=function(t){return delete this.labels[t],this},n.addPause=function(t,e,n){var i=an.delayedCall(0,e||dt,n);return i.data="isPause",this._hasPause=1,Kt(this,i,re(this,t))},n.removePause=function(t){var e=this._first;for(t=re(this,t);e;)e._start===t&&"isPause"===e.data&&Ut(e),e=e._next},n.killTweensOf=function(t,e,n){for(var i=this.getTweensOf(t,n),r=i.length;r--;)Ke!==i[r]&&i[r].kill(t,e);return this},n.getTweensOf=function(t,e){for(var n,i=[],r=de(t),s=this._first,o=G(e);s;)s instanceof an?At(s._targets,r)&&(o?(!Ke||s._initted&&s._ts)&&s.globalTime(0)<=e&&s.globalTime(s.totalDuration())>e:!e||s.isActive())&&i.push(s):(n=s.getTweensOf(r,e)).length&&i.push.apply(i,n),s=s._next;return i},n.tweenTo=function(t,e){e=e||{};var n,i=this,r=re(i,t),s=e,o=s.startAt,a=s.onStart,l=s.onStartParams,c=s.immediateRender,u=an.to(i,Rt({ease:e.ease||"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:e.duration||Math.abs((r-(o&&"time"in o?o.time:i._time))/i.timeScale())||O,onStart:function(){if(i.pause(),!n){var t=e.duration||Math.abs((r-(o&&"time"in o?o.time:i._time))/i.timeScale());u._dur!==t&&ee(u,t,0,1).render(u._time,!0,!0),n=1}a&&a.apply(u,l||[])}},e));return c?u.render(0):u},n.tweenFromTo=function(t,e,n){return this.tweenTo(e,Rt({startAt:{time:re(this,t)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(t){return void 0===t&&(t=this._time),be(this,re(this,t))},n.previousLabel=function(t){return void 0===t&&(t=this._time),be(this,re(this,t),1)},n.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+O)},n.shiftChildren=function(t,e,n){void 0===n&&(n=0);for(var i,r=this._first,s=this.labels;r;)r._start>=n&&(r._start+=t,r._end+=t),r=r._next;if(e)for(i in s)s[i]>=n&&(s[i]+=t);return Vt(this)},n.invalidate=function(){var e=this._first;for(this._lock=0;e;)e.invalidate(),e=e._next;return t.prototype.invalidate.call(this)},n.clear=function(t){void 0===t&&(t=!0);for(var e,n=this._first;n;)e=n._next,this.remove(n),n=e;return this._dp&&(this._time=this._tTime=this._pTime=0),t&&(this.labels={}),Vt(this)},n.totalDuration=function(t){var e,n,i,r=0,s=this,a=s._last,l=z;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-t:t));if(s._dirty){for(i=s.parent;a;)e=a._prev,a._dirty&&a.totalDuration(),(n=a._start)>l&&s._sort&&a._ts&&!s._lock?(s._lock=1,Kt(s,a,n-a._delay,1)._lock=0):l=n,n<0&&a._ts&&(r-=n,(!i&&!s._dp||i&&i.smoothChildTiming)&&(s._start+=n/s._ts,s._time-=n,s._tTime-=n),s.shiftChildren(-n,!1,-Infinity),l=0),a._end>r&&a._ts&&(r=a._end),a=e;ee(s,s===o&&s._time>r?s._time:r,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(t){if(o._ts&&(Lt(o,qt(t,o)),h=Ie.frame),Ie.frame>=xt){xt+=R.autoSleep||120;var e=o._first;if((!e||!e._ts)&&R.autoSleep&&Ie._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||Ie.sleep()}}},e}(Ze);Rt(Ye.prototype,{_lock:0,_hasPause:0,_forcing:0});var Ke,Je,$e=function(t,e,n,i,r,s,o){var a,l,c,u,h,d,p,f,m=new bn(this._pt,t,e,0,1,mn,null,r),v=0,g=0;for(m.b=n,m.e=i,n+="",(p=~(i+="").indexOf("random("))&&(i=ye(i)),s&&(s(f=[n,i],t,e),n=f[0],i=f[1]),l=n.match(nt)||[];a=nt.exec(i);)u=a[0],h=i.substring(v,a.index),c?c=(c+1)%5:"rgba("===h.substr(-5)&&(c=1),u!==l[g++]&&(d=parseFloat(l[g-1])||0,m._pt={_next:m._pt,p:h||1===g?h:",",s:d,c:"="===u.charAt(1)?Pt(d,u)-d:parseFloat(u)-d,m:c&&c<4?Math.round:0},v=nt.lastIndex);return m.c=v<i.length?i.substring(v,i.length):"",m.fp=o,(it.test(i)||p)&&(m.e=0),this._pt=m,m},Qe=function(t,e,n,i,r,s,o,a,l){W(i)&&(i=i(r||0,t,s));var c,u=t[e],h="get"!==n?n:W(u)?l?t[e.indexOf("set")||!W(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():u,d=W(u)?l?un:cn:ln;if(j(i)&&(~i.indexOf("random(")&&(i=ye(i)),"="===i.charAt(1)&&((c=Pt(h,i)+(le(h)||0))||0===c)&&(i=c)),h!==i||Je)return isNaN(h*i)||""===i?(!u&&!(e in t)&&ct(e,i),$e.call(this,t,e,h,i,d,a||R.stringFilter,l)):(c=new bn(this._pt,t,e,+h||0,i-(h||0),"boolean"==typeof u?fn:pn,0,d),l&&(c.fp=l),o&&c.modifier(o,this,t),this._pt=c)},tn=function(t,e,n,i,r,s){var o,a,l,c;if(vt[t]&&!1!==(o=new vt[t]).init(r,o.rawVars?e[t]:function(t,e,n,i,r){if(W(t)&&(t=rn(t,r,e,n,i)),!X(t)||t.style&&t.nodeType||$(t)||J(t))return j(t)?rn(t,r,e,n,i):t;var s,o={};for(s in t)o[s]=rn(t[s],r,e,n,i);return o}(e[t],i,r,s,n),n,i,s)&&(n._pt=a=new bn(n._pt,r,t,0,1,o.render,o,0,o.priority),n!==d))for(l=n._ptLookup[n._targets.indexOf(r)],c=o._props.length;c--;)l[o._props[c]]=a;return o},en=function t(e,n){var i,r,a,l,c,u,h,d,p,f,m,v,g,x=e.vars,y=x.ease,_=x.startAt,b=x.immediateRender,w=x.lazy,M=x.onUpdate,S=x.onUpdateParams,C=x.callbackScope,T=x.runBackwards,P=x.yoyoEase,A=x.keyframes,E=x.autoRevert,L=e._dur,D=e._startAt,k=e._targets,R=e.parent,N=R&&"nested"===R.data?R.parent._targets:k,F="auto"===e._overwrite&&!s,B=e.timeline;if(B&&(!A||!y)&&(y="none"),e._ease=He(y,I.ease),e._yEase=P?Ue(He(!0===P?y:P,I.ease)):0,P&&e._yoyo&&!e._repeat&&(P=e._yEase,e._yEase=e._ease,e._ease=P),e._from=!B&&!!x.runBackwards,!B||A&&!x.stagger){if(v=(d=k[0]?wt(k[0]).harness:0)&&x[d.prop],i=Ot(x,pt),D&&(Ut(D.render(-1,!0)),D._lazy=0),_)if(Ut(e._startAt=an.set(k,Rt({data:"isStart",overwrite:!1,parent:R,immediateRender:!0,lazy:Z(w),startAt:null,delay:0,onUpdate:M,onUpdateParams:S,callbackScope:C,stagger:0},_))),n<0&&!b&&!E&&e._startAt.render(-1,!0),b){if(n>0&&!E&&(e._startAt=0),L&&n<=0)return void(n&&(e._zTime=n))}else!1===E&&(e._startAt=0);else if(T&&L)if(D)!E&&(e._startAt=0);else if(n&&(b=!1),a=Rt({overwrite:!1,data:"isFromStart",lazy:b&&Z(w),immediateRender:b,stagger:0,parent:R},i),v&&(a[d.prop]=v),Ut(e._startAt=an.set(k,a)),n<0&&e._startAt.render(-1,!0),e._zTime=n,b){if(!n)return}else t(e._startAt,O);for(e._pt=e._ptCache=0,w=L&&Z(w)||w&&!L,r=0;r<k.length;r++){if(h=(c=k[r])._gsap||bt(k)[r]._gsap,e._ptLookup[r]=f={},mt[h.id]&&ft.length&&Et(),m=N===k?r:N.indexOf(c),d&&!1!==(p=new d).init(c,v||i,e,m,N)&&(e._pt=l=new bn(e._pt,c,p.name,0,1,p.render,p,0,p.priority),p._props.forEach((function(t){f[t]=l})),p.priority&&(u=1)),!d||v)for(a in i)vt[a]&&(p=tn(a,i,e,m,c,N))?p.priority&&(u=1):f[a]=l=Qe.call(e,c,a,"get",i[a],m,N,0,x.stringFilter);e._op&&e._op[r]&&e.kill(c,e._op[r]),F&&e._pt&&(Ke=e,o.killTweensOf(c,f,e.globalTime(n)),g=!e.parent,Ke=0),e._pt&&w&&(mt[h.id]=1)}u&&_n(e),e._onInit&&e._onInit(e)}e._onUpdate=M,e._initted=(!e._op||e._pt)&&!g,A&&n<=0&&B.render(z,!0,!0)},nn=function(t,e,n,i){var r,s,o=e.ease||i||"power1.inOut";if($(e))s=n[t]||(n[t]=[]),e.forEach((function(t,n){return s.push({t:n/(e.length-1)*100,v:t,e:o})}));else for(r in e)s=n[r]||(n[r]=[]),"ease"===r||s.push({t:parseFloat(t),v:e[r],e:o})},rn=function(t,e,n,i,r){return W(t)?t.call(e,n,i,r):j(t)&&~t.indexOf("random(")?ye(t):t},sn=_t+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",on={};St(sn+",id,stagger,delay,duration,paused,scrollTrigger",(function(t){return on[t]=1}));var an=function(t){function e(e,n,r,a){var l;"number"==typeof n&&(r.duration=n,n=r,r=null);var c,u,h,d,p,f,m,v,g=(l=t.call(this,a?n:Nt(n))||this).vars,x=g.duration,y=g.delay,_=g.immediateRender,b=g.stagger,w=g.overwrite,M=g.keyframes,S=g.defaults,C=g.scrollTrigger,T=g.yoyoEase,P=n.parent||o,A=($(e)||J(e)?G(e[0]):"length"in n)?[e]:de(e);if(l._targets=A.length?bt(A):ut(0,!R.nullTargetWarn)||[],l._ptLookup=[],l._overwrite=w,M||b||K(x)||K(y)){if(n=l.vars,(c=l.timeline=new Ye({data:"nested",defaults:S||{}})).kill(),c.parent=c._dp=i(l),c._start=0,b||K(x)||K(y)){if(d=A.length,m=b&&fe(b),X(b))for(p in b)~sn.indexOf(p)&&(v||(v={}),v[p]=b[p]);for(u=0;u<d;u++)(h=Ot(n,on)).stagger=0,T&&(h.yoyoEase=T),v&&It(h,v),f=A[u],h.duration=+rn(x,i(l),u,f,A),h.delay=(+rn(y,i(l),u,f,A)||0)-l._delay,!b&&1===d&&h.delay&&(l._delay=y=h.delay,l._start+=y,h.delay=0),c.to(f,h,m?m(u,f,A):0),c._ease=Oe.none;c.duration()?x=y=0:l.timeline=0}else if(M){Nt(Rt(c.vars.defaults,{ease:"none"})),c._ease=He(M.ease||n.ease||"none");var E,L,D,k=0;if($(M))M.forEach((function(t){return c.to(A,t,">")}));else{for(p in h={},M)"ease"===p||"easeEach"===p||nn(p,M[p],h,M.easeEach);for(p in h)for(E=h[p].sort((function(t,e){return t.t-e.t})),k=0,u=0;u<E.length;u++)(D={ease:(L=E[u]).e,duration:(L.t-(u?E[u-1].t:0))/100*x})[p]=L.v,c.to(A,D,k),k+=D.duration;c.duration()<x&&c.to({},{duration:x-c.duration()})}}x||l.duration(x=c.duration())}else l.timeline=0;return!0!==w||s||(Ke=i(l),o.killTweensOf(A),Ke=0),Kt(P,i(l),r),n.reversed&&l.reverse(),n.paused&&l.paused(!0),(_||!x&&!M&&l._start===Tt(P._time)&&Z(_)&&jt(i(l))&&"nested"!==P.data)&&(l._tTime=-1e-8,l.render(Math.max(0,-y))),C&&Jt(i(l),C),l}r(e,t);var n=e.prototype;return n.render=function(t,e,n){var i,r,s,o,a,l,c,u,h,d=this._time,p=this._tDur,f=this._dur,m=t>p-O&&t>=0?p:t<O?0:t;if(f){if(m!==this._tTime||!t||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=t<0){if(i=m,u=this.timeline,this._repeat){if(o=f+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*o+t,e,n);if(i=Tt(m%o),m===p?(s=this._repeat,i=f):((s=~~(m/o))&&s===m/o&&(i=f,s--),i>f&&(i=f)),(l=this._yoyo&&1&s)&&(h=this._yEase,i=f-i),a=Gt(this._tTime,o),i===d&&!n&&this._initted)return this._tTime=m,this;s!==a&&(u&&this._yEase&&Ve(u,l),!this.vars.repeatRefresh||l||this._lock||(this._lock=n=1,this.render(Tt(o*s),!0).invalidate()._lock=0))}if(!this._initted){if($t(this,t<0?t:i,n,e))return this._tTime=0,this;if(d!==this._time)return this;if(f!==this._dur)return this.render(t,e,n)}if(this._tTime=m,this._time=i,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=c=(h||this._ease)(i/f),this._from&&(this.ratio=c=1-c),i&&!d&&!e&&(we(this,"onStart"),this._tTime!==m))return this;for(r=this._pt;r;)r.r(c,r.d),r=r._next;u&&u.render(t<0?t:!i&&l?-1e-8:u._dur*u._ease(i/this._dur),e,n)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(t<0&&this._startAt&&this._startAt.render(t,!0,n),we(this,"onUpdate")),this._repeat&&s!==a&&this.vars.onRepeat&&!e&&this.parent&&we(this,"onRepeat"),m!==this._tDur&&m||this._tTime!==m||(t<0&&this._startAt&&!this._onUpdate&&this._startAt.render(t,!0,!0),(t||!f)&&(m===this._tDur&&this._ts>0||!m&&this._ts<0)&&Ut(this,1),e||t<0&&!d||!m&&!d||(we(this,m===p?"onComplete":"onReverseComplete",!0),this._prom&&!(m<p&&this.timeScale()>0)&&this._prom()))}}else!function(t,e,n,i){var r,s,o,a=t.ratio,l=e<0||!e&&(!t._start&&Qt(t)&&(t._initted||!te(t))||(t._ts<0||t._dp._ts<0)&&!te(t))?0:1,c=t._rDelay,u=0;if(c&&t._repeat&&(u=ae(0,t._tDur,e),s=Gt(u,c),t._yoyo&&1&s&&(l=1-l),s!==Gt(t._tTime,c)&&(a=1-l,t.vars.repeatRefresh&&t._initted&&t.invalidate())),l!==a||i||t._zTime===O||!e&&t._zTime){if(!t._initted&&$t(t,e,i,n))return;for(o=t._zTime,t._zTime=e||(n?O:0),n||(n=e&&!o),t.ratio=l,t._from&&(l=1-l),t._time=0,t._tTime=u,r=t._pt;r;)r.r(l,r.d),r=r._next;t._startAt&&e<0&&t._startAt.render(e,!0,!0),t._onUpdate&&!n&&we(t,"onUpdate"),u&&t._repeat&&!n&&t.parent&&we(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===l&&(l&&Ut(t,1),n||(we(t,l?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,n);return this},n.targets=function(){return this._targets},n.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),t.prototype.invalidate.call(this)},n.resetTo=function(t,e,n,i){p||Ie.wake(),this._ts||this.play();var r=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||en(this,r),function(t,e,n,i,r,s,o){var a,l,c,u=(t._pt&&t._ptCache||(t._ptCache={}))[e];if(!u)for(u=t._ptCache[e]=[],l=t._ptLookup,c=t._targets.length;c--;){if((a=l[c][e])&&a.d&&a.d._pt)for(a=a.d._pt;a&&a.p!==e;)a=a._next;if(!a)return Je=1,t.vars[e]="+=0",en(t,o),Je=0,1;u.push(a)}for(c=u.length;c--;)(a=u[c]).s=!i&&0!==i||r?a.s+(i||0)+s*a.c:i,a.c=n-a.s,a.e&&(a.e=Ct(n)+le(a.e)),a.b&&(a.b=a.s+le(a.b))}(this,t,e,n,i,this._ease(r/this._dur),r)?this.resetTo(t,e,n,i):(Zt(this,0),this.parent||Ft(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},n.kill=function(t,e){if(void 0===e&&(e="all"),!(t||e&&"all"!==e))return this._lazy=this._pt=0,this.parent?Me(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,Ke&&!0!==Ke.vars.overwrite)._first||Me(this),this.parent&&n!==this.timeline.totalDuration()&&ee(this,this._dur*this.timeline._tDur/n,0,1),this}var i,r,s,o,a,l,c,u=this._targets,h=t?de(t):u,d=this._ptLookup,p=this._pt;if((!e||"all"===e)&&function(t,e){for(var n=t.length,i=n===e.length;i&&n--&&t[n]===e[n];);return n<0}(u,h))return"all"===e&&(this._pt=0),Me(this);for(i=this._op=this._op||[],"all"!==e&&(j(e)&&(a={},St(e,(function(t){return a[t]=1})),e=a),e=function(t,e){var n,i,r,s,o=t[0]?wt(t[0]).harness:0,a=o&&o.aliases;if(!a)return e;for(i in n=It({},e),a)if(i in n)for(r=(s=a[i].split(",")).length;r--;)n[s[r]]=n[i];return n}(u,e)),c=u.length;c--;)if(~h.indexOf(u[c]))for(a in r=d[c],"all"===e?(i[c]=e,o=r,s={}):(s=i[c]=i[c]||{},o=e),o)(l=r&&r[a])&&("kill"in l.d&&!0!==l.d.kill(a)||Bt(this,l,"_pt"),delete r[a]),"all"!==s&&(s[a]=1);return this._initted&&!this._pt&&p&&Me(this),this},e.to=function(t,n){return new e(t,n,arguments[2])},e.from=function(t,e){return se(1,arguments)},e.delayedCall=function(t,n,i,r){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:n,onReverseComplete:n,onCompleteParams:i,onReverseCompleteParams:i,callbackScope:r})},e.fromTo=function(t,e,n){return se(2,arguments)},e.set=function(t,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(t,n)},e.killTweensOf=function(t,e,n){return o.killTweensOf(t,e,n)},e}(Ze);Rt(an.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),St("staggerTo,staggerFrom,staggerFromTo",(function(t){an[t]=function(){var e=new Ye,n=ce.call(arguments,0);return n.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,n)}}));var ln=function(t,e,n){return t[e]=n},cn=function(t,e,n){return t[e](n)},un=function(t,e,n,i){return t[e](i.fp,n)},hn=function(t,e,n){return t.setAttribute(e,n)},dn=function(t,e){return W(t[e])?cn:q(t[e])&&t.setAttribute?hn:ln},pn=function(t,e){return e.set(e.t,e.p,Math.round(1e6*(e.s+e.c*t))/1e6,e)},fn=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},mn=function(t,e){var n=e._pt,i="";if(!t&&e.b)i=e.b;else if(1===t&&e.e)i=e.e;else{for(;n;)i=n.p+(n.m?n.m(n.s+n.c*t):Math.round(1e4*(n.s+n.c*t))/1e4)+i,n=n._next;i+=e.c}e.set(e.t,e.p,i,e)},vn=function(t,e){for(var n=e._pt;n;)n.r(t,n.d),n=n._next},gn=function(t,e,n,i){for(var r,s=this._pt;s;)r=s._next,s.p===i&&s.modifier(t,e,n),s=r},xn=function(t){for(var e,n,i=this._pt;i;)n=i._next,i.p===t&&!i.op||i.op===t?Bt(this,i,"_pt"):i.dep||(e=1),i=n;return!e},yn=function(t,e,n,i){i.mSet(t,e,i.m.call(i.tween,n,i.mt),i)},_n=function(t){for(var e,n,i,r,s=t._pt;s;){for(e=s._next,n=i;n&&n.pr>s.pr;)n=n._next;(s._prev=n?n._prev:r)?s._prev._next=s:i=s,(s._next=n)?n._prev=s:r=s,s=e}t._pt=i},bn=function(){function t(t,e,n,i,r,s,o,a,l){this.t=e,this.s=i,this.c=r,this.p=n,this.r=s||pn,this.d=o||this,this.set=a||ln,this.pr=l||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,e,n){this.mSet=this.mSet||this.set,this.set=yn,this.m=t,this.mt=n,this.tween=e},t}();St(_t+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(t){return pt[t]=1})),ot.TweenMax=ot.TweenLite=an,ot.TimelineLite=ot.TimelineMax=Ye,o=new Ye({sortChildren:!1,defaults:I,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),R.stringFilter=Re;var wn={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach((function(t){return Se(t)}))},timeline:function(t){return new Ye(t)},getTweensOf:function(t,e){return o.getTweensOf(t,e)},getProperty:function(t,e,n,i){j(t)&&(t=de(t)[0]);var r=wt(t||{}).get,s=n?kt:Dt;return"native"===n&&(n=""),t?e?s((vt[e]&&vt[e].get||r)(t,e,n,i)):function(e,n,i){return s((vt[e]&&vt[e].get||r)(t,e,n,i))}:t},quickSetter:function(t,e,n){if((t=de(t)).length>1){var i=t.map((function(t){return Cn.quickSetter(t,e,n)})),r=i.length;return function(t){for(var e=r;e--;)i[e](t)}}t=t[0]||{};var s=vt[e],o=wt(t),a=o.harness&&(o.harness.aliases||{})[e]||e,l=s?function(e){var i=new s;d._pt=0,i.init(t,n?e+n:e,d,0,[t]),i.render(1,i),d._pt&&vn(1,d)}:o.set(t,a);return s?l:function(e){return l(t,a,n?e+n:e,o,1)}},quickTo:function(t,e,n){var i,r=Cn.to(t,It(((i={})[e]="+=0.1",i.paused=!0,i),n||{})),s=function(t,n,i){return r.resetTo(e,t,n,i)};return s.tween=r,s},isTweening:function(t){return o.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=He(t.ease,I.ease)),zt(I,t||{})},config:function(t){return zt(R,t||{})},registerEffect:function(t){var e=t.name,n=t.effect,i=t.plugins,r=t.defaults,s=t.extendTimeline;(i||"").split(",").forEach((function(t){return t&&!vt[t]&&!ot[t]&&ut()})),gt[e]=function(t,e,i){return n(de(t),Rt(e||{},r),i)},s&&(Ye.prototype[e]=function(t,n,i){return this.add(gt[e](t,X(n)?n:(i=n)&&{},this),i)})},registerEase:function(t,e){Oe[t]=He(e)},parseEase:function(t,e){return arguments.length?He(t,e):Oe},getById:function(t){return o.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var n,i,r=new Ye(t);for(r.smoothChildTiming=Z(t.smoothChildTiming),o.remove(r),r._dp=0,r._time=r._tTime=o._time,n=o._first;n;)i=n._next,!e&&!n._dur&&n instanceof an&&n.vars.onComplete===n._targets[0]||Kt(r,n,n._start-n._delay),n=i;return Kt(o,r,0),r},utils:{wrap:function t(e,n,i){var r=n-e;return $(e)?xe(e,t(0,e.length),n):oe(i,(function(t){return(r+(t-e)%r)%r+e}))},wrapYoyo:function t(e,n,i){var r=n-e,s=2*r;return $(e)?xe(e,t(0,e.length-1),n):oe(i,(function(t){return e+((t=(s+(t-e)%s)%s||0)>r?s-t:t)}))},distribute:fe,random:ge,snap:ve,normalize:function(t,e,n){return _e(t,e,0,1,n)},getUnit:le,clamp:function(t,e,n){return oe(n,(function(n){return ae(t,e,n)}))},splitColor:Ae,toArray:de,selector:function(t){return t=de(t)[0]||ut()||{},function(e){var n=t.current||t.nativeElement||t;return de(e,n.querySelectorAll?n:n===t?ut()||c.createElement("div"):t)}},mapRange:_e,pipe:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduce((function(t,e){return e(t)}),t)}},unitize:function(t,e){return function(n){return t(parseFloat(n))+(e||le(n))}},interpolate:function t(e,n,i,r){var s=isNaN(e+n)?0:function(t){return(1-t)*e+t*n};if(!s){var o,a,l,c,u,h=j(e),d={};if(!0===i&&(r=1)&&(i=null),h)e={p:e},n={p:n};else if($(e)&&!$(n)){for(l=[],c=e.length,u=c-2,a=1;a<c;a++)l.push(t(e[a-1],e[a]));c--,s=function(t){t*=c;var e=Math.min(u,~~t);return l[e](t-e)},i=n}else r||(e=It($(e)?[]:{},e));if(!l){for(o in n)Qe.call(d,e,o,"get",n[o]);s=function(t){return vn(t,d)||(h?e.p:e)}}}return oe(i,s)},shuffle:pe},install:lt,effects:gt,ticker:Ie,updateRoot:Ye.updateRoot,plugins:vt,globalTimeline:o,core:{PropTween:bn,globals:ht,Tween:an,Timeline:Ye,Animation:Ze,getCache:wt,_removeLinkedListItem:Bt,suppressOverwrites:function(t){return s=t}}};St("to,from,fromTo,delayedCall,set,killTweensOf",(function(t){return wn[t]=an[t]})),Ie.add(Ye.updateRoot),d=wn.to({},{duration:0});var Mn=function(t,e){for(var n=t._pt;n&&n.p!==e&&n.op!==e&&n.fp!==e;)n=n._next;return n},Sn=function(t,e){return{name:t,rawVars:1,init:function(t,n,i){i._onInit=function(t){var i,r;if(j(n)&&(i={},St(n,(function(t){return i[t]=1})),n=i),e){for(r in i={},n)i[r]=e(n[r]);n=i}!function(t,e){var n,i,r,s=t._targets;for(n in e)for(i=s.length;i--;)(r=t._ptLookup[i][n])&&(r=r.d)&&(r._pt&&(r=Mn(r,n)),r&&r.modifier&&r.modifier(e[n],t,s[i],n))}(t,n)}}}},Cn=wn.registerPlugin({name:"attr",init:function(t,e,n,i,r){var s,o;for(s in e)(o=this.add(t,"setAttribute",(t.getAttribute(s)||0)+"",e[s],i,r,0,0,s))&&(o.op=s),this._props.push(s)}},{name:"endArray",init:function(t,e){for(var n=e.length;n--;)this.add(t,n,t[n]||0,e[n])}},Sn("roundProps",me),Sn("modifiers"),Sn("snap",ve))||wn;an.version=Ye.version=Cn.version="3.10.3",u=1,Y()&&ze();Oe.Power0;var Tn=Oe.Power1,Pn=Oe.Power2,An=(Oe.Power3,Oe.Power4,Oe.Linear,Oe.Quad,Oe.Cubic,Oe.Quart,Oe.Quint,Oe.Strong,Oe.Elastic,Oe.Back),En=(Oe.SteppedEase,Oe.Bounce,Oe.Sine),Ln=Oe.Expo;Oe.Circ},755:function(t,e){var n;!function(e,n){"use strict";"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:this,(function(i,r){"use strict";var s=[],o=Object.getPrototypeOf,a=s.slice,l=s.flat?function(t){return s.flat.call(t)}:function(t){return s.concat.apply([],t)},c=s.push,u=s.indexOf,h={},d=h.toString,p=h.hasOwnProperty,f=p.toString,m=f.call(Object),v={},g=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},x=function(t){return null!=t&&t===t.window},y=i.document,_={type:!0,src:!0,nonce:!0,noModule:!0};function b(t,e,n){var i,r,s=(n=n||y).createElement("script");if(s.text=t,e)for(i in _)(r=e[i]||e.getAttribute&&e.getAttribute(i))&&s.setAttribute(i,r);n.head.appendChild(s).parentNode.removeChild(s)}function w(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?h[d.call(t)]||"object":typeof t}var M="3.5.1",S=function(t,e){return new S.fn.init(t,e)};function C(t){var e=!!t&&"length"in t&&t.length,n=w(t);return!g(t)&&!x(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}S.fn=S.prototype={jquery:M,constructor:S,length:0,toArray:function(){return a.call(this)},get:function(t){return null==t?a.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=S.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return S.each(this,t)},map:function(t){return this.pushStack(S.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(S.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:s.sort,splice:s.splice},S.extend=S.fn.extend=function(){var t,e,n,i,r,s,o=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[a]||{},a++),"object"==typeof o||g(o)||(o={}),a===l&&(o=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)i=t[e],"__proto__"!==e&&o!==i&&(c&&i&&(S.isPlainObject(i)||(r=Array.isArray(i)))?(n=o[e],s=r&&!Array.isArray(n)?[]:r||S.isPlainObject(n)?n:{},r=!1,o[e]=S.extend(c,s,i)):void 0!==i&&(o[e]=i));return o},S.extend({expando:"jQuery"+(M+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==d.call(t))&&(!(e=o(t))||"function"==typeof(n=p.call(e,"constructor")&&e.constructor)&&f.call(n)===m)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,n){b(t,{nonce:e&&e.nonce},n)},each:function(t,e){var n,i=0;if(C(t))for(n=t.length;i<n&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},makeArray:function(t,e){var n=e||[];return null!=t&&(C(Object(t))?S.merge(n,"string"==typeof t?[t]:t):c.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:u.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;i<n;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i=[],r=0,s=t.length,o=!n;r<s;r++)!e(t[r],r)!==o&&i.push(t[r]);return i},map:function(t,e,n){var i,r,s=0,o=[];if(C(t))for(i=t.length;s<i;s++)null!=(r=e(t[s],s,n))&&o.push(r);else for(s in t)null!=(r=e(t[s],s,n))&&o.push(r);return l(o)},guid:1,support:v}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=s[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){h["[object "+e+"]"]=e.toLowerCase()}));var T=function(t){var e,n,i,r,s,o,a,l,c,u,h,d,p,f,m,v,g,x,y,_="sizzle"+1*new Date,b=t.document,w=0,M=0,S=lt(),C=lt(),T=lt(),P=lt(),A=function(t,e){return t===e&&(h=!0),0},E={}.hasOwnProperty,L=[],D=L.pop,k=L.push,R=L.push,I=L.slice,z=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},O="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="[\\x20\\t\\r\\n\\f]",F="(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",B="\\[[\\x20\\t\\r\\n\\f]*("+F+")(?:"+N+"*([*^$|!~]?=)"+N+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+N+"*\\]",U=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+B+")*)|.*)\\)|)",V=new RegExp(N+"+","g"),H=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),j=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),W=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),G=new RegExp(N+"|>"),q=new RegExp(U),X=new RegExp("^"+F+"$"),Z={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F+"|[*])"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+U),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+O+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,K=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])","g"),nt=function(t,e){var n="0x"+t.slice(1)-65536;return e||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},it=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,rt=function(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},st=function(){d()},ot=_t((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{R.apply(L=I.call(b.childNodes),b.childNodes),L[b.childNodes.length].nodeType}catch(t){R={apply:L.length?function(t,e){k.apply(t,I.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}function at(t,e,i,r){var s,a,c,u,h,f,g,x=e&&e.ownerDocument,b=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==b&&9!==b&&11!==b)return i;if(!r&&(d(e),e=e||p,m)){if(11!==b&&(h=Q.exec(t)))if(s=h[1]){if(9===b){if(!(c=e.getElementById(s)))return i;if(c.id===s)return i.push(c),i}else if(x&&(c=x.getElementById(s))&&y(e,c)&&c.id===s)return i.push(c),i}else{if(h[2])return R.apply(i,e.getElementsByTagName(t)),i;if((s=h[3])&&n.getElementsByClassName&&e.getElementsByClassName)return R.apply(i,e.getElementsByClassName(s)),i}if(n.qsa&&!P[t+" "]&&(!v||!v.test(t))&&(1!==b||"object"!==e.nodeName.toLowerCase())){if(g=t,x=e,1===b&&(G.test(t)||W.test(t))){for((x=tt.test(t)&&gt(e.parentNode)||e)===e&&n.scope||((u=e.getAttribute("id"))?u=u.replace(it,rt):e.setAttribute("id",u=_)),a=(f=o(t)).length;a--;)f[a]=(u?"#"+u:":scope")+" "+yt(f[a]);g=f.join(",")}try{return R.apply(i,x.querySelectorAll(g)),i}catch(e){P(t,!0)}finally{u===_&&e.removeAttribute("id")}}}return l(t.replace(H,"$1"),e,i,r)}function lt(){var t=[];return function e(n,r){return t.push(n+" ")>i.cacheLength&&delete e[t.shift()],e[n+" "]=r}}function ct(t){return t[_]=!0,t}function ut(t){var e=p.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var n=t.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=e}function dt(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function pt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ft(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function mt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ot(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function vt(t){return ct((function(e){return e=+e,ct((function(n,i){for(var r,s=t([],n.length,e),o=s.length;o--;)n[r=s[o]]&&(n[r]=!(i[r]=n[r]))}))}))}function gt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=at.support={},s=at.isXML=function(t){var e=t.namespaceURI,n=(t.ownerDocument||t).documentElement;return!Y.test(e||n&&n.nodeName||"HTML")},d=at.setDocument=function(t){var e,r,o=t?t.ownerDocument||t:b;return o!=p&&9===o.nodeType&&o.documentElement?(f=(p=o).documentElement,m=!s(p),b!=p&&(r=p.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",st,!1):r.attachEvent&&r.attachEvent("onunload",st)),n.scope=ut((function(t){return f.appendChild(t).appendChild(p.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length})),n.attributes=ut((function(t){return t.className="i",!t.getAttribute("className")})),n.getElementsByTagName=ut((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),n.getElementsByClassName=$.test(p.getElementsByClassName),n.getById=ut((function(t){return f.appendChild(t).id=_,!p.getElementsByName||!p.getElementsByName(_).length})),n.getById?(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){return t.getAttribute("id")===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var n=e.getElementById(t);return n?[n]:[]}}):(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var n,i,r,s=e.getElementById(t);if(s){if((n=s.getAttributeNode("id"))&&n.value===t)return[s];for(r=e.getElementsByName(t),i=0;s=r[i++];)if((n=s.getAttributeNode("id"))&&n.value===t)return[s]}return[]}}),i.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,s=e.getElementsByTagName(t);if("*"===t){for(;n=s[r++];)1===n.nodeType&&i.push(n);return i}return s},i.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&m)return e.getElementsByClassName(t)},g=[],v=[],(n.qsa=$.test(p.querySelectorAll))&&(ut((function(t){var e;f.appendChild(t).innerHTML="<a id='"+_+"'></a><select id='"+_+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll("[selected]").length||v.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+O+")"),t.querySelectorAll("[id~="+_+"-]").length||v.push("~="),(e=p.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||v.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll(":checked").length||v.push(":checked"),t.querySelectorAll("a#"+_+"+*").length||v.push(".#.+[+~]"),t.querySelectorAll("\\\f"),v.push("[\\r\\n\\f]")})),ut((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&v.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),f.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),v.push(",.*:")}))),(n.matchesSelector=$.test(x=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ut((function(t){n.disconnectedMatch=x.call(t,"*"),x.call(t,"[s!='']:x"),g.push("!=",U)})),v=v.length&&new RegExp(v.join("|")),g=g.length&&new RegExp(g.join("|")),e=$.test(f.compareDocumentPosition),y=e||$.test(f.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},A=e?function(t,e){if(t===e)return h=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===i?t==p||t.ownerDocument==b&&y(b,t)?-1:e==p||e.ownerDocument==b&&y(b,e)?1:u?z(u,t)-z(u,e):0:4&i?-1:1)}:function(t,e){if(t===e)return h=!0,0;var n,i=0,r=t.parentNode,s=e.parentNode,o=[t],a=[e];if(!r||!s)return t==p?-1:e==p?1:r?-1:s?1:u?z(u,t)-z(u,e):0;if(r===s)return dt(t,e);for(n=t;n=n.parentNode;)o.unshift(n);for(n=e;n=n.parentNode;)a.unshift(n);for(;o[i]===a[i];)i++;return i?dt(o[i],a[i]):o[i]==b?-1:a[i]==b?1:0},p):p},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if(d(t),n.matchesSelector&&m&&!P[e+" "]&&(!g||!g.test(e))&&(!v||!v.test(e)))try{var i=x.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){P(e,!0)}return at(e,p,null,[t]).length>0},at.contains=function(t,e){return(t.ownerDocument||t)!=p&&d(t),y(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!=p&&d(t);var r=i.attrHandle[e.toLowerCase()],s=r&&E.call(i.attrHandle,e.toLowerCase())?r(t,e,!m):void 0;return void 0!==s?s:n.attributes||!m?t.getAttribute(e):(s=t.getAttributeNode(e))&&s.specified?s.value:null},at.escape=function(t){return(t+"").replace(it,rt)},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,i=[],r=0,s=0;if(h=!n.detectDuplicates,u=!n.sortStable&&t.slice(0),t.sort(A),h){for(;e=t[s++];)e===t[s]&&(r=i.push(s));for(;r--;)t.splice(i[r],1)}return u=null,t},r=at.getText=function(t){var e,n="",i=0,s=t.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=r(t)}else if(3===s||4===s)return t.nodeValue}else for(;e=t[i++];)n+=r(e);return n},(i=at.selectors={cacheLength:50,createPseudo:ct,match:Z,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,nt),t[3]=(t[3]||t[4]||t[5]||"").replace(et,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return Z.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&q.test(n)&&(e=o(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=S[t+" "];return e||(e=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+t+"("+N+"|$)"))&&S(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,n){return function(i){var r=at.attr(i,t);return null==r?"!="===e:!e||(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&r.indexOf(n)>-1:"$="===e?n&&r.slice(-n.length)===n:"~="===e?(" "+r.replace(V," ")+" ").indexOf(n)>-1:"|="===e&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,r){var s="nth"!==t.slice(0,3),o="last"!==t.slice(-4),a="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,l){var c,u,h,d,p,f,m=s!==o?"nextSibling":"previousSibling",v=e.parentNode,g=a&&e.nodeName.toLowerCase(),x=!l&&!a,y=!1;if(v){if(s){for(;m;){for(d=e;d=d[m];)if(a?d.nodeName.toLowerCase()===g:1===d.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[o?v.firstChild:v.lastChild],o&&x){for(y=(p=(c=(u=(h=(d=v)[_]||(d[_]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===w&&c[1])&&c[2],d=p&&v.childNodes[p];d=++p&&d&&d[m]||(y=p=0)||f.pop();)if(1===d.nodeType&&++y&&d===e){u[t]=[w,p,y];break}}else if(x&&(y=p=(c=(u=(h=(d=e)[_]||(d[_]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===w&&c[1]),!1===y)for(;(d=++p&&d&&d[m]||(y=p=0)||f.pop())&&((a?d.nodeName.toLowerCase()!==g:1!==d.nodeType)||!++y||(x&&((u=(h=d[_]||(d[_]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]=[w,y]),d!==e)););return(y-=r)===i||y%i==0&&y/i>=0}}},PSEUDO:function(t,e){var n,r=i.pseudos[t]||i.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return r[_]?r(e):r.length>1?(n=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?ct((function(t,n){for(var i,s=r(t,e),o=s.length;o--;)t[i=z(t,s[o])]=!(n[i]=s[o])})):function(t){return r(t,0,n)}):r}},pseudos:{not:ct((function(t){var e=[],n=[],i=a(t.replace(H,"$1"));return i[_]?ct((function(t,e,n,r){for(var s,o=i(t,null,r,[]),a=t.length;a--;)(s=o[a])&&(t[a]=!(e[a]=s))})):function(t,r,s){return e[0]=t,i(e,null,s,n),e[0]=null,!n.pop()}})),has:ct((function(t){return function(e){return at(t,e).length>0}})),contains:ct((function(t){return t=t.replace(et,nt),function(e){return(e.textContent||r(e)).indexOf(t)>-1}})),lang:ct((function(t){return X.test(t||"")||at.error("unsupported lang: "+t),t=t.replace(et,nt).toLowerCase(),function(e){var n;do{if(n=m?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:mt(!1),disabled:mt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return J.test(t.nodeName)},input:function(t){return K.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:vt((function(){return[0]})),last:vt((function(t,e){return[e-1]})),eq:vt((function(t,e,n){return[n<0?n+e:n]})),even:vt((function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t})),odd:vt((function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t})),lt:vt((function(t,e,n){for(var i=n<0?n+e:n>e?e:n;--i>=0;)t.push(i);return t})),gt:vt((function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t}))}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=pt(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=ft(e);function xt(){}function yt(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function _t(t,e,n){var i=e.dir,r=e.next,s=r||i,o=n&&"parentNode"===s,a=M++;return e.first?function(e,n,r){for(;e=e[i];)if(1===e.nodeType||o)return t(e,n,r);return!1}:function(e,n,l){var c,u,h,d=[w,a];if(l){for(;e=e[i];)if((1===e.nodeType||o)&&t(e,n,l))return!0}else for(;e=e[i];)if(1===e.nodeType||o)if(u=(h=e[_]||(e[_]={}))[e.uniqueID]||(h[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[i]||e;else{if((c=u[s])&&c[0]===w&&c[1]===a)return d[2]=c[2];if(u[s]=d,d[2]=t(e,n,l))return!0}return!1}}function bt(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function wt(t,e,n,i,r){for(var s,o=[],a=0,l=t.length,c=null!=e;a<l;a++)(s=t[a])&&(n&&!n(s,i,r)||(o.push(s),c&&e.push(a)));return o}function Mt(t,e,n,i,r,s){return i&&!i[_]&&(i=Mt(i)),r&&!r[_]&&(r=Mt(r,s)),ct((function(s,o,a,l){var c,u,h,d=[],p=[],f=o.length,m=s||function(t,e,n){for(var i=0,r=e.length;i<r;i++)at(t,e[i],n);return n}(e||"*",a.nodeType?[a]:a,[]),v=!t||!s&&e?m:wt(m,d,t,a,l),g=n?r||(s?t:f||i)?[]:o:v;if(n&&n(v,g,a,l),i)for(c=wt(g,p),i(c,[],a,l),u=c.length;u--;)(h=c[u])&&(g[p[u]]=!(v[p[u]]=h));if(s){if(r||t){if(r){for(c=[],u=g.length;u--;)(h=g[u])&&c.push(v[u]=h);r(null,g=[],c,l)}for(u=g.length;u--;)(h=g[u])&&(c=r?z(s,h):d[u])>-1&&(s[c]=!(o[c]=h))}}else g=wt(g===o?g.splice(f,g.length):g),r?r(null,o,g,l):R.apply(o,g)}))}function St(t){for(var e,n,r,s=t.length,o=i.relative[t[0].type],a=o||i.relative[" "],l=o?1:0,u=_t((function(t){return t===e}),a,!0),h=_t((function(t){return z(e,t)>-1}),a,!0),d=[function(t,n,i){var r=!o&&(i||n!==c)||((e=n).nodeType?u(t,n,i):h(t,n,i));return e=null,r}];l<s;l++)if(n=i.relative[t[l].type])d=[_t(bt(d),n)];else{if((n=i.filter[t[l].type].apply(null,t[l].matches))[_]){for(r=++l;r<s&&!i.relative[t[r].type];r++);return Mt(l>1&&bt(d),l>1&&yt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(H,"$1"),n,l<r&&St(t.slice(l,r)),r<s&&St(t=t.slice(r)),r<s&&yt(t))}d.push(n)}return bt(d)}return xt.prototype=i.filters=i.pseudos,i.setFilters=new xt,o=at.tokenize=function(t,e){var n,r,s,o,a,l,c,u=C[t+" "];if(u)return e?0:u.slice(0);for(a=t,l=[],c=i.preFilter;a;){for(o in n&&!(r=j.exec(a))||(r&&(a=a.slice(r[0].length)||a),l.push(s=[])),n=!1,(r=W.exec(a))&&(n=r.shift(),s.push({value:n,type:r[0].replace(H," ")}),a=a.slice(n.length)),i.filter)!(r=Z[o].exec(a))||c[o]&&!(r=c[o](r))||(n=r.shift(),s.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return e?a.length:a?at.error(t):C(t,l).slice(0)},a=at.compile=function(t,e){var n,r=[],s=[],a=T[t+" "];if(!a){for(e||(e=o(t)),n=e.length;n--;)(a=St(e[n]))[_]?r.push(a):s.push(a);(a=T(t,function(t,e){var n=e.length>0,r=t.length>0,s=function(s,o,a,l,u){var h,f,v,g=0,x="0",y=s&&[],_=[],b=c,M=s||r&&i.find.TAG("*",u),S=w+=null==b?1:Math.random()||.1,C=M.length;for(u&&(c=o==p||o||u);x!==C&&null!=(h=M[x]);x++){if(r&&h){for(f=0,o||h.ownerDocument==p||(d(h),a=!m);v=t[f++];)if(v(h,o||p,a)){l.push(h);break}u&&(w=S)}n&&((h=!v&&h)&&g--,s&&y.push(h))}if(g+=x,n&&x!==g){for(f=0;v=e[f++];)v(y,_,o,a);if(s){if(g>0)for(;x--;)y[x]||_[x]||(_[x]=D.call(l));_=wt(_)}R.apply(l,_),u&&!s&&_.length>0&&g+e.length>1&&at.uniqueSort(l)}return u&&(w=S,c=b),y};return n?ct(s):s}(s,r))).selector=t}return a},l=at.select=function(t,e,n,r){var s,l,c,u,h,d="function"==typeof t&&t,p=!r&&o(t=d.selector||t);if(n=n||[],1===p.length){if((l=p[0]=p[0].slice(0)).length>2&&"ID"===(c=l[0]).type&&9===e.nodeType&&m&&i.relative[l[1].type]){if(!(e=(i.find.ID(c.matches[0].replace(et,nt),e)||[])[0]))return n;d&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(s=Z.needsContext.test(t)?0:l.length;s--&&(c=l[s],!i.relative[u=c.type]);)if((h=i.find[u])&&(r=h(c.matches[0].replace(et,nt),tt.test(l[0].type)&&gt(e.parentNode)||e))){if(l.splice(s,1),!(t=r.length&&yt(l)))return R.apply(n,r),n;break}}return(d||a(t,p))(r,e,!m,n,!e||tt.test(t)&&gt(e.parentNode)||e),n},n.sortStable=_.split("").sort(A).join("")===_,n.detectDuplicates=!!h,d(),n.sortDetached=ut((function(t){return 1&t.compareDocumentPosition(p.createElement("fieldset"))})),ut((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||ht("type|href|height|width",(function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),n.attributes&&ut((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||ht("value",(function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ut((function(t){return null==t.getAttribute("disabled")}))||ht(O,(function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null})),at}(i);S.find=T,S.expr=T.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=T.uniqueSort,S.text=T.getText,S.isXMLDoc=T.isXML,S.contains=T.contains,S.escapeSelector=T.escape;var P=function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&S(t).is(n))break;i.push(t)}return i},A=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},E=S.expr.match.needsContext;function L(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var D=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function k(t,e,n){return g(e)?S.grep(t,(function(t,i){return!!e.call(t,i,t)!==n})):e.nodeType?S.grep(t,(function(t){return t===e!==n})):"string"!=typeof e?S.grep(t,(function(t){return u.call(e,t)>-1!==n})):S.filter(e,t,n)}S.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?S.find.matchesSelector(i,t)?[i]:[]:S.find.matches(t,S.grep(e,(function(t){return 1===t.nodeType})))},S.fn.extend({find:function(t){var e,n,i=this.length,r=this;if("string"!=typeof t)return this.pushStack(S(t).filter((function(){for(e=0;e<i;e++)if(S.contains(r[e],this))return!0})));for(n=this.pushStack([]),e=0;e<i;e++)S.find(t,r[e],n);return i>1?S.uniqueSort(n):n},filter:function(t){return this.pushStack(k(this,t||[],!1))},not:function(t){return this.pushStack(k(this,t||[],!0))},is:function(t){return!!k(this,"string"==typeof t&&E.test(t)?S(t):t||[],!1).length}});var R,I=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||R,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:I.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof S?e[0]:e,S.merge(this,S.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:y,!0)),D.test(i[1])&&S.isPlainObject(e))for(i in e)g(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(r=y.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):g(t)?void 0!==n.ready?n.ready(t):t(S):S.makeArray(t,this)}).prototype=S.fn,R=S(y);var z=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};function N(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}S.fn.extend({has:function(t){var e=S(t,this),n=e.length;return this.filter((function(){for(var t=0;t<n;t++)if(S.contains(this,e[t]))return!0}))},closest:function(t,e){var n,i=0,r=this.length,s=[],o="string"!=typeof t&&S(t);if(!E.test(t))for(;i<r;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:1===n.nodeType&&S.find.matchesSelector(n,t))){s.push(n);break}return this.pushStack(s.length>1?S.uniqueSort(s):s)},index:function(t){return t?"string"==typeof t?u.call(S(t),this[0]):u.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),S.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return P(t,"parentNode")},parentsUntil:function(t,e,n){return P(t,"parentNode",n)},next:function(t){return N(t,"nextSibling")},prev:function(t){return N(t,"previousSibling")},nextAll:function(t){return P(t,"nextSibling")},prevAll:function(t){return P(t,"previousSibling")},nextUntil:function(t,e,n){return P(t,"nextSibling",n)},prevUntil:function(t,e,n){return P(t,"previousSibling",n)},siblings:function(t){return A((t.parentNode||{}).firstChild,t)},children:function(t){return A(t.firstChild)},contents:function(t){return null!=t.contentDocument&&o(t.contentDocument)?t.contentDocument:(L(t,"template")&&(t=t.content||t),S.merge([],t.childNodes))}},(function(t,e){S.fn[t]=function(n,i){var r=S.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=S.filter(i,r)),this.length>1&&(O[t]||S.uniqueSort(r),z.test(t)&&r.reverse()),this.pushStack(r)}}));var F=/[^\x20\t\r\n\f]+/g;function B(t){return t}function U(t){throw t}function V(t,e,n,i){var r;try{t&&g(r=t.promise)?r.call(t).done(e).fail(n):t&&g(r=t.then)?r.call(t,e,n):e.apply(void 0,[t].slice(i))}catch(t){n.apply(void 0,[t])}}S.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return S.each(t.match(F)||[],(function(t,n){e[n]=!0})),e}(t):S.extend({},t);var e,n,i,r,s=[],o=[],a=-1,l=function(){for(r=r||t.once,i=e=!0;o.length;a=-1)for(n=o.shift();++a<s.length;)!1===s[a].apply(n[0],n[1])&&t.stopOnFalse&&(a=s.length,n=!1);t.memory||(n=!1),e=!1,r&&(s=n?[]:"")},c={add:function(){return s&&(n&&!e&&(a=s.length-1,o.push(n)),function e(n){S.each(n,(function(n,i){g(i)?t.unique&&c.has(i)||s.push(i):i&&i.length&&"string"!==w(i)&&e(i)}))}(arguments),n&&!e&&l()),this},remove:function(){return S.each(arguments,(function(t,e){for(var n;(n=S.inArray(e,s,n))>-1;)s.splice(n,1),n<=a&&a--})),this},has:function(t){return t?S.inArray(t,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return r=o=[],s=n="",this},disabled:function(){return!s},lock:function(){return r=o=[],n||e||(s=n=""),this},locked:function(){return!!r},fireWith:function(t,n){return r||(n=[t,(n=n||[]).slice?n.slice():n],o.push(n),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},S.extend({Deferred:function(t){var e=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],n="pending",r={state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return S.Deferred((function(n){S.each(e,(function(e,i){var r=g(t[i[4]])&&t[i[4]];s[i[1]]((function(){var t=r&&r.apply(this,arguments);t&&g(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,r?[t]:arguments)}))})),t=null})).promise()},then:function(t,n,r){var s=0;function o(t,e,n,r){return function(){var a=this,l=arguments,c=function(){var i,c;if(!(t<s)){if((i=n.apply(a,l))===e.promise())throw new TypeError("Thenable self-resolution");c=i&&("object"==typeof i||"function"==typeof i)&&i.then,g(c)?r?c.call(i,o(s,e,B,r),o(s,e,U,r)):(s++,c.call(i,o(s,e,B,r),o(s,e,U,r),o(s,e,B,e.notifyWith))):(n!==B&&(a=void 0,l=[i]),(r||e.resolveWith)(a,l))}},u=r?c:function(){try{c()}catch(i){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(i,u.stackTrace),t+1>=s&&(n!==U&&(a=void 0,l=[i]),e.rejectWith(a,l))}};t?u():(S.Deferred.getStackHook&&(u.stackTrace=S.Deferred.getStackHook()),i.setTimeout(u))}}return S.Deferred((function(i){e[0][3].add(o(0,i,g(r)?r:B,i.notifyWith)),e[1][3].add(o(0,i,g(t)?t:B)),e[2][3].add(o(0,i,g(n)?n:U))})).promise()},promise:function(t){return null!=t?S.extend(t,r):r}},s={};return S.each(e,(function(t,i){var o=i[2],a=i[5];r[i[1]]=o.add,a&&o.add((function(){n=a}),e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),o.add(i[3].fire),s[i[0]]=function(){return s[i[0]+"With"](this===s?void 0:this,arguments),this},s[i[0]+"With"]=o.fireWith})),r.promise(s),t&&t.call(s,s),s},when:function(t){var e=arguments.length,n=e,i=Array(n),r=a.call(arguments),s=S.Deferred(),o=function(t){return function(n){i[t]=this,r[t]=arguments.length>1?a.call(arguments):n,--e||s.resolveWith(i,r)}};if(e<=1&&(V(t,s.done(o(n)).resolve,s.reject,!e),"pending"===s.state()||g(r[n]&&r[n].then)))return s.then();for(;n--;)V(r[n],o(n),s.reject);return s.promise()}});var H=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(t,e){i.console&&i.console.warn&&t&&H.test(t.name)&&i.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},S.readyException=function(t){i.setTimeout((function(){throw t}))};var j=S.Deferred();function W(){y.removeEventListener("DOMContentLoaded",W),i.removeEventListener("load",W),S.ready()}S.fn.ready=function(t){return j.then(t).catch((function(t){S.readyException(t)})),this},S.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--S.readyWait:S.isReady)||(S.isReady=!0,!0!==t&&--S.readyWait>0||j.resolveWith(y,[S]))}}),S.ready.then=j.then,"complete"===y.readyState||"loading"!==y.readyState&&!y.documentElement.doScroll?i.setTimeout(S.ready):(y.addEventListener("DOMContentLoaded",W),i.addEventListener("load",W));var G=function(t,e,n,i,r,s,o){var a=0,l=t.length,c=null==n;if("object"===w(n))for(a in r=!0,n)G(t,e,a,n[a],!0,s,o);else if(void 0!==i&&(r=!0,g(i)||(o=!0),c&&(o?(e.call(t,i),e=null):(c=e,e=function(t,e,n){return c.call(S(t),n)})),e))for(;a<l;a++)e(t[a],n,o?i:i.call(t[a],a,e(t[a],n)));return r?t:c?e.call(t):l?e(t[0],n):s},q=/^-ms-/,X=/-([a-z])/g;function Z(t,e){return e.toUpperCase()}function Y(t){return t.replace(q,"ms-").replace(X,Z)}var K=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function J(){this.expando=S.expando+J.uid++}J.uid=1,J.prototype={cache:function(t){var e=t[this.expando];return e||(e={},K(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,r=this.cache(t);if("string"==typeof e)r[Y(e)]=n;else for(i in e)r[Y(i)]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][Y(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i=t[this.expando];if(void 0!==i){if(void 0!==e){n=(e=Array.isArray(e)?e.map(Y):(e=Y(e))in i?[e]:e.match(F)||[]).length;for(;n--;)delete i[e[n]]}(void 0===e||S.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!S.isEmptyObject(e)}};var $=new J,Q=new J,tt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,et=/[A-Z]/g;function nt(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(et,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:tt.test(t)?JSON.parse(t):t)}(n)}catch(t){}Q.set(t,e,n)}else n=void 0;return n}S.extend({hasData:function(t){return Q.hasData(t)||$.hasData(t)},data:function(t,e,n){return Q.access(t,e,n)},removeData:function(t,e){Q.remove(t,e)},_data:function(t,e,n){return $.access(t,e,n)},_removeData:function(t,e){$.remove(t,e)}}),S.fn.extend({data:function(t,e){var n,i,r,s=this[0],o=s&&s.attributes;if(void 0===t){if(this.length&&(r=Q.get(s),1===s.nodeType&&!$.get(s,"hasDataAttrs"))){for(n=o.length;n--;)o[n]&&0===(i=o[n].name).indexOf("data-")&&(i=Y(i.slice(5)),nt(s,i,r[i]));$.set(s,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each((function(){Q.set(this,t)})):G(this,(function(e){var n;if(s&&void 0===e)return void 0!==(n=Q.get(s,t))||void 0!==(n=nt(s,t))?n:void 0;this.each((function(){Q.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){Q.remove(this,t)}))}}),S.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=$.get(t,e),n&&(!i||Array.isArray(n)?i=$.access(t,e,S.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=S.queue(t,e),i=n.length,r=n.shift(),s=S._queueHooks(t,e);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete s.stop,r.call(t,(function(){S.dequeue(t,e)}),s)),!i&&s&&s.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return $.get(t,n)||$.access(t,n,{empty:S.Callbacks("once memory").add((function(){$.remove(t,[e+"queue",n])}))})}}),S.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?S.queue(this[0],t):void 0===e?this:this.each((function(){var n=S.queue(this,t,e);S._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&S.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){S.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=S.Deferred(),s=this,o=this.length,a=function(){--i||r.resolveWith(s,[s])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";o--;)(n=$.get(s[o],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),r.promise(e)}});var it=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rt=new RegExp("^(?:([+-])=|)("+it+")([a-z%]*)$","i"),st=["Top","Right","Bottom","Left"],ot=y.documentElement,at=function(t){return S.contains(t.ownerDocument,t)},lt={composed:!0};ot.getRootNode&&(at=function(t){return S.contains(t.ownerDocument,t)||t.getRootNode(lt)===t.ownerDocument});var ct=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&at(t)&&"none"===S.css(t,"display")};function ut(t,e,n,i){var r,s,o=20,a=i?function(){return i.cur()}:function(){return S.css(t,e,"")},l=a(),c=n&&n[3]||(S.cssNumber[e]?"":"px"),u=t.nodeType&&(S.cssNumber[e]||"px"!==c&&+l)&&rt.exec(S.css(t,e));if(u&&u[3]!==c){for(l/=2,c=c||u[3],u=+l||1;o--;)S.style(t,e,u+c),(1-s)*(1-(s=a()/l||.5))<=0&&(o=0),u/=s;u*=2,S.style(t,e,u+c),n=n||[]}return n&&(u=+u||+l||0,r=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=u,i.end=r)),r}var ht={};function dt(t){var e,n=t.ownerDocument,i=t.nodeName,r=ht[i];return r||(e=n.body.appendChild(n.createElement(i)),r=S.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),ht[i]=r,r)}function pt(t,e){for(var n,i,r=[],s=0,o=t.length;s<o;s++)(i=t[s]).style&&(n=i.style.display,e?("none"===n&&(r[s]=$.get(i,"display")||null,r[s]||(i.style.display="")),""===i.style.display&&ct(i)&&(r[s]=dt(i))):"none"!==n&&(r[s]="none",$.set(i,"display",n)));for(s=0;s<o;s++)null!=r[s]&&(t[s].style.display=r[s]);return t}S.fn.extend({show:function(){return pt(this,!0)},hide:function(){return pt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){ct(this)?S(this).show():S(this).hide()}))}});var ft,mt,vt=/^(?:checkbox|radio)$/i,gt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,xt=/^$|^module$|\/(?:java|ecma)script/i;ft=y.createDocumentFragment().appendChild(y.createElement("div")),(mt=y.createElement("input")).setAttribute("type","radio"),mt.setAttribute("checked","checked"),mt.setAttribute("name","t"),ft.appendChild(mt),v.checkClone=ft.cloneNode(!0).cloneNode(!0).lastChild.checked,ft.innerHTML="<textarea>x</textarea>",v.noCloneChecked=!!ft.cloneNode(!0).lastChild.defaultValue,ft.innerHTML="<option></option>",v.option=!!ft.lastChild;var yt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function _t(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&L(t,e)?S.merge([t],n):n}function bt(t,e){for(var n=0,i=t.length;n<i;n++)$.set(t[n],"globalEval",!e||$.get(e[n],"globalEval"))}yt.tbody=yt.tfoot=yt.colgroup=yt.caption=yt.thead,yt.th=yt.td,v.option||(yt.optgroup=yt.option=[1,"<select multiple='multiple'>","</select>"]);var wt=/<|&#?\w+;/;function Mt(t,e,n,i,r){for(var s,o,a,l,c,u,h=e.createDocumentFragment(),d=[],p=0,f=t.length;p<f;p++)if((s=t[p])||0===s)if("object"===w(s))S.merge(d,s.nodeType?[s]:s);else if(wt.test(s)){for(o=o||h.appendChild(e.createElement("div")),a=(gt.exec(s)||["",""])[1].toLowerCase(),l=yt[a]||yt._default,o.innerHTML=l[1]+S.htmlPrefilter(s)+l[2],u=l[0];u--;)o=o.lastChild;S.merge(d,o.childNodes),(o=h.firstChild).textContent=""}else d.push(e.createTextNode(s));for(h.textContent="",p=0;s=d[p++];)if(i&&S.inArray(s,i)>-1)r&&r.push(s);else if(c=at(s),o=_t(h.appendChild(s),"script"),c&&bt(o),n)for(u=0;s=o[u++];)xt.test(s.type||"")&&n.push(s);return h}var St=/^key/,Ct=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Tt=/^([^.]*)(?:\.(.+)|)/;function Pt(){return!0}function At(){return!1}function Et(t,e){return t===function(){try{return y.activeElement}catch(t){}}()==("focus"===e)}function Lt(t,e,n,i,r,s){var o,a;if("object"==typeof e){for(a in"string"!=typeof n&&(i=i||n,n=void 0),e)Lt(t,a,n,i,e[a],s);return t}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=At;else if(!r)return t;return 1===s&&(o=r,(r=function(t){return S().off(t),o.apply(this,arguments)}).guid=o.guid||(o.guid=S.guid++)),t.each((function(){S.event.add(this,e,r,i,n)}))}function Dt(t,e,n){n?($.set(t,e,!1),S.event.add(t,e,{namespace:!1,handler:function(t){var i,r,s=$.get(this,e);if(1&t.isTrigger&&this[e]){if(s.length)(S.event.special[e]||{}).delegateType&&t.stopPropagation();else if(s=a.call(arguments),$.set(this,e,s),i=n(this,e),this[e](),s!==(r=$.get(this,e))||i?$.set(this,e,!1):r={},s!==r)return t.stopImmediatePropagation(),t.preventDefault(),r.value}else s.length&&($.set(this,e,{value:S.event.trigger(S.extend(s[0],S.Event.prototype),s.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===$.get(t,e)&&S.event.add(t,e,Pt)}S.event={global:{},add:function(t,e,n,i,r){var s,o,a,l,c,u,h,d,p,f,m,v=$.get(t);if(K(t))for(n.handler&&(n=(s=n).handler,r=s.selector),r&&S.find.matchesSelector(ot,r),n.guid||(n.guid=S.guid++),(l=v.events)||(l=v.events=Object.create(null)),(o=v.handle)||(o=v.handle=function(e){return void 0!==S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(F)||[""]).length;c--;)p=m=(a=Tt.exec(e[c])||[])[1],f=(a[2]||"").split(".").sort(),p&&(h=S.event.special[p]||{},p=(r?h.delegateType:h.bindType)||p,h=S.event.special[p]||{},u=S.extend({type:p,origType:m,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&S.expr.match.needsContext.test(r),namespace:f.join(".")},s),(d=l[p])||((d=l[p]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,i,f,o)||t.addEventListener&&t.addEventListener(p,o)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,u):d.push(u),S.event.global[p]=!0)},remove:function(t,e,n,i,r){var s,o,a,l,c,u,h,d,p,f,m,v=$.hasData(t)&&$.get(t);if(v&&(l=v.events)){for(c=(e=(e||"").match(F)||[""]).length;c--;)if(p=m=(a=Tt.exec(e[c])||[])[1],f=(a[2]||"").split(".").sort(),p){for(h=S.event.special[p]||{},d=l[p=(i?h.delegateType:h.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=d.length;s--;)u=d[s],!r&&m!==u.origType||n&&n.guid!==u.guid||a&&!a.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(d.splice(s,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(t,u));o&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,f,v.handle)||S.removeEvent(t,p,v.handle),delete l[p])}else for(p in l)S.event.remove(t,p+e[c],n,i,!0);S.isEmptyObject(l)&&$.remove(t,"handle events")}},dispatch:function(t){var e,n,i,r,s,o,a=new Array(arguments.length),l=S.event.fix(t),c=($.get(this,"events")||Object.create(null))[l.type]||[],u=S.event.special[l.type]||{};for(a[0]=l,e=1;e<arguments.length;e++)a[e]=arguments[e];if(l.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,l)){for(o=S.event.handlers.call(this,l,c),e=0;(r=o[e++])&&!l.isPropagationStopped();)for(l.currentTarget=r.elem,n=0;(s=r.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==s.namespace&&!l.rnamespace.test(s.namespace)||(l.handleObj=s,l.data=s.data,void 0!==(i=((S.event.special[s.origType]||{}).handle||s.handler).apply(r.elem,a))&&!1===(l.result=i)&&(l.preventDefault(),l.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,l),l.result}},handlers:function(t,e){var n,i,r,s,o,a=[],l=e.delegateCount,c=t.target;if(l&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(s=[],o={},n=0;n<l;n++)void 0===o[r=(i=e[n]).selector+" "]&&(o[r]=i.needsContext?S(r,this).index(c)>-1:S.find(r,this,null,[c]).length),o[r]&&s.push(i);s.length&&a.push({elem:c,handlers:s})}return c=this,l<e.length&&a.push({elem:c,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:g(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[S.expando]?t:new S.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return vt.test(e.type)&&e.click&&L(e,"input")&&Dt(e,"click",Pt),!1},trigger:function(t){var e=this||t;return vt.test(e.type)&&e.click&&L(e,"input")&&Dt(e,"click"),!0},_default:function(t){var e=t.target;return vt.test(e.type)&&e.click&&L(e,"input")&&$.get(e,"click")||L(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},S.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},S.Event=function(t,e){if(!(this instanceof S.Event))return new S.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Pt:At,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&S.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:At,isPropagationStopped:At,isImmediatePropagationStopped:At,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Pt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Pt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Pt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&St.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&Ct.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},(function(t,e){S.event.special[t]={setup:function(){return Dt(this,t,Et),!1},trigger:function(){return Dt(this,t),!0},delegateType:e}})),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){S.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,r=t.relatedTarget,s=t.handleObj;return r&&(r===i||S.contains(i,r))||(t.type=s.origType,n=s.handler.apply(this,arguments),t.type=e),n}}})),S.fn.extend({on:function(t,e,n,i){return Lt(this,t,e,n,i)},one:function(t,e,n,i){return Lt(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,S(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=At),this.each((function(){S.event.remove(this,t,n,e)}))}});var kt=/<script|<style|<link/i,Rt=/checked\s*(?:[^=]|=\s*.checked.)/i,It=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function zt(t,e){return L(t,"table")&&L(11!==e.nodeType?e:e.firstChild,"tr")&&S(t).children("tbody")[0]||t}function Ot(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Nt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Ft(t,e){var n,i,r,s,o,a;if(1===e.nodeType){if($.hasData(t)&&(a=$.get(t).events))for(r in $.remove(e,"handle events"),a)for(n=0,i=a[r].length;n<i;n++)S.event.add(e,r,a[r][n]);Q.hasData(t)&&(s=Q.access(t),o=S.extend({},s),Q.set(e,o))}}function Bt(t,e){var n=e.nodeName.toLowerCase();"input"===n&&vt.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function Ut(t,e,n,i){e=l(e);var r,s,o,a,c,u,h=0,d=t.length,p=d-1,f=e[0],m=g(f);if(m||d>1&&"string"==typeof f&&!v.checkClone&&Rt.test(f))return t.each((function(r){var s=t.eq(r);m&&(e[0]=f.call(this,r,s.html())),Ut(s,e,n,i)}));if(d&&(s=(r=Mt(e,t[0].ownerDocument,!1,t,i)).firstChild,1===r.childNodes.length&&(r=s),s||i)){for(a=(o=S.map(_t(r,"script"),Ot)).length;h<d;h++)c=r,h!==p&&(c=S.clone(c,!0,!0),a&&S.merge(o,_t(c,"script"))),n.call(t[h],c,h);if(a)for(u=o[o.length-1].ownerDocument,S.map(o,Nt),h=0;h<a;h++)c=o[h],xt.test(c.type||"")&&!$.access(c,"globalEval")&&S.contains(u,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?S._evalUrl&&!c.noModule&&S._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},u):b(c.textContent.replace(It,""),c,u))}return t}function Vt(t,e,n){for(var i,r=e?S.filter(e,t):t,s=0;null!=(i=r[s]);s++)n||1!==i.nodeType||S.cleanData(_t(i)),i.parentNode&&(n&&at(i)&&bt(_t(i,"script")),i.parentNode.removeChild(i));return t}S.extend({htmlPrefilter:function(t){return t},clone:function(t,e,n){var i,r,s,o,a=t.cloneNode(!0),l=at(t);if(!(v.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||S.isXMLDoc(t)))for(o=_t(a),i=0,r=(s=_t(t)).length;i<r;i++)Bt(s[i],o[i]);if(e)if(n)for(s=s||_t(t),o=o||_t(a),i=0,r=s.length;i<r;i++)Ft(s[i],o[i]);else Ft(t,a);return(o=_t(a,"script")).length>0&&bt(o,!l&&_t(t,"script")),a},cleanData:function(t){for(var e,n,i,r=S.event.special,s=0;void 0!==(n=t[s]);s++)if(K(n)){if(e=n[$.expando]){if(e.events)for(i in e.events)r[i]?S.event.remove(n,i):S.removeEvent(n,i,e.handle);n[$.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),S.fn.extend({detach:function(t){return Vt(this,t,!0)},remove:function(t){return Vt(this,t)},text:function(t){return G(this,(function(t){return void 0===t?S.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return Ut(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||zt(this,t).appendChild(t)}))},prepend:function(){return Ut(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=zt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Ut(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Ut(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(S.cleanData(_t(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return S.clone(this,t,e)}))},html:function(t){return G(this,(function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!kt.test(t)&&!yt[(gt.exec(t)||["",""])[1].toLowerCase()]){t=S.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(S.cleanData(_t(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Ut(this,arguments,(function(e){var n=this.parentNode;S.inArray(this,t)<0&&(S.cleanData(_t(this)),n&&n.replaceChild(e,this))}),t)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){S.fn[t]=function(t){for(var n,i=[],r=S(t),s=r.length-1,o=0;o<=s;o++)n=o===s?this:this.clone(!0),S(r[o])[e](n),c.apply(i,n.get());return this.pushStack(i)}}));var Ht=new RegExp("^("+it+")(?!px)[a-z%]+$","i"),jt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=i),e.getComputedStyle(t)},Wt=function(t,e,n){var i,r,s={};for(r in e)s[r]=t.style[r],t.style[r]=e[r];for(r in i=n.call(t),e)t.style[r]=s[r];return i},Gt=new RegExp(st.join("|"),"i");function qt(t,e,n){var i,r,s,o,a=t.style;return(n=n||jt(t))&&(""!==(o=n.getPropertyValue(e)||n[e])||at(t)||(o=S.style(t,e)),!v.pixelBoxStyles()&&Ht.test(o)&&Gt.test(e)&&(i=a.width,r=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=o,o=n.width,a.width=i,a.minWidth=r,a.maxWidth=s)),void 0!==o?o+"":o}function Xt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(u){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ot.appendChild(c).appendChild(u);var t=i.getComputedStyle(u);n="1%"!==t.top,l=12===e(t.marginLeft),u.style.right="60%",o=36===e(t.right),r=36===e(t.width),u.style.position="absolute",s=12===e(u.offsetWidth/3),ot.removeChild(c),u=null}}function e(t){return Math.round(parseFloat(t))}var n,r,s,o,a,l,c=y.createElement("div"),u=y.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",v.clearCloneStyle="content-box"===u.style.backgroundClip,S.extend(v,{boxSizingReliable:function(){return t(),r},pixelBoxStyles:function(){return t(),o},pixelPosition:function(){return t(),n},reliableMarginLeft:function(){return t(),l},scrollboxSize:function(){return t(),s},reliableTrDimensions:function(){var t,e,n,r;return null==a&&(t=y.createElement("table"),e=y.createElement("tr"),n=y.createElement("div"),t.style.cssText="position:absolute;left:-11111px",e.style.height="1px",n.style.height="9px",ot.appendChild(t).appendChild(e).appendChild(n),r=i.getComputedStyle(e),a=parseInt(r.height)>3,ot.removeChild(t)),a}}))}();var Zt=["Webkit","Moz","ms"],Yt=y.createElement("div").style,Kt={};function Jt(t){var e=S.cssProps[t]||Kt[t];return e||(t in Yt?t:Kt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),n=Zt.length;n--;)if((t=Zt[n]+e)in Yt)return t}(t)||t)}var $t=/^(none|table(?!-c[ea]).+)/,Qt=/^--/,te={position:"absolute",visibility:"hidden",display:"block"},ee={letterSpacing:"0",fontWeight:"400"};function ne(t,e,n){var i=rt.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function ie(t,e,n,i,r,s){var o="width"===e?1:0,a=0,l=0;if(n===(i?"border":"content"))return 0;for(;o<4;o+=2)"margin"===n&&(l+=S.css(t,n+st[o],!0,r)),i?("content"===n&&(l-=S.css(t,"padding"+st[o],!0,r)),"margin"!==n&&(l-=S.css(t,"border"+st[o]+"Width",!0,r))):(l+=S.css(t,"padding"+st[o],!0,r),"padding"!==n?l+=S.css(t,"border"+st[o]+"Width",!0,r):a+=S.css(t,"border"+st[o]+"Width",!0,r));return!i&&s>=0&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-s-l-a-.5))||0),l}function re(t,e,n){var i=jt(t),r=(!v.boxSizingReliable()||n)&&"border-box"===S.css(t,"boxSizing",!1,i),s=r,o=qt(t,e,i),a="offset"+e[0].toUpperCase()+e.slice(1);if(Ht.test(o)){if(!n)return o;o="auto"}return(!v.boxSizingReliable()&&r||!v.reliableTrDimensions()&&L(t,"tr")||"auto"===o||!parseFloat(o)&&"inline"===S.css(t,"display",!1,i))&&t.getClientRects().length&&(r="border-box"===S.css(t,"boxSizing",!1,i),(s=a in t)&&(o=t[a])),(o=parseFloat(o)||0)+ie(t,e,n||(r?"border":"content"),s,i,o)+"px"}function se(t,e,n,i,r){return new se.prototype.init(t,e,n,i,r)}S.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=qt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,s,o,a=Y(e),l=Qt.test(e),c=t.style;if(l||(e=Jt(a)),o=S.cssHooks[e]||S.cssHooks[a],void 0===n)return o&&"get"in o&&void 0!==(r=o.get(t,!1,i))?r:c[e];"string"===(s=typeof n)&&(r=rt.exec(n))&&r[1]&&(n=ut(t,e,r),s="number"),null!=n&&n==n&&("number"!==s||l||(n+=r&&r[3]||(S.cssNumber[a]?"":"px")),v.clearCloneStyle||""!==n||0!==e.indexOf("background")||(c[e]="inherit"),o&&"set"in o&&void 0===(n=o.set(t,n,i))||(l?c.setProperty(e,n):c[e]=n))}},css:function(t,e,n,i){var r,s,o,a=Y(e);return Qt.test(e)||(e=Jt(a)),(o=S.cssHooks[e]||S.cssHooks[a])&&"get"in o&&(r=o.get(t,!0,n)),void 0===r&&(r=qt(t,e,i)),"normal"===r&&e in ee&&(r=ee[e]),""===n||n?(s=parseFloat(r),!0===n||isFinite(s)?s||0:r):r}}),S.each(["height","width"],(function(t,e){S.cssHooks[e]={get:function(t,n,i){if(n)return!$t.test(S.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?re(t,e,i):Wt(t,te,(function(){return re(t,e,i)}))},set:function(t,n,i){var r,s=jt(t),o=!v.scrollboxSize()&&"absolute"===s.position,a=(o||i)&&"border-box"===S.css(t,"boxSizing",!1,s),l=i?ie(t,e,i,a,s):0;return a&&o&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(s[e])-ie(t,e,"border",!1,s)-.5)),l&&(r=rt.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=S.css(t,e)),ne(0,n,l)}}})),S.cssHooks.marginLeft=Xt(v.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(qt(t,"marginLeft"))||t.getBoundingClientRect().left-Wt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),S.each({margin:"",padding:"",border:"Width"},(function(t,e){S.cssHooks[t+e]={expand:function(n){for(var i=0,r={},s="string"==typeof n?n.split(" "):[n];i<4;i++)r[t+st[i]+e]=s[i]||s[i-2]||s[0];return r}},"margin"!==t&&(S.cssHooks[t+e].set=ne)})),S.fn.extend({css:function(t,e){return G(this,(function(t,e,n){var i,r,s={},o=0;if(Array.isArray(e)){for(i=jt(t),r=e.length;o<r;o++)s[e[o]]=S.css(t,e[o],!1,i);return s}return void 0!==n?S.style(t,e,n):S.css(t,e)}),t,e,arguments.length>1)}}),S.Tween=se,se.prototype={constructor:se,init:function(t,e,n,i,r,s){this.elem=t,this.prop=n,this.easing=r||S.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=s||(S.cssNumber[n]?"":"px")},cur:function(){var t=se.propHooks[this.prop];return t&&t.get?t.get(this):se.propHooks._default.get(this)},run:function(t){var e,n=se.propHooks[this.prop];return this.options.duration?this.pos=e=S.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):se.propHooks._default.set(this),this}},se.prototype.init.prototype=se.prototype,se.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=S.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){S.fx.step[t.prop]?S.fx.step[t.prop](t):1!==t.elem.nodeType||!S.cssHooks[t.prop]&&null==t.elem.style[Jt(t.prop)]?t.elem[t.prop]=t.now:S.style(t.elem,t.prop,t.now+t.unit)}}},se.propHooks.scrollTop=se.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},S.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},S.fx=se.prototype.init,S.fx.step={};var oe,ae,le=/^(?:toggle|show|hide)$/,ce=/queueHooks$/;function ue(){ae&&(!1===y.hidden&&i.requestAnimationFrame?i.requestAnimationFrame(ue):i.setTimeout(ue,S.fx.interval),S.fx.tick())}function he(){return i.setTimeout((function(){oe=void 0})),oe=Date.now()}function de(t,e){var n,i=0,r={height:t};for(e=e?1:0;i<4;i+=2-e)r["margin"+(n=st[i])]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function pe(t,e,n){for(var i,r=(fe.tweeners[e]||[]).concat(fe.tweeners["*"]),s=0,o=r.length;s<o;s++)if(i=r[s].call(n,e,t))return i}function fe(t,e,n){var i,r,s=0,o=fe.prefilters.length,a=S.Deferred().always((function(){delete l.elem})),l=function(){if(r)return!1;for(var e=oe||he(),n=Math.max(0,c.startTime+c.duration-e),i=1-(n/c.duration||0),s=0,o=c.tweens.length;s<o;s++)c.tweens[s].run(i);return a.notifyWith(t,[c,i,n]),i<1&&o?n:(o||a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},n),originalProperties:e,originalOptions:n,startTime:oe||he(),duration:n.duration,tweens:[],createTween:function(e,n){var i=S.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(i),i},stop:function(e){var n=0,i=e?c.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)c.tweens[n].run(1);return e?(a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c,e])):a.rejectWith(t,[c,e]),this}}),u=c.props;for(!function(t,e){var n,i,r,s,o;for(n in t)if(r=e[i=Y(n)],s=t[n],Array.isArray(s)&&(r=s[1],s=t[n]=s[0]),n!==i&&(t[i]=s,delete t[n]),(o=S.cssHooks[i])&&"expand"in o)for(n in s=o.expand(s),delete t[i],s)n in t||(t[n]=s[n],e[n]=r);else e[i]=r}(u,c.opts.specialEasing);s<o;s++)if(i=fe.prefilters[s].call(c,t,u,c.opts))return g(i.stop)&&(S._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)),i;return S.map(u,pe,c),g(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),S.fx.timer(S.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c}S.Animation=S.extend(fe,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return ut(n.elem,t,rt.exec(e),n),n}]},tweener:function(t,e){g(t)?(e=t,t=["*"]):t=t.match(F);for(var n,i=0,r=t.length;i<r;i++)n=t[i],fe.tweeners[n]=fe.tweeners[n]||[],fe.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var i,r,s,o,a,l,c,u,h="width"in e||"height"in e,d=this,p={},f=t.style,m=t.nodeType&&ct(t),v=$.get(t,"fxshow");for(i in n.queue||(null==(o=S._queueHooks(t,"fx")).unqueued&&(o.unqueued=0,a=o.empty.fire,o.empty.fire=function(){o.unqueued||a()}),o.unqueued++,d.always((function(){d.always((function(){o.unqueued--,S.queue(t,"fx").length||o.empty.fire()}))}))),e)if(r=e[i],le.test(r)){if(delete e[i],s=s||"toggle"===r,r===(m?"hide":"show")){if("show"!==r||!v||void 0===v[i])continue;m=!0}p[i]=v&&v[i]||S.style(t,i)}if((l=!S.isEmptyObject(e))||!S.isEmptyObject(p))for(i in h&&1===t.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],null==(c=v&&v.display)&&(c=$.get(t,"display")),"none"===(u=S.css(t,"display"))&&(c?u=c:(pt([t],!0),c=t.style.display||c,u=S.css(t,"display"),pt([t]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===S.css(t,"float")&&(l||(d.done((function(){f.display=c})),null==c&&(u=f.display,c="none"===u?"":u)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",d.always((function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}))),l=!1,p)l||(v?"hidden"in v&&(m=v.hidden):v=$.access(t,"fxshow",{display:c}),s&&(v.hidden=!m),m&&pt([t],!0),d.done((function(){for(i in m||pt([t]),$.remove(t,"fxshow"),p)S.style(t,i,p[i])}))),l=pe(m?v[i]:0,i,d),i in v||(v[i]=l.start,m&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?fe.prefilters.unshift(t):fe.prefilters.push(t)}}),S.speed=function(t,e,n){var i=t&&"object"==typeof t?S.extend({},t):{complete:n||!n&&e||g(t)&&t,duration:t,easing:n&&e||e&&!g(e)&&e};return S.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in S.fx.speeds?i.duration=S.fx.speeds[i.duration]:i.duration=S.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){g(i.old)&&i.old.call(this),i.queue&&S.dequeue(this,i.queue)},i},S.fn.extend({fadeTo:function(t,e,n,i){return this.filter(ct).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=S.isEmptyObject(t),s=S.speed(e,n,i),o=function(){var e=fe(this,S.extend({},t),s);(r||$.get(this,"finish"))&&e.stop(!0)};return o.finish=o,r||!1===s.queue?this.each(o):this.queue(s.queue,o)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,r=null!=t&&t+"queueHooks",s=S.timers,o=$.get(this);if(r)o[r]&&o[r].stop&&i(o[r]);else for(r in o)o[r]&&o[r].stop&&ce.test(r)&&i(o[r]);for(r=s.length;r--;)s[r].elem!==this||null!=t&&s[r].queue!==t||(s[r].anim.stop(n),e=!1,s.splice(r,1));!e&&n||S.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,n=$.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],s=S.timers,o=i?i.length:0;for(n.finish=!0,S.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;e<o;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish}))}}),S.each(["toggle","show","hide"],(function(t,e){var n=S.fn[e];S.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(de(e,!0),t,i,r)}})),S.each({slideDown:de("show"),slideUp:de("hide"),slideToggle:de("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){S.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}})),S.timers=[],S.fx.tick=function(){var t,e=0,n=S.timers;for(oe=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||S.fx.stop(),oe=void 0},S.fx.timer=function(t){S.timers.push(t),S.fx.start()},S.fx.interval=13,S.fx.start=function(){ae||(ae=!0,ue())},S.fx.stop=function(){ae=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(t,e){return t=S.fx&&S.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,n){var r=i.setTimeout(e,t);n.stop=function(){i.clearTimeout(r)}}))},function(){var t=y.createElement("input"),e=y.createElement("select").appendChild(y.createElement("option"));t.type="checkbox",v.checkOn=""!==t.value,v.optSelected=e.selected,(t=y.createElement("input")).value="t",t.type="radio",v.radioValue="t"===t.value}();var me,ve=S.expr.attrHandle;S.fn.extend({attr:function(t,e){return G(this,S.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){S.removeAttr(this,t)}))}}),S.extend({attr:function(t,e,n){var i,r,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===t.getAttribute?S.prop(t,e,n):(1===s&&S.isXMLDoc(t)||(r=S.attrHooks[e.toLowerCase()]||(S.expr.match.bool.test(e)?me:void 0)),void 0!==n?null===n?void S.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:null==(i=S.find.attr(t,e))?void 0:i)},attrHooks:{type:{set:function(t,e){if(!v.radioValue&&"radio"===e&&L(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i=0,r=e&&e.match(F);if(r&&1===t.nodeType)for(;n=r[i++];)t.removeAttribute(n)}}),me={set:function(t,e,n){return!1===e?S.removeAttr(t,n):t.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=ve[e]||S.find.attr;ve[e]=function(t,e,i){var r,s,o=e.toLowerCase();return i||(s=ve[o],ve[o]=r,r=null!=n(t,e,i)?o:null,ve[o]=s),r}}));var ge=/^(?:input|select|textarea|button)$/i,xe=/^(?:a|area)$/i;function ye(t){return(t.match(F)||[]).join(" ")}function _e(t){return t.getAttribute&&t.getAttribute("class")||""}function be(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(F)||[]}S.fn.extend({prop:function(t,e){return G(this,S.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[S.propFix[t]||t]}))}}),S.extend({prop:function(t,e,n){var i,r,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&S.isXMLDoc(t)||(e=S.propFix[e]||e,r=S.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=S.find.attr(t,"tabindex");return e?parseInt(e,10):ge.test(t.nodeName)||xe.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),v.optSelected||(S.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){S.propFix[this.toLowerCase()]=this})),S.fn.extend({addClass:function(t){var e,n,i,r,s,o,a,l=0;if(g(t))return this.each((function(e){S(this).addClass(t.call(this,e,_e(this)))}));if((e=be(t)).length)for(;n=this[l++];)if(r=_e(n),i=1===n.nodeType&&" "+ye(r)+" "){for(o=0;s=e[o++];)i.indexOf(" "+s+" ")<0&&(i+=s+" ");r!==(a=ye(i))&&n.setAttribute("class",a)}return this},removeClass:function(t){var e,n,i,r,s,o,a,l=0;if(g(t))return this.each((function(e){S(this).removeClass(t.call(this,e,_e(this)))}));if(!arguments.length)return this.attr("class","");if((e=be(t)).length)for(;n=this[l++];)if(r=_e(n),i=1===n.nodeType&&" "+ye(r)+" "){for(o=0;s=e[o++];)for(;i.indexOf(" "+s+" ")>-1;)i=i.replace(" "+s+" "," ");r!==(a=ye(i))&&n.setAttribute("class",a)}return this},toggleClass:function(t,e){var n=typeof t,i="string"===n||Array.isArray(t);return"boolean"==typeof e&&i?e?this.addClass(t):this.removeClass(t):g(t)?this.each((function(n){S(this).toggleClass(t.call(this,n,_e(this),e),e)})):this.each((function(){var e,r,s,o;if(i)for(r=0,s=S(this),o=be(t);e=o[r++];)s.hasClass(e)?s.removeClass(e):s.addClass(e);else void 0!==t&&"boolean"!==n||((e=_e(this))&&$.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":$.get(this,"__className__")||""))}))},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+ye(_e(n))+" ").indexOf(e)>-1)return!0;return!1}});var we=/\r/g;S.fn.extend({val:function(t){var e,n,i,r=this[0];return arguments.length?(i=g(t),this.each((function(n){var r;1===this.nodeType&&(null==(r=i?t.call(this,n,S(this).val()):t)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=S.map(r,(function(t){return null==t?"":t+""}))),(e=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))}))):r?(e=S.valHooks[r.type]||S.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(we,""):null==n?"":n:void 0}}),S.extend({valHooks:{option:{get:function(t){var e=S.find.attr(t,"value");return null!=e?e:ye(S.text(t))}},select:{get:function(t){var e,n,i,r=t.options,s=t.selectedIndex,o="select-one"===t.type,a=o?null:[],l=o?s+1:r.length;for(i=s<0?l:o?s:0;i<l;i++)if(((n=r[i]).selected||i===s)&&!n.disabled&&(!n.parentNode.disabled||!L(n.parentNode,"optgroup"))){if(e=S(n).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var n,i,r=t.options,s=S.makeArray(e),o=r.length;o--;)((i=r[o]).selected=S.inArray(S.valHooks.option.get(i),s)>-1)&&(n=!0);return n||(t.selectedIndex=-1),s}}}}),S.each(["radio","checkbox"],(function(){S.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=S.inArray(S(t).val(),e)>-1}},v.checkOn||(S.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),v.focusin="onfocusin"in i;var Me=/^(?:focusinfocus|focusoutblur)$/,Se=function(t){t.stopPropagation()};S.extend(S.event,{trigger:function(t,e,n,r){var s,o,a,l,c,u,h,d,f=[n||y],m=p.call(t,"type")?t.type:t,v=p.call(t,"namespace")?t.namespace.split("."):[];if(o=d=a=n=n||y,3!==n.nodeType&&8!==n.nodeType&&!Me.test(m+S.event.triggered)&&(m.indexOf(".")>-1&&(v=m.split("."),m=v.shift(),v.sort()),c=m.indexOf(":")<0&&"on"+m,(t=t[S.expando]?t:new S.Event(m,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=v.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),e=null==e?[t]:S.makeArray(e,[t]),h=S.event.special[m]||{},r||!h.trigger||!1!==h.trigger.apply(n,e))){if(!r&&!h.noBubble&&!x(n)){for(l=h.delegateType||m,Me.test(l+m)||(o=o.parentNode);o;o=o.parentNode)f.push(o),a=o;a===(n.ownerDocument||y)&&f.push(a.defaultView||a.parentWindow||i)}for(s=0;(o=f[s++])&&!t.isPropagationStopped();)d=o,t.type=s>1?l:h.bindType||m,(u=($.get(o,"events")||Object.create(null))[t.type]&&$.get(o,"handle"))&&u.apply(o,e),(u=c&&o[c])&&u.apply&&K(o)&&(t.result=u.apply(o,e),!1===t.result&&t.preventDefault());return t.type=m,r||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(f.pop(),e)||!K(n)||c&&g(n[m])&&!x(n)&&((a=n[c])&&(n[c]=null),S.event.triggered=m,t.isPropagationStopped()&&d.addEventListener(m,Se),n[m](),t.isPropagationStopped()&&d.removeEventListener(m,Se),S.event.triggered=void 0,a&&(n[c]=a)),t.result}},simulate:function(t,e,n){var i=S.extend(new S.Event,n,{type:t,isSimulated:!0});S.event.trigger(i,null,e)}}),S.fn.extend({trigger:function(t,e){return this.each((function(){S.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];if(n)return S.event.trigger(t,e,n,!0)}}),v.focusin||S.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){S.event.simulate(e,t.target,S.event.fix(t))};S.event.special[e]={setup:function(){var i=this.ownerDocument||this.document||this,r=$.access(i,e);r||i.addEventListener(t,n,!0),$.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,r=$.access(i,e)-1;r?$.access(i,e,r):(i.removeEventListener(t,n,!0),$.remove(i,e))}}}));var Ce=i.location,Te={guid:Date.now()},Pe=/\?/;S.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new i.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||S.error("Invalid XML: "+t),e};var Ae=/\[\]$/,Ee=/\r?\n/g,Le=/^(?:submit|button|image|reset|file)$/i,De=/^(?:input|select|textarea|keygen)/i;function ke(t,e,n,i){var r;if(Array.isArray(e))S.each(e,(function(e,r){n||Ae.test(t)?i(t,r):ke(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,n,i)}));else if(n||"object"!==w(e))i(t,e);else for(r in e)ke(t+"["+r+"]",e[r],n,i)}S.param=function(t,e){var n,i=[],r=function(t,e){var n=g(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!S.isPlainObject(t))S.each(t,(function(){r(this.name,this.value)}));else for(n in t)ke(n,t[n],e,r);return i.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=S.prop(this,"elements");return t?S.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!S(this).is(":disabled")&&De.test(this.nodeName)&&!Le.test(t)&&(this.checked||!vt.test(t))})).map((function(t,e){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,(function(t){return{name:e.name,value:t.replace(Ee,"\r\n")}})):{name:e.name,value:n.replace(Ee,"\r\n")}})).get()}});var Re=/%20/g,Ie=/#.*$/,ze=/([?&])_=[^&]*/,Oe=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ne=/^(?:GET|HEAD)$/,Fe=/^\/\//,Be={},Ue={},Ve="*/".concat("*"),He=y.createElement("a");function je(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,s=e.toLowerCase().match(F)||[];if(g(n))for(;i=s[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function We(t,e,n,i){var r={},s=t===Ue;function o(a){var l;return r[a]=!0,S.each(t[a]||[],(function(t,a){var c=a(e,n,i);return"string"!=typeof c||s||r[c]?s?!(l=c):void 0:(e.dataTypes.unshift(c),o(c),!1)})),l}return o(e.dataTypes[0])||!r["*"]&&o("*")}function Ge(t,e){var n,i,r=S.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&S.extend(!0,t,i),t}He.href=Ce.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ce.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ce.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ve,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Ge(Ge(t,S.ajaxSettings),e):Ge(S.ajaxSettings,t)},ajaxPrefilter:je(Be),ajaxTransport:je(Ue),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,r,s,o,a,l,c,u,h,d,p=S.ajaxSetup({},e),f=p.context||p,m=p.context&&(f.nodeType||f.jquery)?S(f):S.event,v=S.Deferred(),g=S.Callbacks("once memory"),x=p.statusCode||{},_={},b={},w="canceled",M={readyState:0,getResponseHeader:function(t){var e;if(c){if(!o)for(o={};e=Oe.exec(s);)o[e[1].toLowerCase()+" "]=(o[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=o[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return c?s:null},setRequestHeader:function(t,e){return null==c&&(t=b[t.toLowerCase()]=b[t.toLowerCase()]||t,_[t]=e),this},overrideMimeType:function(t){return null==c&&(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)M.always(t[M.status]);else for(e in t)x[e]=[x[e],t[e]];return this},abort:function(t){var e=t||w;return n&&n.abort(e),C(0,e),this}};if(v.promise(M),p.url=((t||p.url||Ce.href)+"").replace(Fe,Ce.protocol+"//"),p.type=e.method||e.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(F)||[""],null==p.crossDomain){l=y.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=He.protocol+"//"+He.host!=l.protocol+"//"+l.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=S.param(p.data,p.traditional)),We(Be,p,e,M),c)return M;for(h in(u=S.event&&p.global)&&0==S.active++&&S.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Ne.test(p.type),r=p.url.replace(Ie,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Re,"+")):(d=p.url.slice(r.length),p.data&&(p.processData||"string"==typeof p.data)&&(r+=(Pe.test(r)?"&":"?")+p.data,delete p.data),!1===p.cache&&(r=r.replace(ze,"$1"),d=(Pe.test(r)?"&":"?")+"_="+Te.guid+++d),p.url=r+d),p.ifModified&&(S.lastModified[r]&&M.setRequestHeader("If-Modified-Since",S.lastModified[r]),S.etag[r]&&M.setRequestHeader("If-None-Match",S.etag[r])),(p.data&&p.hasContent&&!1!==p.contentType||e.contentType)&&M.setRequestHeader("Content-Type",p.contentType),M.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Ve+"; q=0.01":""):p.accepts["*"]),p.headers)M.setRequestHeader(h,p.headers[h]);if(p.beforeSend&&(!1===p.beforeSend.call(f,M,p)||c))return M.abort();if(w="abort",g.add(p.complete),M.done(p.success),M.fail(p.error),n=We(Ue,p,e,M)){if(M.readyState=1,u&&m.trigger("ajaxSend",[M,p]),c)return M;p.async&&p.timeout>0&&(a=i.setTimeout((function(){M.abort("timeout")}),p.timeout));try{c=!1,n.send(_,C)}catch(t){if(c)throw t;C(-1,t)}}else C(-1,"No Transport");function C(t,e,o,l){var h,d,y,_,b,w=e;c||(c=!0,a&&i.clearTimeout(a),n=void 0,s=l||"",M.readyState=t>0?4:0,h=t>=200&&t<300||304===t,o&&(_=function(t,e,n){for(var i,r,s,o,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){l.unshift(r);break}if(l[0]in n)s=l[0];else{for(r in n){if(!l[0]||t.converters[r+" "+l[0]]){s=r;break}o||(o=r)}s=s||o}if(s)return s!==l[0]&&l.unshift(s),n[s]}(p,M,o)),!h&&S.inArray("script",p.dataTypes)>-1&&(p.converters["text script"]=function(){}),_=function(t,e,n,i){var r,s,o,a,l,c={},u=t.dataTypes.slice();if(u[1])for(o in t.converters)c[o.toLowerCase()]=t.converters[o];for(s=u.shift();s;)if(t.responseFields[s]&&(n[t.responseFields[s]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=s,s=u.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(!(o=c[l+" "+s]||c["* "+s]))for(r in c)if((a=r.split(" "))[1]===s&&(o=c[l+" "+a[0]]||c["* "+a[0]])){!0===o?o=c[r]:!0!==c[r]&&(s=a[0],u.unshift(a[1]));break}if(!0!==o)if(o&&t.throws)e=o(e);else try{e=o(e)}catch(t){return{state:"parsererror",error:o?t:"No conversion from "+l+" to "+s}}}return{state:"success",data:e}}(p,_,M,h),h?(p.ifModified&&((b=M.getResponseHeader("Last-Modified"))&&(S.lastModified[r]=b),(b=M.getResponseHeader("etag"))&&(S.etag[r]=b)),204===t||"HEAD"===p.type?w="nocontent":304===t?w="notmodified":(w=_.state,d=_.data,h=!(y=_.error))):(y=w,!t&&w||(w="error",t<0&&(t=0))),M.status=t,M.statusText=(e||w)+"",h?v.resolveWith(f,[d,w,M]):v.rejectWith(f,[M,w,y]),M.statusCode(x),x=void 0,u&&m.trigger(h?"ajaxSuccess":"ajaxError",[M,p,h?d:y]),g.fireWith(f,[M,w]),u&&(m.trigger("ajaxComplete",[M,p]),--S.active||S.event.trigger("ajaxStop")))}return M},getJSON:function(t,e,n){return S.get(t,e,n,"json")},getScript:function(t,e){return S.get(t,void 0,e,"script")}}),S.each(["get","post"],(function(t,e){S[e]=function(t,n,i,r){return g(n)&&(r=r||i,i=n,n=void 0),S.ajax(S.extend({url:t,type:e,dataType:r,data:n,success:i},S.isPlainObject(t)&&t))}})),S.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),S._evalUrl=function(t,e,n){return S.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){S.globalEval(t,e,n)}})},S.fn.extend({wrapAll:function(t){var e;return this[0]&&(g(t)&&(t=t.call(this[0])),e=S(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return g(t)?this.each((function(e){S(this).wrapInner(t.call(this,e))})):this.each((function(){var e=S(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)}))},wrap:function(t){var e=g(t);return this.each((function(n){S(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){S(this).replaceWith(this.childNodes)})),this}}),S.expr.pseudos.hidden=function(t){return!S.expr.pseudos.visible(t)},S.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(t){}};var qe={0:200,1223:204},Xe=S.ajaxSettings.xhr();v.cors=!!Xe&&"withCredentials"in Xe,v.ajax=Xe=!!Xe,S.ajaxTransport((function(t){var e,n;if(v.cors||Xe&&!t.crossDomain)return{send:function(r,s){var o,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)a[o]=t.xhrFields[o];for(o in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)a.setRequestHeader(o,r[o]);e=function(t){return function(){e&&(e=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?s(0,"error"):s(a.status,a.statusText):s(qe[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=e(),n=a.onerror=a.ontimeout=e("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&i.setTimeout((function(){e&&n()}))},e=e("abort");try{a.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}})),S.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return S.globalEval(t),t}}}),S.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),S.ajaxTransport("script",(function(t){var e,n;if(t.crossDomain||t.scriptAttrs)return{send:function(i,r){e=S("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),y.head.appendChild(e[0])},abort:function(){n&&n()}}}));var Ze,Ye=[],Ke=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ye.pop()||S.expando+"_"+Te.guid++;return this[t]=!0,t}}),S.ajaxPrefilter("json jsonp",(function(t,e,n){var r,s,o,a=!1!==t.jsonp&&(Ke.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ke.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=g(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Ke,"$1"+r):!1!==t.jsonp&&(t.url+=(Pe.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return o||S.error(r+" was not called"),o[0]},t.dataTypes[0]="json",s=i[r],i[r]=function(){o=arguments},n.always((function(){void 0===s?S(i).removeProp(r):i[r]=s,t[r]&&(t.jsonpCallback=e.jsonpCallback,Ye.push(r)),o&&g(s)&&s(o[0]),o=s=void 0})),"script"})),v.createHTMLDocument=((Ze=y.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ze.childNodes.length),S.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(v.createHTMLDocument?((i=(e=y.implementation.createHTMLDocument("")).createElement("base")).href=y.location.href,e.head.appendChild(i)):e=y),s=!n&&[],(r=D.exec(t))?[e.createElement(r[1])]:(r=Mt([t],e,s),s&&s.length&&S(s).remove(),S.merge([],r.childNodes)));var i,r,s},S.fn.load=function(t,e,n){var i,r,s,o=this,a=t.indexOf(" ");return a>-1&&(i=ye(t.slice(a)),t=t.slice(0,a)),g(e)?(n=e,e=void 0):e&&"object"==typeof e&&(r="POST"),o.length>0&&S.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done((function(t){s=arguments,o.html(i?S("<div>").append(S.parseHTML(t)).find(i):t)})).always(n&&function(t,e){o.each((function(){n.apply(this,s||[t.responseText,e,t])}))}),this},S.expr.pseudos.animated=function(t){return S.grep(S.timers,(function(e){return t===e.elem})).length},S.offset={setOffset:function(t,e,n){var i,r,s,o,a,l,c=S.css(t,"position"),u=S(t),h={};"static"===c&&(t.style.position="relative"),a=u.offset(),s=S.css(t,"top"),l=S.css(t,"left"),("absolute"===c||"fixed"===c)&&(s+l).indexOf("auto")>-1?(o=(i=u.position()).top,r=i.left):(o=parseFloat(s)||0,r=parseFloat(l)||0),g(e)&&(e=e.call(t,n,S.extend({},a))),null!=e.top&&(h.top=e.top-a.top+o),null!=e.left&&(h.left=e.left-a.left+r),"using"in e?e.using.call(t,h):("number"==typeof h.top&&(h.top+="px"),"number"==typeof h.left&&(h.left+="px"),u.css(h))}},S.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){S.offset.setOffset(this,t,e)}));var e,n,i=this[0];return i?i.getClientRects().length?(e=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,i=this[0],r={top:0,left:0};if("fixed"===S.css(i,"position"))e=i.getBoundingClientRect();else{for(e=this.offset(),n=i.ownerDocument,t=i.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===S.css(t,"position");)t=t.parentNode;t&&t!==i&&1===t.nodeType&&((r=S(t).offset()).top+=S.css(t,"borderTopWidth",!0),r.left+=S.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-S.css(i,"marginTop",!0),left:e.left-r.left-S.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===S.css(t,"position");)t=t.offsetParent;return t||ot}))}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var n="pageYOffset"===e;S.fn[t]=function(i){return G(this,(function(t,i,r){var s;if(x(t)?s=t:9===t.nodeType&&(s=t.defaultView),void 0===r)return s?s[e]:t[i];s?s.scrollTo(n?s.pageXOffset:r,n?r:s.pageYOffset):t[i]=r}),t,i,arguments.length)}})),S.each(["top","left"],(function(t,e){S.cssHooks[e]=Xt(v.pixelPosition,(function(t,n){if(n)return n=qt(t,e),Ht.test(n)?S(t).position()[e]+"px":n}))})),S.each({Height:"height",Width:"width"},(function(t,e){S.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,i){S.fn[i]=function(r,s){var o=arguments.length&&(n||"boolean"!=typeof r),a=n||(!0===r||!0===s?"margin":"border");return G(this,(function(e,n,r){var s;return x(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(s=e.documentElement,Math.max(e.body["scroll"+t],s["scroll"+t],e.body["offset"+t],s["offset"+t],s["client"+t])):void 0===r?S.css(e,n,a):S.style(e,n,r,a)}),e,o?r:void 0,o)}}))})),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){S.fn[e]=function(t){return this.on(e,t)}})),S.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){S.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}));var Je=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(t,e){var n,i,r;if("string"==typeof e&&(n=t[e],e=t,t=n),g(t))return i=a.call(arguments,2),(r=function(){return t.apply(e||this,i.concat(a.call(arguments)))}).guid=t.guid=t.guid||S.guid++,r},S.holdReady=function(t){t?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=L,S.isFunction=g,S.isWindow=x,S.camelCase=Y,S.type=w,S.now=Date.now,S.isNumeric=function(t){var e=S.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},S.trim=function(t){return null==t?"":(t+"").replace(Je,"")},void 0===(n=function(){return S}.apply(e,[]))||(t.exports=n);var $e=i.jQuery,Qe=i.$;return S.noConflict=function(t){return i.$===S&&(i.$=Qe),t&&i.jQuery===S&&(i.jQuery=$e),S},void 0===r&&(i.jQuery=i.$=S),S}))},212:function(t,e,n){"use strict";n.d(e,{bGH:function(){return o},DvJ:function(){return Tn},u9r:function(){return on},uWy:function(){return v},SUY:function(){return Bl},Ilk:function(){return yt},cBK:function(){return pl},Xaj:function(){return s},Ox3:function(){return El},ehD:function(){return r},hH6:function(){return hl},a$l:function(){return Je},VzW:function(){return T},ZAu:function(){return Cs},cJO:function(){return Ra},nls:function(){return mo},ejS:function(){return So},wem:function(){return b},aNw:function(){return cl},F5T:function(){return We},ZX$:function(){return lt},Kj0:function(){return Sn},vBJ:function(){return Ge},xoR:function(){return Ba},TyD:function(){return x},ghN:function(){return a},Hy8:function(){return l},iKG:function(){return ni},cPb:function(){return kn},BKK:function(){return qn},_12:function(){return qn},cek:function(){return Pl},woe:function(){return Do},UY4:function(){return To},wk1:function(){return E},iMs:function(){return nc},xsS:function(){return Is},jyz:function(){return Ln},xo$:function(){return za},dpR:function(){return fl},rBU:function(){return Zn},rDY:function(){return En},FM8:function(){return ct},Pa4:function(){return Et},Ltg:function(){return Ct},dd2:function(){return Tt},CP7:function(){return Ds}});const i="137",r=2,s=5,o=100,a=201,l=207,c=301,u=302,h=303,d=304,p=306,f=307,m=1e3,v=1001,g=1002,x=1003,y=1004,_=1005,b=1006,w=1008,M=1009,S=1012,C=1014,T=1015,P=1016,A=1020,E=1023,L=1026,D=1027,k=33776,R=33777,I=33778,z=33779,O=2300,N=2301,F=2302,B=2400,U=2401,V=2402,H=2500,j=3e3,W=3001,G=7680,q=35044,X=35048,Z="300 es",Y=1035;class K{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,i=n.length;e<i;e++)n[e].call(this,t);t.target=null}}}const J=[];for(let t=0;t<256;t++)J[t]=(t<16?"0":"")+t.toString(16);let $=1234567;const Q=Math.PI/180,tt=180/Math.PI;function et(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(J[255&t]+J[t>>8&255]+J[t>>16&255]+J[t>>24&255]+"-"+J[255&e]+J[e>>8&255]+"-"+J[e>>16&15|64]+J[e>>24&255]+"-"+J[63&n|128]+J[n>>8&255]+"-"+J[n>>16&255]+J[n>>24&255]+J[255&i]+J[i>>8&255]+J[i>>16&255]+J[i>>24&255]).toUpperCase()}function nt(t,e,n){return Math.max(e,Math.min(n,t))}function it(t,e){return(t%e+e)%e}function rt(t,e,n){return(1-n)*t+n*e}function st(t){return 0==(t&t-1)&&0!==t}function ot(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function at(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}var lt=Object.freeze({__proto__:null,DEG2RAD:Q,RAD2DEG:tt,generateUUID:et,clamp:nt,euclideanModulo:it,mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},inverseLerp:function(t,e,n){return t!==e?(n-t)/(e-t):0},lerp:rt,damp:function(t,e,n,i){return rt(t,e,1-Math.exp(-n*i))},pingpong:function(t,e=1){return e-Math.abs(it(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&($=t%2147483647),$=16807*$%2147483647,($-1)/2147483646},degToRad:function(t){return t*Q},radToDeg:function(t){return t*tt},isPowerOfTwo:st,ceilPowerOfTwo:ot,floorPowerOfTwo:at,setQuaternionFromProperEuler:function(t,e,n,i,r){const s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((e+i)/2),u=o((e+i)/2),h=s((e-i)/2),d=o((e-i)/2),p=s((i-e)/2),f=o((i-e)/2);switch(r){case"XYX":t.set(a*u,l*h,l*d,a*c);break;case"YZY":t.set(l*d,a*u,l*h,a*c);break;case"ZXZ":t.set(l*h,l*d,a*u,a*c);break;case"XZX":t.set(a*u,l*f,l*p,a*c);break;case"YXY":t.set(l*p,a*u,l*f,a*c);break;case"ZYZ":t.set(l*f,l*p,a*u,a*c)}}});class ct{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,s=this.y-t.y;return this.x=r*n-s*i+t.x,this.y=r*i+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}ct.prototype.isVector2=!0;class ut{constructor(){this.elements=[1,0,0,0,1,0,0,0,1]}set(t,e,n,i,r,s,o,a,l){const c=this.elements;return c[0]=t,c[1]=i,c[2]=o,c[3]=e,c[4]=r,c[5]=a,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,s=n[0],o=n[3],a=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],f=i[0],m=i[3],v=i[6],g=i[1],x=i[4],y=i[7],_=i[2],b=i[5],w=i[8];return r[0]=s*f+o*g+a*_,r[3]=s*m+o*x+a*b,r[6]=s*v+o*y+a*w,r[1]=l*f+c*g+u*_,r[4]=l*m+c*x+u*b,r[7]=l*v+c*y+u*w,r[2]=h*f+d*g+p*_,r[5]=h*m+d*x+p*b,r[8]=h*v+d*y+p*w,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*s*c-e*o*l-n*r*c+n*o*a+i*r*l-i*s*a}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=c*s-o*l,h=o*a-c*r,d=l*r-s*a,p=e*u+n*h+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return t[0]=u*f,t[1]=(i*l-c*n)*f,t[2]=(o*n-i*s)*f,t[3]=h*f,t[4]=(c*e-i*a)*f,t[5]=(i*r-o*e)*f,t[6]=d*f,t[7]=(n*a-l*e)*f,t[8]=(s*e-n*r)*f,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,r,s,o){const a=Math.cos(r),l=Math.sin(r);return this.set(n*a,n*l,-n*(a*s+l*o)+s+t,-i*l,i*a,-i*(-l*s+a*o)+o+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),i=this.elements,r=i[0],s=i[3],o=i[6],a=i[1],l=i[4],c=i[7];return i[0]=e*r+n*a,i[3]=e*s+n*l,i[6]=e*o+n*c,i[1]=-n*r+e*a,i[4]=-n*s+e*l,i[7]=-n*o+e*c,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<9;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}function ht(t){for(let e=t.length-1;e>=0;--e)if(t[e]>65535)return!0;return!1}ut.prototype.isMatrix3=!0;Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function dt(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}const pt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ft={h:0,s:0,l:0},mt={h:0,s:0,l:0};function vt(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function gt(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function xt(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class yt{constructor(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=it(t,1),e=nt(e,0,1),n=nt(n,0,1),0===e)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+e):n+e-n*e,r=2*n-i;this.r=vt(r,i,t+1/3),this.g=vt(r,i,t),this.b=vt(r,i,t-1/3)}return this}setStyle(t){function e(t){void 0!==t&&parseFloat(t)}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const i=n[1],r=n[2];switch(i){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,e(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,e(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r)){const n=parseFloat(t[1])/360,i=parseInt(t[2],10)/100,r=parseInt(t[3],10)/100;return e(t[4]),this.setHSL(n,i,r)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=n[1],e=t.length;if(3===e)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,this;if(6===e)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=pt[t.toLowerCase()];return void 0!==e&&this.setHex(e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=gt(t.r),this.g=gt(t.g),this.b=gt(t.b),this}copyLinearToSRGB(t){return this.r=xt(t.r),this.g=xt(t.g),this.b=xt(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const e=this.r,n=this.g,i=this.b,r=Math.max(e,n,i),s=Math.min(e,n,i);let o,a;const l=(s+r)/2;if(s===r)o=0,a=0;else{const t=r-s;switch(a=l<=.5?t/(r+s):t/(2-r-s),r){case e:o=(n-i)/t+(n<i?6:0);break;case n:o=(i-e)/t+2;break;case i:o=(e-n)/t+4}o/=6}return t.h=o,t.s=a,t.l=l,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,e,n){return this.getHSL(ft),ft.h+=t,ft.s+=e,ft.l+=n,this.setHSL(ft.h,ft.s,ft.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(ft),t.getHSL(mt);const n=rt(ft.h,mt.h,e),i=rt(ft.s,mt.s,e),r=rt(ft.l,mt.l,e);return this.setHSL(n,i,r),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}let _t;yt.NAMES=pt,yt.prototype.isColor=!0,yt.prototype.r=1,yt.prototype.g=1,yt.prototype.b=1;class bt{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===_t&&(_t=dt("canvas")),_t.width=t.width,_t.height=t.height;const n=_t.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=_t}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=dt("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const i=n.getImageData(0,0,t.width,t.height),r=i.data;for(let t=0;t<r.length;t++)r[t]=255*gt(r[t]/255);return n.putImageData(i,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*gt(e[t]/255)):e[t]=gt(e[t]);return{data:e,width:t.width,height:t.height}}return t}}let wt=0;class Mt extends K{constructor(t=Mt.DEFAULT_IMAGE,e=Mt.DEFAULT_MAPPING,n=v,i=v,r=b,s=1008,o=E,a=1009,l=1,c=3e3){super(),Object.defineProperty(this,"id",{value:wt++}),this.uuid=et(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new ct(0,0),this.repeat=new ct(1,1),this.center=new ct(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ut,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const i=this.image;if(void 0===i.uuid&&(i.uuid=et()),!e&&void 0===t.images[i.uuid]){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(St(i[t].image)):e.push(St(i[t]))}else e=St(i);t.images[i.uuid]={uuid:i.uuid,url:e}}n.image=i.uuid}return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case m:t.x=t.x-Math.floor(t.x);break;case v:t.x=t.x<0?0:1;break;case g:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case m:t.y=t.y-Math.floor(t.y);break;case v:t.y=t.y<0?0:1;break;case g:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&this.version++}}function St(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?bt.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:{}}Mt.DEFAULT_IMAGE=void 0,Mt.DEFAULT_MAPPING=300,Mt.prototype.isTexture=!0;class Ct{constructor(t=0,e=0,n=0,i=1){this.x=t,this.y=e,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*e+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*e+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*e+s[7]*n+s[11]*i+s[15]*r,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,i,r;const s=.01,o=.1,a=t.elements,l=a[0],c=a[4],u=a[8],h=a[1],d=a[5],p=a[9],f=a[2],m=a[6],v=a[10];if(Math.abs(c-h)<s&&Math.abs(u-f)<s&&Math.abs(p-m)<s){if(Math.abs(c+h)<o&&Math.abs(u+f)<o&&Math.abs(p+m)<o&&Math.abs(l+d+v-3)<o)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,a=(d+1)/2,g=(v+1)/2,x=(c+h)/4,y=(u+f)/4,_=(p+m)/4;return t>a&&t>g?t<s?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(t),i=x/n,r=y/n):a>g?a<s?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(a),n=x/i,r=_/i):g<s?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(g),n=y/r,i=_/r),this.set(n,i,r,e),this}let g=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(h-c)*(h-c));return Math.abs(g)<.001&&(g=1),this.x=(m-p)/g,this.y=(u-f)/g,this.z=(h-c)/g,this.w=Math.acos((l+d+v-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Ct.prototype.isVector4=!0;class Tt extends K{constructor(t,e,n={}){super(),this.width=t,this.height=e,this.depth=1,this.scissor=new Ct(0,0,t,e),this.scissorTest=!1,this.viewport=new Ct(0,0,t,e),this.texture=new Mt(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:t,height:e,depth:1},this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:b,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}setTexture(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t}setSize(t,e,n=1){this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image=Object.assign({},t.texture.image),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Tt.prototype.isWebGLRenderTarget=!0;(class extends Tt{constructor(t,e,n){super(t,e);const i=this.texture;this.texture=[];for(let t=0;t<n;t++)this.texture[t]=i.clone()}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let i=0,r=this.texture.length;i<r;i++)this.texture[i].image.width=t,this.texture[i].image.height=e,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this.texture.length=0;for(let e=0,n=t.texture.length;e<n;e++)this.texture[e]=t.texture[e].clone();return this}}).prototype.isWebGLMultipleRenderTargets=!0;class Pt extends Tt{constructor(t,e,n={}){super(t,e,n),this.samples=4,this.ignoreDepthForMultisampleCopy=void 0===n.ignoreDepth||n.ignoreDepth,this.useRenderToTexture=void 0!==n.useRenderToTexture&&n.useRenderToTexture,this.useRenderbuffer=!1===this.useRenderToTexture}copy(t){return super.copy.call(this,t),this.samples=t.samples,this.useRenderToTexture=t.useRenderToTexture,this.useRenderbuffer=t.useRenderbuffer,this}}Pt.prototype.isWebGLMultisampleRenderTarget=!0;class At{constructor(t=0,e=0,n=0,i=1){this._x=t,this._y=e,this._z=n,this._w=i}static slerp(t,e,n,i){return n.slerpQuaternions(t,e,i)}static slerpFlat(t,e,n,i,r,s,o){let a=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3];const h=r[s+0],d=r[s+1],p=r[s+2],f=r[s+3];if(0===o)return t[e+0]=a,t[e+1]=l,t[e+2]=c,void(t[e+3]=u);if(1===o)return t[e+0]=h,t[e+1]=d,t[e+2]=p,void(t[e+3]=f);if(u!==f||a!==h||l!==d||c!==p){let t=1-o;const e=a*h+l*d+c*p+u*f,n=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const r=Math.sqrt(i),s=Math.atan2(r,e*n);t=Math.sin(t*s)/r,o=Math.sin(o*s)/r}const r=o*n;if(a=a*t+h*r,l=l*t+d*r,c=c*t+p*r,u=u*t+f*r,t===1-o){const t=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=t,l*=t,c*=t,u*=t}}t[e]=a,t[e+1]=l,t[e+2]=c,t[e+3]=u}static multiplyQuaternionsFlat(t,e,n,i,r,s){const o=n[i],a=n[i+1],l=n[i+2],c=n[i+3],u=r[s],h=r[s+1],d=r[s+2],p=r[s+3];return t[e]=o*p+c*u+a*d-l*h,t[e+1]=a*p+c*h+l*u-o*d,t[e+2]=l*p+c*d+o*h-a*u,t[e+3]=c*p-o*u-a*h-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,i=t._y,r=t._z,s=t._order,o=Math.cos,a=Math.sin,l=o(n/2),c=o(i/2),u=o(r/2),h=a(n/2),d=a(i/2),p=a(r/2);switch(s){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],i=e[4],r=e[8],s=e[1],o=e[5],a=e[9],l=e[2],c=e[6],u=e[10],h=n+o+u;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(c-a)*t,this._y=(r-l)*t,this._z=(s-i)*t}else if(n>o&&n>u){const t=2*Math.sqrt(1+n-o-u);this._w=(c-a)/t,this._x=.25*t,this._y=(i+s)/t,this._z=(r+l)/t}else if(o>u){const t=2*Math.sqrt(1+o-n-u);this._w=(r-l)/t,this._x=(i+s)/t,this._y=.25*t,this._z=(a+c)/t}else{const t=2*Math.sqrt(1+u-n-o);this._w=(s-i)/t,this._x=(r+l)/t,this._y=(a+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(nt(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?this.multiplyQuaternions(t,e):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,i=t._y,r=t._z,s=t._w,o=e._x,a=e._y,l=e._z,c=e._w;return this._x=n*c+s*o+i*l-r*a,this._y=i*c+s*a+r*o-n*l,this._z=r*c+s*l+n*a-i*o,this._w=s*c-n*o-i*a-r*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,i=this._y,r=this._z,s=this._w;let o=s*t._w+n*t._x+i*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;const a=1-o*o;if(a<=Number.EPSILON){const t=1-e;return this._w=t*s+e*this._w,this._x=t*n+e*this._x,this._y=t*i+e*this._y,this._z=t*r+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),u=Math.sin((1-e)*c)/l,h=Math.sin(e*c)/l;return this._w=s*u+this._w*h,this._x=n*u+this._x*h,this._y=i*u+this._y*h,this._z=r*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(i),n*Math.sin(r),n*Math.cos(r),e*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}At.prototype.isQuaternion=!0;class Et{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?this.multiplyVectors(t,e):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return!t||t.isEuler,this.applyQuaternion(Dt.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Dt.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=t.elements,s=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(t){const e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,o=t.z,a=t.w,l=a*e+s*i-o*n,c=a*n+o*e-r*i,u=a*i+r*n-s*e,h=-r*e-s*n-o*i;return this.x=l*a+h*-r+c*-o-u*-s,this.y=c*a+h*-s+u*-r-l*-o,this.z=u*a+h*-o+l*-s-c*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return void 0!==e?this.crossVectors(t,e):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,i=t.y,r=t.z,s=e.x,o=e.y,a=e.z;return this.x=i*a-r*o,this.y=r*s-n*a,this.z=n*o-i*s,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return Lt.copy(this).projectOnVector(t),this.sub(Lt)}reflect(t){return this.sub(Lt.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(nt(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}Et.prototype.isVector3=!0;const Lt=new Et,Dt=new At;class kt{constructor(t=new Et(1/0,1/0,1/0),e=new Et(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.length;a<l;a+=3){const l=t[a],c=t[a+1],u=t[a+2];l<e&&(e=l),c<n&&(n=c),u<i&&(i=u),l>r&&(r=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(e,n,i),this.max.set(r,s,o),this}setFromBufferAttribute(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.count;a<l;a++){const l=t.getX(a),c=t.getY(a),u=t.getZ(a);l<e&&(e=l),c<n&&(n=c),u<i&&(i=u),l>r&&(r=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(e,n,i),this.max.set(r,s,o),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=It.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const n=t.geometry;if(void 0!==n)if(e&&null!=n.attributes&&void 0!==n.attributes.position){const e=n.attributes.position;for(let n=0,i=e.count;n<i;n++)It.fromBufferAttribute(e,n).applyMatrix4(t.matrixWorld),this.expandByPoint(It)}else null===n.boundingBox&&n.computeBoundingBox(),zt.copy(n.boundingBox),zt.applyMatrix4(t.matrixWorld),this.union(zt);const i=t.children;for(let t=0,n=i.length;t<n;t++)this.expandByObject(i[t],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,It),It.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Ht),jt.subVectors(this.max,Ht),Ot.subVectors(t.a,Ht),Nt.subVectors(t.b,Ht),Ft.subVectors(t.c,Ht),Bt.subVectors(Nt,Ot),Ut.subVectors(Ft,Nt),Vt.subVectors(Ot,Ft);let e=[0,-Bt.z,Bt.y,0,-Ut.z,Ut.y,0,-Vt.z,Vt.y,Bt.z,0,-Bt.x,Ut.z,0,-Ut.x,Vt.z,0,-Vt.x,-Bt.y,Bt.x,0,-Ut.y,Ut.x,0,-Vt.y,Vt.x,0];return!!qt(e,Ot,Nt,Ft,jt)&&(e=[1,0,0,0,1,0,0,0,1],!!qt(e,Ot,Nt,Ft,jt)&&(Wt.crossVectors(Bt,Ut),e=[Wt.x,Wt.y,Wt.z],qt(e,Ot,Nt,Ft,jt)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return It.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(It).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(Rt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Rt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Rt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Rt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Rt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Rt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Rt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Rt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Rt)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}kt.prototype.isBox3=!0;const Rt=[new Et,new Et,new Et,new Et,new Et,new Et,new Et,new Et],It=new Et,zt=new kt,Ot=new Et,Nt=new Et,Ft=new Et,Bt=new Et,Ut=new Et,Vt=new Et,Ht=new Et,jt=new Et,Wt=new Et,Gt=new Et;function qt(t,e,n,i,r){for(let s=0,o=t.length-3;s<=o;s+=3){Gt.fromArray(t,s);const o=r.x*Math.abs(Gt.x)+r.y*Math.abs(Gt.y)+r.z*Math.abs(Gt.z),a=e.dot(Gt),l=n.dot(Gt),c=i.dot(Gt);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const Xt=new kt,Zt=new Et,Yt=new Et,Kt=new Et;class Jt{constructor(t=new Et,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):Xt.setFromPoints(t).getCenter(n);let i=0;for(let e=0,r=t.length;e<r;e++)i=Math.max(i,n.distanceToSquared(t[e]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){Kt.subVectors(t,this.center);const e=Kt.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.add(Kt.multiplyScalar(n/t)),this.radius+=n}return this}union(t){return!0===this.center.equals(t.center)?Yt.set(0,0,1).multiplyScalar(t.radius):Yt.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(Zt.copy(t.center).add(Yt)),this.expandByPoint(Zt.copy(t.center).sub(Yt)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const $t=new Et,Qt=new Et,te=new Et,ee=new Et,ne=new Et,ie=new Et,re=new Et;class se{constructor(t=new Et,e=new Et(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,$t)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=$t.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):($t.copy(this.direction).multiplyScalar(e).add(this.origin),$t.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){Qt.copy(t).add(e).multiplyScalar(.5),te.copy(e).sub(t).normalize(),ee.copy(this.origin).sub(Qt);const r=.5*t.distanceTo(e),s=-this.direction.dot(te),o=ee.dot(this.direction),a=-ee.dot(te),l=ee.lengthSq(),c=Math.abs(1-s*s);let u,h,d,p;if(c>0)if(u=s*a-o,h=s*o-a,p=r*c,u>=0)if(h>=-p)if(h<=p){const t=1/c;u*=t,h*=t,d=u*(u+s*h+2*o)+h*(s*u+h+2*a)+l}else h=r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h=-r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h<=-p?(u=Math.max(0,-(-s*r+o)),h=u>0?-r:Math.min(Math.max(-r,-a),r),d=-u*u+h*(h+2*a)+l):h<=p?(u=0,h=Math.min(Math.max(-r,-a),r),d=h*(h+2*a)+l):(u=Math.max(0,-(s*r+o)),h=u>0?r:Math.min(Math.max(-r,-a),r),d=-u*u+h*(h+2*a)+l);else h=s>0?-r:r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy(te).multiplyScalar(h).add(Qt),d}intersectSphere(t,e){$t.subVectors(t.center,this.origin);const n=$t.dot(this.direction),i=$t.dot($t)-n*n,r=t.radius*t.radius;if(i>r)return null;const s=Math.sqrt(r-i),o=n-s,a=n+s;return o<0&&a<0?null:o<0?this.at(a,e):this.at(o,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,i,r,s,o,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,i=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,i=(t.min.x-h.x)*l),c>=0?(r=(t.min.y-h.y)*c,s=(t.max.y-h.y)*c):(r=(t.max.y-h.y)*c,s=(t.min.y-h.y)*c),n>s||r>i?null:((r>n||n!=n)&&(n=r),(s<i||i!=i)&&(i=s),u>=0?(o=(t.min.z-h.z)*u,a=(t.max.z-h.z)*u):(o=(t.max.z-h.z)*u,a=(t.min.z-h.z)*u),n>a||o>i?null:((o>n||n!=n)&&(n=o),(a<i||i!=i)&&(i=a),i<0?null:this.at(n>=0?n:i,e)))}intersectsBox(t){return null!==this.intersectBox(t,$t)}intersectTriangle(t,e,n,i,r){ne.subVectors(e,t),ie.subVectors(n,t),re.crossVectors(ne,ie);let s,o=this.direction.dot(re);if(o>0){if(i)return null;s=1}else{if(!(o<0))return null;s=-1,o=-o}ee.subVectors(this.origin,t);const a=s*this.direction.dot(ie.crossVectors(ee,ie));if(a<0)return null;const l=s*this.direction.dot(ne.cross(ee));if(l<0)return null;if(a+l>o)return null;const c=-s*ee.dot(re);return c<0?null:this.at(c/o,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class oe{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,e,n,i,r,s,o,a,l,c,u,h,d,p,f,m){const v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=i,v[1]=r,v[5]=s,v[9]=o,v[13]=a,v[2]=l,v[6]=c,v[10]=u,v[14]=h,v[3]=d,v[7]=p,v[11]=f,v[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new oe).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,i=1/ae.setFromMatrixColumn(t,0).length(),r=1/ae.setFromMatrixColumn(t,1).length(),s=1/ae.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){!t||t.isEuler;const e=this.elements,n=t.x,i=t.y,r=t.z,s=Math.cos(n),o=Math.sin(n),a=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===t.order){const t=s*c,n=s*u,i=o*c,r=o*u;e[0]=a*c,e[4]=-a*u,e[8]=l,e[1]=n+i*l,e[5]=t-r*l,e[9]=-o*a,e[2]=r-t*l,e[6]=i+n*l,e[10]=s*a}else if("YXZ"===t.order){const t=a*c,n=a*u,i=l*c,r=l*u;e[0]=t+r*o,e[4]=i*o-n,e[8]=s*l,e[1]=s*u,e[5]=s*c,e[9]=-o,e[2]=n*o-i,e[6]=r+t*o,e[10]=s*a}else if("ZXY"===t.order){const t=a*c,n=a*u,i=l*c,r=l*u;e[0]=t-r*o,e[4]=-s*u,e[8]=i+n*o,e[1]=n+i*o,e[5]=s*c,e[9]=r-t*o,e[2]=-s*l,e[6]=o,e[10]=s*a}else if("ZYX"===t.order){const t=s*c,n=s*u,i=o*c,r=o*u;e[0]=a*c,e[4]=i*l-n,e[8]=t*l+r,e[1]=a*u,e[5]=r*l+t,e[9]=n*l-i,e[2]=-l,e[6]=o*a,e[10]=s*a}else if("YZX"===t.order){const t=s*a,n=s*l,i=o*a,r=o*l;e[0]=a*c,e[4]=r-t*u,e[8]=i*u+n,e[1]=u,e[5]=s*c,e[9]=-o*c,e[2]=-l*c,e[6]=n*u+i,e[10]=t-r*u}else if("XZY"===t.order){const t=s*a,n=s*l,i=o*a,r=o*l;e[0]=a*c,e[4]=-u,e[8]=l*c,e[1]=t*u+r,e[5]=s*c,e[9]=n*u-i,e[2]=i*u-n,e[6]=o*c,e[10]=r*u+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(ce,t,ue)}lookAt(t,e,n){const i=this.elements;return pe.subVectors(t,e),0===pe.lengthSq()&&(pe.z=1),pe.normalize(),he.crossVectors(n,pe),0===he.lengthSq()&&(1===Math.abs(n.z)?pe.x+=1e-4:pe.z+=1e-4,pe.normalize(),he.crossVectors(n,pe)),he.normalize(),de.crossVectors(pe,he),i[0]=he.x,i[4]=de.x,i[8]=pe.x,i[1]=he.y,i[5]=de.y,i[9]=pe.y,i[2]=he.z,i[6]=de.z,i[10]=pe.z,this}multiply(t,e){return void 0!==e?this.multiplyMatrices(t,e):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,s=n[0],o=n[4],a=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],v=n[14],g=n[3],x=n[7],y=n[11],_=n[15],b=i[0],w=i[4],M=i[8],S=i[12],C=i[1],T=i[5],P=i[9],A=i[13],E=i[2],L=i[6],D=i[10],k=i[14],R=i[3],I=i[7],z=i[11],O=i[15];return r[0]=s*b+o*C+a*E+l*R,r[4]=s*w+o*T+a*L+l*I,r[8]=s*M+o*P+a*D+l*z,r[12]=s*S+o*A+a*k+l*O,r[1]=c*b+u*C+h*E+d*R,r[5]=c*w+u*T+h*L+d*I,r[9]=c*M+u*P+h*D+d*z,r[13]=c*S+u*A+h*k+d*O,r[2]=p*b+f*C+m*E+v*R,r[6]=p*w+f*T+m*L+v*I,r[10]=p*M+f*P+m*D+v*z,r[14]=p*S+f*A+m*k+v*O,r[3]=g*b+x*C+y*E+_*R,r[7]=g*w+x*T+y*L+_*I,r[11]=g*M+x*P+y*D+_*z,r[15]=g*S+x*A+y*k+_*O,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],s=t[1],o=t[5],a=t[9],l=t[13],c=t[2],u=t[6],h=t[10],d=t[14];return t[3]*(+r*a*u-i*l*u-r*o*h+n*l*h+i*o*d-n*a*d)+t[7]*(+e*a*d-e*l*h+r*s*h-i*s*d+i*l*c-r*a*c)+t[11]*(+e*l*u-e*o*d-r*s*u+n*s*d+r*o*c-n*l*c)+t[15]*(-i*o*c-e*a*u+e*o*h+i*s*u-n*s*h+n*a*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],v=t[15],g=u*m*l-f*h*l+f*a*d-o*m*d-u*a*v+o*h*v,x=p*h*l-c*m*l-p*a*d+s*m*d+c*a*v-s*h*v,y=c*f*l-p*u*l+p*o*d-s*f*d-c*o*v+s*u*v,_=p*u*a-c*f*a-p*o*h+s*f*h+c*o*m-s*u*m,b=e*g+n*x+i*y+r*_;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/b;return t[0]=g*w,t[1]=(f*h*r-u*m*r-f*i*d+n*m*d+u*i*v-n*h*v)*w,t[2]=(o*m*r-f*a*r+f*i*l-n*m*l-o*i*v+n*a*v)*w,t[3]=(u*a*r-o*h*r-u*i*l+n*h*l+o*i*d-n*a*d)*w,t[4]=x*w,t[5]=(c*m*r-p*h*r+p*i*d-e*m*d-c*i*v+e*h*v)*w,t[6]=(p*a*r-s*m*r-p*i*l+e*m*l+s*i*v-e*a*v)*w,t[7]=(s*h*r-c*a*r+c*i*l-e*h*l-s*i*d+e*a*d)*w,t[8]=y*w,t[9]=(p*u*r-c*f*r-p*n*d+e*f*d+c*n*v-e*u*v)*w,t[10]=(s*f*r-p*o*r+p*n*l-e*f*l-s*n*v+e*o*v)*w,t[11]=(c*o*r-s*u*r-c*n*l+e*u*l+s*n*d-e*o*d)*w,t[12]=_*w,t[13]=(c*f*i-p*u*i+p*n*h-e*f*h-c*n*m+e*u*m)*w,t[14]=(p*o*i-s*f*i-p*n*a+e*f*a+s*n*m-e*o*m)*w,t[15]=(s*u*i-c*o*i+c*n*a-e*u*a-s*n*h+e*o*h)*w,this}scale(t){const e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),i=Math.sin(e),r=1-n,s=t.x,o=t.y,a=t.z,l=r*s,c=r*o;return this.set(l*s+n,l*o-i*a,l*a+i*o,0,l*o+i*a,c*o+n,c*a-i*s,0,l*a-i*o,c*a+i*s,r*a*a+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,i,r,s){return this.set(1,n,r,0,t,1,s,0,e,i,1,0,0,0,0,1),this}compose(t,e,n){const i=this.elements,r=e._x,s=e._y,o=e._z,a=e._w,l=r+r,c=s+s,u=o+o,h=r*l,d=r*c,p=r*u,f=s*c,m=s*u,v=o*u,g=a*l,x=a*c,y=a*u,_=n.x,b=n.y,w=n.z;return i[0]=(1-(f+v))*_,i[1]=(d+y)*_,i[2]=(p-x)*_,i[3]=0,i[4]=(d-y)*b,i[5]=(1-(h+v))*b,i[6]=(m+g)*b,i[7]=0,i[8]=(p+x)*w,i[9]=(m-g)*w,i[10]=(1-(h+f))*w,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,n){const i=this.elements;let r=ae.set(i[0],i[1],i[2]).length();const s=ae.set(i[4],i[5],i[6]).length(),o=ae.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],le.copy(this);const a=1/r,l=1/s,c=1/o;return le.elements[0]*=a,le.elements[1]*=a,le.elements[2]*=a,le.elements[4]*=l,le.elements[5]*=l,le.elements[6]*=l,le.elements[8]*=c,le.elements[9]*=c,le.elements[10]*=c,e.setFromRotationMatrix(le),n.x=r,n.y=s,n.z=o,this}makePerspective(t,e,n,i,r,s){const o=this.elements,a=2*r/(e-t),l=2*r/(n-i),c=(e+t)/(e-t),u=(n+i)/(n-i),h=-(s+r)/(s-r),d=-2*s*r/(s-r);return o[0]=a,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,e,n,i,r,s){const o=this.elements,a=1/(e-t),l=1/(n-i),c=1/(s-r),u=(e+t)*a,h=(n+i)*l,d=(s+r)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<16;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}oe.prototype.isMatrix4=!0;const ae=new Et,le=new oe,ce=new Et(0,0,0),ue=new Et(1,1,1),he=new Et,de=new Et,pe=new Et,fe=new oe,me=new At;class ve{constructor(t=0,e=0,n=0,i=ve.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,i=this._order){return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const i=t.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(nt(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-nt(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(nt(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,r));break;case"ZYX":this._y=Math.asin(-nt(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(nt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-nt(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,d),this._y=0)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return fe.makeRotationFromQuaternion(t),this.setFromRotationMatrix(fe,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return me.setFromEuler(this),this.setFromQuaternion(me,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new Et(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}ve.prototype.isEuler=!0,ve.DefaultOrder="XYZ",ve.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class ge{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}}let xe=0;const ye=new Et,_e=new At,be=new oe,we=new Et,Me=new Et,Se=new Et,Ce=new At,Te=new Et(1,0,0),Pe=new Et(0,1,0),Ae=new Et(0,0,1),Ee={type:"added"},Le={type:"removed"};class De extends K{constructor(){super(),Object.defineProperty(this,"id",{value:xe++}),this.uuid=et(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=De.DefaultUp.clone();const t=new Et,e=new ve,n=new At,i=new Et(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new oe},normalMatrix:{value:new ut}}),this.matrix=new oe,this.matrixWorld=new oe,this.matrixAutoUpdate=De.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ge,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return _e.setFromAxisAngle(t,e),this.quaternion.multiply(_e),this}rotateOnWorldAxis(t,e){return _e.setFromAxisAngle(t,e),this.quaternion.premultiply(_e),this}rotateX(t){return this.rotateOnAxis(Te,t)}rotateY(t){return this.rotateOnAxis(Pe,t)}rotateZ(t){return this.rotateOnAxis(Ae,t)}translateOnAxis(t,e){return ye.copy(t).applyQuaternion(this.quaternion),this.position.add(ye.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(Te,t)}translateY(t){return this.translateOnAxis(Pe,t)}translateZ(t){return this.translateOnAxis(Ae,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(be.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?we.copy(t):we.set(t,e,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Me.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?be.lookAt(Me,we,this.up):be.lookAt(we,Me,this.up),this.quaternion.setFromRotationMatrix(be),i&&(be.extractRotation(i.matrixWorld),_e.setFromRotationMatrix(be),this.quaternion.premultiply(_e.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this||t&&t.isObject3D&&(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Ee)),this}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Le)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(Le)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),be.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),be.multiply(t.parent.matrixWorld)),t.applyMatrix4(be),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Me,t,Se),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Me,Ce,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++)t[e].updateWorldMatrix(!1,!0)}}toJSON(t){const e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function r(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,i=n.length;e<i;e++){const i=n[e];r(t.shapes,i)}else r(t.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,i=this.material.length;n<i;n++)e.push(r(t.materials,this.material[n]));i.material=e}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(let e=0;e<this.children.length;e++)i.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];i.animations.push(r(t.animations,n))}}if(e){const e=s(t.geometries),i=s(t.materials),r=s(t.textures),o=s(t.images),a=s(t.shapes),l=s(t.skeletons),c=s(t.animations);e.length>0&&(n.geometries=e),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),o.length>0&&(n.images=o),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c)}return n.object=i,n;function s(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const n=t.children[e];this.add(n.clone())}return this}}De.DefaultUp=new Et(0,1,0),De.DefaultMatrixAutoUpdate=!0,De.prototype.isObject3D=!0;const ke=new Et,Re=new Et,Ie=new Et,ze=new Et,Oe=new Et,Ne=new Et,Fe=new Et,Be=new Et,Ue=new Et,Ve=new Et;class He{constructor(t=new Et,e=new Et,n=new Et){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,i){i.subVectors(n,e),ke.subVectors(t,e),i.cross(ke);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(t,e,n,i,r){ke.subVectors(i,e),Re.subVectors(n,e),Ie.subVectors(t,e);const s=ke.dot(ke),o=ke.dot(Re),a=ke.dot(Ie),l=Re.dot(Re),c=Re.dot(Ie),u=s*l-o*o;if(0===u)return r.set(-2,-1,-1);const h=1/u,d=(l*a-o*c)*h,p=(s*c-o*a)*h;return r.set(1-d-p,p,d)}static containsPoint(t,e,n,i){return this.getBarycoord(t,e,n,i,ze),ze.x>=0&&ze.y>=0&&ze.x+ze.y<=1}static getUV(t,e,n,i,r,s,o,a){return this.getBarycoord(t,e,n,i,ze),a.set(0,0),a.addScaledVector(r,ze.x),a.addScaledVector(s,ze.y),a.addScaledVector(o,ze.z),a}static isFrontFacing(t,e,n,i){return ke.subVectors(n,e),Re.subVectors(t,e),ke.cross(Re).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,n,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return ke.subVectors(this.c,this.b),Re.subVectors(this.a,this.b),.5*ke.cross(Re).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return He.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return He.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,i,r){return He.getUV(t,this.a,this.b,this.c,e,n,i,r)}containsPoint(t){return He.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return He.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,i=this.b,r=this.c;let s,o;Oe.subVectors(i,n),Ne.subVectors(r,n),Be.subVectors(t,n);const a=Oe.dot(Be),l=Ne.dot(Be);if(a<=0&&l<=0)return e.copy(n);Ue.subVectors(t,i);const c=Oe.dot(Ue),u=Ne.dot(Ue);if(c>=0&&u<=c)return e.copy(i);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return s=a/(a-c),e.copy(n).addScaledVector(Oe,s);Ve.subVectors(t,r);const d=Oe.dot(Ve),p=Ne.dot(Ve);if(p>=0&&d<=p)return e.copy(r);const f=d*l-a*p;if(f<=0&&l>=0&&p<=0)return o=l/(l-p),e.copy(n).addScaledVector(Ne,o);const m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return Fe.subVectors(r,i),o=(u-c)/(u-c+(d-p)),e.copy(i).addScaledVector(Fe,o);const v=1/(m+f+h);return s=f*v,o=h*v,e.copy(n).addScaledVector(Oe,s).addScaledVector(Ne,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let je=0;class We extends K{constructor(){super(),Object.defineProperty(this,"id",{value:je++}),this.uuid=et(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=o,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=G,this.stencilZFail=G,this.stencilZPass=G,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n)continue;if("shading"===e){this.flatShading=1===n;continue}const i=this[e];void 0!==i&&(i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n)}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){const e=i(t.textures),r=i(t.images);e.length>0&&(n.textures=e),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let i=0;i!==t;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}We.prototype.isMaterial=!0;class Ge extends We{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new yt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}Ge.prototype.isMeshBasicMaterial=!0;const qe=new Et,Xe=new ct;class Ze{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=q,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(r=new yt),e[n++]=r.r,e[n++]=r.g,e[n++]=r.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(r=new ct),e[n++]=r.x,e[n++]=r.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(r=new Et),e[n++]=r.x,e[n++]=r.y,e[n++]=r.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(r=new Ct),e[n++]=r.x,e[n++]=r.y,e[n++]=r.z,e[n++]=r.w}return this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)Xe.fromBufferAttribute(this,e),Xe.applyMatrix3(t),this.setXY(e,Xe.x,Xe.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)qe.fromBufferAttribute(this,e),qe.applyMatrix3(t),this.setXYZ(e,qe.x,qe.y,qe.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)qe.x=this.getX(e),qe.y=this.getY(e),qe.z=this.getZ(e),qe.applyMatrix4(t),this.setXYZ(e,qe.x,qe.y,qe.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)qe.x=this.getX(e),qe.y=this.getY(e),qe.z=this.getZ(e),qe.applyNormalMatrix(t),this.setXYZ(e,qe.x,qe.y,qe.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)qe.x=this.getX(e),qe.y=this.getY(e),qe.z=this.getZ(e),qe.transformDirection(t),this.setXYZ(e,qe.x,qe.y,qe.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==q&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}}Ze.prototype.isBufferAttribute=!0;class Ye extends Ze{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class Ke extends Ze{constructor(t,e,n){super(new Uint32Array(t),e,n)}}(class extends Ze{constructor(t,e,n){super(new Uint16Array(t),e,n)}}).prototype.isFloat16BufferAttribute=!0;class Je extends Ze{constructor(t,e,n){super(new Float32Array(t),e,n)}}let $e=0;const Qe=new oe,tn=new De,en=new Et,nn=new kt,rn=new kt,sn=new Et;class on extends K{constructor(){super(),Object.defineProperty(this,"id",{value:$e++}),this.uuid=et(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(ht(t)?Ke:Ye)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new ut).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return Qe.makeRotationFromQuaternion(t),this.applyMatrix4(Qe),this}rotateX(t){return Qe.makeRotationX(t),this.applyMatrix4(Qe),this}rotateY(t){return Qe.makeRotationY(t),this.applyMatrix4(Qe),this}rotateZ(t){return Qe.makeRotationZ(t),this.applyMatrix4(Qe),this}translate(t,e,n){return Qe.makeTranslation(t,e,n),this.applyMatrix4(Qe),this}scale(t,e,n){return Qe.makeScale(t,e,n),this.applyMatrix4(Qe),this}lookAt(t){return tn.lookAt(t),tn.updateMatrix(),this.applyMatrix4(tn.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(en).negate(),this.translate(en.x,en.y,en.z),this}setFromPoints(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new Je(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new kt);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)this.boundingBox.set(new Et(-1/0,-1/0,-1/0),new Et(1/0,1/0,1/0));else{if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];nn.setFromBufferAttribute(n),this.morphTargetsRelative?(sn.addVectors(this.boundingBox.min,nn.min),this.boundingBox.expandByPoint(sn),sn.addVectors(this.boundingBox.max,nn.max),this.boundingBox.expandByPoint(sn)):(this.boundingBox.expandByPoint(nn.min),this.boundingBox.expandByPoint(nn.max))}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Jt);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)this.boundingSphere.set(new Et,1/0);else if(t){const n=this.boundingSphere.center;if(nn.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];rn.setFromBufferAttribute(n),this.morphTargetsRelative?(sn.addVectors(nn.min,rn.min),nn.expandByPoint(sn),sn.addVectors(nn.max,rn.max),nn.expandByPoint(sn)):(nn.expandByPoint(rn.min),nn.expandByPoint(rn.max))}nn.getCenter(n);let i=0;for(let e=0,r=t.count;e<r;e++)sn.fromBufferAttribute(t,e),i=Math.max(i,n.distanceToSquared(sn));if(e)for(let r=0,s=e.length;r<s;r++){const s=e[r],o=this.morphTargetsRelative;for(let e=0,r=s.count;e<r;e++)sn.fromBufferAttribute(s,e),o&&(en.fromBufferAttribute(t,e),sn.add(en)),i=Math.max(i,n.distanceToSquared(sn))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return;const n=t.array,i=e.position.array,r=e.normal.array,s=e.uv.array,o=i.length/3;void 0===e.tangent&&this.setAttribute("tangent",new Ze(new Float32Array(4*o),4));const a=e.tangent.array,l=[],c=[];for(let t=0;t<o;t++)l[t]=new Et,c[t]=new Et;const u=new Et,h=new Et,d=new Et,p=new ct,f=new ct,m=new ct,v=new Et,g=new Et;function x(t,e,n){u.fromArray(i,3*t),h.fromArray(i,3*e),d.fromArray(i,3*n),p.fromArray(s,2*t),f.fromArray(s,2*e),m.fromArray(s,2*n),h.sub(u),d.sub(u),f.sub(p),m.sub(p);const r=1/(f.x*m.y-m.x*f.y);isFinite(r)&&(v.copy(h).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(r),g.copy(d).multiplyScalar(f.x).addScaledVector(h,-m.x).multiplyScalar(r),l[t].add(v),l[e].add(v),l[n].add(v),c[t].add(g),c[e].add(g),c[n].add(g))}let y=this.groups;0===y.length&&(y=[{start:0,count:n.length}]);for(let t=0,e=y.length;t<e;++t){const e=y[t],i=e.start;for(let t=i,r=i+e.count;t<r;t+=3)x(n[t+0],n[t+1],n[t+2])}const _=new Et,b=new Et,w=new Et,M=new Et;function S(t){w.fromArray(r,3*t),M.copy(w);const e=l[t];_.copy(e),_.sub(w.multiplyScalar(w.dot(e))).normalize(),b.crossVectors(M,e);const n=b.dot(c[t])<0?-1:1;a[4*t]=_.x,a[4*t+1]=_.y,a[4*t+2]=_.z,a[4*t+3]=n}for(let t=0,e=y.length;t<e;++t){const e=y[t],i=e.start;for(let t=i,r=i+e.count;t<r;t+=3)S(n[t+0]),S(n[t+1]),S(n[t+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new Ze(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const i=new Et,r=new Et,s=new Et,o=new Et,a=new Et,l=new Et,c=new Et,u=new Et;if(t)for(let h=0,d=t.count;h<d;h+=3){const d=t.getX(h+0),p=t.getX(h+1),f=t.getX(h+2);i.fromBufferAttribute(e,d),r.fromBufferAttribute(e,p),s.fromBufferAttribute(e,f),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),o.fromBufferAttribute(n,d),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),o.add(c),a.add(c),l.add(c),n.setXYZ(d,o.x,o.y,o.z),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let t=0,o=e.count;t<o;t+=3)i.fromBufferAttribute(e,t+0),r.fromBufferAttribute(e,t+1),s.fromBufferAttribute(e,t+2),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return;void 0===e&&(e=0);const n=this.attributes;for(const i in n){if(void 0===t.attributes[i])continue;const r=n[i].array,s=t.attributes[i],o=s.array,a=s.itemSize*e,l=Math.min(o.length,r.length-a);for(let t=0,e=a;t<l;t++,e++)r[e]=o[t]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)sn.fromBufferAttribute(t,e),sn.normalize(),t.setXYZ(e,sn.x,sn.y,sn.z)}toNonIndexed(){function t(t,e){const n=t.array,i=t.itemSize,r=t.normalized,s=new n.constructor(e.length*i);let o=0,a=0;for(let r=0,l=e.length;r<l;r++){o=t.isInterleavedBufferAttribute?e[r]*t.data.stride+t.offset:e[r]*i;for(let t=0;t<i;t++)s[a++]=n[o++]}return new Ze(s,i,r)}if(null===this.index)return this;const e=new on,n=this.index.array,i=this.attributes;for(const r in i){const s=t(i[r],n);e.setAttribute(r,s)}const r=this.morphAttributes;for(const i in r){const s=[],o=r[i];for(let e=0,i=o.length;e<i;e++){const i=t(o[e],n);s.push(i)}e.morphAttributes[i]=s}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let t=0,n=s.length;t<n;t++){const n=s[t];e.addGroup(n.start,n.count,n.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const e in n){const i=n[e];t.data.attributes[e]=i.toJSON(t.data)}const i={};let r=!1;for(const e in this.morphAttributes){const n=this.morphAttributes[e],s=[];for(let e=0,i=n.length;e<i;e++){const i=n[e];s.push(i.toJSON(t.data))}s.length>0&&(i[e]=s,r=!0)}r&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return null!==o&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const i=t.attributes;for(const t in i){const n=i[t];this.setAttribute(t,n.clone(e))}const r=t.morphAttributes;for(const t in r){const n=[],i=r[t];for(let t=0,r=i.length;t<r;t++)n.push(i[t].clone(e));this.morphAttributes[t]=n}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let t=0,e=s.length;t<e;t++){const e=s[t];this.addGroup(e.start,e.count,e.materialIndex)}const o=t.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=t.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,void 0!==t.parameters&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}on.prototype.isBufferGeometry=!0;const an=new oe,ln=new se,cn=new Jt,un=new Et,hn=new Et,dn=new Et,pn=new Et,fn=new Et,mn=new Et,vn=new Et,gn=new Et,xn=new Et,yn=new ct,_n=new ct,bn=new ct,wn=new Et,Mn=new Et;class Sn extends De{constructor(t=new on,e=new Ge){super(),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length}}raycast(t,e){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0===i)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),cn.copy(n.boundingSphere),cn.applyMatrix4(r),!1===t.ray.intersectsSphere(cn))return;if(an.copy(r).invert(),ln.copy(t.ray).applyMatrix4(an),null!==n.boundingBox&&!1===ln.intersectsBox(n.boundingBox))return;let s;if(n.isBufferGeometry){const r=n.index,o=n.attributes.position,a=n.morphAttributes.position,l=n.morphTargetsRelative,c=n.attributes.uv,u=n.attributes.uv2,h=n.groups,d=n.drawRange;if(null!==r)if(Array.isArray(i))for(let n=0,p=h.length;n<p;n++){const p=h[n],f=i[p.materialIndex];for(let n=Math.max(p.start,d.start),i=Math.min(r.count,Math.min(p.start+p.count,d.start+d.count));n<i;n+=3){const i=r.getX(n),h=r.getX(n+1),d=r.getX(n+2);s=Cn(this,f,t,ln,o,a,l,c,u,i,h,d),s&&(s.faceIndex=Math.floor(n/3),s.face.materialIndex=p.materialIndex,e.push(s))}}else{for(let n=Math.max(0,d.start),h=Math.min(r.count,d.start+d.count);n<h;n+=3){const h=r.getX(n),d=r.getX(n+1),p=r.getX(n+2);s=Cn(this,i,t,ln,o,a,l,c,u,h,d,p),s&&(s.faceIndex=Math.floor(n/3),e.push(s))}}else if(void 0!==o)if(Array.isArray(i))for(let n=0,r=h.length;n<r;n++){const r=h[n],p=i[r.materialIndex];for(let n=Math.max(r.start,d.start),i=Math.min(o.count,Math.min(r.start+r.count,d.start+d.count));n<i;n+=3){s=Cn(this,p,t,ln,o,a,l,c,u,n,n+1,n+2),s&&(s.faceIndex=Math.floor(n/3),s.face.materialIndex=r.materialIndex,e.push(s))}}else{for(let n=Math.max(0,d.start),r=Math.min(o.count,d.start+d.count);n<r;n+=3){s=Cn(this,i,t,ln,o,a,l,c,u,n,n+1,n+2),s&&(s.faceIndex=Math.floor(n/3),e.push(s))}}}else n.isGeometry}}function Cn(t,e,n,i,s,o,a,l,c,u,h,d){un.fromBufferAttribute(s,u),hn.fromBufferAttribute(s,h),dn.fromBufferAttribute(s,d);const p=t.morphTargetInfluences;if(o&&p){vn.set(0,0,0),gn.set(0,0,0),xn.set(0,0,0);for(let t=0,e=o.length;t<e;t++){const e=p[t],n=o[t];0!==e&&(pn.fromBufferAttribute(n,u),fn.fromBufferAttribute(n,h),mn.fromBufferAttribute(n,d),a?(vn.addScaledVector(pn,e),gn.addScaledVector(fn,e),xn.addScaledVector(mn,e)):(vn.addScaledVector(pn.sub(un),e),gn.addScaledVector(fn.sub(hn),e),xn.addScaledVector(mn.sub(dn),e)))}un.add(vn),hn.add(gn),dn.add(xn)}t.isSkinnedMesh&&(t.boneTransform(u,un),t.boneTransform(h,hn),t.boneTransform(d,dn));const f=function(t,e,n,i,s,o,a,l){let c;if(c=1===e.side?i.intersectTriangle(a,o,s,!0,l):i.intersectTriangle(s,o,a,e.side!==r,l),null===c)return null;Mn.copy(l),Mn.applyMatrix4(t.matrixWorld);const u=n.ray.origin.distanceTo(Mn);return u<n.near||u>n.far?null:{distance:u,point:Mn.clone(),object:t}}(t,e,n,i,un,hn,dn,wn);if(f){l&&(yn.fromBufferAttribute(l,u),_n.fromBufferAttribute(l,h),bn.fromBufferAttribute(l,d),f.uv=He.getUV(wn,un,hn,dn,yn,_n,bn,new ct)),c&&(yn.fromBufferAttribute(c,u),_n.fromBufferAttribute(c,h),bn.fromBufferAttribute(c,d),f.uv2=He.getUV(wn,un,hn,dn,yn,_n,bn,new ct));const t={a:u,b:h,c:d,normal:new Et,materialIndex:0};He.getNormal(un,hn,dn,t.normal),f.face=t}return f}Sn.prototype.isMesh=!0;class Tn extends on{constructor(t=1,e=1,n=1,i=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};const o=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);const a=[],l=[],c=[],u=[];let h=0,d=0;function p(t,e,n,i,r,s,p,f,m,v,g){const x=s/m,y=p/v,_=s/2,b=p/2,w=f/2,M=m+1,S=v+1;let C=0,T=0;const P=new Et;for(let s=0;s<S;s++){const o=s*y-b;for(let a=0;a<M;a++){const h=a*x-_;P[t]=h*i,P[e]=o*r,P[n]=w,l.push(P.x,P.y,P.z),P[t]=0,P[e]=0,P[n]=f>0?1:-1,c.push(P.x,P.y,P.z),u.push(a/m),u.push(1-s/v),C+=1}}for(let t=0;t<v;t++)for(let e=0;e<m;e++){const n=h+e+M*t,i=h+e+M*(t+1),r=h+(e+1)+M*(t+1),s=h+(e+1)+M*t;a.push(n,i,s),a.push(i,r,s),T+=6}o.addGroup(d,T,g),d+=T,h+=C}p("z","y","x",-1,-1,n,e,t,s,r,0),p("z","y","x",1,-1,n,e,-t,s,r,1),p("x","z","y",1,1,t,n,e,i,s,2),p("x","z","y",1,-1,t,n,-e,i,s,3),p("x","y","z",1,-1,t,e,n,i,r,4),p("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(a),this.setAttribute("position",new Je(l,3)),this.setAttribute("normal",new Je(c,3)),this.setAttribute("uv",new Je(u,2))}static fromJSON(t){return new Tn(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Pn(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function An(t){const e={};for(let n=0;n<t.length;n++){const i=Pn(t[n]);for(const t in i)e[t]=i[t]}return e}const En={clone:Pn,merge:An};class Ln extends We{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(t.attributes,this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Pn(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const n in this.uniforms){const i=this.uniforms[n].value;i&&i.isTexture?e.uniforms[n]={type:"t",value:i.toJSON(t).uuid}:i&&i.isColor?e.uniforms[n]={type:"c",value:i.getHex()}:i&&i.isVector2?e.uniforms[n]={type:"v2",value:i.toArray()}:i&&i.isVector3?e.uniforms[n]={type:"v3",value:i.toArray()}:i&&i.isVector4?e.uniforms[n]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?e.uniforms[n]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?e.uniforms[n]={type:"m4",value:i.toArray()}:e.uniforms[n]={value:i}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const t in this.extensions)!0===this.extensions[t]&&(n[t]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}Ln.prototype.isShaderMaterial=!0;class Dn extends De{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new oe,this.projectionMatrix=new oe,this.projectionMatrixInverse=new oe}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}Dn.prototype.isCamera=!0;class kn extends Dn{constructor(t=50,e=1,n=.1,i=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*tt*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*Q*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*tt*Math.atan(Math.tan(.5*Q*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,i,r,s){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*Q*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const t=s.fullWidth,o=s.fullHeight;r+=s.offsetX*i/t,e-=s.offsetY*n/o,i*=s.width/t,n*=s.height/o}const o=this.filmOffset;0!==o&&(r+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}kn.prototype.isPerspectiveCamera=!0;const Rn=90;class In extends De{constructor(t,e,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return;this.renderTarget=n;const i=new kn(Rn,1,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Et(1,0,0)),this.add(i);const r=new kn(Rn,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Et(-1,0,0)),this.add(r);const s=new kn(Rn,1,t,e);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new Et(0,1,0)),this.add(s);const o=new kn(Rn,1,t,e);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new Et(0,-1,0)),this.add(o);const a=new kn(Rn,1,t,e);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new Et(0,0,1)),this.add(a);const l=new kn(Rn,1,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new Et(0,0,-1)),this.add(l)}update(t,e){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[i,r,s,o,a,l]=this.children,c=t.xr.enabled,u=t.getRenderTarget();t.xr.enabled=!1;const h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,i),t.setRenderTarget(n,1),t.render(e,r),t.setRenderTarget(n,2),t.render(e,s),t.setRenderTarget(n,3),t.render(e,o),t.setRenderTarget(n,4),t.render(e,a),n.texture.generateMipmaps=h,t.setRenderTarget(n,5),t.render(e,l),t.setRenderTarget(u),t.xr.enabled=c,n.texture.needsPMREMUpdate=!0}}class zn extends Mt{constructor(t,e,n,i,r,s,o,a,l,u){super(t=void 0!==t?t:[],e=void 0!==e?e:c,n,i,r,s,o,a,l,u),this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}zn.prototype.isCubeTexture=!0;class On extends Tt{constructor(t,e,n){Number.isInteger(e)&&(e=n),super(t,t,e),e=e||{},this.texture=new zn(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:b}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=E,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},i=new Tn(5,5,5),r=new Ln({name:"CubemapFromEquirect",uniforms:Pn(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:1,blending:0});r.uniforms.tEquirect.value=e;const s=new Sn(i,r),o=e.minFilter;e.minFilter===w&&(e.minFilter=b);return new In(1,10,this).update(t,s),e.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,n,i){const r=t.getRenderTarget();for(let r=0;r<6;r++)t.setRenderTarget(this,r),t.clear(e,n,i);t.setRenderTarget(r)}}On.prototype.isWebGLCubeRenderTarget=!0;const Nn=new Et,Fn=new Et,Bn=new ut;class Un{constructor(t=new Et(1,0,0),e=0){this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const i=Nn.subVectors(n,e).cross(Fn.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const n=t.delta(Nn),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const r=-(t.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:e.copy(n).multiplyScalar(r).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||Bn.getNormalMatrix(t),i=this.coplanarPoint(Nn).applyMatrix4(t),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Un.prototype.isPlane=!0;const Vn=new Jt,Hn=new Et;class jn{constructor(t=new Un,e=new Un,n=new Un,i=new Un,r=new Un,s=new Un){this.planes=[t,e,n,i,r,s]}set(t,e,n,i,r,s){const o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(s),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],v=n[13],g=n[14],x=n[15];return e[0].setComponents(o-i,u-a,f-h,x-m).normalize(),e[1].setComponents(o+i,u+a,f+h,x+m).normalize(),e[2].setComponents(o+r,u+l,f+d,x+v).normalize(),e[3].setComponents(o-r,u-l,f-d,x-v).normalize(),e[4].setComponents(o-s,u-c,f-p,x-g).normalize(),e[5].setComponents(o+s,u+c,f+p,x+g).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Vn.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Vn)}intersectsSprite(t){return Vn.center.set(0,0,0),Vn.radius=.7071067811865476,Vn.applyMatrix4(t.matrixWorld),this.intersectsSphere(Vn)}intersectsSphere(t){const e=this.planes,n=t.center,i=-t.radius;for(let t=0;t<6;t++){if(e[t].distanceToPoint(n)<i)return!1}return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const i=e[n];if(Hn.x=i.normal.x>0?t.max.x:t.min.x,Hn.y=i.normal.y>0?t.max.y:t.min.y,Hn.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(Hn)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Wn(){let t=null,e=!1,n=null,i=null;function r(e,s){n(e,s),i=t.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==n&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function Gn(t,e){const n=e.isWebGL2,i=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),i.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const n=i.get(e);n&&(t.deleteBuffer(n.buffer),i.delete(e))},update:function(e,r){if(e.isGLBufferAttribute){const t=i.get(e);return void((!t||t.version<e.version)&&i.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const s=i.get(e);void 0===s?i.set(e,function(e,i){const r=e.array,s=e.usage,o=t.createBuffer();t.bindBuffer(i,o),t.bufferData(i,r,s),e.onUploadCallback();let a=5126;return r instanceof Float32Array?a=5126:r instanceof Float64Array||(r instanceof Uint16Array?e.isFloat16BufferAttribute?n&&(a=5131):a=5123:r instanceof Int16Array?a=5122:r instanceof Uint32Array?a=5125:r instanceof Int32Array?a=5124:r instanceof Int8Array?a=5120:(r instanceof Uint8Array||r instanceof Uint8ClampedArray)&&(a=5121)),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,r)):s.version<e.version&&(!function(e,i,r){const s=i.array,o=i.updateRange;t.bindBuffer(r,e),-1===o.count?t.bufferSubData(r,0,s):(n?t.bufferSubData(r,o.offset*s.BYTES_PER_ELEMENT,s,o.offset,o.count):t.bufferSubData(r,o.offset*s.BYTES_PER_ELEMENT,s.subarray(o.offset,o.offset+o.count)),o.count=-1)}(s.buffer,e,r),s.version=e.version)}}}class qn extends on{constructor(t=1,e=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};const r=t/2,s=e/2,o=Math.floor(n),a=Math.floor(i),l=o+1,c=a+1,u=t/o,h=e/a,d=[],p=[],f=[],m=[];for(let t=0;t<c;t++){const e=t*h-s;for(let n=0;n<l;n++){const i=n*u-r;p.push(i,-e,0),f.push(0,0,1),m.push(n/o),m.push(1-t/a)}}for(let t=0;t<a;t++)for(let e=0;e<o;e++){const n=e+l*t,i=e+l*(t+1),r=e+1+l*(t+1),s=e+1+l*t;d.push(n,i,s),d.push(i,r,s)}this.setIndex(d),this.setAttribute("position",new Je(p,3)),this.setAttribute("normal",new Je(f,3)),this.setAttribute("uv",new Je(m,2))}static fromJSON(t){return new qn(t.width,t.height,t.widthSegments,t.heightSegments)}}const Xn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\treturn texture2D( envMap, uv ).rgb;\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Zn={common:{diffuse:{value:new yt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ut},uv2Transform:{value:new ut},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ct(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new yt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new yt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ut}},sprite:{diffuse:{value:new yt(16777215)},opacity:{value:1},center:{value:new ct(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ut}}},Yn={basic:{uniforms:An([Zn.common,Zn.specularmap,Zn.envmap,Zn.aomap,Zn.lightmap,Zn.fog]),vertexShader:Xn.meshbasic_vert,fragmentShader:Xn.meshbasic_frag},lambert:{uniforms:An([Zn.common,Zn.specularmap,Zn.envmap,Zn.aomap,Zn.lightmap,Zn.emissivemap,Zn.fog,Zn.lights,{emissive:{value:new yt(0)}}]),vertexShader:Xn.meshlambert_vert,fragmentShader:Xn.meshlambert_frag},phong:{uniforms:An([Zn.common,Zn.specularmap,Zn.envmap,Zn.aomap,Zn.lightmap,Zn.emissivemap,Zn.bumpmap,Zn.normalmap,Zn.displacementmap,Zn.fog,Zn.lights,{emissive:{value:new yt(0)},specular:{value:new yt(1118481)},shininess:{value:30}}]),vertexShader:Xn.meshphong_vert,fragmentShader:Xn.meshphong_frag},standard:{uniforms:An([Zn.common,Zn.envmap,Zn.aomap,Zn.lightmap,Zn.emissivemap,Zn.bumpmap,Zn.normalmap,Zn.displacementmap,Zn.roughnessmap,Zn.metalnessmap,Zn.fog,Zn.lights,{emissive:{value:new yt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Xn.meshphysical_vert,fragmentShader:Xn.meshphysical_frag},toon:{uniforms:An([Zn.common,Zn.aomap,Zn.lightmap,Zn.emissivemap,Zn.bumpmap,Zn.normalmap,Zn.displacementmap,Zn.gradientmap,Zn.fog,Zn.lights,{emissive:{value:new yt(0)}}]),vertexShader:Xn.meshtoon_vert,fragmentShader:Xn.meshtoon_frag},matcap:{uniforms:An([Zn.common,Zn.bumpmap,Zn.normalmap,Zn.displacementmap,Zn.fog,{matcap:{value:null}}]),vertexShader:Xn.meshmatcap_vert,fragmentShader:Xn.meshmatcap_frag},points:{uniforms:An([Zn.points,Zn.fog]),vertexShader:Xn.points_vert,fragmentShader:Xn.points_frag},dashed:{uniforms:An([Zn.common,Zn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Xn.linedashed_vert,fragmentShader:Xn.linedashed_frag},depth:{uniforms:An([Zn.common,Zn.displacementmap]),vertexShader:Xn.depth_vert,fragmentShader:Xn.depth_frag},normal:{uniforms:An([Zn.common,Zn.bumpmap,Zn.normalmap,Zn.displacementmap,{opacity:{value:1}}]),vertexShader:Xn.meshnormal_vert,fragmentShader:Xn.meshnormal_frag},sprite:{uniforms:An([Zn.sprite,Zn.fog]),vertexShader:Xn.sprite_vert,fragmentShader:Xn.sprite_frag},background:{uniforms:{uvTransform:{value:new ut},t2D:{value:null}},vertexShader:Xn.background_vert,fragmentShader:Xn.background_frag},cube:{uniforms:An([Zn.envmap,{opacity:{value:1}}]),vertexShader:Xn.cube_vert,fragmentShader:Xn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Xn.equirect_vert,fragmentShader:Xn.equirect_frag},distanceRGBA:{uniforms:An([Zn.common,Zn.displacementmap,{referencePosition:{value:new Et},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Xn.distanceRGBA_vert,fragmentShader:Xn.distanceRGBA_frag},shadow:{uniforms:An([Zn.lights,Zn.fog,{color:{value:new yt(0)},opacity:{value:1}}]),vertexShader:Xn.shadow_vert,fragmentShader:Xn.shadow_frag}};function Kn(t,e,n,i,r,s){const o=new yt(0);let a,l,c=!0===r?0:1,u=null,h=0,d=null;function f(t,e){n.buffers.color.setClear(t.r,t.g,t.b,e,s)}return{getClearColor:function(){return o},setClearColor:function(t,e=1){o.set(t),c=e,f(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(t){c=t,f(o,c)},render:function(n,r){let s=!1,m=!0===r.isScene?r.background:null;m&&m.isTexture&&(m=e.get(m));const v=t.xr,g=v.getSession&&v.getSession();g&&"additive"===g.environmentBlendMode&&(m=null),null===m?f(o,c):m&&m.isColor&&(f(m,1),s=!0),(t.autoClear||s)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),m&&(m.isCubeTexture||m.mapping===p)?(void 0===l&&(l=new Sn(new Tn(1,1,1),new Ln({name:"BackgroundCubeMaterial",uniforms:Pn(Yn.cube.uniforms),vertexShader:Yn.cube.vertexShader,fragmentShader:Yn.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(l)),l.material.uniforms.envMap.value=m,l.material.uniforms.flipEnvMap.value=m.isCubeTexture&&!1===m.isRenderTargetTexture?-1:1,u===m&&h===m.version&&d===t.toneMapping||(l.material.needsUpdate=!0,u=m,h=m.version,d=t.toneMapping),n.unshift(l,l.geometry,l.material,0,0,null)):m&&m.isTexture&&(void 0===a&&(a=new Sn(new qn(2,2),new Ln({name:"BackgroundMaterial",uniforms:Pn(Yn.background.uniforms),vertexShader:Yn.background.vertexShader,fragmentShader:Yn.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(a)),a.material.uniforms.t2D.value=m,!0===m.matrixAutoUpdate&&m.updateMatrix(),a.material.uniforms.uvTransform.value.copy(m.matrix),u===m&&h===m.version&&d===t.toneMapping||(a.material.needsUpdate=!0,u=m,h=m.version,d=t.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null))}}}function Jn(t,e,n,i){const r=t.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=d(null);let c=l;function u(e){return i.isWebGL2?t.bindVertexArray(e):s.bindVertexArrayOES(e)}function h(e){return i.isWebGL2?t.deleteVertexArray(e):s.deleteVertexArrayOES(e)}function d(t){const e=[],n=[],i=[];for(let t=0;t<r;t++)e[t]=0,n[t]=0,i[t]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:i,object:t,attributes:{},index:null}}function p(){const t=c.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function f(t){m(t,0)}function m(n,r){const s=c.newAttributes,o=c.enabledAttributes,a=c.attributeDivisors;if(s[n]=1,0===o[n]&&(t.enableVertexAttribArray(n),o[n]=1),a[n]!==r){(i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),a[n]=r}}function v(){const e=c.newAttributes,n=c.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==e[i]&&(t.disableVertexAttribArray(i),n[i]=0)}function g(e,n,r,s,o,a){!0!==i.isWebGL2||5124!==r&&5125!==r?t.vertexAttribPointer(e,n,r,s,o,a):t.vertexAttribIPointer(e,n,r,o,a)}function x(){y(),c!==l&&(c=l,u(c.object))}function y(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,h,x,y){let _=!1;if(o){const e=function(e,n,r){const o=!0===r.wireframe;let l=a[e.id];void 0===l&&(l={},a[e.id]=l);let c=l[n.id];void 0===c&&(c={},l[n.id]=c);let u=c[o];void 0===u&&(u=d(i.isWebGL2?t.createVertexArray():s.createVertexArrayOES()),c[o]=u);return u}(x,h,l);c!==e&&(c=e,u(c.object)),_=function(t,e){const n=c.attributes,i=t.attributes;let r=0;for(const t in i){const e=n[t],s=i[t];if(void 0===e)return!0;if(e.attribute!==s)return!0;if(e.data!==s.data)return!0;r++}return c.attributesNum!==r||c.index!==e}(x,y),_&&function(t,e){const n={},i=t.attributes;let r=0;for(const t in i){const e=i[t],s={};s.attribute=e,e.data&&(s.data=e.data),n[t]=s,r++}c.attributes=n,c.attributesNum=r,c.index=e}(x,y)}else{const t=!0===l.wireframe;c.geometry===x.id&&c.program===h.id&&c.wireframe===t||(c.geometry=x.id,c.program=h.id,c.wireframe=t,_=!0)}!0===r.isInstancedMesh&&(_=!0),null!==y&&n.update(y,34963),_&&(!function(r,s,o,a){if(!1===i.isWebGL2&&(r.isInstancedMesh||a.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;p();const l=a.attributes,c=o.getAttributes(),u=s.defaultAttributeValues;for(const e in c){const i=c[e];if(i.location>=0){let s=l[e];if(void 0===s&&("instanceMatrix"===e&&r.instanceMatrix&&(s=r.instanceMatrix),"instanceColor"===e&&r.instanceColor&&(s=r.instanceColor)),void 0!==s){const e=s.normalized,o=s.itemSize,l=n.get(s);if(void 0===l)continue;const c=l.buffer,u=l.type,h=l.bytesPerElement;if(s.isInterleavedBufferAttribute){const n=s.data,l=n.stride,d=s.offset;if(n&&n.isInstancedInterleavedBuffer){for(let t=0;t<i.locationSize;t++)m(i.location+t,n.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let t=0;t<i.locationSize;t++)f(i.location+t);t.bindBuffer(34962,c);for(let t=0;t<i.locationSize;t++)g(i.location+t,o/i.locationSize,u,e,l*h,(d+o/i.locationSize*t)*h)}else{if(s.isInstancedBufferAttribute){for(let t=0;t<i.locationSize;t++)m(i.location+t,s.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let t=0;t<i.locationSize;t++)f(i.location+t);t.bindBuffer(34962,c);for(let t=0;t<i.locationSize;t++)g(i.location+t,o/i.locationSize,u,e,o*h,o/i.locationSize*t*h)}}else if(void 0!==u){const n=u[e];if(void 0!==n)switch(n.length){case 2:t.vertexAttrib2fv(i.location,n);break;case 3:t.vertexAttrib3fv(i.location,n);break;case 4:t.vertexAttrib4fv(i.location,n);break;default:t.vertexAttrib1fv(i.location,n)}}}}v()}(r,l,h,x),null!==y&&t.bindBuffer(34963,n.get(y).buffer))},reset:x,resetDefaultState:y,dispose:function(){x();for(const t in a){const e=a[t];for(const t in e){const n=e[t];for(const t in n)h(n[t].object),delete n[t];delete e[t]}delete a[t]}},releaseStatesOfGeometry:function(t){if(void 0===a[t.id])return;const e=a[t.id];for(const t in e){const n=e[t];for(const t in n)h(n[t].object),delete n[t];delete e[t]}delete a[t.id]},releaseStatesOfProgram:function(t){for(const e in a){const n=a[e];if(void 0===n[t.id])continue;const i=n[t.id];for(const t in i)h(i[t].object),delete i[t];delete n[t.id]}},initAttributes:p,enableAttribute:f,disableUnusedAttributes:v}}function $n(t,e,n,i){const r=i.isWebGL2;let s;this.setMode=function(t){s=t},this.render=function(e,i){t.drawArrays(s,e,i),n.update(i,s,1)},this.renderInstances=function(i,o,a){if(0===a)return;let l,c;if(r)l=t,c="drawArraysInstanced";else if(l=e.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return;l[c](s,i,o,a),n.update(o,s,a)}}function Qn(t,e,n){let i;function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const s="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let o=void 0!==n.precision?n.precision:"highp";const a=r(o);a!==o&&(o=a);const l=s||e.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,u=t.getParameter(34930),h=t.getParameter(35660),d=t.getParameter(3379),p=t.getParameter(34076),f=t.getParameter(34921),m=t.getParameter(36347),v=t.getParameter(36348),g=t.getParameter(36349),x=h>0,y=s||e.has("OES_texture_float");return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const n=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:g,vertexTextures:x,floatFragmentTextures:y,floatVertexTextures:x&&y,maxSamples:s?t.getParameter(36183):0}}function ti(t){const e=this;let n=null,i=0,r=!1,s=!1;const o=new Un,a=new ut,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(t,n,i,r){const s=null!==t?t.length:0;let c=null;if(0!==s){if(c=l.value,!0!==r||null===c){const e=i+4*s,r=n.matrixWorldInverse;a.getNormalMatrix(r),(null===c||c.length<e)&&(c=new Float32Array(e));for(let e=0,n=i;e!==s;++e,n+=4)o.copy(t[e]).applyMatrix4(r,a),o.normal.toArray(c,n),c[n+3]=o.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=s,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,s){const o=0!==t.length||e||0!==i||r;return r=e,n=u(t,s,0),i=t.length,o},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,c()},this.setState=function(e,o,a){const h=e.clippingPlanes,d=e.clipIntersection,p=e.clipShadows,f=t.get(e);if(!r||null===h||0===h.length||s&&!p)s?u(null):c();else{const t=s?0:i,e=4*t;let r=f.clippingState||null;l.value=r,r=u(h,o,e,a);for(let t=0;t!==e;++t)r[t]=n[t];f.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function ei(t){let e=new WeakMap;function n(t,e){return e===h?t.mapping=c:e===d&&(t.mapping=u),t}function i(t){const n=t.target;n.removeEventListener("dispose",i);const r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture&&!1===r.isRenderTargetTexture){const s=r.mapping;if(s===h||s===d){if(e.has(r)){return n(e.get(r).texture,r.mapping)}{const s=r.image;if(s&&s.height>0){const o=new On(s.height/2);return o.fromEquirectangularTexture(t,r),e.set(r,o),r.addEventListener("dispose",i),n(o.texture,r.mapping)}return null}}}return r},dispose:function(){e=new WeakMap}}}Yn.physical={uniforms:An([Yn.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ct(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new yt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ct},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new yt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new yt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Xn.meshphysical_vert,fragmentShader:Xn.meshphysical_frag};class ni extends Dn{constructor(t=-1,e=1,n=1,i=-1,r=.1,s=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-t,s=n+t,o=i+e,a=i-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=t*this.view.offsetX,s=r+t*this.view.width,o-=e*this.view.offsetY,a=o-e*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}ni.prototype.isOrthographicCamera=!0;class ii extends Ln{constructor(t){super(t),this.type="RawShaderMaterial"}}ii.prototype.isRawShaderMaterial=!0;const ri=Math.pow(2,8),si=[.125,.215,.35,.446,.526,.582],oi=5+si.length,ai=new ni,{_lodPlanes:li,_sizeLods:ci,_sigmas:ui}=gi(),hi=new yt;let di=null;const pi=(1+Math.sqrt(5))/2,fi=1/pi,mi=[new Et(1,1,1),new Et(-1,1,1),new Et(1,1,-1),new Et(-1,1,-1),new Et(0,pi,fi),new Et(0,pi,-fi),new Et(fi,0,pi),new Et(-fi,0,pi),new Et(pi,fi,0),new Et(-pi,fi,0)];class vi{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=function(t){const e=new Float32Array(t),n=new Et(0,1,0);return new ii({name:"SphericalGaussianBlur",defines:{n:t},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:wi(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(20),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,i=100){di=this._renderer.getRenderTarget();const r=this._allocateTargets();return this._sceneToCubeUV(t,n,i,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=bi(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=_i(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let t=0;t<li.length;t++)li[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(di),t.scissorTest=!1,yi(t,0,0,t.width,t.height)}_fromTexture(t,e){di=this._renderer.getRenderTarget();const n=e||this._allocateTargets(t);return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(t){const e={magFilter:b,minFilter:b,generateMipmaps:!1,type:P,format:E,encoding:j,depthBuffer:!1},n=xi(e);return n.depthBuffer=!t,null===this._pingPongRenderTarget&&(this._pingPongRenderTarget=xi(e)),n}_compileMaterial(t){const e=new Sn(li[0],t);this._renderer.compile(e,ai)}_sceneToCubeUV(t,e,n,i){const r=new kn(90,1,e,n),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(hi),a.toneMapping=0,a.autoClear=!1;const u=new Ge({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),h=new Sn(new Tn,u);let d=!1;const p=t.background;p?p.isColor&&(u.color.copy(p),t.background=null,d=!0):(u.color.copy(hi),d=!0);for(let e=0;e<6;e++){const n=e%3;0===n?(r.up.set(0,s[e],0),r.lookAt(o[e],0,0)):1===n?(r.up.set(0,0,s[e]),r.lookAt(0,o[e],0)):(r.up.set(0,s[e],0),r.lookAt(0,0,o[e])),yi(i,n*ri,e>2?ri:0,ri,ri),a.setRenderTarget(i),d&&a.render(h,r),a.render(t,r)}h.geometry.dispose(),h.material.dispose(),a.toneMapping=c,a.autoClear=l,t.background=p}_textureToCubeUV(t,e){const n=this._renderer,i=t.mapping===c||t.mapping===u;i?(null===this._cubemapShader&&(this._cubemapShader=bi()),this._cubemapShader.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectShader&&(this._equirectShader=_i());const r=i?this._cubemapShader:this._equirectShader,s=new Sn(li[0],r),o=r.uniforms;o.envMap.value=t,i||o.texelSize.value.set(1/t.image.width,1/t.image.height),yi(e,0,0,3*ri,2*ri),n.setRenderTarget(e),n.render(s,ai)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let e=1;e<oi;e++){const n=Math.sqrt(ui[e]*ui[e]-ui[e-1]*ui[e-1]),i=mi[(e-1)%mi.length];this._blur(t,e-1,e,n,i)}e.autoClear=n}_blur(t,e,n,i,r){const s=this._pingPongRenderTarget;this._halfBlur(t,s,e,n,i,"latitudinal",r),this._halfBlur(s,t,n,n,i,"longitudinal",r)}_halfBlur(t,e,n,i,r,s,o){const a=this._renderer,l=this._blurMaterial,c=new Sn(li[i],l),u=l.uniforms,h=ci[n]-1,d=isFinite(r)?Math.PI/(2*h):2*Math.PI/39,p=r/d,f=isFinite(r)?1+Math.floor(3*p):20,m=[];let v=0;for(let t=0;t<20;++t){const e=t/p,n=Math.exp(-e*e/2);m.push(n),0===t?v+=n:t<f&&(v+=2*n)}for(let t=0;t<m.length;t++)m[t]=m[t]/v;u.envMap.value=t.texture,u.samples.value=f,u.weights.value=m,u.latitudinal.value="latitudinal"===s,o&&(u.poleAxis.value=o),u.dTheta.value=d,u.mipInt.value=8-n;const g=ci[i];yi(e,3*Math.max(0,ri-2*g),(0===i?0:2*ri)+2*g*(i>4?i-8+4:0),3*g,2*g),a.setRenderTarget(e),a.render(c,ai)}}function gi(){const t=[],e=[],n=[];let i=8;for(let r=0;r<oi;r++){const s=Math.pow(2,i);e.push(s);let o=1/s;r>4?o=si[r-8+4-1]:0===r&&(o=0),n.push(o);const a=1/(s-1),l=-a/2,c=1+a/2,u=[l,l,c,l,c,c,l,l,c,c,l,c],h=6,d=6,p=3,f=2,m=1,v=new Float32Array(p*d*h),g=new Float32Array(f*d*h),x=new Float32Array(m*d*h);for(let t=0;t<h;t++){const e=t%3*2/3-1,n=t>2?0:-1,i=[e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0];v.set(i,p*d*t),g.set(u,f*d*t);const r=[t,t,t,t,t,t];x.set(r,m*d*t)}const y=new on;y.setAttribute("position",new Ze(v,p)),y.setAttribute("uv",new Ze(g,f)),y.setAttribute("faceIndex",new Ze(x,m)),t.push(y),i>4&&i--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}function xi(t){const e=new Tt(3*ri,3*ri,t);return e.texture.mapping=p,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function yi(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function _i(){const t=new ct(1,1);return new ii({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:t}},vertexShader:wi(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = texture2D ( envMap, uv ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function bi(){return new ii({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:wi(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function wi(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function Mi(t){let e=new WeakMap,n=null;function i(t){const n=t.target;n.removeEventListener("dispose",i);const r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping,o=s===h||s===d,a=s===c||s===u;if(o||a){if(r.isRenderTargetTexture&&!0===r.needsPMREMUpdate){r.needsPMREMUpdate=!1;let i=e.get(r);return null===n&&(n=new vi(t)),i=o?n.fromEquirectangular(r,i):n.fromCubemap(r,i),e.set(r,i),i.texture}if(e.has(r))return e.get(r).texture;{const s=r.image;if(o&&s&&s.height>0||a&&s&&function(t){let e=0;const n=6;for(let i=0;i<n;i++)void 0!==t[i]&&e++;return e===n}(s)){null===n&&(n=new vi(t));const s=o?n.fromEquirectangular(r):n.fromCubemap(r);return e.set(r,s),r.addEventListener("dispose",i),s.texture}return null}}}return r},dispose:function(){e=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function Si(t){const e={};function n(n){if(void 0!==e[n])return e[n];let i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(n)}return e[n]=i,i}return{has:function(t){return null!==n(t)},init:function(t){t.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(t){const e=n(t);return e}}}function Ci(t,e,n,i){const r={},s=new WeakMap;function o(t){const a=t.target;null!==a.index&&e.remove(a.index);for(const t in a.attributes)e.remove(a.attributes[t]);a.removeEventListener("dispose",o),delete r[a.id];const l=s.get(a);l&&(e.remove(l),s.delete(a)),i.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,n.memory.geometries--}function a(t){const n=[],i=t.index,r=t.attributes.position;let o=0;if(null!==i){const t=i.array;o=i.version;for(let e=0,i=t.length;e<i;e+=3){const i=t[e+0],r=t[e+1],s=t[e+2];n.push(i,r,r,s,s,i)}}else{const t=r.array;o=r.version;for(let e=0,i=t.length/3-1;e<i;e+=3){const t=e+0,i=e+1,r=e+2;n.push(t,i,i,r,r,t)}}const a=new(ht(n)?Ke:Ye)(n,1);a.version=o;const l=s.get(t);l&&e.remove(l),s.set(t,a)}return{get:function(t,e){return!0===r[e.id]||(e.addEventListener("dispose",o),r[e.id]=!0,n.memory.geometries++),e},update:function(t){const n=t.attributes;for(const t in n)e.update(n[t],34962);const i=t.morphAttributes;for(const t in i){const n=i[t];for(let t=0,i=n.length;t<i;t++)e.update(n[t],34962)}},getWireframeAttribute:function(t){const e=s.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&a(t)}else a(t);return s.get(t)}}}function Ti(t,e,n,i){const r=i.isWebGL2;let s,o,a;this.setMode=function(t){s=t},this.setIndex=function(t){o=t.type,a=t.bytesPerElement},this.render=function(e,i){t.drawElements(s,i,o,e*a),n.update(i,s,1)},this.renderInstances=function(i,l,c){if(0===c)return;let u,h;if(r)u=t,h="drawElementsInstanced";else if(u=e.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return;u[h](s,l,o,i*a,c),n.update(l,s,c)}}function Pi(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,i){switch(e.calls++,n){case 4:e.triangles+=i*(t/3);break;case 1:e.lines+=i*(t/2);break;case 3:e.lines+=i*(t-1);break;case 2:e.lines+=i*t;break;case 0:e.points+=i*t}}}}class Ai extends Mt{constructor(t=null,e=1,n=1,i=1){super(null),this.image={data:t,width:e,height:n,depth:i},this.magFilter=x,this.minFilter=x,this.wrapR=v,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}function Ei(t,e){return t[0]-e[0]}function Li(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Di(t,e){let n=1;const i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?n=127:i instanceof Int16Array?n=32767:i instanceof Int32Array&&(n=2147483647),t.divideScalar(n)}function ki(t,e,n){const i={},r=new Float32Array(8),s=new WeakMap,o=new Et,a=[];for(let t=0;t<8;t++)a[t]=[t,0];return{update:function(l,c,u,h){const d=l.morphTargetInfluences;if(!0===e.isWebGL2){const i=c.morphAttributes.position.length;let r=s.get(c);if(void 0===r||r.count!==i){void 0!==r&&r.texture.dispose();const t=void 0!==c.morphAttributes.normal,n=c.morphAttributes.position,a=c.morphAttributes.normal||[],l=!0===t?2:1;let u=c.attributes.position.count*l,h=1;u>e.maxTextureSize&&(h=Math.ceil(u/e.maxTextureSize),u=e.maxTextureSize);const d=new Float32Array(u*h*4*i),p=new Ai(d,u,h,i);p.format=E,p.type=T,p.needsUpdate=!0;const f=4*l;for(let e=0;e<i;e++){const i=n[e],r=a[e],s=u*h*4*e;for(let e=0;e<i.count;e++){o.fromBufferAttribute(i,e),!0===i.normalized&&Di(o,i);const n=e*f;d[s+n+0]=o.x,d[s+n+1]=o.y,d[s+n+2]=o.z,d[s+n+3]=0,!0===t&&(o.fromBufferAttribute(r,e),!0===r.normalized&&Di(o,r),d[s+n+4]=o.x,d[s+n+5]=o.y,d[s+n+6]=o.z,d[s+n+7]=0)}}r={count:i,texture:p,size:new ct(u,h)},s.set(c,r),c.addEventListener("dispose",(function t(){p.dispose(),s.delete(c),c.removeEventListener("dispose",t)}))}let a=0;for(let t=0;t<d.length;t++)a+=d[t];const l=c.morphTargetsRelative?1:1-a;h.getUniforms().setValue(t,"morphTargetBaseInfluence",l),h.getUniforms().setValue(t,"morphTargetInfluences",d),h.getUniforms().setValue(t,"morphTargetsTexture",r.texture,n),h.getUniforms().setValue(t,"morphTargetsTextureSize",r.size)}else{const e=void 0===d?0:d.length;let n=i[c.id];if(void 0===n||n.length!==e){n=[];for(let t=0;t<e;t++)n[t]=[t,0];i[c.id]=n}for(let t=0;t<e;t++){const e=n[t];e[0]=t,e[1]=d[t]}n.sort(Li);for(let t=0;t<8;t++)t<e&&n[t][1]?(a[t][0]=n[t][0],a[t][1]=n[t][1]):(a[t][0]=Number.MAX_SAFE_INTEGER,a[t][1]=0);a.sort(Ei);const s=c.morphAttributes.position,o=c.morphAttributes.normal;let l=0;for(let t=0;t<8;t++){const e=a[t],n=e[0],i=e[1];n!==Number.MAX_SAFE_INTEGER&&i?(s&&c.getAttribute("morphTarget"+t)!==s[n]&&c.setAttribute("morphTarget"+t,s[n]),o&&c.getAttribute("morphNormal"+t)!==o[n]&&c.setAttribute("morphNormal"+t,o[n]),r[t]=i,l+=i):(s&&!0===c.hasAttribute("morphTarget"+t)&&c.deleteAttribute("morphTarget"+t),o&&!0===c.hasAttribute("morphNormal"+t)&&c.deleteAttribute("morphNormal"+t),r[t]=0)}const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(t,"morphTargetBaseInfluence",u),h.getUniforms().setValue(t,"morphTargetInfluences",r)}}}}function Ri(t,e,n,i){let r=new WeakMap;function s(t){const e=t.target;e.removeEventListener("dispose",s),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(t){const o=i.render.frame,a=t.geometry,l=e.get(t,a);return r.get(l)!==o&&(e.update(l),r.set(l,o)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",s)&&t.addEventListener("dispose",s),n.update(t.instanceMatrix,34962),null!==t.instanceColor&&n.update(t.instanceColor,34962)),l},dispose:function(){r=new WeakMap}}}Ai.prototype.isDataTexture2DArray=!0;class Ii extends Mt{constructor(t=null,e=1,n=1,i=1){super(null),this.image={data:t,width:e,height:n,depth:i},this.magFilter=x,this.minFilter=x,this.wrapR=v,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Ii.prototype.isDataTexture3D=!0;const zi=new Mt,Oi=new Ai,Ni=new Ii,Fi=new zn,Bi=[],Ui=[],Vi=new Float32Array(16),Hi=new Float32Array(9),ji=new Float32Array(4);function Wi(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=Bi[r];if(void 0===s&&(s=new Float32Array(r),Bi[r]=s),0!==e){i.toArray(s,0);for(let i=1,r=0;i!==e;++i)r+=n,t[i].toArray(s,r)}return s}function Gi(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function qi(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function Xi(t,e){let n=Ui[e];void 0===n&&(n=new Int32Array(e),Ui[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function Zi(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Yi(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Gi(n,e))return;t.uniform2fv(this.addr,e),qi(n,e)}}function Ki(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Gi(n,e))return;t.uniform3fv(this.addr,e),qi(n,e)}}function Ji(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Gi(n,e))return;t.uniform4fv(this.addr,e),qi(n,e)}}function $i(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(Gi(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),qi(n,e)}else{if(Gi(n,i))return;ji.set(i),t.uniformMatrix2fv(this.addr,!1,ji),qi(n,i)}}function Qi(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(Gi(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),qi(n,e)}else{if(Gi(n,i))return;Hi.set(i),t.uniformMatrix3fv(this.addr,!1,Hi),qi(n,i)}}function tr(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(Gi(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),qi(n,e)}else{if(Gi(n,i))return;Vi.set(i),t.uniformMatrix4fv(this.addr,!1,Vi),qi(n,i)}}function er(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function nr(t,e){const n=this.cache;Gi(n,e)||(t.uniform2iv(this.addr,e),qi(n,e))}function ir(t,e){const n=this.cache;Gi(n,e)||(t.uniform3iv(this.addr,e),qi(n,e))}function rr(t,e){const n=this.cache;Gi(n,e)||(t.uniform4iv(this.addr,e),qi(n,e))}function sr(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function or(t,e){const n=this.cache;Gi(n,e)||(t.uniform2uiv(this.addr,e),qi(n,e))}function ar(t,e){const n=this.cache;Gi(n,e)||(t.uniform3uiv(this.addr,e),qi(n,e))}function lr(t,e){const n=this.cache;Gi(n,e)||(t.uniform4uiv(this.addr,e),qi(n,e))}function cr(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.safeSetTexture2D(e||zi,r)}function ur(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||Ni,r)}function hr(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.safeSetTextureCube(e||Fi,r)}function dr(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||Oi,r)}function pr(t,e){t.uniform1fv(this.addr,e)}function fr(t,e){const n=Wi(e,this.size,2);t.uniform2fv(this.addr,n)}function mr(t,e){const n=Wi(e,this.size,3);t.uniform3fv(this.addr,n)}function vr(t,e){const n=Wi(e,this.size,4);t.uniform4fv(this.addr,n)}function gr(t,e){const n=Wi(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function xr(t,e){const n=Wi(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function yr(t,e){const n=Wi(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function _r(t,e){t.uniform1iv(this.addr,e)}function br(t,e){t.uniform2iv(this.addr,e)}function wr(t,e){t.uniform3iv(this.addr,e)}function Mr(t,e){t.uniform4iv(this.addr,e)}function Sr(t,e){t.uniform1uiv(this.addr,e)}function Cr(t,e){t.uniform2uiv(this.addr,e)}function Tr(t,e){t.uniform3uiv(this.addr,e)}function Pr(t,e){t.uniform4uiv(this.addr,e)}function Ar(t,e,n){const i=e.length,r=Xi(n,i);t.uniform1iv(this.addr,r);for(let t=0;t!==i;++t)n.safeSetTexture2D(e[t]||zi,r[t])}function Er(t,e,n){const i=e.length,r=Xi(n,i);t.uniform1iv(this.addr,r);for(let t=0;t!==i;++t)n.setTexture3D(e[t]||Ni,r[t])}function Lr(t,e,n){const i=e.length,r=Xi(n,i);t.uniform1iv(this.addr,r);for(let t=0;t!==i;++t)n.safeSetTextureCube(e[t]||Fi,r[t])}function Dr(t,e,n){const i=e.length,r=Xi(n,i);t.uniform1iv(this.addr,r);for(let t=0;t!==i;++t)n.setTexture2DArray(e[t]||Oi,r[t])}function kr(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return Zi;case 35664:return Yi;case 35665:return Ki;case 35666:return Ji;case 35674:return $i;case 35675:return Qi;case 35676:return tr;case 5124:case 35670:return er;case 35667:case 35671:return nr;case 35668:case 35672:return ir;case 35669:case 35673:return rr;case 5125:return sr;case 36294:return or;case 36295:return ar;case 36296:return lr;case 35678:case 36198:case 36298:case 36306:case 35682:return cr;case 35679:case 36299:case 36307:return ur;case 35680:case 36300:case 36308:case 36293:return hr;case 36289:case 36303:case 36311:case 36292:return dr}}(e.type)}function Rr(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return pr;case 35664:return fr;case 35665:return mr;case 35666:return vr;case 35674:return gr;case 35675:return xr;case 35676:return yr;case 5124:case 35670:return _r;case 35667:case 35671:return br;case 35668:case 35672:return wr;case 35669:case 35673:return Mr;case 5125:return Sr;case 36294:return Cr;case 36295:return Tr;case 36296:return Pr;case 35678:case 36198:case 36298:case 36306:case 35682:return Ar;case 35679:case 36299:case 36307:return Er;case 35680:case 36300:case 36308:case 36293:return Lr;case 36289:case 36303:case 36311:case 36292:return Dr}}(e.type)}function Ir(t){this.id=t,this.seq=[],this.map={}}Rr.prototype.updateCache=function(t){const e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),qi(e,t)},Ir.prototype.setValue=function(t,e,n){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const s=i[r];s.setValue(t,e[s.id],n)}};const zr=/(\w+)(\])?(\[|\.)?/g;function Or(t,e){t.seq.push(e),t.map[e.id]=e}function Nr(t,e,n){const i=t.name,r=i.length;for(zr.lastIndex=0;;){const s=zr.exec(i),o=zr.lastIndex;let a=s[1];const l="]"===s[2],c=s[3];if(l&&(a|=0),void 0===c||"["===c&&o+2===r){Or(n,void 0===c?new kr(a,t,e):new Rr(a,t,e));break}{let t=n.map[a];void 0===t&&(t=new Ir(a),Or(n,t)),n=t}}}function Fr(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,35718);for(let i=0;i<n;++i){const n=t.getActiveUniform(e,i);Nr(n,t.getUniformLocation(e,n.name),this)}}function Br(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}Fr.prototype.setValue=function(t,e,n,i){const r=this.map[e];void 0!==r&&r.setValue(t,n,i)},Fr.prototype.setOptional=function(t,e,n){const i=e[n];void 0!==i&&this.setValue(t,n,i)},Fr.upload=function(t,e,n,i){for(let r=0,s=e.length;r!==s;++r){const s=e[r],o=n[s.id];!1!==o.needsUpdate&&s.setValue(t,o.value,i)}},Fr.seqWithValue=function(t,e){const n=[];for(let i=0,r=t.length;i!==r;++i){const r=t[i];r.id in e&&n.push(r)}return n};let Ur=0;function Vr(t,e,n){const i=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();return i&&""===r?"":n.toUpperCase()+"\n\n"+r+"\n\n"+function(t){const e=t.split("\n");for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}(t.getShaderSource(e))}function Hr(t,e){const n=function(t){switch(t){case j:return["Linear","( value )"];case W:return["sRGB","( value )"];default:return["Linear","( value )"]}}(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function jr(t,e){let n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Wr(t){return""!==t}function Gr(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function qr(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Xr=/^[ \t]*#include +<([\w\d./]+)>/gm;function Zr(t){return t.replace(Xr,Yr)}function Yr(t,e){const n=Xn[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return Zr(n)}const Kr=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Jr=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function $r(t){return t.replace(Jr,ts).replace(Kr,Qr)}function Qr(t,e,n,i){return ts(t,e,n,i)}function ts(t,e,n,i){let r="";for(let t=parseInt(e);t<parseInt(n);t++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+t+" ]").replace(/UNROLLED_LOOP_INDEX/g,t);return r}function es(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function ns(t,e,n,i){const r=t.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=function(t){let e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(n),h=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case c:case u:e="ENVMAP_TYPE_CUBE";break;case p:case f:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),d=function(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case u:case f:e="ENVMAP_MODE_REFRACTION"}return e}(n),m=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(n),v=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Wr).join("\n")}(n),g=function(t){const e=[];for(const n in t){const i=t[n];!1!==i&&e.push("#define "+n+" "+i)}return e.join("\n")}(s),x=r.createProgram();let y,_,b=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(y=[g].filter(Wr).join("\n"),y.length>0&&(y+="\n"),_=[v,g].filter(Wr).join("\n"),_.length>0&&(_+="\n")):(y=[es(n),"#define SHADER_NAME "+n.shaderName,g,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Wr).join("\n"),_=[v,es(n),"#define SHADER_NAME "+n.shaderName,g,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.envMap?"#define "+d:"",n.envMap?"#define "+m:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Xn.tonemapping_pars_fragment:"",0!==n.toneMapping?jr("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.transparent?"":"#define OPAQUE",Xn.encodings_pars_fragment,Hr("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Wr).join("\n")),o=Zr(o),o=Gr(o,n),o=qr(o,n),a=Zr(a),a=Gr(a,n),a=qr(a,n),o=$r(o),a=$r(a),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(b="#version 300 es\n",y=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+y,_=["#define varying in",n.glslVersion===Z?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Z?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const w=b+_+a,M=Br(r,35633,b+y+o),S=Br(r,35632,w);if(r.attachShader(x,M),r.attachShader(x,S),void 0!==n.index0AttributeName?r.bindAttribLocation(x,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(x,0,"position"),r.linkProgram(x),t.debug.checkShaderErrors){const t=r.getProgramInfoLog(x).trim(),e=r.getShaderInfoLog(M).trim(),n=r.getShaderInfoLog(S).trim();let i=!0,s=!0;if(!1===r.getProgramParameter(x,35714)){i=!1;Vr(r,M,"vertex"),Vr(r,S,"fragment")}else""!==t||""!==e&&""!==n||(s=!1);s&&(this.diagnostics={runnable:i,programLog:t,vertexShader:{log:e,prefix:y},fragmentShader:{log:n,prefix:_}})}let C,T;return r.deleteShader(M),r.deleteShader(S),this.getUniforms=function(){return void 0===C&&(C=new Fr(r,x)),C},this.getAttributes=function(){return void 0===T&&(T=function(t,e){const n={},i=t.getProgramParameter(e,35721);for(let r=0;r<i;r++){const i=t.getActiveAttrib(e,r),s=i.name;let o=1;35674===i.type&&(o=2),35675===i.type&&(o=3),35676===i.type&&(o=4),n[s]={type:i.type,location:t.getAttribLocation(e,s),locationSize:o}}return n}(r,x)),T},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(x),this.program=void 0},this.name=n.shaderName,this.id=Ur++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=M,this.fragmentShader=S,this}let is=0;class rs{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,n=t.fragmentShader,i=this._getShaderStage(e),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(t);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const t of e)t.usedTimes--,0===t.usedTimes&&this.shaderCache.delete(t);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;return!1===e.has(t)&&e.set(t,new Set),e.get(t)}_getShaderStage(t){const e=this.shaderCache;if(!1===e.has(t)){const n=new ss;e.set(t,n)}return e.get(t)}}class ss{constructor(){this.id=is++,this.usedTimes=0}}function os(t,e,n,i,s,o,a){const l=new ge,c=new rs,u=[],h=s.isWebGL2,d=s.logarithmicDepthBuffer,m=s.floatVertexTextures,v=s.maxVertexUniforms,g=s.vertexTextures;let x=s.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(o,l,u,_,b){const w=_.fog,M=o.isMeshStandardMaterial?_.environment:null,S=(o.isMeshStandardMaterial?n:e).get(o.envMap||M),C=y[o.type],T=b.isSkinnedMesh?function(t){const e=t.skeleton.bones;if(m)return 1024;{const t=v,n=Math.floor((t-20)/4),i=Math.min(n,e.length);return i<e.length?0:i}}(b):0;let P,A,E,L;if(null!==o.precision&&(x=s.getMaxPrecision(o.precision),o.precision),C){const t=Yn[C];P=t.vertexShader,A=t.fragmentShader}else P=o.vertexShader,A=o.fragmentShader,c.update(o),E=c.getVertexShaderID(o),L=c.getFragmentShaderID(o);const D=t.getRenderTarget(),k=o.alphaTest>0,R=o.clearcoat>0;return{isWebGL2:h,shaderID:C,shaderName:o.type,vertexShader:P,fragmentShader:A,defines:o.defines,customVertexShaderID:E,customFragmentShaderID:L,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:x,instancing:!0===b.isInstancedMesh,instancingColor:!0===b.isInstancedMesh&&null!==b.instanceColor,supportsVertexTextures:g,outputEncoding:null===D?t.outputEncoding:!0===D.isXRRenderTarget?D.texture.encoding:j,map:!!o.map,matcap:!!o.matcap,envMap:!!S,envMapMode:S&&S.mapping,envMapCubeUV:!!S&&(S.mapping===p||S.mapping===f),lightMap:!!o.lightMap,aoMap:!!o.aoMap,emissiveMap:!!o.emissiveMap,bumpMap:!!o.bumpMap,normalMap:!!o.normalMap,objectSpaceNormalMap:1===o.normalMapType,tangentSpaceNormalMap:0===o.normalMapType,decodeVideoTexture:!!o.map&&!0===o.map.isVideoTexture&&o.map.encoding===W,clearcoat:R,clearcoatMap:R&&!!o.clearcoatMap,clearcoatRoughnessMap:R&&!!o.clearcoatRoughnessMap,clearcoatNormalMap:R&&!!o.clearcoatNormalMap,displacementMap:!!o.displacementMap,roughnessMap:!!o.roughnessMap,metalnessMap:!!o.metalnessMap,specularMap:!!o.specularMap,specularIntensityMap:!!o.specularIntensityMap,specularColorMap:!!o.specularColorMap,transparent:o.transparent,alphaMap:!!o.alphaMap,alphaTest:k,gradientMap:!!o.gradientMap,sheen:o.sheen>0,sheenColorMap:!!o.sheenColorMap,sheenRoughnessMap:!!o.sheenRoughnessMap,transmission:o.transmission>0,transmissionMap:!!o.transmissionMap,thicknessMap:!!o.thicknessMap,combine:o.combine,vertexTangents:!!o.normalMap&&!!b.geometry&&!!b.geometry.attributes.tangent,vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!b.geometry&&!!b.geometry.attributes.color&&4===b.geometry.attributes.color.itemSize,vertexUvs:!!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatMap||o.clearcoatRoughnessMap||o.clearcoatNormalMap||o.displacementMap||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularColorMap||o.sheenColorMap||o.sheenRoughnessMap),uvsVertexOnly:!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatNormalMap||o.transmission>0||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularColorMap||o.sheen>0||o.sheenColorMap||o.sheenRoughnessMap||!o.displacementMap),fog:!!w,useFog:o.fog,fogExp2:w&&w.isFogExp2,flatShading:!!o.flatShading,sizeAttenuation:o.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===b.isSkinnedMesh&&T>0,maxBones:T,useVertexTexture:m,morphTargets:!!b.geometry&&!!b.geometry.morphAttributes.position,morphNormals:!!b.geometry&&!!b.geometry.morphAttributes.normal,morphTargetsCount:b.geometry&&b.geometry.morphAttributes.position?b.geometry.morphAttributes.position.length:0,numDirLights:l.directional.length,numPointLights:l.point.length,numSpotLights:l.spot.length,numRectAreaLights:l.rectArea.length,numHemiLights:l.hemi.length,numDirLightShadows:l.directionalShadowMap.length,numPointLightShadows:l.pointShadowMap.length,numSpotLightShadows:l.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:o.dithering,shadowMapEnabled:t.shadowMap.enabled&&u.length>0,shadowMapType:t.shadowMap.type,toneMapping:o.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===r,flipSided:1===o.side,depthPacking:void 0!==o.depthPacking&&o.depthPacking,index0AttributeName:o.index0AttributeName,extensionDerivatives:o.extensions&&o.extensions.derivatives,extensionFragDepth:o.extensions&&o.extensions.fragDepth,extensionDrawBuffers:o.extensions&&o.extensions.drawBuffers,extensionShaderTextureLOD:o.extensions&&o.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||i.has("EXT_shader_texture_lod"),customProgramCacheKey:o.customProgramCacheKey()}},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.customVertexShaderID),n.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(!function(t,e){t.push(e.precision),t.push(e.outputEncoding),t.push(e.envMapMode),t.push(e.combine),t.push(e.vertexUvs),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.maxBones),t.push(e.morphTargetsCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection)}(n,e),function(t,e){l.disableAll(),e.isWebGL2&&l.enable(0);e.supportsVertexTextures&&l.enable(1);e.instancing&&l.enable(2);e.instancingColor&&l.enable(3);e.map&&l.enable(4);e.matcap&&l.enable(5);e.envMap&&l.enable(6);e.envMapCubeUV&&l.enable(7);e.lightMap&&l.enable(8);e.aoMap&&l.enable(9);e.emissiveMap&&l.enable(10);e.bumpMap&&l.enable(11);e.normalMap&&l.enable(12);e.objectSpaceNormalMap&&l.enable(13);e.tangentSpaceNormalMap&&l.enable(14);e.clearcoat&&l.enable(15);e.clearcoatMap&&l.enable(16);e.clearcoatRoughnessMap&&l.enable(17);e.clearcoatNormalMap&&l.enable(18);e.displacementMap&&l.enable(19);e.specularMap&&l.enable(20);e.roughnessMap&&l.enable(21);e.metalnessMap&&l.enable(22);e.gradientMap&&l.enable(23);e.alphaMap&&l.enable(24);e.alphaTest&&l.enable(25);e.vertexColors&&l.enable(26);e.vertexAlphas&&l.enable(27);e.vertexUvs&&l.enable(28);e.vertexTangents&&l.enable(29);e.uvsVertexOnly&&l.enable(30);e.fog&&l.enable(31);t.push(l.mask),l.disableAll(),e.useFog&&l.enable(0);e.flatShading&&l.enable(1);e.logarithmicDepthBuffer&&l.enable(2);e.skinning&&l.enable(3);e.useVertexTexture&&l.enable(4);e.morphTargets&&l.enable(5);e.morphNormals&&l.enable(6);e.premultipliedAlpha&&l.enable(7);e.shadowMapEnabled&&l.enable(8);e.physicallyCorrectLights&&l.enable(9);e.doubleSided&&l.enable(10);e.flipSided&&l.enable(11);e.depthPacking&&l.enable(12);e.dithering&&l.enable(13);e.specularIntensityMap&&l.enable(14);e.specularColorMap&&l.enable(15);e.transmission&&l.enable(16);e.transmissionMap&&l.enable(17);e.thicknessMap&&l.enable(18);e.sheen&&l.enable(19);e.sheenColorMap&&l.enable(20);e.sheenRoughnessMap&&l.enable(21);e.decodeVideoTexture&&l.enable(22);e.transparent&&l.enable(23);t.push(l.mask)}(n,e),n.push(t.outputEncoding)),n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){const e=y[t.type];let n;if(e){const t=Yn[e];n=En.clone(t.uniforms)}else n=t.uniforms;return n},acquireProgram:function(e,n){let i;for(let t=0,e=u.length;t<e;t++){const e=u[t];if(e.cacheKey===n){i=e,++i.usedTimes;break}}return void 0===i&&(i=new ns(t,n,e,o),u.push(i)),i},releaseProgram:function(t){if(0==--t.usedTimes){const e=u.indexOf(t);u[e]=u[u.length-1],u.pop(),t.destroy()}},releaseShaderCache:function(t){c.remove(t)},programs:u,dispose:function(){c.dispose()}}}function as(){let t=new WeakMap;return{get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,i){t.get(e)[n]=i},dispose:function(){t=new WeakMap}}}function ls(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function cs(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function us(){const t=[];let e=0;const n=[],i=[],r=[];function s(n,i,r,s,o,a){let l=t[e];return void 0===l?(l={id:n.id,object:n,geometry:i,material:r,groupOrder:s,renderOrder:n.renderOrder,z:o,group:a},t[e]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=r,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=o,l.group=a),e++,l}return{opaque:n,transmissive:i,transparent:r,init:function(){e=0,n.length=0,i.length=0,r.length=0},push:function(t,e,o,a,l,c){const u=s(t,e,o,a,l,c);o.transmission>0?i.push(u):!0===o.transparent?r.push(u):n.push(u)},unshift:function(t,e,o,a,l,c){const u=s(t,e,o,a,l,c);o.transmission>0?i.unshift(u):!0===o.transparent?r.unshift(u):n.unshift(u)},finish:function(){for(let n=e,i=t.length;n<i;n++){const e=t[n];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}},sort:function(t,e){n.length>1&&n.sort(t||ls),i.length>1&&i.sort(e||cs),r.length>1&&r.sort(e||cs)}}}function hs(){let t=new WeakMap;return{get:function(e,n){let i;return!1===t.has(e)?(i=new us,t.set(e,[i])):n>=t.get(e).length?(i=new us,t.get(e).push(i)):i=t.get(e)[n],i},dispose:function(){t=new WeakMap}}}function ds(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Et,color:new yt};break;case"SpotLight":n={position:new Et,direction:new Et,color:new yt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Et,color:new yt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Et,skyColor:new yt,groundColor:new yt};break;case"RectAreaLight":n={color:new yt,position:new Et,halfWidth:new Et,halfHeight:new Et}}return t[e.id]=n,n}}}let ps=0;function fs(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function ms(t,e){const n=new ds,i=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ct};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ct,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let t=0;t<9;t++)r.probe.push(new Et);const s=new Et,o=new oe,a=new oe;return{setup:function(s,o){let a=0,l=0,c=0;for(let t=0;t<9;t++)r.probe[t].set(0,0,0);let u=0,h=0,d=0,p=0,f=0,m=0,v=0,g=0;s.sort(fs);const x=!0!==o?Math.PI:1;for(let t=0,e=s.length;t<e;t++){const e=s[t],o=e.color,y=e.intensity,_=e.distance,b=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)a+=o.r*y*x,l+=o.g*y*x,c+=o.b*y*x;else if(e.isLightProbe)for(let t=0;t<9;t++)r.probe[t].addScaledVector(e.sh.coefficients[t],y);else if(e.isDirectionalLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*x),e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,r.directionalShadow[u]=n,r.directionalShadowMap[u]=b,r.directionalShadowMatrix[u]=e.shadow.matrix,m++}r.directional[u]=t,u++}else if(e.isSpotLight){const t=n.get(e);if(t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(o).multiplyScalar(y*x),t.distance=_,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,r.spotShadow[d]=n,r.spotShadowMap[d]=b,r.spotShadowMatrix[d]=e.shadow.matrix,g++}r.spot[d]=t,d++}else if(e.isRectAreaLight){const t=n.get(e);t.color.copy(o).multiplyScalar(y),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),r.rectArea[p]=t,p++}else if(e.isPointLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*x),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,n.shadowCameraNear=t.camera.near,n.shadowCameraFar=t.camera.far,r.pointShadow[h]=n,r.pointShadowMap[h]=b,r.pointShadowMatrix[h]=e.shadow.matrix,v++}r.point[h]=t,h++}else if(e.isHemisphereLight){const t=n.get(e);t.skyColor.copy(e.color).multiplyScalar(y*x),t.groundColor.copy(e.groundColor).multiplyScalar(y*x),r.hemi[f]=t,f++}}p>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=Zn.LTC_FLOAT_1,r.rectAreaLTC2=Zn.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")&&(r.rectAreaLTC1=Zn.LTC_HALF_1,r.rectAreaLTC2=Zn.LTC_HALF_2)),r.ambient[0]=a,r.ambient[1]=l,r.ambient[2]=c;const y=r.hash;y.directionalLength===u&&y.pointLength===h&&y.spotLength===d&&y.rectAreaLength===p&&y.hemiLength===f&&y.numDirectionalShadows===m&&y.numPointShadows===v&&y.numSpotShadows===g||(r.directional.length=u,r.spot.length=d,r.rectArea.length=p,r.point.length=h,r.hemi.length=f,r.directionalShadow.length=m,r.directionalShadowMap.length=m,r.pointShadow.length=v,r.pointShadowMap.length=v,r.spotShadow.length=g,r.spotShadowMap.length=g,r.directionalShadowMatrix.length=m,r.pointShadowMatrix.length=v,r.spotShadowMatrix.length=g,y.directionalLength=u,y.pointLength=h,y.spotLength=d,y.rectAreaLength=p,y.hemiLength=f,y.numDirectionalShadows=m,y.numPointShadows=v,y.numSpotShadows=g,r.version=ps++)},setupView:function(t,e){let n=0,i=0,l=0,c=0,u=0;const h=e.matrixWorldInverse;for(let e=0,d=t.length;e<d;e++){const d=t[e];if(d.isDirectionalLight){const t=r.directional[n];t.direction.setFromMatrixPosition(d.matrixWorld),s.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(h),n++}else if(d.isSpotLight){const t=r.spot[l];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(h),t.direction.setFromMatrixPosition(d.matrixWorld),s.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(h),l++}else if(d.isRectAreaLight){const t=r.rectArea[c];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(h),a.identity(),o.copy(d.matrixWorld),o.premultiply(h),a.extractRotation(o),t.halfWidth.set(.5*d.width,0,0),t.halfHeight.set(0,.5*d.height,0),t.halfWidth.applyMatrix4(a),t.halfHeight.applyMatrix4(a),c++}else if(d.isPointLight){const t=r.point[i];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(h),i++}else if(d.isHemisphereLight){const t=r.hemi[u];t.direction.setFromMatrixPosition(d.matrixWorld),t.direction.transformDirection(h),t.direction.normalize(),u++}}},state:r}}function vs(t,e){const n=new ms(t,e),i=[],r=[];return{init:function(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:function(t){n.setup(i,t)},setupLightsView:function(t){n.setupView(i,t)},pushLight:function(t){i.push(t)},pushShadow:function(t){r.push(t)}}}function gs(t,e){let n=new WeakMap;return{get:function(i,r=0){let s;return!1===n.has(i)?(s=new vs(t,e),n.set(i,[s])):r>=n.get(i).length?(s=new vs(t,e),n.get(i).push(s)):s=n.get(i)[r],s},dispose:function(){n=new WeakMap}}}class xs extends We{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}xs.prototype.isMeshDepthMaterial=!0;class ys extends We{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new Et,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}ys.prototype.isMeshDistanceMaterial=!0;function _s(t,e,n){let i=new jn;const s=new ct,o=new ct,a=new Ct,l=new xs({depthPacking:3201}),c=new ys,u={},h=n.maxTextureSize,d={0:1,1:0,2:r},p=new Ln({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ct},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=p.clone();f.defines.HORIZONTAL_PASS=1;const m=new on;m.setAttribute("position",new Ze(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new Sn(m,p),g=this;function y(n,i){const r=e.update(v);p.defines.VSM_SAMPLES!==n.blurSamples&&(p.defines.VSM_SAMPLES=n.blurSamples,f.defines.VSM_SAMPLES=n.blurSamples,p.needsUpdate=!0,f.needsUpdate=!0),p.uniforms.shadow_pass.value=n.map.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(i,null,r,p,v,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(i,null,r,f,v,null)}function _(e,n,i,r,s,o,a){let h=null;const p=!0===r.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(h=void 0!==p?p:!0===r.isPointLight?c:l,t.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length||i.displacementMap&&0!==i.displacementScale||i.alphaMap&&i.alphaTest>0){const t=h.uuid,e=i.uuid;let n=u[t];void 0===n&&(n={},u[t]=n);let r=n[e];void 0===r&&(r=h.clone(),n[e]=r),h=r}return h.visible=i.visible,h.wireframe=i.wireframe,h.side=3===a?null!==i.shadowSide?i.shadowSide:i.side:null!==i.shadowSide?i.shadowSide:d[i.side],h.alphaMap=i.alphaMap,h.alphaTest=i.alphaTest,h.clipShadows=i.clipShadows,h.clippingPlanes=i.clippingPlanes,h.clipIntersection=i.clipIntersection,h.displacementMap=i.displacementMap,h.displacementScale=i.displacementScale,h.displacementBias=i.displacementBias,h.wireframeLinewidth=i.wireframeLinewidth,h.linewidth=i.linewidth,!0===r.isPointLight&&!0===h.isMeshDistanceMaterial&&(h.referencePosition.setFromMatrixPosition(r.matrixWorld),h.nearDistance=s,h.farDistance=o),h}function w(n,r,s,o,a){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===a)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const i=e.update(n),r=n.material;if(Array.isArray(r)){const e=i.groups;for(let l=0,c=e.length;l<c;l++){const c=e[l],u=r[c.materialIndex];if(u&&u.visible){const e=_(n,0,u,o,s.near,s.far,a);t.renderBufferDirect(s,null,i,e,n,c)}}}else if(r.visible){const e=_(n,0,r,o,s.near,s.far,a);t.renderBufferDirect(s,null,i,e,n,null)}}const l=n.children;for(let t=0,e=l.length;t<e;t++)w(l[t],r,s,o,a)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(e,n,r){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),c=t.getActiveCubeFace(),u=t.getActiveMipmapLevel(),d=t.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let l=0,c=e.length;l<c;l++){const c=e[l],u=c.shadow;if(void 0===u)continue;if(!1===u.autoUpdate&&!1===u.needsUpdate)continue;s.copy(u.mapSize);const p=u.getFrameExtents();if(s.multiply(p),o.copy(u.mapSize),(s.x>h||s.y>h)&&(s.x>h&&(o.x=Math.floor(h/p.x),s.x=o.x*p.x,u.mapSize.x=o.x),s.y>h&&(o.y=Math.floor(h/p.y),s.y=o.y*p.y,u.mapSize.y=o.y)),null===u.map&&!u.isPointLightShadow&&3===this.type){const t={minFilter:b,magFilter:b,format:E};u.map=new Tt(s.x,s.y,t),u.map.texture.name=c.name+".shadowMap",u.mapPass=new Tt(s.x,s.y,t),u.camera.updateProjectionMatrix()}if(null===u.map){const t={minFilter:x,magFilter:x,format:E};u.map=new Tt(s.x,s.y,t),u.map.texture.name=c.name+".shadowMap",u.camera.updateProjectionMatrix()}t.setRenderTarget(u.map),t.clear();const f=u.getViewportCount();for(let t=0;t<f;t++){const e=u.getViewport(t);a.set(o.x*e.x,o.y*e.y,o.x*e.z,o.y*e.w),d.viewport(a),u.updateMatrices(c,t),i=u.getFrustum(),w(n,r,u.camera,c,this.type)}u.isPointLightShadow||3!==this.type||y(u,r),u.needsUpdate=!1}g.needsUpdate=!1,t.setRenderTarget(l,c,u)}}function bs(t,e,n){const i=n.isWebGL2;const c=new function(){let e=!1;const n=new Ct;let i=null;const r=new Ct(0,0,0,0);return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,s,o,a){!0===a&&(e*=o,i*=o,s*=o),n.set(e,i,s,o),!1===r.equals(n)&&(t.clearColor(e,i,s,o),r.copy(n))},reset:function(){e=!1,i=null,r.set(-1,0,0,0)}}},u=new function(){let e=!1,n=null,i=null,r=null;return{setTest:function(t){t?j(2929):W(2929)},setMask:function(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function(e){if(i!==e){if(e)switch(e){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);i=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,n=null,i=null,r=null}}},h=new function(){let e=!1,n=null,i=null,r=null,s=null,o=null,a=null,l=null,c=null;return{setTest:function(t){e||(t?j(2960):W(2960))},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,o){i===e&&r===n&&s===o||(t.stencilFunc(e,n,o),i=e,r=n,s=o)},setOp:function(e,n,i){o===e&&a===n&&l===i||(t.stencilOp(e,n,i),o=e,a=n,l=i)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,i=null,r=null,s=null,o=null,a=null,l=null,c=null}}};let d={},p={},f=new WeakMap,m=[],v=null,g=!1,x=null,y=null,_=null,b=null,w=null,M=null,S=null,C=!1,T=null,P=null,A=null,E=null,L=null;const D=t.getParameter(35661);let k=!1,R=0;const I=t.getParameter(7938);-1!==I.indexOf("WebGL")?(R=parseFloat(/^WebGL (\d)/.exec(I)[1]),k=R>=1):-1!==I.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL ES (\d)/.exec(I)[1]),k=R>=2);let z=null,O={};const N=t.getParameter(3088),F=t.getParameter(2978),B=(new Ct).fromArray(N),U=(new Ct).fromArray(F);function V(e,n,i){const r=new Uint8Array(4),s=t.createTexture();t.bindTexture(e,s),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(let e=0;e<i;e++)t.texImage2D(n+e,0,6408,1,1,0,6408,5121,r);return s}const H={};function j(e){!0!==d[e]&&(t.enable(e),d[e]=!0)}function W(e){!1!==d[e]&&(t.disable(e),d[e]=!1)}H[3553]=V(3553,3553,1),H[34067]=V(34067,34069,6),c.setClear(0,0,0,1),u.setClear(1),h.setClear(0),j(2929),u.setFunc(3),Z(!1),Y(1),j(2884),X(0);const G={[o]:32774,101:32778,102:32779};if(i)G[103]=32775,G[104]=32776;else{const t=e.get("EXT_blend_minmax");null!==t&&(G[103]=t.MIN_EXT,G[104]=t.MAX_EXT)}const q={200:0,[a]:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,[l]:773};function X(e,n,i,r,a,l,c,u){if(0!==e){if(!1===g&&(j(3042),g=!0),e===s)a=a||n,l=l||i,c=c||r,n===y&&a===w||(t.blendEquationSeparate(G[n],G[a]),y=n,w=a),i===_&&r===b&&l===M&&c===S||(t.blendFuncSeparate(q[i],q[r],q[l],q[c]),_=i,b=r,M=l,S=c),x=e,C=null;else if(e!==x||u!==C){if(y===o&&w===o||(t.blendEquation(32774),y=o,w=o),u)switch(e){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,769,0,1);break;case 4:t.blendFuncSeparate(0,768,0,770)}else switch(e){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFuncSeparate(0,769,0,1);break;case 4:t.blendFunc(0,768)}_=null,b=null,M=null,S=null,x=e,C=u}}else!0===g&&(W(3042),g=!1)}function Z(e){T!==e&&(e?t.frontFace(2304):t.frontFace(2305),T=e)}function Y(e){0!==e?(j(2884),e!==P&&(1===e?t.cullFace(1029):2===e?t.cullFace(1028):t.cullFace(1032))):W(2884),P=e}function K(e,n,i){e?(j(32823),E===n&&L===i||(t.polygonOffset(n,i),E=n,L=i)):W(32823)}function J(e){void 0===e&&(e=33984+D-1),z!==e&&(t.activeTexture(e),z=e)}return{buffers:{color:c,depth:u,stencil:h},enable:j,disable:W,bindFramebuffer:function(e,n){return p[e]!==n&&(t.bindFramebuffer(e,n),p[e]=n,i&&(36009===e&&(p[36160]=n),36160===e&&(p[36009]=n)),!0)},drawBuffers:function(i,r){let s=m,o=!1;if(i)if(s=f.get(r),void 0===s&&(s=[],f.set(r,s)),i.isWebGLMultipleRenderTargets){const t=i.texture;if(s.length!==t.length||36064!==s[0]){for(let e=0,n=t.length;e<n;e++)s[e]=36064+e;s.length=t.length,o=!0}}else 36064!==s[0]&&(s[0]=36064,o=!0);else 1029!==s[0]&&(s[0]=1029,o=!0);o&&(n.isWebGL2?t.drawBuffers(s):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(s))},useProgram:function(e){return v!==e&&(t.useProgram(e),v=e,!0)},setBlending:X,setMaterial:function(t,e){t.side===r?W(2884):j(2884);let n=1===t.side;e&&(n=!n),Z(n),1===t.blending&&!1===t.transparent?X(0):X(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),u.setFunc(t.depthFunc),u.setTest(t.depthTest),u.setMask(t.depthWrite),c.setMask(t.colorWrite);const i=t.stencilWrite;h.setTest(i),i&&(h.setMask(t.stencilWriteMask),h.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),h.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),K(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?j(32926):W(32926)},setFlipSided:Z,setCullFace:Y,setLineWidth:function(e){e!==A&&(k&&t.lineWidth(e),A=e)},setPolygonOffset:K,setScissorTest:function(t){t?j(3089):W(3089)},activeTexture:J,bindTexture:function(e,n){null===z&&J();let i=O[z];void 0===i&&(i={type:void 0,texture:void 0},O[z]=i),i.type===e&&i.texture===n||(t.bindTexture(e,n||H[e]),i.type=e,i.texture=n)},unbindTexture:function(){const e=O[z];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){}},texStorage2D:function(){try{t.texStorage2D.apply(t,arguments)}catch(t){}},texStorage3D:function(){try{t.texStorage3D.apply(t,arguments)}catch(t){}},texSubImage2D:function(){try{t.texSubImage2D.apply(t,arguments)}catch(t){}},texSubImage3D:function(){try{t.texSubImage3D.apply(t,arguments)}catch(t){}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(t){}},scissor:function(e){!1===B.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),B.copy(e))},viewport:function(e){!1===U.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),U.copy(e))},reset:function(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),!0===i&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),d={},z=null,O={},p={},f=new WeakMap,m=[],v=null,g=!1,x=null,y=null,_=null,b=null,w=null,M=null,S=null,C=!1,T=null,P=null,A=null,E=null,L=null,B.set(0,0,t.canvas.width,t.canvas.height),U.set(0,0,t.canvas.width,t.canvas.height),c.reset(),u.reset(),h.reset()}}}function ws(t,e,n,i,r,s,o){const a=r.isWebGL2,l=(r.maxTextures,r.maxCubemapSize),c=r.maxTextureSize,u=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):void 0,d=new WeakMap;let p,f=!1;try{f="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function M(t,e){return f?new OffscreenCanvas(t,e):dt("canvas")}function k(t,e,n,i){let r=1;if((t.width>i||t.height>i)&&(r=i/Math.max(t.width,t.height)),r<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const i=e?at:Math.floor,s=i(r*t.width),o=i(r*t.height);void 0===p&&(p=M(s,o));const a=n?M(s,o):p;a.width=s,a.height=o;return a.getContext("2d").drawImage(t,0,0,s,o),a}return t}return t}function R(t){return st(t.width)&&st(t.height)}function I(t,e){return t.generateMipmaps&&e&&t.minFilter!==x&&t.minFilter!==b}function z(e){t.generateMipmap(e)}function O(n,i,r,s,o=!1){if(!1===a)return i;if(null!==n&&void 0!==t[n])return t[n];let l=i;return 6403===i&&(5126===r&&(l=33326),5131===r&&(l=33325),5121===r&&(l=33321)),33319===i&&(5126===r&&(l=33328),5131===r&&(l=33327),5121===r&&(l=33323)),6408===i&&(5126===r&&(l=34836),5131===r&&(l=34842),5121===r&&(l=s===W&&!1===o?35907:32856),32819===r&&(l=32854),32820===r&&(l=32855)),33325!==l&&33326!==l&&33327!==l&&33328!==l&&34842!==l&&34836!==l||e.get("EXT_color_buffer_float"),l}function N(t,e,n){return!0===I(t,n)||t.isFramebufferTexture&&t.minFilter!==x&&t.minFilter!==b?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function F(t){return t===x||t===y||t===_?9728:9729}function B(e){const n=e.target;n.removeEventListener("dispose",B),function(e){const n=i.get(e);if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture),i.remove(e)}(n),n.isVideoTexture&&d.delete(n),o.memory.textures--}function U(e){const n=e.target;n.removeEventListener("dispose",U),function(e){const n=e.texture,r=i.get(e),s=i.get(n);if(!e)return;void 0!==s.__webglTexture&&(t.deleteTexture(s.__webglTexture),o.memory.textures--);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)t.deleteFramebuffer(r.__webglFramebuffer[e]),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer[e]);else t.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&t.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer&&t.deleteRenderbuffer(r.__webglColorRenderbuffer),r.__webglDepthRenderbuffer&&t.deleteRenderbuffer(r.__webglDepthRenderbuffer);if(e.isWebGLMultipleRenderTargets)for(let e=0,r=n.length;e<r;e++){const r=i.get(n[e]);r.__webglTexture&&(t.deleteTexture(r.__webglTexture),o.memory.textures--),i.remove(n[e])}i.remove(n),i.remove(e)}(n)}let V=0;function H(t,e){const r=i.get(t);if(t.isVideoTexture&&function(t){const e=o.render.frame;d.get(t)!==e&&(d.set(t,e),t.update())}(t),t.version>0&&r.__version!==t.version){const n=t.image;if(void 0===n);else if(!1!==n.complete)return void J(r,t,e)}n.activeTexture(33984+e),n.bindTexture(3553,r.__webglTexture)}function G(e,r){const o=i.get(e);e.version>0&&o.__version!==e.version?function(e,i,r){if(6!==i.image.length)return;K(e,i),n.activeTexture(33984+r),n.bindTexture(34067,e.__webglTexture),t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment),t.pixelStorei(37443,0);const o=i&&(i.isCompressedTexture||i.image[0].isCompressedTexture),c=i.image[0]&&i.image[0].isDataTexture,u=[];for(let t=0;t<6;t++)u[t]=o||c?c?i.image[t].image:i.image[t]:k(i.image[t],!1,!0,l),u[t]=nt(i,u[t]);const h=u[0],d=R(h)||a,p=s.convert(i.format,i.encoding),f=s.convert(i.type),m=O(i.internalFormat,p,f,i.encoding),v=a&&!0!==i.isVideoTexture,g=void 0===e.__version;let x,y=N(i,h,d);if(Z(34067,i,d),o){v&&g&&n.texStorage2D(34067,y,m,h.width,h.height);for(let t=0;t<6;t++){x=u[t].mipmaps;for(let e=0;e<x.length;e++){const r=x[e];i.format!==E?null!==p&&(v?n.compressedTexSubImage2D(34069+t,e,0,0,r.width,r.height,p,r.data):n.compressedTexImage2D(34069+t,e,m,r.width,r.height,0,r.data)):v?n.texSubImage2D(34069+t,e,0,0,r.width,r.height,p,f,r.data):n.texImage2D(34069+t,e,m,r.width,r.height,0,p,f,r.data)}}}else{x=i.mipmaps,v&&g&&(x.length>0&&y++,n.texStorage2D(34067,y,m,u[0].width,u[0].height));for(let t=0;t<6;t++)if(c){v?n.texSubImage2D(34069+t,0,0,0,u[t].width,u[t].height,p,f,u[t].data):n.texImage2D(34069+t,0,m,u[t].width,u[t].height,0,p,f,u[t].data);for(let e=0;e<x.length;e++){const i=x[e].image[t].image;v?n.texSubImage2D(34069+t,e+1,0,0,i.width,i.height,p,f,i.data):n.texImage2D(34069+t,e+1,m,i.width,i.height,0,p,f,i.data)}}else{v?n.texSubImage2D(34069+t,0,0,0,p,f,u[t]):n.texImage2D(34069+t,0,m,p,f,u[t]);for(let e=0;e<x.length;e++){const i=x[e];v?n.texSubImage2D(34069+t,e+1,0,0,p,f,i.image[t]):n.texImage2D(34069+t,e+1,m,p,f,i.image[t])}}}I(i,d)&&z(34067);e.__version=i.version,i.onUpdate&&i.onUpdate(i)}(o,e,r):(n.activeTexture(33984+r),n.bindTexture(34067,o.__webglTexture))}const q={[m]:10497,[v]:33071,[g]:33648},X={[x]:9728,[y]:9984,[_]:9986,[b]:9729,1007:9985,[w]:9987};function Z(n,s,o){if(o?(t.texParameteri(n,10242,q[s.wrapS]),t.texParameteri(n,10243,q[s.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,q[s.wrapR]),t.texParameteri(n,10240,X[s.magFilter]),t.texParameteri(n,10241,X[s.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),s.wrapS!==v||s.wrapT,t.texParameteri(n,10240,F(s.magFilter)),t.texParameteri(n,10241,F(s.minFilter)),s.minFilter!==x&&s.minFilter),!0===e.has("EXT_texture_filter_anisotropic")){const o=e.get("EXT_texture_filter_anisotropic");if(s.type===T&&!1===e.has("OES_texture_float_linear"))return;if(!1===a&&s.type===P&&!1===e.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||i.get(s).__currentAnisotropy)&&(t.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy)}}function K(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",B),e.__webglTexture=t.createTexture(),o.memory.textures++)}function J(e,i,r){let o=3553;i.isDataTexture2DArray&&(o=35866),i.isDataTexture3D&&(o=32879),K(e,i),n.activeTexture(33984+r),n.bindTexture(o,e.__webglTexture),t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment),t.pixelStorei(37443,0);const l=function(t){return!a&&(t.wrapS!==v||t.wrapT!==v||t.minFilter!==x&&t.minFilter!==b)}(i)&&!1===R(i.image);let u=k(i.image,l,!1,c);u=nt(i,u);const h=R(u)||a,d=s.convert(i.format,i.encoding);let p,f=s.convert(i.type),m=O(i.internalFormat,d,f,i.encoding,i.isVideoTexture);Z(o,i,h);const g=i.mipmaps,y=a&&!0!==i.isVideoTexture,_=void 0===e.__version,w=N(i,u,h);if(i.isDepthTexture)m=6402,a?m=i.type===T?36012:i.type===C?33190:i.type===A?35056:33189:i.type,i.format===L&&6402===m&&i.type!==S&&i.type!==C&&(i.type=S,f=s.convert(i.type)),i.format===D&&6402===m&&(m=34041,i.type!==A&&(i.type=A,f=s.convert(i.type))),y&&_?n.texStorage2D(3553,1,m,u.width,u.height):n.texImage2D(3553,0,m,u.width,u.height,0,d,f,null);else if(i.isDataTexture)if(g.length>0&&h){y&&_&&n.texStorage2D(3553,w,m,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)p=g[t],y?n.texSubImage2D(3553,0,0,0,p.width,p.height,d,f,p.data):n.texImage2D(3553,t,m,p.width,p.height,0,d,f,p.data);i.generateMipmaps=!1}else y?(_&&n.texStorage2D(3553,w,m,u.width,u.height),n.texSubImage2D(3553,0,0,0,u.width,u.height,d,f,u.data)):n.texImage2D(3553,0,m,u.width,u.height,0,d,f,u.data);else if(i.isCompressedTexture){y&&_&&n.texStorage2D(3553,w,m,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)p=g[t],i.format!==E?null!==d&&(y?n.compressedTexSubImage2D(3553,t,0,0,p.width,p.height,d,p.data):n.compressedTexImage2D(3553,t,m,p.width,p.height,0,p.data)):y?n.texSubImage2D(3553,t,0,0,p.width,p.height,d,f,p.data):n.texImage2D(3553,t,m,p.width,p.height,0,d,f,p.data)}else if(i.isDataTexture2DArray)y?(_&&n.texStorage3D(35866,w,m,u.width,u.height,u.depth),n.texSubImage3D(35866,0,0,0,0,u.width,u.height,u.depth,d,f,u.data)):n.texImage3D(35866,0,m,u.width,u.height,u.depth,0,d,f,u.data);else if(i.isDataTexture3D)y?(_&&n.texStorage3D(32879,w,m,u.width,u.height,u.depth),n.texSubImage3D(32879,0,0,0,0,u.width,u.height,u.depth,d,f,u.data)):n.texImage3D(32879,0,m,u.width,u.height,u.depth,0,d,f,u.data);else if(i.isFramebufferTexture)y&&_?n.texStorage2D(3553,w,m,u.width,u.height):n.texImage2D(3553,0,m,u.width,u.height,0,d,f,null);else if(g.length>0&&h){y&&_&&n.texStorage2D(3553,w,m,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)p=g[t],y?n.texSubImage2D(3553,t,0,0,d,f,p):n.texImage2D(3553,t,m,d,f,p);i.generateMipmaps=!1}else y?(_&&n.texStorage2D(3553,w,m,u.width,u.height),n.texSubImage2D(3553,0,0,0,d,f,u)):n.texImage2D(3553,0,m,d,f,u);I(i,h)&&z(o),e.__version=i.version,i.onUpdate&&i.onUpdate(i)}function $(e,r,o,a,l){const c=s.convert(o.format,o.encoding),u=s.convert(o.type),d=O(o.internalFormat,c,u,o.encoding);i.get(r).__hasExternalTextures||(32879===l||35866===l?n.texImage3D(l,0,d,r.width,r.height,r.depth,0,c,u,null):n.texImage2D(l,0,d,r.width,r.height,0,c,u,null)),n.bindFramebuffer(36160,e),r.useRenderToTexture?h.framebufferTexture2DMultisampleEXT(36160,a,l,i.get(o).__webglTexture,0,et(r)):t.framebufferTexture2D(36160,a,l,i.get(o).__webglTexture,0),n.bindFramebuffer(36160,null)}function Q(e,n,i){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){let r=33189;if(i||n.useRenderToTexture){const e=n.depthTexture;e&&e.isDepthTexture&&(e.type===T?r=36012:e.type===C&&(r=33190));const i=et(n);n.useRenderToTexture?h.renderbufferStorageMultisampleEXT(36161,i,r,n.width,n.height):t.renderbufferStorageMultisample(36161,i,r,n.width,n.height)}else t.renderbufferStorage(36161,r,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){const r=et(n);i&&n.useRenderbuffer?t.renderbufferStorageMultisample(36161,r,35056,n.width,n.height):n.useRenderToTexture?h.renderbufferStorageMultisampleEXT(36161,r,35056,n.width,n.height):t.renderbufferStorage(36161,34041,n.width,n.height),t.framebufferRenderbuffer(36160,33306,36161,e)}else{const e=!0===n.isWebGLMultipleRenderTargets?n.texture[0]:n.texture,r=s.convert(e.format,e.encoding),o=s.convert(e.type),a=O(e.internalFormat,r,o,e.encoding),l=et(n);i&&n.useRenderbuffer?t.renderbufferStorageMultisample(36161,l,a,n.width,n.height):n.useRenderToTexture?h.renderbufferStorageMultisampleEXT(36161,l,a,n.width,n.height):t.renderbufferStorage(36161,a,n.width,n.height)}t.bindRenderbuffer(36161,null)}function tt(e){const r=i.get(e),s=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture&&!r.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,e),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),H(r.depthTexture,0);const s=i.get(r.depthTexture).__webglTexture,o=et(r);if(r.depthTexture.format===L)r.useRenderToTexture?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,s,0,o):t.framebufferTexture2D(36160,36096,3553,s,0);else{if(r.depthTexture.format!==D)throw new Error("Unknown depthTexture format");r.useRenderToTexture?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,s,0,o):t.framebufferTexture2D(36160,33306,3553,s,0)}}(r.__webglFramebuffer,e)}else if(s){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)n.bindFramebuffer(36160,r.__webglFramebuffer[i]),r.__webglDepthbuffer[i]=t.createRenderbuffer(),Q(r.__webglDepthbuffer[i],e,!1)}else n.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=t.createRenderbuffer(),Q(r.__webglDepthbuffer,e,!1);n.bindFramebuffer(36160,null)}function et(t){return a&&(t.useRenderbuffer||t.useRenderToTexture)?Math.min(u,t.samples):0}function nt(t,n){const i=t.encoding,r=t.format;t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||t.format===Y||i!==j&&i===W&&!1===a&&(!0===e.has("EXT_sRGB")&&r===E?(t.format=Y,t.minFilter=b,t.generateMipmaps=!1):n=bt.sRGBToLinear(n)),n}let it=!1,rt=!1;this.allocateTextureUnit=function(){const t=V;return V+=1,t},this.resetTextureUnits=function(){V=0},this.setTexture2D=H,this.setTexture2DArray=function(t,e){const r=i.get(t);t.version>0&&r.__version!==t.version?J(r,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(t,e){const r=i.get(t);t.version>0&&r.__version!==t.version?J(r,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,r.__webglTexture))},this.setTextureCube=G,this.rebindTextures=function(t,e,n){const r=i.get(t);void 0!==e&&$(r.__webglFramebuffer,t,t.texture,36064,3553),void 0!==n&&tt(t)},this.setupRenderTarget=function(e){const l=e.texture,c=i.get(e),u=i.get(l);e.addEventListener("dispose",U),!0!==e.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=t.createTexture()),u.__version=l.version,o.memory.textures++);const h=!0===e.isWebGLCubeRenderTarget,d=!0===e.isWebGLMultipleRenderTargets,p=l.isDataTexture3D||l.isDataTexture2DArray,f=R(e)||a;if(h){c.__webglFramebuffer=[];for(let e=0;e<6;e++)c.__webglFramebuffer[e]=t.createFramebuffer()}else if(c.__webglFramebuffer=t.createFramebuffer(),d){if(r.drawBuffers){const n=e.texture;for(let e=0,r=n.length;e<r;e++){const r=i.get(n[e]);void 0===r.__webglTexture&&(r.__webglTexture=t.createTexture(),o.memory.textures++)}}}else if(e.useRenderbuffer&&a){c.__webglMultisampledFramebuffer=t.createFramebuffer(),c.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,c.__webglColorRenderbuffer);const i=s.convert(l.format,l.encoding),r=s.convert(l.type),o=O(l.internalFormat,i,r,l.encoding),a=et(e);t.renderbufferStorageMultisample(36161,a,o,e.width,e.height),n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,c.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(c.__webglDepthRenderbuffer=t.createRenderbuffer(),Q(c.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(36160,null)}if(h){n.bindTexture(34067,u.__webglTexture),Z(34067,l,f);for(let t=0;t<6;t++)$(c.__webglFramebuffer[t],e,l,36064,34069+t);I(l,f)&&z(34067),n.unbindTexture()}else if(d){const t=e.texture;for(let r=0,s=t.length;r<s;r++){const s=t[r],o=i.get(s);n.bindTexture(3553,o.__webglTexture),Z(3553,s,f),$(c.__webglFramebuffer,e,s,36064+r,3553),I(s,f)&&z(3553)}n.unbindTexture()}else{let t=3553;if(p&&a){t=l.isDataTexture3D?32879:35866}n.bindTexture(t,u.__webglTexture),Z(t,l,f),$(c.__webglFramebuffer,e,l,36064,t),I(l,f)&&z(t),n.unbindTexture()}e.depthBuffer&&tt(e)},this.updateRenderTargetMipmap=function(t){const e=R(t)||a,r=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let s=0,o=r.length;s<o;s++){const o=r[s];if(I(o,e)){const e=t.isWebGLCubeRenderTarget?34067:3553,r=i.get(o).__webglTexture;n.bindTexture(e,r),z(e),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(e.useRenderbuffer&&a){const r=e.width,s=e.height;let o=16384;const a=[36064],l=e.stencilBuffer?33306:36096;e.depthBuffer&&a.push(l),e.ignoreDepthForMultisampleCopy||(e.depthBuffer&&(o|=256),e.stencilBuffer&&(o|=1024));const c=i.get(e);n.bindFramebuffer(36008,c.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,c.__webglFramebuffer),e.ignoreDepthForMultisampleCopy&&(t.invalidateFramebuffer(36008,[l]),t.invalidateFramebuffer(36009,[l])),t.blitFramebuffer(0,0,r,s,0,0,r,s,o,9728),t.invalidateFramebuffer(36008,a),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,c.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=tt,this.setupFrameBufferTexture=$,this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===it&&(it=!0),t=t.texture),H(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===rt&&(rt=!0),t=t.texture),G(t,e)}}function Ms(t,e,n){const i=n.isWebGL2;return{convert:function(t,n=null){let r;if(t===M)return 5121;if(1017===t)return 32819;if(1018===t)return 32820;if(1010===t)return 5120;if(1011===t)return 5122;if(t===S)return 5123;if(1013===t)return 5124;if(t===C)return 5125;if(t===T)return 5126;if(t===P)return i?5131:(r=e.get("OES_texture_half_float"),null!==r?r.HALF_FLOAT_OES:null);if(1021===t)return 6406;if(t===E)return 6408;if(1024===t)return 6409;if(1025===t)return 6410;if(t===L)return 6402;if(t===D)return 34041;if(1028===t)return 6403;if(1022===t)return 6408;if(t===Y)return r=e.get("EXT_sRGB"),null!==r?r.SRGB_ALPHA_EXT:null;if(1029===t)return 36244;if(1030===t)return 33319;if(1031===t)return 33320;if(1033===t)return 36249;if(t===k||t===R||t===I||t===z)if(n===W){if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===r)return null;if(t===k)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(t===R)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(t===I)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(t===z)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(r=e.get("WEBGL_compressed_texture_s3tc"),null===r)return null;if(t===k)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===R)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===I)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===z)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===t||35841===t||35842===t||35843===t){if(r=e.get("WEBGL_compressed_texture_pvrtc"),null===r)return null;if(35840===t)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===t)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===t)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===t)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===t)return r=e.get("WEBGL_compressed_texture_etc1"),null!==r?r.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===t||37496===t){if(r=e.get("WEBGL_compressed_texture_etc"),null===r)return null;if(37492===t)return n===W?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(37496===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}if(37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t){if(r=e.get("WEBGL_compressed_texture_astc"),null===r)return null;if(37808===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===t)return n===W?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===t){if(r=e.get("EXT_texture_compression_bptc"),null===r)return null;if(36492===t)return n===W?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT}return t===A?i?34042:(r=e.get("WEBGL_depth_texture"),null!==r?r.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class Ss extends kn{constructor(t=[]){super(),this.cameras=t}}Ss.prototype.isArrayCamera=!0;class Cs extends De{constructor(){super(),this.type="Group"}}Cs.prototype.isGroup=!0;const Ts={type:"move"};class Ps{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Cs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Cs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Et,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Et),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Cs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Et,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Et),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let i=null,r=null,s=null;const o=this._targetRay,a=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(null!==o&&(i=e.getPose(t.targetRaySpace,n),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Ts))),l&&t.hand){s=!0;for(const i of t.hand.values()){const t=e.getJointPose(i,n);if(void 0===l.joints[i.jointName]){const t=new Cs;t.matrixAutoUpdate=!1,t.visible=!1,l.joints[i.jointName]=t,l.add(t)}const r=l.joints[i.jointName];null!==t&&(r.matrix.fromArray(t.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.jointRadius=t.radius),r.visible=null!==t}const i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],o=i.position.distanceTo(r.position),a=.02,c=.005;l.inputState.pinching&&o>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&o<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==a&&t.gripSpace&&(r=e.getPose(t.gripSpace,n),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1));return null!==o&&(o.visible=null!==i),null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),this}}class As extends Mt{constructor(t,e,n,i,r,s,o,a,l,c){if((c=void 0!==c?c:L)!==L&&c!==D)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===L&&(n=S),void 0===n&&c===D&&(n=A),super(null,i,r,s,o,a,c,n,l),this.image={width:t,height:e},this.magFilter=void 0!==o?o:x,this.minFilter=void 0!==a?a:x,this.flipY=!1,this.generateMipmaps=!1}}As.prototype.isDepthTexture=!0;class Es extends K{constructor(t,e){super();const n=this;let i=null,r=1,s=null,o="local-floor";const a=t.extensions.has("WEBGL_multisampled_render_to_texture");let l=null,c=null,u=null,h=null,d=!1,p=null;const f=e.getContextAttributes();let m=null,v=null;const g=[],x=new Map,y=new kn;y.layers.enable(1),y.viewport=new Ct;const _=new kn;_.layers.enable(2),_.viewport=new Ct;const b=[y,_],w=new Ss;w.layers.enable(1),w.layers.enable(2);let C=null,T=null;function P(t){const e=x.get(t.inputSource);e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function k(){x.forEach((function(t,e){t.disconnect(e)})),x.clear(),C=null,T=null,t.setRenderTarget(m),h=null,u=null,c=null,i=null,v=null,F.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function R(t){const e=i.inputSources;for(let t=0;t<g.length;t++)x.set(e[t],g[t]);for(let e=0;e<t.removed.length;e++){const n=t.removed[e],i=x.get(n);i&&(i.dispatchEvent({type:"disconnected",data:n}),x.delete(n))}for(let e=0;e<t.added.length;e++){const n=t.added[e],i=x.get(n);i&&i.dispatchEvent({type:"connected",data:n})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=g[t];return void 0===e&&(e=new Ps,g[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=g[t];return void 0===e&&(e=new Ps,g[t]=e),e.getGripSpace()},this.getHand=function(t){let e=g[t];return void 0===e&&(e=new Ps,g[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){r=t,n.isPresenting},this.setReferenceSpaceType=function(t){o=t,n.isPresenting},this.getReferenceSpace=function(){return s},this.getBaseLayer=function(){return null!==u?u:h},this.getBinding=function(){return c},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(l){if(i=l,null!==i){if(m=t.getRenderTarget(),i.addEventListener("select",P),i.addEventListener("selectstart",P),i.addEventListener("selectend",P),i.addEventListener("squeeze",P),i.addEventListener("squeezestart",P),i.addEventListener("squeezeend",P),i.addEventListener("end",k),i.addEventListener("inputsourceschange",R),!0!==f.xrCompatible&&await e.makeXRCompatible(),void 0===i.renderState.layers||!1===t.capabilities.isWebGL2){const n={antialias:void 0!==i.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:r};h=new XRWebGLLayer(i,e,n),i.updateRenderState({baseLayer:h}),v=new Tt(h.framebufferWidth,h.framebufferHeight,{format:E,type:M,encoding:t.outputEncoding})}else{d=f.antialias;let n=null,s=null,o=null;f.depth&&(o=f.stencil?35056:33190,n=f.stencil?D:L,s=f.stencil?A:S);const l={colorFormat:t.outputEncoding===W?35907:32856,depthFormat:o,scaleFactor:r};c=new XRWebGLBinding(i,e),u=c.createProjectionLayer(l),i.updateRenderState({layers:[u]}),v=d?new Pt(u.textureWidth,u.textureHeight,{format:E,type:M,depthTexture:new As(u.textureWidth,u.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,ignoreDepth:u.ignoreDepthValues,useRenderToTexture:a,encoding:t.outputEncoding}):new Tt(u.textureWidth,u.textureHeight,{format:E,type:M,depthTexture:new As(u.textureWidth,u.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,ignoreDepth:u.ignoreDepthValues,encoding:t.outputEncoding})}v.isXRRenderTarget=!0,this.setFoveation(1),s=await i.requestReferenceSpace(o),F.setContext(i),F.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const I=new Et,z=new Et;function O(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===i)return;w.near=_.near=y.near=t.near,w.far=_.far=y.far=t.far,C===w.near&&T===w.far||(i.updateRenderState({depthNear:w.near,depthFar:w.far}),C=w.near,T=w.far);const e=t.parent,n=w.cameras;O(w,e);for(let t=0;t<n.length;t++)O(n[t],e);w.matrixWorld.decompose(w.position,w.quaternion,w.scale),t.position.copy(w.position),t.quaternion.copy(w.quaternion),t.scale.copy(w.scale),t.matrix.copy(w.matrix),t.matrixWorld.copy(w.matrixWorld);const r=t.children;for(let t=0,e=r.length;t<e;t++)r[t].updateMatrixWorld(!0);2===n.length?function(t,e,n){I.setFromMatrixPosition(e.matrixWorld),z.setFromMatrixPosition(n.matrixWorld);const i=I.distanceTo(z),r=e.projectionMatrix.elements,s=n.projectionMatrix.elements,o=r[14]/(r[10]-1),a=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],u=(r[8]-1)/r[0],h=(s[8]+1)/s[0],d=o*u,p=o*h,f=i/(-u+h),m=f*-u;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const v=o+f,g=a+f,x=d-m,y=p+(i-m),_=l*a/g*v,b=c*a/g*v;t.projectionMatrix.makePerspective(x,y,_,b,v,g)}(w,y,_):w.projectionMatrix.copy(y.projectionMatrix)},this.getCamera=function(){return w},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==h?h.fixedFoveation:void 0},this.setFoveation=function(t){null!==u&&(u.fixedFoveation=t),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=t)};let N=null;const F=new Wn;F.setAnimationLoop((function(e,n){if(l=n.getViewerPose(s),p=n,null!==l){const e=l.views;null!==h&&(t.setRenderTargetFramebuffer(v,h.framebuffer),t.setRenderTarget(v));let n=!1;e.length!==w.cameras.length&&(w.cameras.length=0,n=!0);for(let i=0;i<e.length;i++){const r=e[i];let s=null;if(null!==h)s=h.getViewport(r);else{const e=c.getViewSubImage(u,r);s=e.viewport,0===i&&(t.setRenderTargetTextures(v,e.colorTexture,u.ignoreDepthValues?void 0:e.depthStencilTexture),t.setRenderTarget(v))}const o=b[i];o.matrix.fromArray(r.transform.matrix),o.projectionMatrix.fromArray(r.projectionMatrix),o.viewport.set(s.x,s.y,s.width,s.height),0===i&&w.matrix.copy(o.matrix),!0===n&&w.cameras.push(o)}}const r=i.inputSources;for(let t=0;t<g.length;t++){const e=g[t],i=r[t];e.update(i,n,s)}N&&N(e,n),p=null})),this.setAnimationLoop=function(t){N=t},this.dispose=function(){}}}function Ls(t){function e(e,n){e.opacity.value=n.opacity,n.color&&e.diffuse.value.copy(n.color),n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(e.map.value=n.map),n.alphaMap&&(e.alphaMap.value=n.alphaMap),n.specularMap&&(e.specularMap.value=n.specularMap),n.alphaTest>0&&(e.alphaTest.value=n.alphaTest);const i=t.get(n).envMap;let r,s;i&&(e.envMap.value=i,e.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,e.reflectivity.value=n.reflectivity,e.ior.value=n.ior,e.refractionRatio.value=n.refractionRatio),n.lightMap&&(e.lightMap.value=n.lightMap,e.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(e.aoMap.value=n.aoMap,e.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap?r=n.clearcoatRoughnessMap:n.specularIntensityMap?r=n.specularIntensityMap:n.specularColorMap?r=n.specularColorMap:n.transmissionMap?r=n.transmissionMap:n.thicknessMap?r=n.thicknessMap:n.sheenColorMap?r=n.sheenColorMap:n.sheenRoughnessMap&&(r=n.sheenRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix)),n.aoMap?s=n.aoMap:n.lightMap&&(s=n.lightMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),e.uv2Transform.value.copy(s.matrix))}function n(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap),n.bumpMap&&(e.bumpMap.value=n.bumpMap,e.bumpScale.value=n.bumpScale,1===n.side&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,e.normalScale.value.copy(n.normalScale),1===n.side&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias);t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,i,r,s,o){i.isMeshBasicMaterial?e(t,i):i.isMeshLambertMaterial?(e(t,i),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(t,i)):i.isMeshToonMaterial?(e(t,i),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap);e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshPhongMaterial?(e(t,i),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshStandardMaterial?(e(t,i),i.isMeshPhysicalMaterial?function(t,e,i){n(t,e),t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap));e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,1===e.side&&t.clearcoatNormalScale.value.negate()));e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=i.texture,t.transmissionSamplerSize.value.set(i.width,i.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor));t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap);e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap)}(t,i,o):n(t,i)):i.isMeshMatcapMaterial?(e(t,i),function(t,e){e.matcap&&(t.matcap.value=e.matcap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshDepthMaterial?(e(t,i),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshDistanceMaterial?(e(t,i),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,i)):i.isMeshNormalMaterial?(e(t,i),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,i),i.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,i)):i.isPointsMaterial?function(t,e,n,i){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*i,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);e.alphaTest>0&&(t.alphaTest.value=e.alphaTest);let r;e.map?r=e.map:e.alphaMap&&(r=e.alphaMap);void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix))}(t,i,r,s):i.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);e.alphaTest>0&&(t.alphaTest.value=e.alphaTest);let n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(t,i):i.isShadowMaterial?(t.color.value.copy(i.color),t.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function Ds(t={}){const e=void 0!==t.canvas?t.canvas:function(){const t=dt("canvas");return t.style.display="block",t}(),n=void 0!==t.context?t.context:null,i=void 0!==t.alpha&&t.alpha,s=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,a=void 0!==t.antialias&&t.antialias,l=void 0===t.premultipliedAlpha||t.premultipliedAlpha,c=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,u=void 0!==t.powerPreference?t.powerPreference:"default",h=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let d=null,p=null;const f=[],m=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=j,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const g=this;let y=!1,_=0,b=0,S=null,C=-1,A=null;const L=new Ct,D=new Ct;let k=null,R=e.width,I=e.height,z=1,O=null,N=null;const F=new Ct(0,0,R,I),B=new Ct(0,0,R,I);let U=!1;const V=new jn;let H=!1,W=!1,G=null;const q=new oe,X=new Et,Z={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Y(){return null===S?z:1}let K,J,$,Q,tt,et,nt,it,rt,st,ot,at,lt,ct,ut,ht,pt,ft,mt,vt,gt,xt,yt,_t=n;function bt(t,n){for(let i=0;i<t.length;i++){const r=t[i],s=e.getContext(r,n);if(null!==s)return s}return null}try{const t={alpha:!0,depth:s,stencil:o,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r137"),e.addEventListener("webglcontextlost",St,!1),e.addEventListener("webglcontextrestored",At,!1),null===_t){const e=["webgl2","webgl","experimental-webgl"];if(!0===g.isWebGL1Renderer&&e.shift(),_t=bt(e,t),null===_t)throw bt(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===_t.getShaderPrecisionFormat&&(_t.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw t}function wt(){K=new Si(_t),J=new Qn(_t,K,t),K.init(J),xt=new Ms(_t,K,J),$=new bs(_t,K,J),Q=new Pi(_t),tt=new as,et=new ws(_t,K,$,tt,J,xt,Q),nt=new ei(g),it=new Mi(g),rt=new Gn(_t,J),yt=new Jn(_t,K,rt,J),st=new Ci(_t,rt,Q,yt),ot=new Ri(_t,st,rt,Q),mt=new ki(_t,J,et),ht=new ti(tt),at=new os(g,nt,it,K,J,yt,ht),lt=new Ls(tt),ct=new hs,ut=new gs(K,J),ft=new Kn(g,nt,$,ot,i,l),pt=new _s(g,ot,J),vt=new $n(_t,K,Q,J),gt=new Ti(_t,K,Q,J),Q.programs=at.programs,g.capabilities=J,g.extensions=K,g.properties=tt,g.renderLists=ct,g.shadowMap=pt,g.state=$,g.info=Q}wt();const Mt=new Es(g,_t);function St(t){t.preventDefault(),y=!0}function At(){y=!1;const t=Q.autoReset,e=pt.enabled,n=pt.autoUpdate,i=pt.needsUpdate,r=pt.type;wt(),Q.autoReset=t,pt.enabled=e,pt.autoUpdate=n,pt.needsUpdate=i,pt.type=r}function Lt(t){const e=t.target;e.removeEventListener("dispose",Lt),function(t){(function(t){const e=tt.get(t).programs;void 0!==e&&(e.forEach((function(t){at.releaseProgram(t)})),t.isShaderMaterial&&at.releaseShaderCache(t))})(t),tt.remove(t)}(e)}this.xr=Mt,this.getContext=function(){return _t},this.getContextAttributes=function(){return _t.getContextAttributes()},this.forceContextLoss=function(){const t=K.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=K.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return z},this.setPixelRatio=function(t){void 0!==t&&(z=t,this.setSize(R,I,!1))},this.getSize=function(t){return t.set(R,I)},this.setSize=function(t,n,i){Mt.isPresenting||(R=t,I=n,e.width=Math.floor(t*z),e.height=Math.floor(n*z),!1!==i&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return t.set(R*z,I*z).floor()},this.setDrawingBufferSize=function(t,n,i){R=t,I=n,z=i,e.width=Math.floor(t*i),e.height=Math.floor(n*i),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return t.copy(L)},this.getViewport=function(t){return t.copy(F)},this.setViewport=function(t,e,n,i){t.isVector4?F.set(t.x,t.y,t.z,t.w):F.set(t,e,n,i),$.viewport(L.copy(F).multiplyScalar(z).floor())},this.getScissor=function(t){return t.copy(B)},this.setScissor=function(t,e,n,i){t.isVector4?B.set(t.x,t.y,t.z,t.w):B.set(t,e,n,i),$.scissor(D.copy(B).multiplyScalar(z).floor())},this.getScissorTest=function(){return U},this.setScissorTest=function(t){$.setScissorTest(U=t)},this.setOpaqueSort=function(t){O=t},this.setTransparentSort=function(t){N=t},this.getClearColor=function(t){return t.copy(ft.getClearColor())},this.setClearColor=function(){ft.setClearColor.apply(ft,arguments)},this.getClearAlpha=function(){return ft.getClearAlpha()},this.setClearAlpha=function(){ft.setClearAlpha.apply(ft,arguments)},this.clear=function(t,e,n){let i=0;(void 0===t||t)&&(i|=16384),(void 0===e||e)&&(i|=256),(void 0===n||n)&&(i|=1024),_t.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",St,!1),e.removeEventListener("webglcontextrestored",At,!1),ct.dispose(),ut.dispose(),tt.dispose(),nt.dispose(),it.dispose(),ot.dispose(),yt.dispose(),at.dispose(),Mt.dispose(),Mt.removeEventListener("sessionstart",kt),Mt.removeEventListener("sessionend",Rt),G&&(G.dispose(),G=null),It.stop()},this.renderBufferDirect=function(t,e,n,i,r,s){null===e&&(e=Z);const o=r.isMesh&&r.matrixWorld.determinant()<0,a=function(t,e,n,i,r){!0!==e.isScene&&(e=Z);et.resetTextureUnits();const s=e.fog,o=i.isMeshStandardMaterial?e.environment:null,a=null===S?g.outputEncoding:!0===S.isXRRenderTarget?S.texture.encoding:j,l=(i.isMeshStandardMaterial?it:nt).get(i.envMap||o),c=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!i.normalMap&&!!n.attributes.tangent,h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,f=n.morphAttributes.position?n.morphAttributes.position.length:0,m=i.toneMapped?g.toneMapping:0,v=tt.get(i),x=p.state.lights;if(!0===H&&(!0===W||t!==A)){const e=t===A&&i.id===C;ht.setState(i,t,e)}let y=!1;i.version===v.__version?v.needsLights&&v.lightsStateVersion!==x.state.version||v.outputEncoding!==a||r.isInstancedMesh&&!1===v.instancing?y=!0:r.isInstancedMesh||!0!==v.instancing?r.isSkinnedMesh&&!1===v.skinning?y=!0:r.isSkinnedMesh||!0!==v.skinning?v.envMap!==l||i.fog&&v.fog!==s?y=!0:void 0===v.numClippingPlanes||v.numClippingPlanes===ht.numPlanes&&v.numIntersection===ht.numIntersection?(v.vertexAlphas!==c||v.vertexTangents!==u||v.morphTargets!==h||v.morphNormals!==d||v.toneMapping!==m||!0===J.isWebGL2&&v.morphTargetsCount!==f)&&(y=!0):y=!0:y=!0:y=!0:(y=!0,v.__version=i.version);let _=v.currentProgram;!0===y&&(_=Bt(i,e,r));let b=!1,w=!1,M=!1;const T=_.getUniforms(),P=v.uniforms;$.useProgram(_.program)&&(b=!0,w=!0,M=!0);i.id!==C&&(C=i.id,w=!0);if(b||A!==t){if(T.setValue(_t,"projectionMatrix",t.projectionMatrix),J.logarithmicDepthBuffer&&T.setValue(_t,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),A!==t&&(A=t,w=!0,M=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){const e=T.map.cameraPosition;void 0!==e&&e.setValue(_t,X.setFromMatrixPosition(t.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&T.setValue(_t,"isOrthographic",!0===t.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.isShadowMaterial||r.isSkinnedMesh)&&T.setValue(_t,"viewMatrix",t.matrixWorldInverse)}if(r.isSkinnedMesh){T.setOptional(_t,r,"bindMatrix"),T.setOptional(_t,r,"bindMatrixInverse");const t=r.skeleton;t&&(J.floatVertexTextures?(null===t.boneTexture&&t.computeBoneTexture(),T.setValue(_t,"boneTexture",t.boneTexture,et),T.setValue(_t,"boneTextureSize",t.boneTextureSize)):T.setOptional(_t,t,"boneMatrices"))}!n||void 0===n.morphAttributes.position&&void 0===n.morphAttributes.normal||mt.update(r,n,i,_);(w||v.receiveShadow!==r.receiveShadow)&&(v.receiveShadow=r.receiveShadow,T.setValue(_t,"receiveShadow",r.receiveShadow));w&&(T.setValue(_t,"toneMappingExposure",g.toneMappingExposure),v.needsLights&&(L=M,(E=P).ambientLightColor.needsUpdate=L,E.lightProbe.needsUpdate=L,E.directionalLights.needsUpdate=L,E.directionalLightShadows.needsUpdate=L,E.pointLights.needsUpdate=L,E.pointLightShadows.needsUpdate=L,E.spotLights.needsUpdate=L,E.spotLightShadows.needsUpdate=L,E.rectAreaLights.needsUpdate=L,E.hemisphereLights.needsUpdate=L),s&&i.fog&&lt.refreshFogUniforms(P,s),lt.refreshMaterialUniforms(P,i,z,I,G),Fr.upload(_t,v.uniformsList,P,et));var E,L;i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(Fr.upload(_t,v.uniformsList,P,et),i.uniformsNeedUpdate=!1);i.isSpriteMaterial&&T.setValue(_t,"center",r.center);return T.setValue(_t,"modelViewMatrix",r.modelViewMatrix),T.setValue(_t,"normalMatrix",r.normalMatrix),T.setValue(_t,"modelMatrix",r.matrixWorld),_}(t,e,n,i,r);$.setMaterial(i,o);let l=n.index;const c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let u,h=1;!0===i.wireframe&&(l=st.getWireframeAttribute(n),h=2),yt.setup(r,i,a,n,l);let d=vt;null!==l&&(u=rt.get(l),d=gt,d.setIndex(u));const f=null!==l?l.count:c.count,m=n.drawRange.start*h,v=n.drawRange.count*h,x=null!==s?s.start*h:0,y=null!==s?s.count*h:1/0,_=Math.max(m,x),b=Math.min(f,m+v,x+y)-1,w=Math.max(0,b-_+1);if(0!==w){if(r.isMesh)!0===i.wireframe?($.setLineWidth(i.wireframeLinewidth*Y()),d.setMode(1)):d.setMode(4);else if(r.isLine){let t=i.linewidth;void 0===t&&(t=1),$.setLineWidth(t*Y()),r.isLineSegments?d.setMode(1):r.isLineLoop?d.setMode(2):d.setMode(3)}else r.isPoints?d.setMode(0):r.isSprite&&d.setMode(4);if(r.isInstancedMesh)d.renderInstances(_,w,r.count);else if(n.isInstancedBufferGeometry){const t=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(_,w,t)}else d.render(_,w)}},this.compile=function(t,e){p=ut.get(t),p.init(),m.push(p),t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(p.pushLight(t),t.castShadow&&p.pushShadow(t))})),p.setupLights(g.physicallyCorrectLights),t.traverse((function(e){const n=e.material;if(n)if(Array.isArray(n))for(let i=0;i<n.length;i++){Bt(n[i],t,e)}else Bt(n,t,e)})),m.pop(),p=null};let Dt=null;function kt(){It.stop()}function Rt(){It.start()}const It=new Wn;function zt(t,e,n,i){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)p.pushLight(t),t.castShadow&&p.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||V.intersectsSprite(t)){i&&X.setFromMatrixPosition(t.matrixWorld).applyMatrix4(q);const e=ot.update(t),r=t.material;r.visible&&d.push(t,e,r,n,X.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==Q.render.frame&&(t.skeleton.update(),t.skeleton.frame=Q.render.frame),!t.frustumCulled||V.intersectsObject(t))){i&&X.setFromMatrixPosition(t.matrixWorld).applyMatrix4(q);const e=ot.update(t),r=t.material;if(Array.isArray(r)){const i=e.groups;for(let s=0,o=i.length;s<o;s++){const o=i[s],a=r[o.materialIndex];a&&a.visible&&d.push(t,e,a,n,X.z,o)}}else r.visible&&d.push(t,e,r,n,X.z,null)}const r=t.children;for(let t=0,s=r.length;t<s;t++)zt(r[t],e,n,i)}function Ot(t,e,n,i){const r=t.opaque,s=t.transmissive,o=t.transparent;p.setupLightsView(n),s.length>0&&function(t,e,n){if(null===G){const t=!0===a&&!0===J.isWebGL2;G=new(t?Pt:Tt)(1024,1024,{generateMipmaps:!0,type:null!==xt.convert(P)?P:M,minFilter:w,magFilter:x,wrapS:v,wrapT:v,useRenderToTexture:K.has("WEBGL_multisampled_render_to_texture")})}const i=g.getRenderTarget();g.setRenderTarget(G),g.clear();const r=g.toneMapping;g.toneMapping=0,Nt(t,e,n),g.toneMapping=r,et.updateMultisampleRenderTarget(G),et.updateRenderTargetMipmap(G),g.setRenderTarget(i)}(r,e,n),i&&$.viewport(L.copy(i)),r.length>0&&Nt(r,e,n),s.length>0&&Nt(s,e,n),o.length>0&&Nt(o,e,n)}function Nt(t,e,n){const i=!0===e.isScene?e.overrideMaterial:null;for(let r=0,s=t.length;r<s;r++){const s=t[r],o=s.object,a=s.geometry,l=null===i?s.material:i,c=s.group;o.layers.test(n.layers)&&Ft(o,e,n,a,l,c)}}function Ft(t,e,n,i,s,o){t.onBeforeRender(g,e,n,i,s,o),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),s.onBeforeRender(g,e,n,i,t,o),!0===s.transparent&&s.side===r?(s.side=1,s.needsUpdate=!0,g.renderBufferDirect(n,e,i,s,t,o),s.side=0,s.needsUpdate=!0,g.renderBufferDirect(n,e,i,s,t,o),s.side=r):g.renderBufferDirect(n,e,i,s,t,o),t.onAfterRender(g,e,n,i,s,o)}function Bt(t,e,n){!0!==e.isScene&&(e=Z);const i=tt.get(t),r=p.state.lights,s=p.state.shadowsArray,o=r.state.version,a=at.getParameters(t,r.state,s,e,n),l=at.getProgramCacheKey(a);let c=i.programs;i.environment=t.isMeshStandardMaterial?e.environment:null,i.fog=e.fog,i.envMap=(t.isMeshStandardMaterial?it:nt).get(t.envMap||i.environment),void 0===c&&(t.addEventListener("dispose",Lt),c=new Map,i.programs=c);let u=c.get(l);if(void 0!==u){if(i.currentProgram===u&&i.lightsStateVersion===o)return Ut(t,a),u}else a.uniforms=at.getUniforms(t),t.onBuild(n,a,g),t.onBeforeCompile(a,g),u=at.acquireProgram(a,l),c.set(l,u),i.uniforms=a.uniforms;const h=i.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(h.clippingPlanes=ht.uniform),Ut(t,a),i.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),i.lightsStateVersion=o,i.needsLights&&(h.ambientLightColor.value=r.state.ambient,h.lightProbe.value=r.state.probe,h.directionalLights.value=r.state.directional,h.directionalLightShadows.value=r.state.directionalShadow,h.spotLights.value=r.state.spot,h.spotLightShadows.value=r.state.spotShadow,h.rectAreaLights.value=r.state.rectArea,h.ltc_1.value=r.state.rectAreaLTC1,h.ltc_2.value=r.state.rectAreaLTC2,h.pointLights.value=r.state.point,h.pointLightShadows.value=r.state.pointShadow,h.hemisphereLights.value=r.state.hemi,h.directionalShadowMap.value=r.state.directionalShadowMap,h.directionalShadowMatrix.value=r.state.directionalShadowMatrix,h.spotShadowMap.value=r.state.spotShadowMap,h.spotShadowMatrix.value=r.state.spotShadowMatrix,h.pointShadowMap.value=r.state.pointShadowMap,h.pointShadowMatrix.value=r.state.pointShadowMatrix);const d=u.getUniforms(),f=Fr.seqWithValue(d.seq,h);return i.currentProgram=u,i.uniformsList=f,u}function Ut(t,e){const n=tt.get(t);n.outputEncoding=e.outputEncoding,n.instancing=e.instancing,n.skinning=e.skinning,n.morphTargets=e.morphTargets,n.morphNormals=e.morphNormals,n.morphTargetsCount=e.morphTargetsCount,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas,n.vertexTangents=e.vertexTangents,n.toneMapping=e.toneMapping}It.setAnimationLoop((function(t){Dt&&Dt(t)})),"undefined"!=typeof window&&It.setContext(window),this.setAnimationLoop=function(t){Dt=t,Mt.setAnimationLoop(t),null===t?It.stop():It.start()},Mt.addEventListener("sessionstart",kt),Mt.addEventListener("sessionend",Rt),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return;if(!0===y)return;!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===Mt.enabled&&!0===Mt.isPresenting&&(!0===Mt.cameraAutoUpdate&&Mt.updateCamera(e),e=Mt.getCamera()),!0===t.isScene&&t.onBeforeRender(g,t,e,S),p=ut.get(t,m.length),p.init(),m.push(p),q.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),V.setFromProjectionMatrix(q),W=this.localClippingEnabled,H=ht.init(this.clippingPlanes,W,e),d=ct.get(t,f.length),d.init(),f.push(d),zt(t,e,0,g.sortObjects),d.finish(),!0===g.sortObjects&&d.sort(O,N),!0===H&&ht.beginShadows();const n=p.state.shadowsArray;if(pt.render(n,t,e),!0===H&&ht.endShadows(),!0===this.info.autoReset&&this.info.reset(),ft.render(d,t),p.setupLights(g.physicallyCorrectLights),e.isArrayCamera){const n=e.cameras;for(let e=0,i=n.length;e<i;e++){const i=n[e];Ot(d,t,i,i.viewport)}}else Ot(d,t,e);null!==S&&(et.updateMultisampleRenderTarget(S),et.updateRenderTargetMipmap(S)),!0===t.isScene&&t.onAfterRender(g,t,e),$.buffers.depth.setTest(!0),$.buffers.depth.setMask(!0),$.buffers.color.setMask(!0),$.setPolygonOffset(!1),yt.resetDefaultState(),C=-1,A=null,m.pop(),p=m.length>0?m[m.length-1]:null,f.pop(),d=f.length>0?f[f.length-1]:null},this.getActiveCubeFace=function(){return _},this.getActiveMipmapLevel=function(){return b},this.getRenderTarget=function(){return S},this.setRenderTargetTextures=function(t,e,n){tt.get(t.texture).__webglTexture=e,tt.get(t.depthTexture).__webglTexture=n;const i=tt.get(t);i.__hasExternalTextures=!0,i.__hasExternalTextures&&(i.__autoAllocateDepthBuffer=void 0===n,i.__autoAllocateDepthBuffer||t.useRenderToTexture&&(t.useRenderToTexture=!1,t.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(t,e){const n=tt.get(t);n.__webglFramebuffer=e,n.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t,e=0,n=0){S=t,_=e,b=n;let i=!0;if(t){const e=tt.get(t);void 0!==e.__useDefaultFramebuffer?($.bindFramebuffer(36160,null),i=!1):void 0===e.__webglFramebuffer?et.setupRenderTarget(t):e.__hasExternalTextures&&et.rebindTextures(t,tt.get(t.texture).__webglTexture,tt.get(t.depthTexture).__webglTexture)}let r=null,s=!1,o=!1;if(t){const n=t.texture;(n.isDataTexture3D||n.isDataTexture2DArray)&&(o=!0);const i=tt.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=i[e],s=!0):r=t.useRenderbuffer?tt.get(t).__webglMultisampledFramebuffer:i,L.copy(t.viewport),D.copy(t.scissor),k=t.scissorTest}else L.copy(F).multiplyScalar(z).floor(),D.copy(B).multiplyScalar(z).floor(),k=U;if($.bindFramebuffer(36160,r)&&J.drawBuffers&&i&&$.drawBuffers(t,r),$.viewport(L),$.scissor(D),$.setScissorTest(k),s){const i=tt.get(t.texture);_t.framebufferTexture2D(36160,36064,34069+e,i.__webglTexture,n)}else if(o){const i=tt.get(t.texture),r=e||0;_t.framebufferTextureLayer(36160,36064,i.__webglTexture,n||0,r)}C=-1},this.readRenderTargetPixels=function(t,e,n,i,r,s,o){if(!t||!t.isWebGLRenderTarget)return;let a=tt.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){$.bindFramebuffer(36160,a);try{const o=t.texture,a=o.format,l=o.type;if(a!==E&&xt.convert(a)!==_t.getParameter(35739))return;const c=l===P&&(K.has("EXT_color_buffer_half_float")||J.isWebGL2&&K.has("EXT_color_buffer_float"));if(!(l===M||xt.convert(l)===_t.getParameter(35738)||l===T&&(J.isWebGL2||K.has("OES_texture_float")||K.has("WEBGL_color_buffer_float"))||c))return;36053===_t.checkFramebufferStatus(36160)&&e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r&&_t.readPixels(e,n,i,r,xt.convert(a),xt.convert(l),s)}finally{const t=null!==S?tt.get(S).__webglFramebuffer:null;$.bindFramebuffer(36160,t)}}},this.copyFramebufferToTexture=function(t,e,n=0){if(!0!==e.isFramebufferTexture)return;const i=Math.pow(2,-n),r=Math.floor(e.image.width*i),s=Math.floor(e.image.height*i);et.setTexture2D(e,0),_t.copyTexSubImage2D(3553,n,0,0,t.x,t.y,r,s),$.unbindTexture()},this.copyTextureToTexture=function(t,e,n,i=0){const r=e.image.width,s=e.image.height,o=xt.convert(n.format),a=xt.convert(n.type);et.setTexture2D(n,0),_t.pixelStorei(37440,n.flipY),_t.pixelStorei(37441,n.premultiplyAlpha),_t.pixelStorei(3317,n.unpackAlignment),e.isDataTexture?_t.texSubImage2D(3553,i,t.x,t.y,r,s,o,a,e.image.data):e.isCompressedTexture?_t.compressedTexSubImage2D(3553,i,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,o,e.mipmaps[0].data):_t.texSubImage2D(3553,i,t.x,t.y,o,a,e.image),0===i&&n.generateMipmaps&&_t.generateMipmap(3553),$.unbindTexture()},this.copyTextureToTexture3D=function(t,e,n,i,r=0){if(g.isWebGL1Renderer)return;const s=t.max.x-t.min.x+1,o=t.max.y-t.min.y+1,a=t.max.z-t.min.z+1,l=xt.convert(i.format),c=xt.convert(i.type);let u;if(i.isDataTexture3D)et.setTexture3D(i,0),u=32879;else{if(!i.isDataTexture2DArray)return;et.setTexture2DArray(i,0),u=35866}_t.pixelStorei(37440,i.flipY),_t.pixelStorei(37441,i.premultiplyAlpha),_t.pixelStorei(3317,i.unpackAlignment);const h=_t.getParameter(3314),d=_t.getParameter(32878),p=_t.getParameter(3316),f=_t.getParameter(3315),m=_t.getParameter(32877),v=n.isCompressedTexture?n.mipmaps[0]:n.image;_t.pixelStorei(3314,v.width),_t.pixelStorei(32878,v.height),_t.pixelStorei(3316,t.min.x),_t.pixelStorei(3315,t.min.y),_t.pixelStorei(32877,t.min.z),n.isDataTexture||n.isDataTexture3D?_t.texSubImage3D(u,r,e.x,e.y,e.z,s,o,a,l,c,v.data):n.isCompressedTexture?_t.compressedTexSubImage3D(u,r,e.x,e.y,e.z,s,o,a,l,v.data):_t.texSubImage3D(u,r,e.x,e.y,e.z,s,o,a,l,c,v),_t.pixelStorei(3314,h),_t.pixelStorei(32878,d),_t.pixelStorei(3316,p),_t.pixelStorei(3315,f),_t.pixelStorei(32877,m),0===r&&i.generateMipmaps&&_t.generateMipmap(u),$.unbindTexture()},this.initTexture=function(t){et.setTexture2D(t,0),$.unbindTexture()},this.resetState=function(){_=0,b=0,S=null,$.reset(),yt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Ds.prototype.isWebGLRenderer=!0;(class extends Ds{}).prototype.isWebGL1Renderer=!0;class ks{constructor(t,e=25e-5){this.name="",this.color=new yt(t),this.density=e}clone(){return new ks(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}ks.prototype.isFogExp2=!0;class Rs{constructor(t,e=1,n=1e3){this.name="",this.color=new yt(t),this.near=e,this.far=n}clone(){return new Rs(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Rs.prototype.isFog=!0;class Is extends De{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}Is.prototype.isScene=!0;class zs{constructor(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=q,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=et()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=et()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=et()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}zs.prototype.isInterleavedBuffer=!0;const Os=new Et;class Ns{constructor(t,e,n,i=!1){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)Os.x=this.getX(e),Os.y=this.getY(e),Os.z=this.getZ(e),Os.applyMatrix4(t),this.setXYZ(e,Os.x,Os.y,Os.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Os.x=this.getX(e),Os.y=this.getY(e),Os.z=this.getZ(e),Os.applyNormalMatrix(t),this.setXYZ(e,Os.x,Os.y,Os.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Os.x=this.getX(e),Os.y=this.getY(e),Os.z=this.getZ(e),Os.transformDirection(t),this.setXYZ(e,Os.x,Os.y,Os.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}clone(t){if(void 0===t){const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new Ze(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Ns(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Ns.prototype.isInterleavedBufferAttribute=!0;class Fs extends We{constructor(t){super(),this.type="SpriteMaterial",this.color=new yt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}}let Bs;Fs.prototype.isSpriteMaterial=!0;const Us=new Et,Vs=new Et,Hs=new Et,js=new ct,Ws=new ct,Gs=new oe,qs=new Et,Xs=new Et,Zs=new Et,Ys=new ct,Ks=new ct,Js=new ct;class $s extends De{constructor(t){if(super(),this.type="Sprite",void 0===Bs){Bs=new on;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),e=new zs(t,5);Bs.setIndex([0,1,2,0,2,3]),Bs.setAttribute("position",new Ns(e,3,0,!1)),Bs.setAttribute("uv",new Ns(e,2,3,!1))}this.geometry=Bs,this.material=void 0!==t?t:new Fs,this.center=new ct(.5,.5)}raycast(t,e){t.camera,Vs.setFromMatrixScale(this.matrixWorld),Gs.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Hs.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Vs.multiplyScalar(-Hs.z);const n=this.material.rotation;let i,r;0!==n&&(r=Math.cos(n),i=Math.sin(n));const s=this.center;Qs(qs.set(-.5,-.5,0),Hs,s,Vs,i,r),Qs(Xs.set(.5,-.5,0),Hs,s,Vs,i,r),Qs(Zs.set(.5,.5,0),Hs,s,Vs,i,r),Ys.set(0,0),Ks.set(1,0),Js.set(1,1);let o=t.ray.intersectTriangle(qs,Xs,Zs,!1,Us);if(null===o&&(Qs(Xs.set(-.5,.5,0),Hs,s,Vs,i,r),Ks.set(0,1),o=t.ray.intersectTriangle(qs,Zs,Xs,!1,Us),null===o))return;const a=t.ray.origin.distanceTo(Us);a<t.near||a>t.far||e.push({distance:a,point:Us.clone(),uv:He.getUV(Us,qs,Xs,Zs,Ys,Ks,Js,new ct),face:null,object:this})}copy(t){return super.copy(t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}}function Qs(t,e,n,i,r,s){js.subVectors(t,n).addScalar(.5).multiply(i),void 0!==r?(Ws.x=s*js.x-r*js.y,Ws.y=r*js.x+s*js.y):Ws.copy(js),t.copy(e),t.x+=Ws.x,t.y+=Ws.y,t.applyMatrix4(Gs)}$s.prototype.isSprite=!0;const to=new Et,eo=new Ct,no=new Ct,io=new Et,ro=new oe;class so extends Sn{constructor(t,e){super(t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new oe,this.bindMatrixInverse=new oe}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Ct,e=this.geometry.attributes.skinWeight;for(let n=0,i=e.count;n<i;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}boneTransform(t,e){const n=this.skeleton,i=this.geometry;eo.fromBufferAttribute(i.attributes.skinIndex,t),no.fromBufferAttribute(i.attributes.skinWeight,t),to.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let t=0;t<4;t++){const i=no.getComponent(t);if(0!==i){const r=eo.getComponent(t);ro.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),e.addScaledVector(io.copy(to).applyMatrix4(ro),i)}}return e.applyMatrix4(this.bindMatrixInverse)}}so.prototype.isSkinnedMesh=!0;class oo extends De{constructor(){super(),this.type="Bone"}}oo.prototype.isBone=!0;class ao extends Mt{constructor(t=null,e=1,n=1,i,r,s,o,a,l=x,c=x,u,h){super(null,s,o,a,l,c,i,r,u,h),this.image={data:t,width:e,height:n},this.magFilter=l,this.minFilter=c,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}ao.prototype.isDataTexture=!0;class lo extends Ze{constructor(t,e,n,i=1){"number"==typeof n&&(i=n,n=!1),super(t,e,n),this.meshPerAttribute=i}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}lo.prototype.isInstancedBufferAttribute=!0;const co=new oe,uo=new oe,ho=[],po=new Sn;class fo extends Sn{constructor(t,e,n){super(t,e),this.instanceMatrix=new lo(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const n=this.matrixWorld,i=this.count;if(po.geometry=this.geometry,po.material=this.material,void 0!==po.material)for(let r=0;r<i;r++){this.getMatrixAt(r,co),uo.multiplyMatrices(n,co),po.matrixWorld=uo,po.raycast(t,ho);for(let t=0,n=ho.length;t<n;t++){const n=ho[t];n.instanceId=r,n.object=this,e.push(n)}ho.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new lo(new Float32Array(3*this.instanceMatrix.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}fo.prototype.isInstancedMesh=!0;class mo extends We{constructor(t){super(),this.type="LineBasicMaterial",this.color=new yt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this}}mo.prototype.isLineBasicMaterial=!0;const vo=new Et,go=new Et,xo=new oe,yo=new se,_o=new Jt;class bo extends De{constructor(t=new on,e=new mo){super(),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry){if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,i=e.count;t<i;t++)vo.fromBufferAttribute(e,t-1),go.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=vo.distanceTo(go);t.setAttribute("lineDistance",new Je(n,1))}}else t.isGeometry;return this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),_o.copy(n.boundingSphere),_o.applyMatrix4(i),_o.radius+=r,!1===t.ray.intersectsSphere(_o))return;xo.copy(i).invert(),yo.copy(t.ray).applyMatrix4(xo);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new Et,c=new Et,u=new Et,h=new Et,d=this.isLineSegments?2:1;if(n.isBufferGeometry){const i=n.index,r=n.attributes.position;if(null!==i){for(let n=Math.max(0,s.start),o=Math.min(i.count,s.start+s.count)-1;n<o;n+=d){const s=i.getX(n),o=i.getX(n+1);l.fromBufferAttribute(r,s),c.fromBufferAttribute(r,o);if(yo.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const d=t.ray.origin.distanceTo(h);d<t.near||d>t.far||e.push({distance:d,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else{for(let n=Math.max(0,s.start),i=Math.min(r.count,s.start+s.count)-1;n<i;n+=d){l.fromBufferAttribute(r,n),c.fromBufferAttribute(r,n+1);if(yo.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const i=t.ray.origin.distanceTo(h);i<t.near||i>t.far||e.push({distance:i,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}}else n.isGeometry}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length}}}bo.prototype.isLine=!0;const wo=new Et,Mo=new Et;class So extends bo{constructor(t,e){super(t,e),this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry){if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,i=e.count;t<i;t+=2)wo.fromBufferAttribute(e,t),Mo.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+wo.distanceTo(Mo);t.setAttribute("lineDistance",new Je(n,1))}}else t.isGeometry;return this}}So.prototype.isLineSegments=!0;class Co extends bo{constructor(t,e){super(t,e),this.type="LineLoop"}}Co.prototype.isLineLoop=!0;class To extends We{constructor(t){super(),this.type="PointsMaterial",this.color=new yt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this}}To.prototype.isPointsMaterial=!0;const Po=new oe,Ao=new se,Eo=new Jt,Lo=new Et;class Do extends De{constructor(t=new on,e=new To){super(),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Points.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Eo.copy(n.boundingSphere),Eo.applyMatrix4(i),Eo.radius+=r,!1===t.ray.intersectsSphere(Eo))return;Po.copy(i).invert(),Ao.copy(t.ray).applyMatrix4(Po);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(n.isBufferGeometry){const r=n.index,o=n.attributes.position;if(null!==r){for(let n=Math.max(0,s.start),l=Math.min(r.count,s.start+s.count);n<l;n++){const s=r.getX(n);Lo.fromBufferAttribute(o,s),ko(Lo,s,a,i,t,e,this)}}else{for(let n=Math.max(0,s.start),r=Math.min(o.count,s.start+s.count);n<r;n++)Lo.fromBufferAttribute(o,n),ko(Lo,n,a,i,t,e,this)}}}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length}}}function ko(t,e,n,i,r,s,o){const a=Ao.distanceSqToPoint(t);if(a<n){const n=new Et;Ao.closestPointToPoint(t,n),n.applyMatrix4(i);const l=r.ray.origin.distanceTo(n);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:n,index:e,face:null,object:o})}}Do.prototype.isPoints=!0;(class extends Mt{constructor(t,e,n,i,r,s,o,a,l){super(t,e,n,i,r,s,o,a,l),this.minFilter=void 0!==s?s:b,this.magFilter=void 0!==r?r:b,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback((function e(){c.needsUpdate=!0,t.requestVideoFrameCallback(e)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;!1==="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}).prototype.isVideoTexture=!0;(class extends Mt{constructor(t,e,n){super({width:t,height:e}),this.format=n,this.magFilter=x,this.minFilter=x,this.generateMipmaps=!1,this.needsUpdate=!0}}).prototype.isFramebufferTexture=!0;class Ro extends Mt{constructor(t,e,n,i,r,s,o,a,l,c,u,h){super(null,s,o,a,l,c,i,r,u,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}Ro.prototype.isCompressedTexture=!0;(class extends Mt{constructor(t,e,n,i,r,s,o,a,l){super(t,e,n,i,r,s,o,a,l),this.needsUpdate=!0}}).prototype.isCanvasTexture=!0;class Io extends on{constructor(t=[],e=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:i};const r=[],s=[];function o(t,e,n,i){const r=i+1,s=[];for(let i=0;i<=r;i++){s[i]=[];const o=t.clone().lerp(n,i/r),a=e.clone().lerp(n,i/r),l=r-i;for(let t=0;t<=l;t++)s[i][t]=0===t&&i===r?o:o.clone().lerp(a,t/l)}for(let t=0;t<r;t++)for(let e=0;e<2*(r-t)-1;e++){const n=Math.floor(e/2);e%2==0?(a(s[t][n+1]),a(s[t+1][n]),a(s[t][n])):(a(s[t][n+1]),a(s[t+1][n+1]),a(s[t+1][n]))}}function a(t){r.push(t.x,t.y,t.z)}function l(e,n){const i=3*e;n.x=t[i+0],n.y=t[i+1],n.z=t[i+2]}function c(t,e,n,i){i<0&&1===t.x&&(s[e]=t.x-1),0===n.x&&0===n.z&&(s[e]=i/2/Math.PI+.5)}function u(t){return Math.atan2(t.z,-t.x)}!function(t){const n=new Et,i=new Et,r=new Et;for(let s=0;s<e.length;s+=3)l(e[s+0],n),l(e[s+1],i),l(e[s+2],r),o(n,i,r,t)}(i),function(t){const e=new Et;for(let n=0;n<r.length;n+=3)e.x=r[n+0],e.y=r[n+1],e.z=r[n+2],e.normalize().multiplyScalar(t),r[n+0]=e.x,r[n+1]=e.y,r[n+2]=e.z}(n),function(){const t=new Et;for(let n=0;n<r.length;n+=3){t.x=r[n+0],t.y=r[n+1],t.z=r[n+2];const i=u(t)/2/Math.PI+.5,o=(e=t,Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5);s.push(i,1-o)}var e;(function(){const t=new Et,e=new Et,n=new Et,i=new Et,o=new ct,a=new ct,l=new ct;for(let h=0,d=0;h<r.length;h+=9,d+=6){t.set(r[h+0],r[h+1],r[h+2]),e.set(r[h+3],r[h+4],r[h+5]),n.set(r[h+6],r[h+7],r[h+8]),o.set(s[d+0],s[d+1]),a.set(s[d+2],s[d+3]),l.set(s[d+4],s[d+5]),i.copy(t).add(e).add(n).divideScalar(3);const p=u(i);c(o,d+0,t,p),c(a,d+2,e,p),c(l,d+4,n,p)}})(),function(){for(let t=0;t<s.length;t+=6){const e=s[t+0],n=s[t+2],i=s[t+4],r=Math.max(e,n,i),o=Math.min(e,n,i);r>.9&&o<.1&&(e<.2&&(s[t+0]+=1),n<.2&&(s[t+2]+=1),i<.2&&(s[t+4]+=1))}}()}(),this.setAttribute("position",new Je(r,3)),this.setAttribute("normal",new Je(r.slice(),3)),this.setAttribute("uv",new Je(s,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(t){return new Io(t.vertices,t.indices,t.radius,t.details)}}new Et,new Et,new Et,new He;class zo{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,i=this.getPoint(0),r=0;e.push(0);for(let s=1;s<=t;s++)n=this.getPoint(s/t),r+=n.distanceTo(i),e.push(r),i=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let i=0;const r=n.length;let s;s=e||t*n[r-1];let o,a=0,l=r-1;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),o=n[i]-s,o<0)a=i+1;else{if(!(o>0)){l=i;break}l=i-1}if(i=l,n[i]===s)return i/(r-1);const c=n[i];return(i+(s-c)/(n[i+1]-c))/(r-1)}getTangent(t,e){const n=1e-4;let i=t-n,r=t+n;i<0&&(i=0),r>1&&(r=1);const s=this.getPoint(i),o=this.getPoint(r),a=e||(s.isVector2?new ct:new Et);return a.copy(o).sub(s).normalize(),a}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new Et,i=[],r=[],s=[],o=new Et,a=new oe;for(let e=0;e<=t;e++){const n=e/t;i[e]=this.getTangentAt(n,new Et)}r[0]=new Et,s[0]=new Et;let l=Number.MAX_VALUE;const c=Math.abs(i[0].x),u=Math.abs(i[0].y),h=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],o),s[0].crossVectors(i[0],r[0]);for(let e=1;e<=t;e++){if(r[e]=r[e-1].clone(),s[e]=s[e-1].clone(),o.crossVectors(i[e-1],i[e]),o.length()>Number.EPSILON){o.normalize();const t=Math.acos(nt(i[e-1].dot(i[e]),-1,1));r[e].applyMatrix4(a.makeRotationAxis(o,t))}s[e].crossVectors(i[e],r[e])}if(!0===e){let e=Math.acos(nt(r[0].dot(r[t]),-1,1));e/=t,i[0].dot(o.crossVectors(r[0],r[t]))>0&&(e=-e);for(let n=1;n<=t;n++)r[n].applyMatrix4(a.makeRotationAxis(i[n],e*n)),s[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class Oo extends zo{constructor(t=0,e=0,n=1,i=1,r=0,s=2*Math.PI,o=!1,a=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(t,e){const n=e||new ct,i=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=s?0:i),!0!==this.aClockwise||s||(r===i?r=-i:r-=i);const o=this.aStartAngle+t*r;let a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=a-this.aX,i=l-this.aY;a=n*t-i*e+this.aX,l=n*e+i*t+this.aY}return n.set(a,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}Oo.prototype.isEllipseCurve=!0;class No extends Oo{constructor(t,e,n,i,r,s){super(t,e,n,n,i,r,s),this.type="ArcCurve"}}function Fo(){let t=0,e=0,n=0,i=0;function r(r,s,o,a){t=r,e=o,n=-3*r+3*s-2*o-a,i=2*r-2*s+o+a}return{initCatmullRom:function(t,e,n,i,s){r(e,n,s*(n-t),s*(i-e))},initNonuniformCatmullRom:function(t,e,n,i,s,o,a){let l=(e-t)/s-(n-t)/(s+o)+(n-e)/o,c=(n-e)/o-(i-e)/(o+a)+(i-n)/a;l*=o,c*=o,r(e,n,l,c)},calc:function(r){const s=r*r;return t+e*r+n*s+i*(s*r)}}}No.prototype.isArcCurve=!0;const Bo=new Et,Uo=new Fo,Vo=new Fo,Ho=new Fo;class jo extends zo{constructor(t=[],e=!1,n="centripetal",i=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=i}getPoint(t,e=new Et){const n=e,i=this.points,r=i.length,s=(r-(this.closed?0:1))*t;let o,a,l=Math.floor(s),c=s-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/r)+1)*r:0===c&&l===r-1&&(l=r-2,c=1),this.closed||l>0?o=i[(l-1)%r]:(Bo.subVectors(i[0],i[1]).add(i[0]),o=Bo);const u=i[l%r],h=i[(l+1)%r];if(this.closed||l+2<r?a=i[(l+2)%r]:(Bo.subVectors(i[r-1],i[r-2]).add(i[r-1]),a=Bo),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(o.distanceToSquared(u),t),n=Math.pow(u.distanceToSquared(h),t),i=Math.pow(h.distanceToSquared(a),t);n<1e-4&&(n=1),e<1e-4&&(e=n),i<1e-4&&(i=n),Uo.initNonuniformCatmullRom(o.x,u.x,h.x,a.x,e,n,i),Vo.initNonuniformCatmullRom(o.y,u.y,h.y,a.y,e,n,i),Ho.initNonuniformCatmullRom(o.z,u.z,h.z,a.z,e,n,i)}else"catmullrom"===this.curveType&&(Uo.initCatmullRom(o.x,u.x,h.x,a.x,this.tension),Vo.initCatmullRom(o.y,u.y,h.y,a.y,this.tension),Ho.initCatmullRom(o.z,u.z,h.z,a.z,this.tension));return n.set(Uo.calc(c),Vo.calc(c),Ho.calc(c)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new Et).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function Wo(t,e,n,i,r){const s=.5*(i-e),o=.5*(r-n),a=t*t;return(2*n-2*i+s+o)*(t*a)+(-3*n+3*i-2*s-o)*a+s*t+n}function Go(t,e,n,i){return function(t,e){const n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,i)}function qo(t,e,n,i,r){return function(t,e){const n=1-t;return n*n*n*e}(t,e)+function(t,e){const n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,i)+function(t,e){return t*t*t*e}(t,r)}jo.prototype.isCatmullRomCurve3=!0;class Xo extends zo{constructor(t=new ct,e=new ct,n=new ct,i=new ct){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new ct){const n=e,i=this.v0,r=this.v1,s=this.v2,o=this.v3;return n.set(qo(t,i.x,r.x,s.x,o.x),qo(t,i.y,r.y,s.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}Xo.prototype.isCubicBezierCurve=!0;class Zo extends zo{constructor(t=new Et,e=new Et,n=new Et,i=new Et){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new Et){const n=e,i=this.v0,r=this.v1,s=this.v2,o=this.v3;return n.set(qo(t,i.x,r.x,s.x,o.x),qo(t,i.y,r.y,s.y,o.y),qo(t,i.z,r.z,s.z,o.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}Zo.prototype.isCubicBezierCurve3=!0;class Yo extends zo{constructor(t=new ct,e=new ct){super(),this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new ct){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){const n=e||new ct;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Yo.prototype.isLineCurve=!0;class Ko extends zo{constructor(t=new ct,e=new ct,n=new ct){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new ct){const n=e,i=this.v0,r=this.v1,s=this.v2;return n.set(Go(t,i.x,r.x,s.x),Go(t,i.y,r.y,s.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Ko.prototype.isQuadraticBezierCurve=!0;class Jo extends zo{constructor(t=new Et,e=new Et,n=new Et){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Et){const n=e,i=this.v0,r=this.v1,s=this.v2;return n.set(Go(t,i.x,r.x,s.x),Go(t,i.y,r.y,s.y),Go(t,i.z,r.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Jo.prototype.isQuadraticBezierCurve3=!0;class $o extends zo{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,e=new ct){const n=e,i=this.points,r=(i.length-1)*t,s=Math.floor(r),o=r-s,a=i[0===s?s:s-1],l=i[s],c=i[s>i.length-2?i.length-1:s+1],u=i[s>i.length-3?i.length-1:s+2];return n.set(Wo(o,a.x,l.x,c.x,u.x),Wo(o,a.y,l.y,c.y,u.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new ct).fromArray(n))}return this}}$o.prototype.isSplineCurve=!0;var Qo=Object.freeze({__proto__:null,ArcCurve:No,CatmullRomCurve3:jo,CubicBezierCurve:Xo,CubicBezierCurve3:Zo,EllipseCurve:Oo,LineCurve:Yo,LineCurve3:class extends zo{constructor(t=new Et,e=new Et){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=t,this.v2=e}getPoint(t,e=new Et){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},QuadraticBezierCurve:Ko,QuadraticBezierCurve3:Jo,SplineCurve:$o});class ta extends zo{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Yo(e,t))}getPoint(t,e){const n=t*this.getLength(),i=this.getCurveLengths();let r=0;for(;r<i.length;){if(i[r]>=n){const t=i[r]-n,s=this.curves[r],o=s.getLength(),a=0===o?0:1-t/o;return s.getPointAt(a,e)}r++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const s=r[i],o=s&&s.isEllipseCurve?2*t:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?t*s.points.length:t,a=s.getPoints(o);for(let t=0;t<a.length;t++){const i=a[t];n&&n.equals(i)||(e.push(i),n=i)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const n=this.curves[e];t.curves.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new Qo[n.type]).fromJSON(n))}return this}}class ea extends ta{constructor(t){super(),this.type="Path",this.currentPoint=new ct,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new Yo(this.currentPoint.clone(),new ct(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,i){const r=new Ko(this.currentPoint.clone(),new ct(t,e),new ct(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(t,e,n,i,r,s){const o=new Xo(this.currentPoint.clone(),new ct(t,e),new ct(n,i),new ct(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new $o(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,i,r,s){const o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+o,e+a,n,i,r,s),this}absarc(t,e,n,i,r,s){return this.absellipse(t,e,n,n,i,r,s),this}ellipse(t,e,n,i,r,s,o,a){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,n,i,r,s,o,a),this}absellipse(t,e,n,i,r,s,o,a){const l=new Oo(t,e,n,i,r,s,o,a);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class na extends ea{constructor(t){super(t),this.uuid=et(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const n=this.holes[e];t.holes.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new ea).fromJSON(n))}return this}}const ia=function(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let s=ra(t,0,r,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,h,d,p;if(i&&(s=function(t,e,n,i){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:t.length,c=ra(t,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(ma(c));for(r.sort(ha),s=0;s<r.length;s++)da(r[s],n),n=sa(n,n.next);return n}(t,e,s,n)),t.length>80*n){a=c=t[0],l=u=t[1];for(let e=n;e<r;e+=n)h=t[e],d=t[e+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-a,u-l),p=0!==p?1/p:0}return oa(s,o,n,a,l,p),o};function ra(t,e,n,i,r){let s,o;if(r===function(t,e,n,i){let r=0;for(let s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}(t,e,n,i)>0)for(s=e;s<n;s+=i)o=Ca(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=Ca(s,t[s],t[s+1],o);return o&&ya(o,o.next)&&(Ta(o),o=o.next),o}function sa(t,e){if(!t)return t;e||(e=t);let n,i=t;do{if(n=!1,i.steiner||!ya(i,i.next)&&0!==xa(i.prev,i,i.next))i=i.next;else{if(Ta(i),i=e=i.prev,i===i.next)break;n=!0}}while(n||i!==e);return e}function oa(t,e,n,i,r,s,o){if(!t)return;!o&&s&&function(t,e,n,i){let r=t;do{null===r.z&&(r.z=fa(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){let e,n,i,r,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<c&&(a++,i=i.nextZ,i);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,c*=2}while(o>1)}(r)}(t,i,r,s);let a,l,c=t;for(;t.prev!==t.next;)if(a=t.prev,l=t.next,s?la(t,i,r,s):aa(t))e.push(a.i/n),e.push(t.i/n),e.push(l.i/n),Ta(t),t=l.next,c=l.next;else if((t=l)===c){o?1===o?oa(t=ca(sa(t),e,n),e,n,i,r,s,2):2===o&&ua(t,e,n,i,r,s):oa(sa(t),e,n,i,r,s,1);break}}function aa(t){const e=t.prev,n=t,i=t.next;if(xa(e,n,i)>=0)return!1;let r=t.next.next;for(;r!==t.prev;){if(va(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&xa(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function la(t,e,n,i){const r=t.prev,s=t,o=t.next;if(xa(r,s,o)>=0)return!1;const a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,l=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,c=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,u=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,h=fa(a,l,e,n,i),d=fa(c,u,e,n,i);let p=t.prevZ,f=t.nextZ;for(;p&&p.z>=h&&f&&f.z<=d;){if(p!==t.prev&&p!==t.next&&va(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&xa(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==t.prev&&f!==t.next&&va(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&xa(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&va(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&xa(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==t.prev&&f!==t.next&&va(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&xa(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function ca(t,e,n){let i=t;do{const r=i.prev,s=i.next.next;!ya(r,s)&&_a(r,i,i.next,s)&&Ma(r,s)&&Ma(s,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(s.i/n),Ta(i),Ta(i.next),i=t=s),i=i.next}while(i!==t);return sa(i)}function ua(t,e,n,i,r,s){let o=t;do{let t=o.next.next;for(;t!==o.prev;){if(o.i!==t.i&&ga(o,t)){let a=Sa(o,t);return o=sa(o,o.next),a=sa(a,a.next),oa(o,e,n,i,r,s),void oa(a,e,n,i,r,s)}t=t.next}o=o.next}while(o!==t)}function ha(t,e){return t.x-e.x}function da(t,e){if(e=function(t,e){let n=e;const i=t.x,r=t.y;let s,o=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const t=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=i&&t>o){if(o=t,t===i){if(r===n.y)return n;if(r===n.next.y)return n.next}s=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!s)return null;if(i===o)return s;const a=s,l=s.x,c=s.y;let u,h=1/0;n=s;do{i>=n.x&&n.x>=l&&i!==n.x&&va(r<c?i:o,r,l,c,r<c?o:i,r,n.x,n.y)&&(u=Math.abs(r-n.y)/(i-n.x),Ma(n,t)&&(u<h||u===h&&(n.x>s.x||n.x===s.x&&pa(s,n)))&&(s=n,h=u)),n=n.next}while(n!==a);return s}(t,e)){const n=Sa(e,t);sa(e,e.next),sa(n,n.next)}}function pa(t,e){return xa(t.prev,t,e.prev)<0&&xa(e.next,t,t.next)<0}function fa(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ma(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function va(t,e,n,i,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(i-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0}function ga(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&_a(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Ma(t,e)&&Ma(e,t)&&function(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(xa(t.prev,t,e.prev)||xa(t,e.prev,e))||ya(t,e)&&xa(t.prev,t,t.next)>0&&xa(e.prev,e,e.next)>0)}function xa(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function ya(t,e){return t.x===e.x&&t.y===e.y}function _a(t,e,n,i){const r=wa(xa(t,e,n)),s=wa(xa(t,e,i)),o=wa(xa(n,i,t)),a=wa(xa(n,i,e));return r!==s&&o!==a||(!(0!==r||!ba(t,n,e))||(!(0!==s||!ba(t,i,e))||(!(0!==o||!ba(n,t,i))||!(0!==a||!ba(n,e,i)))))}function ba(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function wa(t){return t>0?1:t<0?-1:0}function Ma(t,e){return xa(t.prev,t,t.next)<0?xa(t,e,t.next)>=0&&xa(t,t.prev,e)>=0:xa(t,e,t.prev)<0||xa(t,t.next,e)<0}function Sa(t,e){const n=new Pa(t.i,t.x,t.y),i=new Pa(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function Ca(t,e,n,i){const r=new Pa(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Ta(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Pa(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Aa{static area(t){const e=t.length;let n=0;for(let i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n}static isClockWise(t){return Aa.area(t)<0}static triangulateShape(t,e){const n=[],i=[],r=[];Ea(t),La(n,t);let s=t.length;e.forEach(Ea);for(let t=0;t<e.length;t++)i.push(s),s+=e[t].length,La(n,e[t]);const o=ia(n,i);for(let t=0;t<o.length;t+=3)r.push(o.slice(t,t+3));return r}}function Ea(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function La(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class Da extends on{constructor(t=new na([new ct(.5,.5),new ct(-.5,.5),new ct(-.5,-.5),new ct(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,i=[],r=[];for(let e=0,n=t.length;e<n;e++){s(t[e])}function s(t){const s=[],o=void 0!==e.curveSegments?e.curveSegments:12,a=void 0!==e.steps?e.steps:1;let l=void 0!==e.depth?e.depth:1,c=void 0===e.bevelEnabled||e.bevelEnabled,u=void 0!==e.bevelThickness?e.bevelThickness:.2,h=void 0!==e.bevelSize?e.bevelSize:u-.1,d=void 0!==e.bevelOffset?e.bevelOffset:0,p=void 0!==e.bevelSegments?e.bevelSegments:3;const f=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:ka;void 0!==e.amount&&(l=e.amount);let v,g,x,y,_,b=!1;f&&(v=f.getSpacedPoints(a),b=!0,c=!1,g=f.computeFrenetFrames(a,!1),x=new Et,y=new Et,_=new Et),c||(p=0,u=0,h=0,d=0);const w=t.extractPoints(o);let M=w.shape;const S=w.holes;if(!Aa.isClockWise(M)){M=M.reverse();for(let t=0,e=S.length;t<e;t++){const e=S[t];Aa.isClockWise(e)&&(S[t]=e.reverse())}}const C=Aa.triangulateShape(M,S),T=M;for(let t=0,e=S.length;t<e;t++){const e=S[t];M=M.concat(e)}function P(t,e,n){return e.clone().multiplyScalar(n).add(t)}const A=M.length,E=C.length;function L(t,e,n){let i,r,s;const o=t.x-e.x,a=t.y-e.y,l=n.x-t.x,c=n.y-t.y,u=o*o+a*a,h=o*c-a*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=e.x-a/h,f=e.y+o/h,m=((n.x-c/d-p)*c-(n.y+l/d-f)*l)/(o*c-a*l);i=p+o*m-t.x,r=f+a*m-t.y;const v=i*i+r*r;if(v<=2)return new ct(i,r);s=Math.sqrt(v/2)}else{let t=!1;o>Number.EPSILON?l>Number.EPSILON&&(t=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(t=!0):Math.sign(a)===Math.sign(c)&&(t=!0),t?(i=-a,r=o,s=Math.sqrt(u)):(i=o,r=a,s=Math.sqrt(u/2))}return new ct(i/s,r/s)}const D=[];for(let t=0,e=T.length,n=e-1,i=t+1;t<e;t++,n++,i++)n===e&&(n=0),i===e&&(i=0),D[t]=L(T[t],T[n],T[i]);const k=[];let R,I=D.concat();for(let t=0,e=S.length;t<e;t++){const e=S[t];R=[];for(let t=0,n=e.length,i=n-1,r=t+1;t<n;t++,i++,r++)i===n&&(i=0),r===n&&(r=0),R[t]=L(e[t],e[i],e[r]);k.push(R),I=I.concat(R)}for(let t=0;t<p;t++){const e=t/p,n=u*Math.cos(e*Math.PI/2),i=h*Math.sin(e*Math.PI/2)+d;for(let t=0,e=T.length;t<e;t++){const e=P(T[t],D[t],i);N(e.x,e.y,-n)}for(let t=0,e=S.length;t<e;t++){const e=S[t];R=k[t];for(let t=0,r=e.length;t<r;t++){const r=P(e[t],R[t],i);N(r.x,r.y,-n)}}}const z=h+d;for(let t=0;t<A;t++){const e=c?P(M[t],I[t],z):M[t];b?(y.copy(g.normals[0]).multiplyScalar(e.x),x.copy(g.binormals[0]).multiplyScalar(e.y),_.copy(v[0]).add(y).add(x),N(_.x,_.y,_.z)):N(e.x,e.y,0)}for(let t=1;t<=a;t++)for(let e=0;e<A;e++){const n=c?P(M[e],I[e],z):M[e];b?(y.copy(g.normals[t]).multiplyScalar(n.x),x.copy(g.binormals[t]).multiplyScalar(n.y),_.copy(v[t]).add(y).add(x),N(_.x,_.y,_.z)):N(n.x,n.y,l/a*t)}for(let t=p-1;t>=0;t--){const e=t/p,n=u*Math.cos(e*Math.PI/2),i=h*Math.sin(e*Math.PI/2)+d;for(let t=0,e=T.length;t<e;t++){const e=P(T[t],D[t],i);N(e.x,e.y,l+n)}for(let t=0,e=S.length;t<e;t++){const e=S[t];R=k[t];for(let t=0,r=e.length;t<r;t++){const r=P(e[t],R[t],i);b?N(r.x,r.y+v[a-1].y,v[a-1].x+n):N(r.x,r.y,l+n)}}}function O(t,e){let n=t.length;for(;--n>=0;){const i=n;let r=n-1;r<0&&(r=t.length-1);for(let t=0,n=a+2*p;t<n;t++){const n=A*t,s=A*(t+1);B(e+i+n,e+r+n,e+r+s,e+i+s)}}}function N(t,e,n){s.push(t),s.push(e),s.push(n)}function F(t,e,r){U(t),U(e),U(r);const s=i.length/3,o=m.generateTopUV(n,i,s-3,s-2,s-1);V(o[0]),V(o[1]),V(o[2])}function B(t,e,r,s){U(t),U(e),U(s),U(e),U(r),U(s);const o=i.length/3,a=m.generateSideWallUV(n,i,o-6,o-3,o-2,o-1);V(a[0]),V(a[1]),V(a[3]),V(a[1]),V(a[2]),V(a[3])}function U(t){i.push(s[3*t+0]),i.push(s[3*t+1]),i.push(s[3*t+2])}function V(t){r.push(t.x),r.push(t.y)}!function(){const t=i.length/3;if(c){let t=0,e=A*t;for(let t=0;t<E;t++){const n=C[t];F(n[2]+e,n[1]+e,n[0]+e)}t=a+2*p,e=A*t;for(let t=0;t<E;t++){const n=C[t];F(n[0]+e,n[1]+e,n[2]+e)}}else{for(let t=0;t<E;t++){const e=C[t];F(e[2],e[1],e[0])}for(let t=0;t<E;t++){const e=C[t];F(e[0]+A*a,e[1]+A*a,e[2]+A*a)}}n.addGroup(t,i.length/3-t,0)}(),function(){const t=i.length/3;let e=0;O(T,e),e+=T.length;for(let t=0,n=S.length;t<n;t++){const n=S[t];O(n,e),e+=n.length}n.addGroup(t,i.length/3-t,1)}()}this.setAttribute("position",new Je(i,3)),this.setAttribute("uv",new Je(r,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON();return function(t,e,n){if(n.shapes=[],Array.isArray(t))for(let e=0,i=t.length;e<i;e++){const i=t[e];n.shapes.push(i.uuid)}else n.shapes.push(t.uuid);void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){const n=[];for(let i=0,r=t.shapes.length;i<r;i++){const r=e[t.shapes[i]];n.push(r)}const i=t.options.extrudePath;return void 0!==i&&(t.options.extrudePath=(new Qo[i.type]).fromJSON(i)),new Da(n,t.options)}}const ka={generateTopUV:function(t,e,n,i,r){const s=e[3*n],o=e[3*n+1],a=e[3*i],l=e[3*i+1],c=e[3*r],u=e[3*r+1];return[new ct(s,o),new ct(a,l),new ct(c,u)]},generateSideWallUV:function(t,e,n,i,r,s){const o=e[3*n],a=e[3*n+1],l=e[3*n+2],c=e[3*i],u=e[3*i+1],h=e[3*i+2],d=e[3*r],p=e[3*r+1],f=e[3*r+2],m=e[3*s],v=e[3*s+1],g=e[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new ct(o,1-l),new ct(c,1-h),new ct(d,1-f),new ct(m,1-g)]:[new ct(a,1-l),new ct(u,1-h),new ct(p,1-f),new ct(v,1-g)]}};class Ra extends Io{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new Ra(t.radius,t.detail)}}class Ia extends on{constructor(t=new na([new ct(0,.5),new ct(-.5,-.5),new ct(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],i=[],r=[],s=[];let o=0,a=0;if(!1===Array.isArray(t))l(t);else for(let e=0;e<t.length;e++)l(t[e]),this.addGroup(o,a,e),o+=a,a=0;function l(t){const o=i.length/3,l=t.extractPoints(e);let c=l.shape;const u=l.holes;!1===Aa.isClockWise(c)&&(c=c.reverse());for(let t=0,e=u.length;t<e;t++){const e=u[t];!0===Aa.isClockWise(e)&&(u[t]=e.reverse())}const h=Aa.triangulateShape(c,u);for(let t=0,e=u.length;t<e;t++){const e=u[t];c=c.concat(e)}for(let t=0,e=c.length;t<e;t++){const e=c[t];i.push(e.x,e.y,0),r.push(0,0,1),s.push(e.x,e.y)}for(let t=0,e=h.length;t<e;t++){const e=h[t],i=e[0]+o,r=e[1]+o,s=e[2]+o;n.push(i,r,s),a+=3}}this.setIndex(n),this.setAttribute("position",new Je(i,3)),this.setAttribute("normal",new Je(r,3)),this.setAttribute("uv",new Je(s,2))}toJSON(){const t=super.toJSON();return function(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}static fromJSON(t,e){const n=[];for(let i=0,r=t.shapes.length;i<r;i++){const r=e[t.shapes[i]];n.push(r)}return new Ia(n,t.curveSegments)}}class za extends on{constructor(t=1,e=32,n=16,i=0,r=2*Math.PI,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:o},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));const a=Math.min(s+o,Math.PI);let l=0;const c=[],u=new Et,h=new Et,d=[],p=[],f=[],m=[];for(let d=0;d<=n;d++){const v=[],g=d/n;let x=0;0==d&&0==s?x=.5/e:d==n&&a==Math.PI&&(x=-.5/e);for(let n=0;n<=e;n++){const a=n/e;u.x=-t*Math.cos(i+a*r)*Math.sin(s+g*o),u.y=t*Math.cos(s+g*o),u.z=t*Math.sin(i+a*r)*Math.sin(s+g*o),p.push(u.x,u.y,u.z),h.copy(u).normalize(),f.push(h.x,h.y,h.z),m.push(a+x,1-g),v.push(l++)}c.push(v)}for(let t=0;t<n;t++)for(let i=0;i<e;i++){const e=c[t][i+1],r=c[t][i],o=c[t+1][i],l=c[t+1][i+1];(0!==t||s>0)&&d.push(e,r,l),(t!==n-1||a<Math.PI)&&d.push(r,o,l)}this.setIndex(d),this.setAttribute("position",new Je(p,3)),this.setAttribute("normal",new Je(f,3)),this.setAttribute("uv",new Je(m,2))}static fromJSON(t){return new za(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class Oa extends We{constructor(t){super(),this.type="ShadowMaterial",this.color=new yt(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}}Oa.prototype.isShadowMaterial=!0;class Na extends We{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new yt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ct(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}}Na.prototype.isMeshStandardMaterial=!0;class Fa extends Na{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ct(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return nt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new yt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new yt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new yt(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}Fa.prototype.isMeshPhysicalMaterial=!0;class Ba extends We{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new yt(16777215),this.specular=new yt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ct(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}}Ba.prototype.isMeshPhongMaterial=!0;class Ua extends We{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new yt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ct(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}Ua.prototype.isMeshToonMaterial=!0;class Va extends We{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ct(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}Va.prototype.isMeshNormalMaterial=!0;class Ha extends We{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new yt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}Ha.prototype.isMeshLambertMaterial=!0;class ja extends We{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new yt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ct(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this}}ja.prototype.isMeshMatcapMaterial=!0;class Wa extends mo{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}Wa.prototype.isLineDashedMaterial=!0;const Ga={arraySlice:function(t,e,n){return Ga.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const e=t.length,n=new Array(e);for(let t=0;t!==e;++t)n[t]=t;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){const i=t.length,r=new t.constructor(i);for(let s=0,o=0;o!==i;++s){const i=n[s]*e;for(let n=0;n!==e;++n)r[o++]=t[i+n]}return r},flattenJSON:function(t,e,n,i){let r=1,s=t[0];for(;void 0!==s&&void 0===s[i];)s=t[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),n.push.apply(n,o)),s=t[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(n,n.length)),s=t[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),n.push(o)),s=t[r++]}while(void 0!==s)},subclip:function(t,e,n,i,r=30){const s=t.clone();s.name=e;const o=[];for(let t=0;t<s.tracks.length;++t){const e=s.tracks[t],a=e.getValueSize(),l=[],c=[];for(let t=0;t<e.times.length;++t){const s=e.times[t]*r;if(!(s<n||s>=i)){l.push(e.times[t]);for(let n=0;n<a;++n)c.push(e.values[t*a+n])}}0!==l.length&&(e.times=Ga.convertArray(l,e.times.constructor),e.values=Ga.convertArray(c,e.values.constructor),o.push(e))}s.tracks=o;let a=1/0;for(let t=0;t<s.tracks.length;++t)a>s.tracks[t].times[0]&&(a=s.tracks[t].times[0]);for(let t=0;t<s.tracks.length;++t)s.tracks[t].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,s=e/i;for(let e=0;e<r;++e){const i=n.tracks[e],r=i.ValueTypeName;if("bool"===r||"string"===r)continue;const o=t.tracks.find((function(t){return t.name===i.name&&t.ValueTypeName===r}));if(void 0===o)continue;let a=0;const l=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const u=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=i.times.length-1;let d;if(s<=i.times[0]){const t=a,e=l-a;d=Ga.arraySlice(i.values,t,e)}else if(s>=i.times[h]){const t=h*l+a,e=t+l-a;d=Ga.arraySlice(i.values,t,e)}else{const t=i.createInterpolant(),e=a,n=l-a;t.evaluate(s),d=Ga.arraySlice(t.resultBuffer,e,n)}if("quaternion"===r){(new At).fromArray(d).normalize().conjugate().toArray(d)}const p=o.times.length;for(let t=0;t<p;++t){const e=t*u+c;if("quaternion"===r)At.multiplyQuaternionsFlat(o.values,e,d,0,o.values,e);else{const t=u-2*c;for(let n=0;n<t;++n)o.values[e+n]-=d[n]}}}return t.blendMode=2501,t}};class qa{constructor(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{let s;n:{i:if(!(t<i)){for(let s=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,r)}if(n===s)break;if(r=i,i=e[++n],t<i)break e}s=e.length;break n}if(t>=r)break t;{const o=e[1];t<o&&(n=2,r=o);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(n===s)break;if(i=r,r=e[--n-1],t>=r)break e}s=n,n=0}}for(;n<s;){const i=n+s>>>1;t<e[i]?s=i:n=i+1}if(i=e[n],r=e[n-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(void 0===i)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,r,t)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i;for(let t=0;t!==i;++t)e[t]=n[r+t];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}qa.prototype.beforeStart_=qa.prototype.copySampleValue_,qa.prototype.afterEnd_=qa.prototype.copySampleValue_;class Xa extends qa{constructor(t,e,n,i){super(t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:B,endingEnd:B}}intervalChanged_(t,e,n){const i=this.parameterPositions;let r=t-2,s=t+1,o=i[r],a=i[s];if(void 0===o)switch(this.getSettings_().endingStart){case U:r=t,o=2*e-n;break;case V:r=i.length-2,o=e+i[r]-i[r+1];break;default:r=t,o=n}if(void 0===a)switch(this.getSettings_().endingEnd){case U:s=t,a=2*n-e;break;case V:s=1,a=n+i[1]-i[0];break;default:s=t-1,a=e}const l=.5*(n-e),c=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(a-n),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-e)/(i-e),f=p*p,m=f*p,v=-h*m+2*h*f-h*p,g=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,x=(-1-d)*m+(1.5+d)*f+.5*p,y=d*m-d*f;for(let t=0;t!==o;++t)r[t]=v*s[c+t]+g*s[l+t]+x*s[a+t]+y*s[u+t];return r}}class Za extends qa{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,c=(n-e)/(i-e),u=1-c;for(let t=0;t!==o;++t)r[t]=s[l+t]*u+s[a+t]*c;return r}}class Ya extends qa{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t){return this.copySampleValue_(t-1)}}class Ka{constructor(t,e,n,i){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Ga.convertArray(e,this.TimeBufferType),this.values=Ga.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:Ga.convertArray(t.times,Array),values:Ga.convertArray(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new Ya(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new Za(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new Xa(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case O:e=this.InterpolantFactoryMethodDiscrete;break;case N:e=this.InterpolantFactoryMethodLinear;break;case F:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return O;case this.InterpolantFactoryMethodLinear:return N;case this.InterpolantFactoryMethodSmooth:return F}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]*=t}return this}trim(t,e){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<t;)++r;for(;-1!==s&&n[s]>e;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const t=this.getValueSize();this.times=Ga.arraySlice(n,r,s),this.values=Ga.arraySlice(this.values,r*t,s*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(t=!1);const n=this.times,i=this.values,r=n.length;0===r&&(t=!1);let s=null;for(let e=0;e!==r;e++){const i=n[e];if("number"==typeof i&&isNaN(i)){t=!1;break}if(null!==s&&s>i){t=!1;break}s=i}if(void 0!==i&&Ga.isTypedArray(i))for(let e=0,n=i.length;e!==n;++e){const n=i[e];if(isNaN(n)){t=!1;break}}return t}optimize(){const t=Ga.arraySlice(this.times),e=Ga.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===F,r=t.length-1;let s=1;for(let o=1;o<r;++o){let r=!1;const a=t[o];if(a!==t[o+1]&&(1!==o||a!==t[0]))if(i)r=!0;else{const t=o*n,i=t-n,s=t+n;for(let o=0;o!==n;++o){const n=e[t+o];if(n!==e[i+o]||n!==e[s+o]){r=!0;break}}}if(r){if(o!==s){t[s]=t[o];const i=o*n,r=s*n;for(let t=0;t!==n;++t)e[r+t]=e[i+t]}++s}}if(r>0){t[s]=t[r];for(let t=r*n,i=s*n,o=0;o!==n;++o)e[i+o]=e[t+o];++s}return s!==t.length?(this.times=Ga.arraySlice(t,0,s),this.values=Ga.arraySlice(e,0,s*n)):(this.times=t,this.values=e),this}clone(){const t=Ga.arraySlice(this.times,0),e=Ga.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}Ka.prototype.TimeBufferType=Float32Array,Ka.prototype.ValueBufferType=Float32Array,Ka.prototype.DefaultInterpolation=N;class Ja extends Ka{}Ja.prototype.ValueTypeName="bool",Ja.prototype.ValueBufferType=Array,Ja.prototype.DefaultInterpolation=O,Ja.prototype.InterpolantFactoryMethodLinear=void 0,Ja.prototype.InterpolantFactoryMethodSmooth=void 0;class $a extends Ka{}$a.prototype.ValueTypeName="color";class Qa extends Ka{}Qa.prototype.ValueTypeName="number";class tl extends qa{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(n-e)/(i-e);let l=t*o;for(let t=l+o;l!==t;l+=4)At.slerpFlat(r,0,s,l-o,s,l,a);return r}}class el extends Ka{InterpolantFactoryMethodLinear(t){return new tl(this.times,this.values,this.getValueSize(),t)}}el.prototype.ValueTypeName="quaternion",el.prototype.DefaultInterpolation=N,el.prototype.InterpolantFactoryMethodSmooth=void 0;class nl extends Ka{}nl.prototype.ValueTypeName="string",nl.prototype.ValueBufferType=Array,nl.prototype.DefaultInterpolation=O,nl.prototype.InterpolantFactoryMethodLinear=void 0,nl.prototype.InterpolantFactoryMethodSmooth=void 0;class il extends Ka{}il.prototype.ValueTypeName="vector";class rl{constructor(t,e=-1,n,i=2500){this.name=t,this.tracks=n,this.duration=e,this.blendMode=i,this.uuid=et(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,i=1/(t.fps||1);for(let t=0,r=n.length;t!==r;++t)e.push(sl(n[t]).scale(i));const r=new this(t.name,t.duration,e,t.blendMode);return r.uuid=t.uuid,r}static toJSON(t){const e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let t=0,i=n.length;t!==i;++t)e.push(Ka.toJSON(n[t]));return i}static CreateFromMorphTargetSequence(t,e,n,i){const r=e.length,s=[];for(let t=0;t<r;t++){let o=[],a=[];o.push((t+r-1)%r,t,(t+1)%r),a.push(0,1,0);const l=Ga.getKeyframeOrder(o);o=Ga.sortedArray(o,1,l),a=Ga.sortedArray(a,1,l),i||0!==o[0]||(o.push(r),a.push(a[0])),s.push(new Qa(".morphTargetInfluences["+e[t].name+"]",o,a).scale(1/n))}return new this(t,-1,s)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let t=0;t<n.length;t++)if(n[t].name===e)return n[t];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let e=0,n=t.length;e<n;e++){const n=t[e],s=n.name.match(r);if(s&&s.length>1){const t=s[1];let e=i[t];e||(i[t]=e=[]),e.push(n)}}const s=[];for(const t in i)s.push(this.CreateFromMorphTargetSequence(t,i[t],e,n));return s}static parseAnimation(t,e){if(!t)return null;const n=function(t,e,n,i,r){if(0!==n.length){const s=[],o=[];Ga.flattenJSON(n,s,o,i),0!==s.length&&r.push(new t(e,s,o))}},i=[],r=t.name||"default",s=t.fps||30,o=t.blendMode;let a=t.length||-1;const l=t.hierarchy||[];for(let t=0;t<l.length;t++){const r=l[t].keys;if(r&&0!==r.length)if(r[0].morphTargets){const t={};let e;for(e=0;e<r.length;e++)if(r[e].morphTargets)for(let n=0;n<r[e].morphTargets.length;n++)t[r[e].morphTargets[n]]=-1;for(const n in t){const t=[],s=[];for(let i=0;i!==r[e].morphTargets.length;++i){const i=r[e];t.push(i.time),s.push(i.morphTarget===n?1:0)}i.push(new Qa(".morphTargetInfluence["+n+"]",t,s))}a=t.length*(s||1)}else{const s=".bones["+e[t].name+"]";n(il,s+".position",r,"pos",i),n(el,s+".quaternion",r,"rot",i),n(il,s+".scale",r,"scl",i)}}if(0===i.length)return null;return new this(r,a,i,o)}resetDuration(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function sl(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Qa;case"vector":case"vector2":case"vector3":case"vector4":return il;case"color":return $a;case"quaternion":return el;case"bool":case"boolean":return Ja;case"string":return nl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],n=[];Ga.flattenJSON(t.keys,e,n,"value"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const ol={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class al{constructor(t,e,n){const i=this;let r,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===s&&void 0!==i.onStart&&i.onStart(t,o,a),s=!0},this.itemEnd=function(t){o++,void 0!==i.onProgress&&i.onProgress(t,o,a),o===a&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return r?r(t):t},this.setURLModifier=function(t){return r=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],i=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null}}}const ll=new al;class cl{constructor(t){this.manager=void 0!==t?t:ll,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise((function(i,r){n.load(t,i,e,r)}))}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const ul={};class hl extends cl{constructor(t){super(t)}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=ol.get(t);if(void 0!==r)return this.manager.itemStart(t),setTimeout((()=>{e&&e(r),this.manager.itemEnd(t)}),0),r;if(void 0!==ul[t])return void ul[t].push({onLoad:e,onProgress:n,onError:i});ul[t]=[],ul[t].push({onLoad:e,onProgress:n,onError:i});const s=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then((e=>{if(200===e.status||0===e.status){if(e.status,"undefined"==typeof ReadableStream||void 0===e.body.getReader)return e;const n=ul[t],i=e.body.getReader(),r=e.headers.get("Content-Length"),s=r?parseInt(r):0,o=0!==s;let a=0;const l=new ReadableStream({start(t){!function e(){i.read().then((({done:i,value:r})=>{if(i)t.close();else{a+=r.byteLength;const i=new ProgressEvent("progress",{lengthComputable:o,loaded:a,total:s});for(let t=0,e=n.length;t<e;t++){const e=n[t];e.onProgress&&e.onProgress(i)}t.enqueue(r),e()}}))}()}});return new Response(l)}throw Error(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`)})).then((t=>{switch(a){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then((t=>(new DOMParser).parseFromString(t,o)));case"json":return t.json();default:if(void 0===o)return t.text();{const e=/charset="?([^;"\s]*)"?/i.exec(o),n=e&&e[1]?e[1].toLowerCase():void 0,i=new TextDecoder(n);return t.arrayBuffer().then((t=>i.decode(t)))}}})).then((e=>{ol.add(t,e);const n=ul[t];delete ul[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onLoad&&i.onLoad(e)}})).catch((e=>{const n=ul[t];if(void 0===n)throw this.manager.itemError(t),e;delete ul[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onError&&i.onError(e)}this.manager.itemError(t)})).finally((()=>{this.manager.itemEnd(t)})),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class dl extends cl{constructor(t){super(t)}load(t,e,n,i){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=ol.get(t);if(void 0!==s)return r.manager.itemStart(t),setTimeout((function(){e&&e(s),r.manager.itemEnd(t)}),0),s;const o=dt("img");function a(){c(),ol.add(t,this),e&&e(this),r.manager.itemEnd(t)}function l(e){c(),i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)}function c(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(t),o.src=t,o}}class pl extends cl{constructor(t){super(t)}load(t,e,n,i){const r=new zn,s=new dl(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let o=0;function a(n){s.load(t[n],(function(t){r.images[n]=t,o++,6===o&&(r.needsUpdate=!0,e&&e(r))}),void 0,i)}for(let e=0;e<t.length;++e)a(e);return r}}class fl extends cl{constructor(t){super(t)}load(t,e,n,i){const r=new Mt,s=new dl(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,(function(t){r.image=t,r.needsUpdate=!0,void 0!==e&&e(r)}),n,i),r}}class ml extends De{constructor(t,e=1){super(),this.type="Light",this.color=new yt(t),this.intensity=e}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}ml.prototype.isLight=!0;class vl extends ml{constructor(t,e,n){super(t,n),this.type="HemisphereLight",this.position.copy(De.DefaultUp),this.updateMatrix(),this.groundColor=new yt(e)}copy(t){return ml.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}vl.prototype.isHemisphereLight=!0;const gl=new oe,xl=new Et,yl=new Et;class _l{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ct(512,512),this.map=null,this.mapPass=null,this.matrix=new oe,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new jn,this._frameExtents=new ct(1,1),this._viewportCount=1,this._viewports=[new Ct(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;xl.setFromMatrixPosition(t.matrixWorld),e.position.copy(xl),yl.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(yl),e.updateMatrixWorld(),gl.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(gl),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class bl extends _l{constructor(){super(new kn(50,1,.5,500)),this.focus=1}updateMatrices(t){const e=this.camera,n=2*tt*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;n===e.fov&&i===e.aspect&&r===e.far||(e.fov=n,e.aspect=i,e.far=r,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}bl.prototype.isSpotLightShadow=!0;class wl extends ml{constructor(t,e,n=0,i=Math.PI/3,r=0,s=1){super(t,e),this.type="SpotLight",this.position.copy(De.DefaultUp),this.updateMatrix(),this.target=new De,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.shadow=new bl}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}wl.prototype.isSpotLight=!0;const Ml=new oe,Sl=new Et,Cl=new Et;class Tl extends _l{constructor(){super(new kn(90,1,.5,500)),this._frameExtents=new ct(4,2),this._viewportCount=6,this._viewports=[new Ct(2,1,1,1),new Ct(0,1,1,1),new Ct(3,1,1,1),new Ct(1,1,1,1),new Ct(3,0,1,1),new Ct(1,0,1,1)],this._cubeDirections=[new Et(1,0,0),new Et(-1,0,0),new Et(0,0,1),new Et(0,0,-1),new Et(0,1,0),new Et(0,-1,0)],this._cubeUps=[new Et(0,1,0),new Et(0,1,0),new Et(0,1,0),new Et(0,1,0),new Et(0,0,1),new Et(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,i=this.matrix,r=t.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),Sl.setFromMatrixPosition(t.matrixWorld),n.position.copy(Sl),Cl.copy(n.position),Cl.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(Cl),n.updateMatrixWorld(),i.makeTranslation(-Sl.x,-Sl.y,-Sl.z),Ml.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ml)}}Tl.prototype.isPointLightShadow=!0;class Pl extends ml{constructor(t,e,n=0,i=1){super(t,e),this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new Tl}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}Pl.prototype.isPointLight=!0;class Al extends _l{constructor(){super(new ni(-5,5,5,-5,.5,500))}}Al.prototype.isDirectionalLightShadow=!0;class El extends ml{constructor(t,e){super(t,e),this.type="DirectionalLight",this.position.copy(De.DefaultUp),this.updateMatrix(),this.target=new De,this.shadow=new Al}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}El.prototype.isDirectionalLight=!0;class Ll extends ml{constructor(t,e){super(t,e),this.type="AmbientLight"}}Ll.prototype.isAmbientLight=!0;class Dl extends ml{constructor(t,e,n=10,i=10){super(t,e),this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}Dl.prototype.isRectAreaLight=!0;class kl{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new Et)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,i=t.y,r=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.282095),e.addScaledVector(s[1],.488603*i),e.addScaledVector(s[2],.488603*r),e.addScaledVector(s[3],.488603*n),e.addScaledVector(s[4],n*i*1.092548),e.addScaledVector(s[5],i*r*1.092548),e.addScaledVector(s[6],.315392*(3*r*r-1)),e.addScaledVector(s[7],n*r*1.092548),e.addScaledVector(s[8],.546274*(n*n-i*i)),e}getIrradianceAt(t,e){const n=t.x,i=t.y,r=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.886227),e.addScaledVector(s[1],1.023328*i),e.addScaledVector(s[2],1.023328*r),e.addScaledVector(s[3],1.023328*n),e.addScaledVector(s[4],.858086*n*i),e.addScaledVector(s[5],.858086*i*r),e.addScaledVector(s[6],.743125*r*r-.247708),e.addScaledVector(s[7],.858086*n*r),e.addScaledVector(s[8],.429043*(n*n-i*i)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(t,e+3*i);return this}toArray(t=[],e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(t,e+3*i);return t}static getBasisAt(t,e){const n=t.x,i=t.y,r=t.z;e[0]=.282095,e[1]=.488603*i,e[2]=.488603*r,e[3]=.488603*n,e[4]=1.092548*n*i,e[5]=1.092548*i*r,e[6]=.315392*(3*r*r-1),e[7]=1.092548*n*r,e[8]=.546274*(n*n-i*i)}}kl.prototype.isSphericalHarmonics3=!0;class Rl extends ml{constructor(t=new kl,e=1){super(void 0,e),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}Rl.prototype.isLightProbe=!0;class Il{static decodeText(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let n=0,i=t.length;n<i;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(t){return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}static resolveURL(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}class zl extends on{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}zl.prototype.isInstancedBufferGeometry=!0;let Ol;(class extends cl{constructor(t){super(t),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=ol.get(t);if(void 0!==s)return r.manager.itemStart(t),setTimeout((function(){e&&e(s),r.manager.itemEnd(t)}),0),s;const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(t,o).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,Object.assign(r.options,{colorSpaceConversion:"none"}))})).then((function(n){ol.add(t,n),e&&e(n),r.manager.itemEnd(t)})).catch((function(e){i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)})),r.manager.itemStart(t)}}).prototype.isImageBitmapLoader=!0;const Nl=function(){return void 0===Ol&&(Ol=new(window.AudioContext||window.webkitAudioContext)),Ol};class Fl extends cl{constructor(t){super(t)}load(t,e,n,i){const r=this,s=new hl(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(n){try{const t=n.slice(0);Nl().decodeAudioData(t,(function(t){e(t)}))}catch(e){i&&i(e),r.manager.itemError(t)}}),n,i)}}(class extends Rl{constructor(t,e,n=1){super(void 0,n);const i=(new yt).set(t),r=(new yt).set(e),s=new Et(i.r,i.g,i.b),o=new Et(r.r,r.g,r.b),a=Math.sqrt(Math.PI),l=a*Math.sqrt(.75);this.sh.coefficients[0].copy(s).add(o).multiplyScalar(a),this.sh.coefficients[1].copy(s).sub(o).multiplyScalar(l)}}).prototype.isHemisphereLightProbe=!0;(class extends Rl{constructor(t,e=1){super(void 0,e);const n=(new yt).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}).prototype.isAmbientLightProbe=!0;class Bl{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Ul(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const e=Ul();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}function Ul(){return("undefined"==typeof performance?Date:performance).now()}class Vl extends De{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return;if(!1===this.hasPlaybackControl)return;this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1!==this.hasPlaybackControl&&this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}class Hl{constructor(t,e,n){let i,r,s;switch(this.binding=t,this.valueSize=n,e){case"quaternion":i=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,i=this.valueSize,r=t*i+i;let s=this.cumulativeWeight;if(0===s){for(let t=0;t!==i;++t)n[r+t]=n[t];s=e}else{s+=e;const t=e/s;this._mixBufferRegion(n,r,0,t,i)}this.cumulativeWeight=s}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,i,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,i=t*e+e,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const t=e*this._origIndex;this._mixBufferRegion(n,i,t,1-r,e)}s>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*e,1,e);for(let t=e,r=e+e;t!==r;++t)if(n[t]!==n[t+e]){o.setValue(n,i);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,i=n*this._origIndex;t.getValue(e,i);for(let t=n,r=i;t!==r;++t)e[t]=e[i+t%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,i,r){if(i>=.5)for(let i=0;i!==r;++i)t[e+i]=t[n+i]}_slerp(t,e,n,i){At.slerpFlat(t,e,t,e,t,n,i)}_slerpAdditive(t,e,n,i,r){const s=this._workIndex*r;At.multiplyQuaternionsFlat(t,s,t,e,t,n),At.slerpFlat(t,e,t,e,t,s,i)}_lerp(t,e,n,i,r){const s=1-i;for(let o=0;o!==r;++o){const r=e+o;t[r]=t[r]*s+t[n+o]*i}}_lerpAdditive(t,e,n,i,r){for(let s=0;s!==r;++s){const r=e+s;t[r]=t[r]+t[n+s]*i}}}const jl="\\[\\]\\.:\\/",Wl=new RegExp("[\\[\\]\\.:\\/]","g"),Gl="[^\\[\\]\\.:\\/]",ql="[^"+jl.replace("\\.","")+"]",Xl=/((?:WC+[\/:])*)/.source.replace("WC",Gl),Zl=/(WCOD+)?/.source.replace("WCOD",ql),Yl=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Gl),Kl=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Gl),Jl=new RegExp("^"+Xl+Zl+Yl+Kl+"$"),$l=["material","materials","bones"];class Ql{constructor(t,e,n){this.path=e,this.parsedPath=n||Ql.parseTrackName(e),this.node=Ql.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new Ql.Composite(t,e,n):new Ql(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Wl,"")}static parseTrackName(t){const e=Jl.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const t=n.nodeName.substring(i+1);-1!==$l.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let i=0;i<t.length;i++){const r=t[i];if(r.name===e||r.uuid===e)return r;const s=n(r.children);if(s)return s}return null},i=n(t.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)t[e++]=n[i]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,i=e.propertyName;let r=e.propertyIndex;if(t||(t=Ql.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return;if(n){let i=e.objectIndex;switch(n){case"materials":if(!t.material)return;if(!t.material.materials)return;t=t.material.materials;break;case"bones":if(!t.skeleton)return;t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===i){i=e;break}break;default:if(void 0===t[n])return;t=t[n]}if(void 0!==i){if(void 0===t[i])return;t=t[i]}}const s=t[i];if(void 0===s){e.nodeName;return}let o=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return;if(!t.geometry.isBufferGeometry)return;if(!t.geometry.morphAttributes)return;void 0!==t.morphTargetDictionary[r]&&(r=t.morphTargetDictionary[r])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ql.Composite=class{constructor(t,e,n){const i=n||Ql.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},Ql.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Ql.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Ql.prototype.GetterByBindingType=[Ql.prototype._getValue_direct,Ql.prototype._getValue_array,Ql.prototype._getValue_arrayElement,Ql.prototype._getValue_toArray],Ql.prototype.SetterByBindingTypeAndVersioning=[[Ql.prototype._setValue_direct,Ql.prototype._setValue_direct_setNeedsUpdate,Ql.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ql.prototype._setValue_array,Ql.prototype._setValue_array_setNeedsUpdate,Ql.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ql.prototype._setValue_arrayElement,Ql.prototype._setValue_arrayElement_setNeedsUpdate,Ql.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ql.prototype._setValue_fromArray,Ql.prototype._setValue_fromArray_setNeedsUpdate,Ql.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];(class{constructor(){this.uuid=et(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}add(){const t=this._objects,e=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,s=r.length;let o,a=t.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=e[h];if(void 0===d){d=a++,e[h]=d,t.push(u);for(let t=0,e=s;t!==e;++t)r[t].push(new Ql(u,n[t],i[t]))}else if(d<l){o=t[d];const a=--l,c=t[a];e[c.uuid]=d,t[d]=c,e[h]=a,t[a]=u;for(let t=0,e=s;t!==e;++t){const e=r[t],s=e[a];let o=e[d];e[d]=s,void 0===o&&(o=new Ql(u,n[t],i[t])),e[a]=o}}else t[d]}this.nCachedObjects_=l}remove(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let s=0,o=arguments.length;s!==o;++s){const o=arguments[s],a=o.uuid,l=e[a];if(void 0!==l&&l>=r){const s=r++,c=t[s];e[c.uuid]=l,t[l]=c,e[a]=s,t[s]=o;for(let t=0,e=i;t!==e;++t){const e=n[t],i=e[s],r=e[l];e[l]=i,e[s]=r}}}this.nCachedObjects_=r}uncache(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,s=t.length;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o].uuid,l=e[a];if(void 0!==l)if(delete e[a],l<r){const o=--r,a=t[o],c=--s,u=t[c];e[a.uuid]=l,t[l]=a,e[u.uuid]=o,t[o]=u,t.pop();for(let t=0,e=i;t!==e;++t){const e=n[t],i=e[o],r=e[c];e[l]=i,e[o]=r,e.pop()}}else{const r=--s,o=t[r];r>0&&(e[o.uuid]=l),t[l]=o,t.pop();for(let t=0,e=i;t!==e;++t){const e=n[t];e[l]=e[r],e.pop()}}}this.nCachedObjects_=r}subscribe_(t,e){const n=this._bindingsIndicesByPath;let i=n[t];const r=this._bindings;if(void 0!==i)return r[i];const s=this._paths,o=this._parsedPaths,a=this._objects,l=a.length,c=this.nCachedObjects_,u=new Array(l);i=r.length,n[t]=i,s.push(t),o.push(e),r.push(u);for(let n=c,i=a.length;n!==i;++n){const i=a[n];u[n]=new Ql(i,t,e)}return u}unsubscribe_(t){const e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){const i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length-1,a=s[o];e[t[o]]=n,s[n]=a,s.pop(),r[n]=r[o],r.pop(),i[n]=i[o],i.pop()}}}).prototype.isAnimationObjectGroup=!0;class tc{constructor(t,e,n=null,i=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=i;const r=e.tracks,s=r.length,o=new Array(s),a={endingStart:B,endingEnd:B};for(let t=0;t!==s;++t){const e=r[t].createInterpolant(null);o[t]=e,e.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const n=this._clip.duration,i=t._clip.duration,r=i/n,s=n/i;t.warp(1,r,e),this.warp(s,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const i=this._mixer,r=i.time,s=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=r,a[1]=r+n,l[0]=t/s,l[1]=e/s,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,i){if(!this.enabled)return void this._updateWeight(t);const r=this._startTime;if(null!==r){const i=(t-r)*n;if(i<0||0===n)return;this._startTime=null,e=n*i}e*=this._updateTimeScale(t);const s=this._updateTime(e),o=this._updateWeight(t);if(o>0){const t=this._interpolants,e=this._propertyBindings;switch(this.blendMode){case 2501:for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(s),e[n].accumulateAdditive(o);break;case H:default:for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(s),e[n].accumulate(i,o)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let i=this.time+t,r=this._loopCount;const s=2202===n;if(0===t)return-1===r?i:s&&1==(1&r)?e-i:i;if(2200===n){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(i>=e)i=e;else{if(!(i<0)){this.time=i;break t}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),i>=e||i<0){const n=Math.floor(i/e);i-=e*n,r+=Math.abs(n);const o=this.repetitions-r;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=t>0?e:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===o){const e=t<0;this._setEndings(e,!e,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(s&&1==(1&r))return e-i}return i}_setEndings(t,e,n){const i=this._interpolantSettings;n?(i.endingStart=U,i.endingEnd=U):(i.endingStart=t?this.zeroSlopeAtStart?U:B:V,i.endingEnd=e?this.zeroSlopeAtEnd?U:B:V)}_scheduleFading(t,e,n){const i=this._mixer,r=i.time;let s=this._weightInterpolant;null===s&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);const o=s.parameterPositions,a=s.sampleValues;return o[0]=r,a[0]=e,o[1]=r+t,a[1]=n,this}}(class extends K{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,s=t._propertyBindings,o=t._interpolants,a=n.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let t=0;t!==r;++t){const r=i[t],l=r.name;let u=c[l];if(void 0!==u)++u.referenceCount,s[t]=u;else{if(u=s[t],void 0!==u){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,a,l));continue}const i=e&&e._propertyBindings[t].binding.parsedPath;u=new Hl(Ql.create(n,l,i),r.ValueTypeName,r.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,a,l),s[t]=u}o[t].resultBuffer=u.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,i=this._actionsByClip[n];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,n){const i=this._actions,r=this._actionsByClip;let s=r[e];if(void 0===s)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=s;else{const e=s.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=i.length,i.push(t),s.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;const r=t._clip.uuid,s=this._actionsByClip,o=s[r],a=o.knownActions,l=a[a.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),t._byClipCacheIndex=null;delete o.actionByRoot[(t._localRoot||this._root).uuid],0===a.length&&delete s[r],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.referenceCount&&this._removeInactiveBinding(n)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_addInactiveBinding(t,e,n){const i=this._bindingsByRootAndName,r=this._bindings;let s=i[e];void 0===s&&(s={},i[e]=s),s[n]=t,t._cacheIndex=r.length,r.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,i=n.rootNode.uuid,r=n.path,s=this._bindingsByRootAndName,o=s[i],a=e[e.length-1],l=t._cacheIndex;a._cacheIndex=l,e[l]=a,e.pop(),delete o[r],0===Object.keys(o).length&&delete s[i]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new Za(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r}clipAction(t,e,n){const i=e||this._root,r=i.uuid;let s="string"==typeof t?rl.findByName(i,t):t;const o=null!==s?s.uuid:t,a=this._actionsByClip[o];let l=null;if(void 0===n&&(n=null!==s?s.blendMode:H),void 0!==a){const t=a.actionByRoot[r];if(void 0!==t&&t.blendMode===n)return t;l=a.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;const c=new tc(this,s,e,n);return this._bindAction(c,l),this._addInactiveAction(c,o,r),c}existingAction(t,e){const n=e||this._root,i=n.uuid,r="string"==typeof t?rl.findByName(n,t):t,s=r?r.uuid:t,o=this._actionsByClip[s];return void 0!==o&&o.actionByRoot[i]||null}stopAllAction(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this}update(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,i=this.time+=t,r=Math.sign(t),s=this._accuIndex^=1;for(let o=0;o!==n;++o){e[o]._update(i,t,r,s)}const o=this._bindings,a=this._nActiveBindings;for(let t=0;t!==a;++t)o[t].apply(s);return this}setTime(t){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){const t=r.knownActions;for(let n=0,i=t.length;n!==i;++n){const i=t[n];this._deactivateAction(i);const r=i._cacheIndex,s=e[e.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,s._cacheIndex=r,e[r]=s,e.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const t in n){const i=n[t].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}const i=this._bindingsByRootAndName[e];if(void 0!==i)for(const t in i){const e=i[t];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class ec{constructor(t){"string"==typeof t&&(t=arguments[1]),this.value=t}clone(){return new ec(void 0===this.value.clone?this.value:this.value.clone())}}(class extends zs{constructor(t,e,n=1){super(t,e),this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}).prototype.isInstancedInterleavedBuffer=!0;(class{constructor(t,e,n,i,r){this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=i,this.count=r,this.version=0}set needsUpdate(t){!0===t&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,e){return this.type=t,this.elementSize=e,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}}).prototype.isGLBufferAttribute=!0;class nc{constructor(t,e,n=0,i=1/0){this.ray=new se(t,e),this.near=n,this.far=i,this.camera=null,this.layers=new ge,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera&&(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e)}intersectObject(t,e=!0,n=[]){return rc(t,this,n,e),n.sort(ic),n}intersectObjects(t,e=!0,n=[]){for(let i=0,r=t.length;i<r;i++)rc(t[i],this,n,e);return n.sort(ic),n}}function ic(t,e){return t.distance-e.distance}function rc(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===i){const i=t.children;for(let t=0,r=i.length;t<r;t++)rc(i[t],e,n,!0)}}const sc=new ct;class oc{constructor(t=new ct(1/0,1/0),e=new ct(-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=sc.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return sc.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}oc.prototype.isBox2=!0;const ac=new Et,lc=new Et;const cc=new Et,uc=new oe,hc=new oe;function dc(t){const e=[];t&&t.isBone&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,dc(t.children[n]));return e}const pc=new Float32Array(1);new Int32Array(pc.buffer);zo.create=function(t,e){return t.prototype=Object.create(zo.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},ea.prototype.fromPoints=function(t){return this.setFromPoints(t)},class extends So{constructor(t=10,e=10,n=4473924,i=8947848){n=new yt(n),i=new yt(i);const r=e/2,s=t/e,o=t/2,a=[],l=[];for(let t=0,c=0,u=-o;t<=e;t++,u+=s){a.push(-o,0,u,o,0,u),a.push(u,0,-o,u,0,o);const e=t===r?n:i;e.toArray(l,c),c+=3,e.toArray(l,c),c+=3,e.toArray(l,c),c+=3,e.toArray(l,c),c+=3}const c=new on;c.setAttribute("position",new Je(a,3)),c.setAttribute("color",new Je(l,3));super(c,new mo({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){},class extends So{constructor(t){const e=dc(t),n=new on,i=[],r=[],s=new yt(0,0,1),o=new yt(0,1,0);for(let t=0;t<e.length;t++){const n=e[t];n.parent&&n.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(s.r,s.g,s.b),r.push(o.r,o.g,o.b))}n.setAttribute("position",new Je(i,3)),n.setAttribute("color",new Je(r,3));super(n,new mo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,i=n.getAttribute("position");hc.copy(this.root.matrixWorld).invert();for(let t=0,n=0;t<e.length;t++){const r=e[t];r.parent&&r.parent.isBone&&(uc.multiplyMatrices(hc,r.matrixWorld),cc.setFromMatrixPosition(uc),i.setXYZ(n,cc.x,cc.y,cc.z),uc.multiplyMatrices(hc,r.parent.matrixWorld),cc.setFromMatrixPosition(uc),i.setXYZ(n+1,cc.x,cc.y,cc.z),n+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}.prototype.update=function(){},cl.prototype.extractUrlBase=function(t){return Il.extractUrlBase(t)},cl.Handlers={add:function(){},get:function(){}},oc.prototype.center=function(t){return this.getCenter(t)},oc.prototype.empty=function(){return this.isEmpty()},oc.prototype.isIntersectionBox=function(t){return this.intersectsBox(t)},oc.prototype.size=function(t){return this.getSize(t)},kt.prototype.center=function(t){return this.getCenter(t)},kt.prototype.empty=function(){return this.isEmpty()},kt.prototype.isIntersectionBox=function(t){return this.intersectsBox(t)},kt.prototype.isIntersectionSphere=function(t){return this.intersectsSphere(t)},kt.prototype.size=function(t){return this.getSize(t)},Jt.prototype.empty=function(){return this.isEmpty()},jn.prototype.setFromMatrix=function(t){return this.setFromProjectionMatrix(t)},class{constructor(t=new Et,e=new Et){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){ac.subVectors(t,this.start),lc.subVectors(this.end,this.start);const n=lc.dot(lc);let i=lc.dot(ac)/n;return e&&(i=nt(i,0,1)),i}closestPointToPoint(t,e,n){const i=this.closestPointToPointParameter(t,e);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}.prototype.center=function(t){return this.getCenter(t)},ut.prototype.flattenToArrayOffset=function(t,e){return this.toArray(t,e)},ut.prototype.multiplyVector3=function(t){return t.applyMatrix3(this)},ut.prototype.multiplyVector3Array=function(){},ut.prototype.applyToBufferAttribute=function(t){return t.applyMatrix3(this)},ut.prototype.applyToVector3Array=function(){},ut.prototype.getInverse=function(t){return this.copy(t).invert()},oe.prototype.extractPosition=function(t){return this.copyPosition(t)},oe.prototype.flattenToArrayOffset=function(t,e){return this.toArray(t,e)},oe.prototype.getPosition=function(){return(new Et).setFromMatrixColumn(this,3)},oe.prototype.setRotationFromQuaternion=function(t){return this.makeRotationFromQuaternion(t)},oe.prototype.multiplyToArray=function(){},oe.prototype.multiplyVector3=function(t){return t.applyMatrix4(this)},oe.prototype.multiplyVector4=function(t){return t.applyMatrix4(this)},oe.prototype.multiplyVector3Array=function(){},oe.prototype.rotateAxis=function(t){t.transformDirection(this)},oe.prototype.crossVector=function(t){return t.applyMatrix4(this)},oe.prototype.translate=function(){},oe.prototype.rotateX=function(){},oe.prototype.rotateY=function(){},oe.prototype.rotateZ=function(){},oe.prototype.rotateByAxis=function(){},oe.prototype.applyToBufferAttribute=function(t){return t.applyMatrix4(this)},oe.prototype.applyToVector3Array=function(){},oe.prototype.makeFrustum=function(t,e,n,i,r,s){return this.makePerspective(t,e,i,n,r,s)},oe.prototype.getInverse=function(t){return this.copy(t).invert()},Un.prototype.isIntersectionLine=function(t){return this.intersectsLine(t)},At.prototype.multiplyVector3=function(t){return t.applyQuaternion(this)},At.prototype.inverse=function(){return this.invert()},se.prototype.isIntersectionBox=function(t){return this.intersectsBox(t)},se.prototype.isIntersectionPlane=function(t){return this.intersectsPlane(t)},se.prototype.isIntersectionSphere=function(t){return this.intersectsSphere(t)},He.prototype.area=function(){return this.getArea()},He.prototype.barycoordFromPoint=function(t,e){return this.getBarycoord(t,e)},He.prototype.midpoint=function(t){return this.getMidpoint(t)},He.prototypenormal=function(t){return this.getNormal(t)},He.prototype.plane=function(t){return this.getPlane(t)},He.barycoordFromPoint=function(t,e,n,i,r){return He.getBarycoord(t,e,n,i,r)},He.normal=function(t,e,n,i){return He.getNormal(t,e,n,i)},na.prototype.extractAllPoints=function(t){return this.extractPoints(t)},na.prototype.extrude=function(t){return new Da(this,t)},na.prototype.makeGeometry=function(t){return new Ia(this,t)},ct.prototype.fromAttribute=function(t,e,n){return this.fromBufferAttribute(t,e,n)},ct.prototype.distanceToManhattan=function(t){return this.manhattanDistanceTo(t)},ct.prototype.lengthManhattan=function(){return this.manhattanLength()},Et.prototype.setEulerFromRotationMatrix=function(){},Et.prototype.setEulerFromQuaternion=function(){},Et.prototype.getPositionFromMatrix=function(t){return this.setFromMatrixPosition(t)},Et.prototype.getScaleFromMatrix=function(t){return this.setFromMatrixScale(t)},Et.prototype.getColumnFromMatrix=function(t,e){return this.setFromMatrixColumn(e,t)},Et.prototype.applyProjection=function(t){return this.applyMatrix4(t)},Et.prototype.fromAttribute=function(t,e,n){return this.fromBufferAttribute(t,e,n)},Et.prototype.distanceToManhattan=function(t){return this.manhattanDistanceTo(t)},Et.prototype.lengthManhattan=function(){return this.manhattanLength()},Ct.prototype.fromAttribute=function(t,e,n){return this.fromBufferAttribute(t,e,n)},Ct.prototype.lengthManhattan=function(){return this.manhattanLength()},De.prototype.getChildByName=function(t){return this.getObjectByName(t)},De.prototype.renderDepth=function(){},De.prototype.translate=function(t,e){return this.translateOnAxis(e,t)},De.prototype.getWorldRotation=function(){},De.prototype.applyMatrix=function(t){return this.applyMatrix4(t)},Object.defineProperties(De.prototype,{eulerOrder:{get:function(){return this.rotation.order},set:function(t){this.rotation.order=t}},useQuaternion:{get:function(){},set:function(){}}}),Sn.prototype.setDrawMode=function(){},Object.defineProperties(Sn.prototype,{drawMode:{get:function(){return 0},set:function(){}}}),so.prototype.initBones=function(){},kn.prototype.setLens=function(t,e){void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(ml.prototype,{onlyShadow:{set:function(){}},shadowCameraFov:{set:function(t){this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){}},shadowBias:{set:function(t){this.shadow.bias=t}},shadowDarkness:{set:function(){}},shadowMapWidth:{set:function(t){this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){this.shadow.mapSize.height=t}}}),Object.defineProperties(Ze.prototype,{length:{get:function(){return this.array.length}},dynamic:{get:function(){return this.usage===X},set:function(){this.setUsage(X)}}}),Ze.prototype.setDynamic=function(t){return this.setUsage(!0===t?X:q),this},Ze.prototype.copyIndicesArray=function(){},Ze.prototype.setArray=function(){},on.prototype.addIndex=function(t){this.setIndex(t)},on.prototype.addAttribute=function(t,e){return e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(this.setIndex(e),this):this.setAttribute(t,e):this.setAttribute(t,new Ze(arguments[1],arguments[2]))},on.prototype.addDrawCall=function(t,e,n){this.addGroup(t,e)},on.prototype.clearDrawCalls=function(){this.clearGroups()},on.prototype.computeOffsets=function(){},on.prototype.removeAttribute=function(t){return this.deleteAttribute(t)},on.prototype.applyMatrix=function(t){return this.applyMatrix4(t)},Object.defineProperties(on.prototype,{drawcalls:{get:function(){return this.groups}},offsets:{get:function(){return this.groups}}}),zs.prototype.setDynamic=function(t){return this.setUsage(!0===t?X:q),this},zs.prototype.setArray=function(){},Da.prototype.getArrays=function(){},Da.prototype.addShapeList=function(){},Da.prototype.addShape=function(){},Is.prototype.dispose=function(){},ec.prototype.onUpdate=function(){return this},Object.defineProperties(We.prototype,{wrapAround:{get:function(){},set:function(){}},overdraw:{get:function(){},set:function(){}},wrapRGB:{get:function(){return new yt}},shading:{get:function(){},set:function(t){this.flatShading=1===t}},stencilMask:{get:function(){return this.stencilFuncMask},set:function(t){this.stencilFuncMask=t}},vertexTangents:{get:function(){},set:function(){}}}),Object.defineProperties(Ln.prototype,{derivatives:{get:function(){return this.extensions.derivatives},set:function(t){this.extensions.derivatives=t}}}),Ds.prototype.clearTarget=function(t,e,n,i){this.setRenderTarget(t),this.clear(e,n,i)},Ds.prototype.animate=function(t){this.setAnimationLoop(t)},Ds.prototype.getCurrentRenderTarget=function(){return this.getRenderTarget()},Ds.prototype.getMaxAnisotropy=function(){return this.capabilities.getMaxAnisotropy()},Ds.prototype.getPrecision=function(){return this.capabilities.precision},Ds.prototype.resetGLState=function(){return this.state.reset()},Ds.prototype.supportsFloatTextures=function(){return this.extensions.get("OES_texture_float")},Ds.prototype.supportsHalfFloatTextures=function(){return this.extensions.get("OES_texture_half_float")},Ds.prototype.supportsStandardDerivatives=function(){return this.extensions.get("OES_standard_derivatives")},Ds.prototype.supportsCompressedTextureS3TC=function(){return this.extensions.get("WEBGL_compressed_texture_s3tc")},Ds.prototype.supportsCompressedTexturePVRTC=function(){return this.extensions.get("WEBGL_compressed_texture_pvrtc")},Ds.prototype.supportsBlendMinMax=function(){return this.extensions.get("EXT_blend_minmax")},Ds.prototype.supportsVertexTextures=function(){return this.capabilities.vertexTextures},Ds.prototype.supportsInstancedArrays=function(){return this.extensions.get("ANGLE_instanced_arrays")},Ds.prototype.enableScissorTest=function(t){this.setScissorTest(t)},Ds.prototype.initMaterial=function(){},Ds.prototype.addPrePlugin=function(){},Ds.prototype.addPostPlugin=function(){},Ds.prototype.updateShadowMap=function(){},Ds.prototype.setFaceCulling=function(){},Ds.prototype.allocTextureUnit=function(){},Ds.prototype.setTexture=function(){},Ds.prototype.setTexture2D=function(){},Ds.prototype.setTextureCube=function(){},Ds.prototype.getActiveMipMapLevel=function(){return this.getActiveMipmapLevel()},Object.defineProperties(Ds.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){this.shadowMap.type=t}},shadowMapCullFace:{get:function(){},set:function(){}},context:{get:function(){return this.getContext()}},vr:{get:function(){return this.xr}},gammaInput:{get:function(){return!1},set:function(){}},gammaOutput:{get:function(){return!1},set:function(t){this.outputEncoding=!0===t?W:j}},toneMappingWhitePoint:{get:function(){return 1},set:function(){}},gammaFactor:{get:function(){return 2},set:function(){}}}),Object.defineProperties(_s.prototype,{cullFace:{get:function(){},set:function(){}},renderReverseSided:{get:function(){},set:function(){}},renderSingleSided:{get:function(){},set:function(){}}}),Object.defineProperties(Tt.prototype,{wrapS:{get:function(){return this.texture.wrapS},set:function(t){this.texture.wrapS=t}},wrapT:{get:function(){return this.texture.wrapT},set:function(t){this.texture.wrapT=t}},magFilter:{get:function(){return this.texture.magFilter},set:function(t){this.texture.magFilter=t}},minFilter:{get:function(){return this.texture.minFilter},set:function(t){this.texture.minFilter=t}},anisotropy:{get:function(){return this.texture.anisotropy},set:function(t){this.texture.anisotropy=t}},offset:{get:function(){return this.texture.offset},set:function(t){this.texture.offset=t}},repeat:{get:function(){return this.texture.repeat},set:function(t){this.texture.repeat=t}},format:{get:function(){return this.texture.format},set:function(t){this.texture.format=t}},type:{get:function(){return this.texture.type},set:function(t){this.texture.type=t}},generateMipmaps:{get:function(){return this.texture.generateMipmaps},set:function(t){this.texture.generateMipmaps=t}}}),Vl.prototype.load=function(t){const e=this;return(new Fl).load(t,(function(t){e.setBuffer(t)})),this},class{constructor(t,e=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const e=this.getFrequencyData();for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}}.prototype.getData=function(){return this.getFrequencyData()},In.prototype.updateCubeMap=function(t,e){return this.update(t,e)},In.prototype.clear=function(t,e,n,i){return this.renderTarget.clear(t,e,n,i)},bt.crossOrigin=void 0,bt.loadTexture=function(t,e,n,i){const r=new fl;r.setCrossOrigin(this.crossOrigin);const s=r.load(t,n,void 0,i);return e&&(s.mapping=e),s},bt.loadTextureCube=function(t,e,n,i){const r=new pl;r.setCrossOrigin(this.crossOrigin);const s=r.load(t,n,void 0,i);return e&&(s.mapping=e),s},bt.loadCompressedTexture=function(){},bt.loadCompressedTextureCube=function(){};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:i}})),"undefined"!=typeof window&&(window.__THREE__||(window.__THREE__=i))},498:function(t,e){!function(t){"use strict";class e{constructor(t){const[e,n]=t.split("-"),i=e.split(".");this.major=parseInt(i[0],10),this.minor=parseInt(i[1],10),this.patch=parseInt(i[2],10),this.prerelease=null!=n?n:null}toString(){const t=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[t,this.prerelease].join("-"):t}}class n{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class i{constructor(t){this.target=t}}class r extends i{constructor(t,e,n,i){super(t),this.value=e,this.presetKey=n,this.last=null==i||i}}class s extends i{constructor(t,e,n){super(t),this.value=e,this.presetKey=n}}class o extends i{constructor(t,e){super(t),this.expanded=e}}function a(t){return t}function l(t){return null==t}function c(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}const u={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class h{constructor(t){var e;this.message=null!==(e=u[t.type](a(t.context)))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}static alreadyDisposed(){return new h({type:"alreadydisposed"})}static notBindable(){return new h({type:"notbindable"})}static propertyNotFound(t){return new h({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new h({type:"shouldneverhappen"})}}class d{constructor(t,e,n){this.obj_=t,this.key_=e,this.presetKey_=null!=n?n:e}static isBindable(t){return null!==t&&"object"==typeof t}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(t){this.obj_[this.key_]=t}writeProperty(t,e){const n=this.read();if(!d.isBindable(n))throw h.notBindable();if(!(t in n))throw h.propertyNotFound(t);n[t]=e}}class p extends n{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get title(){var t;return null!==(t=this.controller_.valueController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.valueController.props.set("title",t)}on(t,e){const n=e.bind(this);return this.controller_.valueController.emitter.on(t,(()=>{n(new i(this))})),this}}class f{constructor(){this.observers_={}}on(t,e){let n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this}off(t,e){const n=this.observers_[t];return n&&(this.observers_[t]=n.filter((t=>t.handler!==e))),this}emit(t,e){const n=this.observers_[t];n&&n.forEach((t=>{t.handler(e)}))}}const m="tp";function v(t){return(e,n)=>[m,"-",t,"v",e?`_${e}`:"",n?`-${n}`:""].join("")}function g(t,e){return n=>e(t(n))}function x(t){return t.rawValue}function y(t,e){t.emitter.on("change",g(x,e)),e(t.rawValue)}function _(t,e,n){y(t.value(e),n)}function b(t,e,n){n?t.classList.add(e):t.classList.remove(e)}function w(t,e){return n=>{b(t,e,n)}}function M(t,e){y(t,(t=>{e.textContent=null!=t?t:""}))}const S=v("btn");class C{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(S()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("button");n.classList.add(S("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=t.createElement("div");i.classList.add(S("t")),M(e.props.value("title"),i),this.buttonElement.appendChild(i)}}class T{constructor(t,e){this.emitter=new f,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new C(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class P{constructor(t,e){var n;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(n=null==e?void 0:e.equals)&&void 0!==n?n:(t,e)=>t===e,this.emitter=new f,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=null!=e?e:{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(t):t;(!this.equals_(this.rawValue_,i)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:n,rawValue:i,sender:this}))}}class A{constructor(t){this.emitter=new f,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=null!=e?e:{forceEmit:!1,last:!0};(this.value_!==t||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:n,rawValue:this.value_,sender:this}))}}function E(t,e){const n=null==e?void 0:e.constraint,i=null==e?void 0:e.equals;return n||i?new P(t,e):new A(t)}class L{constructor(t){this.emitter=new f,this.valMap_=t;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",(()=>{this.emitter.emit("change",{key:t,sender:this})}))}static createCore(t){return Object.keys(t).reduce(((e,n)=>Object.assign(e,{[n]:E(t[n])})),{})}static fromObject(t){const e=this.createCore(t);return new L(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function D(t,e){return a(Object.keys(e).reduce(((n,i)=>{if(void 0===n)return;const r=(0,e[i])(t[i]);return r.succeeded?Object.assign(Object.assign({},n),{[i]:r.value}):void 0}),{}))}function k(t,e){return t.reduce(((t,n)=>{if(void 0===t)return;const i=e(n);return i.succeeded&&void 0!==i.value?[...t,i.value]:void 0}),[])}function R(t){return null!==t&&"object"==typeof t}function I(t){return e=>n=>{if(!e&&void 0===n)return{succeeded:!1,value:void 0};if(e&&void 0===n)return{succeeded:!0,value:void 0};const i=t(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function z(t){return{custom:e=>I(e)(t),boolean:I((t=>"boolean"==typeof t?t:void 0))(t),number:I((t=>"number"==typeof t?t:void 0))(t),string:I((t=>"string"==typeof t?t:void 0))(t),function:I((t=>"function"==typeof t?t:void 0))(t),constant:e=>I((t=>t===e?e:void 0))(t),raw:I((t=>t))(t),object:e=>I((t=>{if(R(t))return D(t,e)}))(t),array:e=>I((t=>{if(Array.isArray(t))return k(t,e)}))(t)}}const O={optional:z(!0),required:z(!1)};function N(t,e){const n=O.required.object(e)(t);return n.succeeded?n.value:void 0}function F(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}function B(){return["veryfirst","first","last","verylast"]}const U=v(""),V={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class H{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{B().forEach((t=>{e.classList.remove(U(void 0,V[t]))})),this.blade.get("positions").forEach((t=>{e.classList.add(U(void 0,V[t]))}))})),this.viewProps.handleDispose((()=>{F(e)}))}get parent(){return this.parent_}}const j="http://www.w3.org/2000/svg";function W(t){t.offsetHeight}function G(t,e){const n=t.style.transition;t.style.transition="none",e(),t.style.transition=n}function q(t){return void 0!==t.ontouchstart}function X(){return new Function("return this")()}function Z(){return a(X()).document}function Y(t){const e=t.ownerDocument.defaultView;return e&&"document"in e?t.getContext("2d"):null}const K={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function J(t,e){const n=t.createElementNS(j,"svg");return n.innerHTML=K[e],n}function $(t,e,n){t.insertBefore(e,t.children[n])}function Q(t){t.parentElement&&t.parentElement.removeChild(t)}function tt(t){for(;t.children.length>0;)t.removeChild(t.children[0])}function et(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}function nt(t){return t.relatedTarget?a(t.relatedTarget):"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}const it=v("lbl");function rt(t,e){const n=t.createDocumentFragment();return e.split("\n").map((e=>t.createTextNode(e))).forEach(((e,i)=>{i>0&&n.appendChild(t.createElement("br")),n.appendChild(e)})),n}class st{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(it()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(it("l")),_(e.props,"label",(e=>{l(e)?this.element.classList.add(it(void 0,"nol")):(this.element.classList.remove(it(void 0,"nol")),et(n),n.appendChild(rt(t,e)))})),this.element.appendChild(n),this.labelElement=n;const i=t.createElement("div");i.classList.add(it("v")),this.element.appendChild(i),this.valueElement=i}}class ot extends H{constructor(t,e){const n=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new st(t,{props:e.props,viewProps:n}),viewProps:n})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const at={id:"button",type:"blade",accept(t){const e=O,n=N(t,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return n?{params:n}:null},controller:t=>new ot(t.document,{blade:t.blade,props:L.fromObject({label:t.params.label}),valueController:new T(t.document,{props:L.fromObject({title:t.params.title}),viewProps:t.viewProps})}),api:t=>t.controller instanceof ot&&t.controller.valueController instanceof T?new p(t.controller):null};class lt extends H{constructor(t){super(t),this.value=t.value}}function ct(){return new L({positions:E([],{equals:c})})}class ut extends L{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=L.createCore(e);return new ut(n)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!l(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const n=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};_(this,"expanded",n),_(this,"temporaryExpanded",n)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function ht(t,e){let n=0;return G(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),W(e),n=e.clientHeight,t.set("temporaryExpanded",null),W(e)})),n}function dt(t,e){e.style.height=t.styleHeight}function pt(t,e){t.value("expanded").emitter.on("beforechange",(()=>{t.set("completed",!1),l(t.get("expandedHeight"))&&t.set("expandedHeight",ht(t,e)),t.set("shouldFixHeight",!0),W(e)})),t.emitter.on("change",(()=>{dt(t,e)})),dt(t,e),e.addEventListener("transitionend",(e=>{"height"===e.propertyName&&t.cleanUpTransition()}))}class ft extends n{constructor(t,e){super(t),this.rackApi_=e}}function mt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function vt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function gt(t,e){const n=e||{};return t.addBlade(Object.assign(Object.assign({},n),{view:"separator"}))}function xt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}class yt{constructor(t){this.emitter=new f,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(t){for(const e of this.allItems())if(t(e))return e;return null}includes(t){return this.cache_.has(t)}add(t,e){if(this.includes(t))throw h.shouldNeverHappen();const n=void 0!==e?e:this.items_.length;this.items_.splice(n,0,t),this.cache_.add(t);const i=this.extract_(t);i&&(i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach((t=>{this.cache_.add(t)}))),this.emitter.emit("add",{index:n,item:t,root:this,target:this})}remove(t){const e=this.items_.indexOf(t);if(e<0)return;this.items_.splice(e,1),this.cache_.delete(t);const n=this.extract_(t);n&&(n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}onSubListAdd_(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}onSubListRemove_(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}}class _t extends n{constructor(t){super(t),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new f,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}refresh(){this.controller_.binding.read()}onBindingChange_(t){const e=t.sender.target.read();this.emitter_.emit("change",{event:new r(this,a(e),this.controller_.binding.target.presetKey,t.options.last)})}}class bt extends ot{constructor(t,e){super(t,e),this.binding=e.binding}}class wt extends n{constructor(t){super(t),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new f,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(t){const e=t.sender.target.read();this.emitter_.emit("update",{event:new s(this,a(e),this.controller_.binding.target.presetKey)})}}class Mt extends ot{constructor(t,e){super(t,e),this.binding=e.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose((()=>{this.binding.dispose()}))}}function St(t){return t instanceof Pt?t.apiSet_:t instanceof ft?t.rackApi_.apiSet_:null}function Ct(t,e){const n=t.find((t=>t.controller_===e));if(!n)throw h.shouldNeverHappen();return n}function Tt(t,e,n){if(!d.isBindable(t))throw h.notBindable();return new d(t,e,n)}class Pt extends n{constructor(t,e){super(t),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new f,this.apiSet_=new yt(St),this.pool_=e;const n=this.controller_.rack;n.emitter.on("add",this.onRackAdd_),n.emitter.on("remove",this.onRackRemove_),n.emitter.on("inputchange",this.onRackInputChange_),n.emitter.on("monitorupdate",this.onRackMonitorUpdate_),n.children.forEach((t=>{this.setUpApi_(t)}))}get children(){return this.controller_.rack.children.map((t=>Ct(this.apiSet_,t)))}addInput(t,e,n){const i=n||{},r=this.controller_.view.element.ownerDocument,s=this.pool_.createInput(r,Tt(t,e,i.presetKey),i),o=new _t(s);return this.add(o,i.index)}addMonitor(t,e,n){const i=n||{},r=this.controller_.view.element.ownerDocument,s=this.pool_.createMonitor(r,Tt(t,e),i),o=new wt(s);return a(this.add(o,i.index))}addFolder(t){return vt(this,t)}addButton(t){return mt(this,t)}addSeparator(t){return gt(this,t)}addTab(t){return xt(this,t)}add(t,e){this.controller_.rack.add(t.controller_,e);const n=this.apiSet_.find((e=>e.controller_===t.controller_));return n&&this.apiSet_.remove(n),this.apiSet_.add(t),t}remove(t){this.controller_.rack.remove(t.controller_)}addBlade(t){const e=this.controller_.view.element.ownerDocument,n=this.pool_.createBlade(e,t),i=this.pool_.createBladeApi(n);return this.add(i,t.index)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}setUpApi_(t){this.apiSet_.find((e=>e.controller_===t))||this.apiSet_.add(this.pool_.createBladeApi(t))}onRackAdd_(t){this.setUpApi_(t.bladeController)}onRackRemove_(t){if(t.isRoot){const e=Ct(this.apiSet_,t.bladeController);this.apiSet_.remove(e)}}onRackInputChange_(t){const e=t.bladeController;if(e instanceof bt){const n=Ct(this.apiSet_,e),i=e.binding;this.emitter_.emit("change",{event:new r(n,a(i.target.read()),i.target.presetKey,t.options.last)})}else if(e instanceof lt){const n=Ct(this.apiSet_,e);this.emitter_.emit("change",{event:new r(n,e.value.rawValue,void 0,t.options.last)})}}onRackMonitorUpdate_(t){if(!(t.bladeController instanceof Mt))throw h.shouldNeverHappen();const e=Ct(this.apiSet_,t.bladeController),n=t.bladeController.binding;this.emitter_.emit("update",{event:new s(e,a(n.target.read()),n.target.presetKey)})}}class At extends ft{constructor(t,e){super(t,new Pt(t.rackController,e)),this.emitter_=new f,this.controller_.foldable.value("expanded").emitter.on("change",(t=>{this.emitter_.emit("fold",{event:new o(this,t.sender.rawValue)})})),this.rackApi_.on("change",(t=>{this.emitter_.emit("change",{event:t})})),this.rackApi_.on("update",(t=>{this.emitter_.emit("update",{event:t})}))}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(t){this.controller_.foldable.set("expanded",t)}get title(){return this.controller_.props.get("title")}set title(t){this.controller_.props.set("title",t)}get children(){return this.rackApi_.children}addInput(t,e,n){return this.rackApi_.addInput(t,e,n)}addMonitor(t,e,n){return this.rackApi_.addMonitor(t,e,n)}addFolder(t){return this.rackApi_.addFolder(t)}addButton(t){return this.rackApi_.addButton(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){return this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBlade(t){return this.rackApi_.addBlade(t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}}class Et extends H{constructor(t){super({blade:t.blade,view:t.view,viewProps:t.rackController.viewProps}),this.rackController=t.rackController}}class Lt{constructor(t,e){const n=v(e.viewName);this.element=t.createElement("div"),this.element.classList.add(n()),e.viewProps.bindClassModifiers(this.element)}}function Dt(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(i instanceof bt&&i.binding===e)return i}return null}function kt(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(i instanceof Mt&&i.binding===e)return i}return null}function Rt(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(i instanceof lt&&i.value===e)return i}return null}function It(t){return t instanceof Nt?t.rack:t instanceof Et?t.rackController.rack:null}function zt(t){const e=It(t);return e?e.bcSet_:null}class Ot{constructor(t){var e;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new f,this.blade_=null!=t?t:null,null===(e=this.blade_)||void 0===e||e.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new yt(zt),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(t,e){t.parent&&t.parent.remove(t),t.parent_=this,this.bcSet_.add(t,e)}remove(t){t.parent_=null,this.bcSet_.remove(t)}find(t){return a(this.bcSet_.allItems().filter((e=>e instanceof t)))}onSetAdd_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,isRoot:e,sender:this}),!e)return;const n=t.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),n instanceof bt)n.binding.emitter.on("change",this.onChildInputChange_);else if(n instanceof Mt)n.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(n instanceof lt)n.value.emitter.on("change",this.onChildValueChange_);else{const t=It(n);if(t){const e=t.emitter;e.on("layout",this.onDescendantLayout_),e.on("inputchange",this.onDescendantInputChange_),e.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,isRoot:e,sender:this}),!e)return;const n=t.item;if(n instanceof bt)n.binding.emitter.off("change",this.onChildInputChange_);else if(n instanceof Mt)n.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(n instanceof lt)n.value.emitter.off("change",this.onChildValueChange_);else{const t=It(n);if(t){const e=t.emitter;e.off("layout",this.onDescendantLayout_),e.off("inputchange",this.onDescendantInputChange_),e.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const t=this.bcSet_.items.filter((t=>!t.viewProps.get("hidden"))),e=t[0],n=t[t.length-1];this.bcSet_.items.forEach((t=>{const i=[];t===e&&(i.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||i.push("veryfirst")),t===n&&(i.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||i.push("verylast")),t.blade.set("positions",i)}))}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((t=>t.viewProps.get("disposed"))).forEach((t=>{this.bcSet_.remove(t)}))}onChildInputChange_(t){const e=Dt(this.find(bt),t.sender);if(!e)throw h.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onChildMonitorUpdate_(t){const e=kt(this.find(Mt),t.sender);if(!e)throw h.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:e,sender:this})}onChildValueChange_(t){const e=Rt(this.find(lt),t.sender);if(!e)throw h.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onDescendantLayout_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(t){this.emitter.emit("inputchange",{bladeController:t.bladeController,options:t.options,sender:this})}onDescendantMonitorUpdate_(t){this.emitter.emit("monitorupdate",{bladeController:t.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class Nt extends H{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new Lt(t,{viewName:"brk",viewProps:e.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const n=new Ot(e.root?void 0:e.blade);n.emitter.on("add",this.onRackAdd_),n.emitter.on("remove",this.onRackRemove_),this.rack=n,this.viewProps.handleDispose((()=>{for(let t=this.rack.children.length-1;t>=0;t--)this.rack.children[t].viewProps.set("disposed",!0)}))}onRackAdd_(t){t.isRoot&&$(this.view.element,t.bladeController.view.element,t.index)}onRackRemove_(t){t.isRoot&&Q(t.bladeController.view.element)}}const Ft=v("cnt");class Bt{constructor(t,e){this.className_=v(e.viewName||"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),Ft()),e.viewProps.bindClassModifiers(this.element),this.foldable_=e.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),_(this.foldable_,"completed",w(this.element,this.className_(void 0,"cpl")));const n=t.createElement("button");n.classList.add(this.className_("b")),_(e.props,"title",(t=>{l(t)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))})),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=t.createElement("div");i.classList.add(this.className_("t")),M(e.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i;const r=t.createElement("div");r.classList.add(this.className_("m")),this.buttonElement.appendChild(r);const s=e.containerElement;s.classList.add(this.className_("c")),this.element.appendChild(s),this.containerElement=s}}class Ut extends Et{constructor(t,e){var n;const i=ut.create(null===(n=e.expanded)||void 0===n||n),r=new Nt(t,{blade:e.blade,root:e.root,viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:r,view:new Bt(t,{containerElement:r.view.element,foldable:i,props:e.props,viewName:e.root?"rot":void 0,viewProps:e.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=e.props,this.foldable=i,pt(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",(()=>{this.foldable.cleanUpTransition()})),this.rackController.rack.emitter.on("remove",(()=>{this.foldable.cleanUpTransition()})),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const Vt={id:"folder",type:"blade",accept(t){const e=O,n=N(t,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return n?{params:n}:null},controller:t=>new Ut(t.document,{blade:t.blade,expanded:t.params.expanded,props:L.fromObject({title:t.params.title}),viewProps:t.viewProps}),api:t=>t.controller instanceof Ut?new At(t.controller,t.pool):null};class Ht extends lt{constructor(t,e){const n=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new st(t,{props:e.props,viewProps:n}),viewProps:n})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class jt extends n{}const Wt=v("spr");class Gt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Wt()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("hr");n.classList.add(Wt("r")),this.element.appendChild(n)}}class qt extends H{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new Gt(t,{viewProps:e.viewProps})}))}}const Xt={id:"separator",type:"blade",accept(t){const e=N(t,{view:O.required.constant("separator")});return e?{params:e}:null},controller:t=>new qt(t.document,{blade:t.blade,viewProps:t.viewProps}),api:t=>t.controller instanceof qt?new jt(t.controller):null},Zt=v("");function Yt(t,e){return w(t,Zt(void 0,e))}class Kt extends L{constructor(t){super(t)}static create(t){var e,n;const i=null!=t?t:{},r={disabled:null!==(e=i.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(n=i.hidden)&&void 0!==n&&n},s=L.createCore(r);return new Kt(s)}bindClassModifiers(t){_(this,"disabled",Yt(t,"disabled")),_(this,"hidden",Yt(t,"hidden"))}bindDisabled(t){_(this,"disabled",(e=>{t.disabled=e}))}bindTabIndex(t){_(this,"disabled",(e=>{t.tabIndex=e?-1:0}))}handleDispose(t){this.value("disposed").emitter.on("change",(e=>{e&&t()}))}}const Jt=v("tbi");class $t{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Jt()),e.viewProps.bindClassModifiers(this.element),_(e.props,"selected",(t=>{t?this.element.classList.add(Jt(void 0,"sel")):this.element.classList.remove(Jt(void 0,"sel"))}));const n=t.createElement("button");n.classList.add(Jt("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=t.createElement("div");i.classList.add(Jt("t")),M(e.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i}}class Qt{constructor(t,e){this.emitter=new f,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new $t(t,{props:e.props,viewProps:e.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class te{constructor(t,e){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Qt(t,{props:e.itemProps,viewProps:Kt.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new Nt(t,{blade:ct(),viewProps:Kt.create()}),this.props=e.props,_(this.props,"selected",(t=>{this.itemController.props.set("selected",t),this.contentController.viewProps.set("hidden",!t)}))}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class ee{constructor(t,e){this.controller_=t,this.rackApi_=e}get title(){var t;return null!==(t=this.controller_.itemController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.itemController.props.set("title",t)}get selected(){return this.controller_.props.get("selected")}set selected(t){this.controller_.props.set("selected",t)}get children(){return this.rackApi_.children}addButton(t){return this.rackApi_.addButton(t)}addFolder(t){return this.rackApi_.addFolder(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addInput(t,e,n){return this.rackApi_.addInput(t,e,n)}addMonitor(t,e,n){return this.rackApi_.addMonitor(t,e,n)}addBlade(t){return this.rackApi_.addBlade(t)}}class ne extends ft{constructor(t,e){super(t,new Pt(t.rackController,e)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.emitter_=new f,this.pageApiMap_=new Map,this.rackApi_.on("change",(t=>{this.emitter_.emit("change",{event:t})})),this.rackApi_.on("update",(t=>{this.emitter_.emit("update",{event:t})})),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach((t=>{this.setUpPageApi_(t)}))}get pages(){return this.controller_.pageSet.items.map((t=>{const e=this.pageApiMap_.get(t);if(!e)throw h.shouldNeverHappen();return e}))}addPage(t){const e=this.controller_.view.element.ownerDocument,n=new te(e,{itemProps:L.fromObject({selected:!1,title:t.title}),props:L.fromObject({selected:!1})});this.controller_.add(n,t.index);const i=this.pageApiMap_.get(n);if(!i)throw h.shouldNeverHappen();return i}removePage(t){this.controller_.remove(t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}setUpPageApi_(t){const e=this.rackApi_.apiSet_.find((e=>e.controller_===t.contentController));if(!e)throw h.shouldNeverHappen();const n=new ee(t,e);this.pageApiMap_.set(t,n)}onPageAdd_(t){this.setUpPageApi_(t.item)}onPageRemove_(t){if(!this.pageApiMap_.get(t.item))throw h.shouldNeverHappen();this.pageApiMap_.delete(t.item)}}const ie=v("tab");class re{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ie(),Ft()),e.viewProps.bindClassModifiers(this.element),y(e.empty,w(this.element,ie(void 0,"nop")));const n=t.createElement("div");n.classList.add(ie("i")),this.element.appendChild(n),this.itemsElement=n;const i=e.contentsElement;i.classList.add(ie("c")),this.element.appendChild(i),this.contentsElement=i}}class se extends Et{constructor(t,e){const n=new Nt(t,{blade:e.blade,viewProps:e.viewProps}),i=E(!0);super({blade:e.blade,rackController:n,view:new re(t,{contentsElement:n.view.element,empty:i,viewProps:e.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onPageSelectedChange_=this.onPageSelectedChange_.bind(this),this.pageSet_=new yt((()=>null)),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.empty_=i,this.applyPages_()}get pageSet(){return this.pageSet_}add(t,e){this.pageSet_.add(t,null!=e?e:this.pageSet_.items.length)}remove(t){this.pageSet_.remove(this.pageSet_.items[t])}applyPages_(){this.keepSelection_(),this.empty_.rawValue=0===this.pageSet_.items.length}onPageAdd_(t){const e=t.item;$(this.view.itemsElement,e.itemController.view.element,t.index),this.rackController.rack.add(e.contentController,t.index),e.props.value("selected").emitter.on("change",this.onPageSelectedChange_),this.applyPages_()}onPageRemove_(t){const e=t.item;Q(e.itemController.view.element),this.rackController.rack.remove(e.contentController),e.props.value("selected").emitter.off("change",this.onPageSelectedChange_),this.applyPages_()}keepSelection_(){if(0===this.pageSet_.items.length)return;const t=this.pageSet_.items.findIndex((t=>t.props.get("selected")));t<0?this.pageSet_.items.forEach(((t,e)=>{t.props.set("selected",0===e)})):this.pageSet_.items.forEach(((e,n)=>{e.props.set("selected",n===t)}))}onPageSelectedChange_(t){if(t.rawValue){const e=this.pageSet_.items.findIndex((e=>e.props.value("selected")===t.sender));this.pageSet_.items.forEach(((t,n)=>{t.props.set("selected",n===e)}))}else this.keepSelection_()}}const oe={id:"tab",type:"blade",accept(t){const e=O,n=N(t,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return n&&0!==n.pages.length?{params:n}:null},controller(t){const e=new se(t.document,{blade:t.blade,viewProps:t.viewProps});return t.params.pages.forEach((n=>{const i=new te(t.document,{itemProps:L.fromObject({selected:!1,title:n.title}),props:L.fromObject({selected:!1})});e.add(i)})),e},api:t=>t.controller instanceof se?new ne(t.controller,t.pool):null};function ae(t,e){const n=t.accept(e.params);if(!n)return null;const i=O.optional.boolean(e.params.disabled).value,r=O.optional.boolean(e.params.hidden).value;return t.controller({blade:ct(),document:e.document,params:a(Object.assign(Object.assign({},n.params),{disabled:i,hidden:r})),viewProps:Kt.create({disabled:i,hidden:r})})}class le{constructor(){this.disabled=!1,this.emitter=new f}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class ce{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new f,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class ue{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}}function he(t,e){if(t instanceof e)return t;if(t instanceof ue){const n=t.constraints.reduce(((t,n)=>t||(n instanceof e?n:null)),null);if(n)return n}return null}class de{constructor(t){this.options=t}constrain(t){const e=this.options;return 0===e.length||e.filter((e=>e.value===t)).length>0?t:e[0].value}}class pe{constructor(t){this.maxValue=t.max,this.minValue=t.min}constrain(t){let e=t;return l(this.minValue)||(e=Math.max(e,this.minValue)),l(this.maxValue)||(e=Math.min(e,this.maxValue)),e}}class fe{constructor(t){this.step=t}constrain(t){return(t<0?-Math.round(-t/this.step):Math.round(t/this.step))*this.step}}const me=v("lst");class ve{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.element=t.createElement("div"),this.element.classList.add(me()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("select");n.classList.add(me("s")),_(this.props_,"options",(e=>{tt(n),e.forEach(((e,i)=>{const r=t.createElement("option");r.dataset.index=String(i),r.textContent=e.text,r.value=String(e.value),n.appendChild(r)}))})),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.selectElement=n;const i=t.createElement("div");i.classList.add(me("m")),i.appendChild(J(t,"dropdown")),this.element.appendChild(i),e.value.emitter.on("change",this.onValueChange_),this.value_=e.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class ge{constructor(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new ve(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(t){const e=a(t.currentTarget).selectedOptions.item(0);if(!e)return;const n=Number(e.dataset.index);this.value.rawValue=this.props.get("options")[n].value}}const xe=v("pop");class ye{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(xe()),e.viewProps.bindClassModifiers(this.element),y(e.shows,w(this.element,xe(void 0,"v")))}}class _e{constructor(t,e){this.shows=E(!1),this.viewProps=e.viewProps,this.view=new ye(t,{shows:this.shows,viewProps:this.viewProps})}}const be=v("txt");class we{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(be()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const n=t.createElement("input");n.classList.add(be("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class Me{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new we(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=a(t.currentTarget).value,n=this.parser_(e);l(n)||(this.value.rawValue=n),this.view.refresh()}}function Se(t){return String(t)}function Ce(t){return"false"!==t&&!!t}function Te(t){return Se(t)}class Pe{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const Ae={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class Ee{constructor(t,e,n){this.left=e,this.operator=t,this.right=n}evaluate(){const t=Ae[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Le={"+":t=>t,"-":t=>-t,"~":t=>~t};class De{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=Le[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function ke(t){return(e,n)=>{for(let i=0;i<t.length;i++){const r=t[i](e,n);if(""!==r)return r}return""}}function Re(t,e){var n;const i=t.substr(e).match(/^\s+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Ie(t,e){const n=t.substr(e,1);return n.match(/^[1-9]$/)?n:""}function ze(t,e){var n;const i=t.substr(e).match(/^[0-9]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Oe(t,e){const n=ze(t,e);if(""!==n)return n;const i=t.substr(e,1);if("-"!==i&&"+"!==i)return"";const r=ze(t,e+=1);return""===r?"":i+r}function Ne(t,e){const n=t.substr(e,1);if(e+=1,"e"!==n.toLowerCase())return"";const i=Oe(t,e);return""===i?"":n+i}function Fe(t,e){const n=t.substr(e,1);if("0"===n)return n;const i=Ie(t,e);return e+=i.length,""===i?"":i+ze(t,e)}function Be(t,e){const n=Fe(t,e);if(e+=n.length,""===n)return"";const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const r=ze(t,e);return n+i+r+Ne(t,e+=r.length)}function Ue(t,e){const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const i=ze(t,e);return e+=i.length,""===i?"":n+i+Ne(t,e)}function Ve(t,e){const n=Fe(t,e);return e+=n.length,""===n?"":n+Ne(t,e)}const He=ke([Be,Ue,Ve]);function je(t,e){var n;const i=t.substr(e).match(/^[01]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function We(t,e){const n=t.substr(e,2);if(e+=n.length,"0b"!==n.toLowerCase())return"";const i=je(t,e);return""===i?"":n+i}function Ge(t,e){var n;const i=t.substr(e).match(/^[0-7]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function qe(t,e){const n=t.substr(e,2);if(e+=n.length,"0o"!==n.toLowerCase())return"";const i=Ge(t,e);return""===i?"":n+i}function Xe(t,e){var n;const i=t.substr(e).match(/^[0-9a-f]+/i);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Ze(t,e){const n=t.substr(e,2);if(e+=n.length,"0x"!==n.toLowerCase())return"";const i=Xe(t,e);return""===i?"":n+i}const Ye=ke([We,qe,Ze]),Ke=ke([Ye,He]);function Je(t,e){const n=Ke(t,e);return e+=n.length,""===n?null:{evaluable:new Pe(n),cursor:e}}function $e(t,e){const n=t.substr(e,1);if(e+=n.length,"("!==n)return null;const i=sn(t,e);if(!i)return null;e=i.cursor,e+=Re(t,e).length;const r=t.substr(e,1);return e+=r.length,")"!==r?null:{evaluable:i.evaluable,cursor:e}}function Qe(t,e){return Je(t,e)||$e(t,e)}function tn(t,e){const n=Qe(t,e);if(n)return n;const i=t.substr(e,1);if(e+=i.length,"+"!==i&&"-"!==i&&"~"!==i)return null;const r=tn(t,e);return r?{cursor:e=r.cursor,evaluable:new De(i,r.evaluable)}:null}function en(t,e,n){n+=Re(e,n).length;const i=t.filter((t=>e.startsWith(t,n)))[0];return i?(n+=i.length,{cursor:n+=Re(e,n).length,operator:i}):null}function nn(t,e){return(n,i)=>{const r=t(n,i);if(!r)return null;i=r.cursor;let s=r.evaluable;for(;;){const r=en(e,n,i);if(!r)break;i=r.cursor;const o=t(n,i);if(!o)return null;i=o.cursor,s=new Ee(r.operator,s,o.evaluable)}return s?{cursor:i,evaluable:s}:null}}const rn=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>nn(t,e)),tn);function sn(t,e){return e+=Re(t,e).length,rn(t,e)}function on(t){const e=sn(t,0);return e?e.cursor+Re(t,e.cursor).length!==t.length?null:e.evaluable:null}function an(t){var e;const n=on(t);return null!==(e=null==n?void 0:n.evaluate())&&void 0!==e?e:null}function ln(t){if("number"==typeof t)return t;if("string"==typeof t){const e=an(t);if(!l(e))return e}return 0}function cn(t){return String(t)}function un(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}const hn=un(0);function dn(t){return hn(t)+"%"}function pn(t){return String(t)}function fn(t){return t}function mn(t,e){for(;t.length<e;)t.push(void 0)}function vn(t){const e=[];return mn(e,t),E(e)}function gn(t){const e=t.indexOf(void 0);return a(e<0?t:t.slice(0,e))}function xn(t,e){const n=[...gn(t),e];return n.length>t.length?n.splice(0,n.length-t.length):mn(n,t.length),n}function yn({primary:t,secondary:e,forward:n,backward:i}){let r=!1;function s(t){r||(r=!0,t(),r=!1)}t.emitter.on("change",(i=>{s((()=>{e.setRawValue(n(t,e),i.options)}))})),e.emitter.on("change",(r=>{s((()=>{t.setRawValue(i(t,e),r.options)})),s((()=>{e.setRawValue(n(t,e),r.options)}))})),s((()=>{e.setRawValue(n(t,e),{forceEmit:!1,last:!0})}))}function _n(t,e){const n=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+n:e.downKey?-n:0}function bn(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function wn(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function Mn(t){return"ArrowUp"===t||"ArrowDown"===t}function Sn(t){return Mn(t)||"ArrowLeft"===t||"ArrowRight"===t}function Cn(t,e){const n=e.ownerDocument.defaultView,i=e.getBoundingClientRect();return{x:t.pageX-((n&&n.scrollX||0)+i.left),y:t.pageY-((n&&n.scrollY||0)+i.top)}}class Tn{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new f,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(Cn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(Cn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(Cn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const n=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function Pn(t,e,n,i,r){return i+(t-e)/(n-e)*(r-i)}function An(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function En(t,e,n){return Math.min(Math.max(t,e),n)}function Ln(t,e){return(t%e+e)%e}const Dn=v("txt");class kn{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Dn(),Dn(void 0,"num")),e.arrayPosition&&this.element.classList.add(Dn(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("input");n.classList.add(Dn("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Dn()),this.inputElement.classList.add(Dn("i"));const i=t.createElement("div");i.classList.add(Dn("k")),this.element.appendChild(i),this.knobElement=i;const r=t.createElementNS(j,"svg");r.classList.add(Dn("g")),this.knobElement.appendChild(r);const s=t.createElementNS(j,"path");s.classList.add(Dn("gb")),r.appendChild(s),this.guideBodyElem_=s;const o=t.createElementNS(j,"path");o.classList.add(Dn("gh")),r.appendChild(o),this.guideHeadElem_=o;const a=t.createElement("div");a.classList.add(v("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(Dn(void 0,"drg"));this.element.classList.add(Dn(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),n=e+(e>0?-1:e<0?1:0),i=En(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+i},0 L${n},4 L${n+i},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class Rn{constructor(t,e){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=E(null),this.view=new kn(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const n=new Tn(this.view.knobElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}onInputChange_(t){const e=a(t.currentTarget).value,n=this.parser_(e);l(n)||(this.value.rawValue=n),this.view.refresh()}onInputKeyDown_(t){const e=_n(this.baseStep_,bn(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==_n(this.baseStep_,bn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.originRawValue_+e*this.props.get("draggingScale")}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const In=v("sld");class zn{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(In()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(In("t")),e.viewProps.bindTabIndex(n),this.element.appendChild(n),this.trackElement=n;const i=t.createElement("div");i.classList.add(In("k")),this.trackElement.appendChild(i),this.knobElement=i,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.update_()}update_(){const t=En(Pn(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${t}%`}onChange_(){this.update_()}}class On{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.viewProps=e.viewProps,this.props=e.props,this.view=new zn(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Tn(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){t.point&&this.value.setRawValue(Pn(En(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),e)}onPointerDownOrMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=_n(this.baseStep_,wn(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onKeyUp_(t){0!==_n(this.baseStep_,wn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Nn=v("sldtxt");class Fn{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Nn());const n=t.createElement("div");n.classList.add(Nn("s")),this.sliderView_=e.sliderView,n.appendChild(this.sliderView_.element),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(Nn("t")),this.textView_=e.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}}class Bn{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sliderC_=new On(t,{baseStep:e.baseStep,props:e.sliderProps,value:e.value,viewProps:this.viewProps}),this.textC_=new Rn(t,{baseStep:e.baseStep,parser:e.parser,props:e.textProps,value:e.value,viewProps:e.viewProps}),this.view=new Fn(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function Un(t,e){t.write(e)}function Vn(t){const e=O;return Array.isArray(t)?e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(t).value:"object"==typeof t?e.required.raw(t).value:void 0}function Hn(t){if("inline"===t||"popup"===t)return t}function jn(t){const e=O;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(t).value}function Wn(t){if(Array.isArray(t))return t;const e=[];return Object.keys(t).forEach((n=>{e.push({text:n,value:t[n]})})),e}function Gn(t){return l(t)?null:new de(Wn(a(t)))}function qn(t){const e=t?he(t,de):null;return e?e.options:null}function Xn(t){const e=t?he(t,fe):null;return e?e.step:null}function Zn(t,e){const n=t&&he(t,fe);return n?An(n.step):Math.max(An(e),2)}function Yn(t){const e=Xn(t);return null!=e?e:1}function Kn(t,e){var n;const i=t&&he(t,fe),r=Math.abs(null!==(n=null==i?void 0:i.step)&&void 0!==n?n:e);return 0===r?.1:Math.pow(10,Math.floor(Math.log10(r))-1)}const Jn=v("ckb");class $n{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Jn()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("label");n.classList.add(Jn("l")),this.element.appendChild(n);const i=t.createElement("input");i.classList.add(Jn("i")),i.type="checkbox",n.appendChild(i),this.inputElement=i,e.viewProps.bindDisabled(this.inputElement);const r=t.createElement("div");r.classList.add(Jn("w")),n.appendChild(r);const s=J(t,"check");r.appendChild(s),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class Qn{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new $n(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=a(t.currentTarget);this.value.rawValue=e.checked}}function ti(t){const e=[],n=Gn(t.options);return n&&e.push(n),new ue(e)}const ei={id:"input-bool",type:"input",accept:(t,e)=>{if("boolean"!=typeof t)return null;const n=N(e,{options:O.optional.custom(Vn)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>Ce,constraint:t=>ti(t.params),writer:t=>Un},controller:t=>{var e;const n=t.document,i=t.value,r=t.constraint;return r&&he(r,de)?new ge(n,{props:L.fromObject({options:null!==(e=qn(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps}):new Qn(n,{value:i,viewProps:t.viewProps})}},ni=v("col");class ii{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ni()),e.foldable.bindExpandedClass(this.element,ni(void 0,"expanded")),_(e.foldable,"completed",w(this.element,ni(void 0,"cpl")));const n=t.createElement("div");n.classList.add(ni("h")),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(ni("s")),n.appendChild(i),this.swatchElement=i;const r=t.createElement("div");if(r.classList.add(ni("t")),n.appendChild(r),this.textElement=r,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(ni("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}function ri(t,e,n){const i=En(t/255,0,1),r=En(e/255,0,1),s=En(n/255,0,1),o=Math.max(i,r,s),a=Math.min(i,r,s),l=o-a;let c=0,u=0;const h=(a+o)/2;return 0!==l&&(u=l/(1-Math.abs(o+a-1)),c=i===o?(r-s)/l:r===o?2+(s-i)/l:4+(i-r)/l,c=c/6+(c<0?1:0)),[360*c,100*u,100*h]}function si(t,e,n){const i=(t%360+360)%360,r=En(e/100,0,1),s=En(n/100,0,1),o=(1-Math.abs(2*s-1))*r,a=o*(1-Math.abs(i/60%2-1)),l=s-o/2;let c,u,h;return[c,u,h]=i>=0&&i<60?[o,a,0]:i>=60&&i<120?[a,o,0]:i>=120&&i<180?[0,o,a]:i>=180&&i<240?[0,a,o]:i>=240&&i<300?[a,0,o]:[o,0,a],[255*(c+l),255*(u+l),255*(h+l)]}function oi(t,e,n){const i=En(t/255,0,1),r=En(e/255,0,1),s=En(n/255,0,1),o=Math.max(i,r,s),a=o-Math.min(i,r,s);let l;return l=0===a?0:o===i?((r-s)/a%6+6)%6*60:o===r?60*((s-i)/a+2):60*((i-r)/a+4),[l,100*(0===o?0:a/o),100*o]}function ai(t,e,n){const i=Ln(t,360),r=En(e/100,0,1),s=En(n/100,0,1),o=s*r,a=o*(1-Math.abs(i/60%2-1)),l=s-o;let c,u,h;return[c,u,h]=i>=0&&i<60?[o,a,0]:i>=60&&i<120?[a,o,0]:i>=120&&i<180?[0,o,a]:i>=180&&i<240?[0,a,o]:i>=240&&i<300?[a,0,o]:[o,0,a],[255*(c+l),255*(u+l),255*(h+l)]}function li(t,e,n){const i=n+e*(100-Math.abs(2*n-100))/200;return[t,0!==i?e*(100-Math.abs(2*n-100))/i:0,n+e*(100-Math.abs(2*n-100))/200]}function ci(t,e,n){const i=100-Math.abs(n*(200-e)/100-100);return[t,0!==i?e*n/i:0,n*(200-e)/200]}function ui(t){return[t[0],t[1],t[2]]}function hi(t,e){return[t[0],t[1],t[2],e]}const di={hsl:{hsl:(t,e,n)=>[t,e,n],hsv:li,rgb:si},hsv:{hsl:ci,hsv:(t,e,n)=>[t,e,n],rgb:ai},rgb:{hsl:ri,hsv:oi,rgb:(t,e,n)=>[t,e,n]}};function pi(t,e,n){return di[e][n](...t)}const fi={hsl:t=>{var e;return[Ln(t[0],360),En(t[1],0,100),En(t[2],0,100),En(null!==(e=t[3])&&void 0!==e?e:1,0,1)]},hsv:t=>{var e;return[Ln(t[0],360),En(t[1],0,100),En(t[2],0,100),En(null!==(e=t[3])&&void 0!==e?e:1,0,1)]},rgb:t=>{var e;return[En(t[0],0,255),En(t[1],0,255),En(t[2],0,255),En(null!==(e=t[3])&&void 0!==e?e:1,0,1)]}};function mi(t,e){return"object"==typeof t&&!l(t)&&e in t&&"number"==typeof t[e]}class vi{constructor(t,e){this.mode_=e,this.comps_=fi[e](t)}static black(){return new vi([0,0,0],"rgb")}static fromObject(t){const e="a"in t?[t.r,t.g,t.b,t.a]:[t.r,t.g,t.b];return new vi(e,"rgb")}static toRgbaObject(t){return t.toRgbaObject()}static isRgbColorObject(t){return mi(t,"r")&&mi(t,"g")&&mi(t,"b")}static isRgbaColorObject(t){return this.isRgbColorObject(t)&&mi(t,"a")}static isColorObject(t){return this.isRgbColorObject(t)}static equals(t,e){if(t.mode_!==e.mode_)return!1;const n=t.comps_,i=e.comps_;for(let t=0;t<n.length;t++)if(n[t]!==i[t])return!1;return!0}get mode(){return this.mode_}getComponents(t){return hi(pi(ui(this.comps_),this.mode_,t||this.mode_),this.comps_[3])}toRgbaObject(){const t=this.getComponents("rgb");return{r:t[0],g:t[1],b:t[2],a:t[3]}}}const gi=v("colp");class xi{constructor(t,e){this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add(gi());const n=t.createElement("div");n.classList.add(gi("hsv"));const i=t.createElement("div");i.classList.add(gi("sv")),this.svPaletteView_=e.svPaletteView,i.appendChild(this.svPaletteView_.element),n.appendChild(i);const r=t.createElement("div");r.classList.add(gi("h")),this.hPaletteView_=e.hPaletteView,r.appendChild(this.hPaletteView_.element),n.appendChild(r),this.element.appendChild(n);const s=t.createElement("div");if(s.classList.add(gi("rgb")),this.textView_=e.textView,s.appendChild(this.textView_.element),this.element.appendChild(s),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};const n=t.createElement("div");n.classList.add(gi("a"));const i=t.createElement("div");i.classList.add(gi("ap")),i.appendChild(this.alphaViews_.palette.element),n.appendChild(i);const r=t.createElement("div");r.classList.add(gi("at")),r.appendChild(this.alphaViews_.text.element),n.appendChild(r),this.element.appendChild(n)}}get allFocusableElements(){const t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map((t=>t.inputElement))];return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}}function yi(t){const e=O;return N(t,{alpha:e.optional.boolean,expanded:e.optional.boolean,picker:e.optional.custom(Hn)})}function _i(t){return t?.1:1}function bi(t,e){const n=t.match(/^(.+)%$/);return n?Math.min(.01*parseFloat(n[1])*e,e):Math.min(parseFloat(t),e)}const wi={deg:t=>t,grad:t=>360*t/400,rad:t=>360*t/(2*Math.PI),turn:t=>360*t};function Mi(t){const e=t.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(t);const n=parseFloat(e[1]),i=e[2];return wi[i](n)}const Si={"func.rgb":t=>{const e=t.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[bi(e[1],255),bi(e[2],255),bi(e[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:new vi(n,"rgb")},"func.rgba":t=>{const e=t.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[bi(e[1],255),bi(e[2],255),bi(e[3],255),bi(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:new vi(n,"rgb")},"func.hsl":t=>{const e=t.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Mi(e[1]),bi(e[2],100),bi(e[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:new vi(n,"hsl")},"func.hsla":t=>{const e=t.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Mi(e[1]),bi(e[2],100),bi(e[3],100),bi(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:new vi(n,"hsl")},"hex.rgb":t=>{const e=t.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return new vi([parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)],"rgb");const n=t.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?new vi([parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)],"rgb"):null},"hex.rgba":t=>{const e=t.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return new vi([parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),Pn(parseInt(e[4]+e[4],16),0,255,0,1)],"rgb");const n=t.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?new vi([parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),Pn(parseInt(n[4],16),0,255,0,1)],"rgb"):null}};function Ci(t){return Object.keys(Si).reduce(((e,n)=>e||((0,Si[n])(t)?n:null)),null)}const Ti=t=>{const e=Ci(t);return e?Si[e](t):null};function Pi(t){return"func.hsla"===t||"func.rgba"===t||"hex.rgba"===t}function Ai(t){if("string"==typeof t){const e=Ti(t);if(e)return e}return vi.black()}function Ei(t){const e=En(Math.floor(t),0,255).toString(16);return 1===e.length?`0${e}`:e}function Li(t,e="#"){return`${e}${ui(t.getComponents("rgb")).map(Ei).join("")}`}function Di(t,e="#"){const n=t.getComponents("rgb");return`${e}${[n[0],n[1],n[2],255*n[3]].map(Ei).join("")}`}function ki(t){const e=un(0);return`rgb(${ui(t.getComponents("rgb")).map((t=>e(t))).join(", ")})`}function Ri(t){const e=un(2),n=un(0);return`rgba(${t.getComponents("rgb").map(((t,i)=>(3===i?e:n)(t))).join(", ")})`}function Ii(t){const e=[un(0),dn,dn];return`hsl(${ui(t.getComponents("hsl")).map(((t,n)=>e[n](t))).join(", ")})`}function zi(t){const e=[un(0),dn,dn,un(2)];return`hsla(${t.getComponents("hsl").map(((t,n)=>e[n](t))).join(", ")})`}const Oi={"func.hsl":Ii,"func.hsla":zi,"func.rgb":ki,"func.rgba":Ri,"hex.rgb":Li,"hex.rgba":Di};function Ni(t){return Oi[t]}const Fi=v("apl");class Bi{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Fi()),e.viewProps.bindTabIndex(this.element);const n=t.createElement("div");n.classList.add(Fi("b")),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(Fi("c")),n.appendChild(i),this.colorElem_=i;const r=t.createElement("div");r.classList.add(Fi("m")),this.element.appendChild(r),this.markerElem_=r;const s=t.createElement("div");s.classList.add(Fi("p")),this.markerElem_.appendChild(s),this.previewElem_=s,this.update_()}update_(){const t=this.value.rawValue,e=t.getComponents("rgb"),n=new vi([e[0],e[1],e[2],0],"rgb"),i=new vi([e[0],e[1],e[2],255],"rgb"),r=["to right",Ri(n),Ri(i)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=Ri(t);const s=Pn(e[3],0,1,0,100);this.markerElem_.style.left=`${s}%`}onValueChange_(){this.update_()}}class Ui{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Bi(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Tn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const n=t.point.x/t.bounds.width,i=this.value.rawValue,[r,s,o]=i.getComponents("hsv");this.value.setRawValue(new vi([r,s,o,n],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=_n(_i(!0),wn(t));if(0===e)return;const n=this.value.rawValue,[i,r,s,o]=n.getComponents("hsv");this.value.setRawValue(new vi([i,r,s,o+e],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==_n(_i(!0),wn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Vi=v("coltxt");function Hi(t){const e=t.createElement("select"),n=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return e.appendChild(n.reduce(((e,n)=>{const i=t.createElement("option");return i.textContent=n.text,i.value=n.value,e.appendChild(i),e}),t.createDocumentFragment())),e}class ji{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Vi());const n=t.createElement("div");n.classList.add(Vi("m")),this.modeElem_=Hi(t),this.modeElem_.classList.add(Vi("ms")),n.appendChild(this.modeSelectElement);const i=t.createElement("div");i.classList.add(Vi("mm")),i.appendChild(J(t,"dropdown")),n.appendChild(i),this.element.appendChild(n);const r=t.createElement("div");r.classList.add(Vi("w")),this.element.appendChild(r),this.textsElem_=r,this.textViews_=e.textViews,this.applyTextViews_(),y(e.colorMode,(t=>{this.modeElem_.value=t}))}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(t){this.textViews_=t,this.applyTextViews_()}applyTextViews_(){tt(this.textsElem_);const t=this.element.ownerDocument;this.textViews_.forEach((e=>{const n=t.createElement("div");n.classList.add(Vi("c")),n.appendChild(e.element),this.textsElem_.appendChild(n)}))}}const Wi=un(0),Gi={rgb:()=>new pe({min:0,max:255}),hsl:t=>new pe(0===t?{min:0,max:360}:{min:0,max:100}),hsv:t=>new pe(0===t?{min:0,max:360}:{min:0,max:100})};function qi(t,e,n){return new Rn(t,{arrayPosition:0===n?"fst":2===n?"lst":"mid",baseStep:_i(!1),parser:e.parser,props:L.fromObject({draggingScale:1,formatter:Wi}),value:E(0,{constraint:Gi[e.colorMode](n)}),viewProps:e.viewProps})}class Xi{constructor(t,e){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.parser_=e.parser,this.value=e.value,this.viewProps=e.viewProps,this.colorMode=E(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new ji(t,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(t){const e={colorMode:this.colorMode.rawValue,parser:this.parser_,viewProps:this.viewProps},n=[qi(t,e,0),qi(t,e,1),qi(t,e,2)];return n.forEach(((t,e)=>{yn({primary:this.value,secondary:t.value,forward:t=>t.rawValue.getComponents(this.colorMode.rawValue)[e],backward:(t,n)=>{const i=this.colorMode.rawValue,r=t.rawValue.getComponents(i);return r[e]=n.rawValue,new vi(hi(ui(r),r[3]),i)}})})),n}onModeSelectChange_(t){const e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const Zi=v("hpl");class Yi{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Zi()),e.viewProps.bindTabIndex(this.element);const n=t.createElement("div");n.classList.add(Zi("c")),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(Zi("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const t=this.value.rawValue,[e]=t.getComponents("hsv");this.markerElem_.style.backgroundColor=ki(new vi([e,100,100],"hsv"));const n=Pn(e,0,360,0,100);this.markerElem_.style.left=`${n}%`}onValueChange_(){this.update_()}}class Ki{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Yi(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Tn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const n=Pn(En(t.point.x,0,t.bounds.width),0,t.bounds.width,0,359),i=this.value.rawValue,[,r,s,o]=i.getComponents("hsv");this.value.setRawValue(new vi([n,r,s,o],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=_n(_i(!1),wn(t));if(0===e)return;const n=this.value.rawValue,[i,r,s,o]=n.getComponents("hsv");this.value.setRawValue(new vi([i+e,r,s,o],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==_n(_i(!1),wn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ji=v("svp"),$i=64;class Qi{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Ji()),e.viewProps.bindTabIndex(this.element);const n=t.createElement("canvas");n.height=$i,n.width=$i,n.classList.add(Ji("c")),this.element.appendChild(n),this.canvasElement=n;const i=t.createElement("div");i.classList.add(Ji("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const t=Y(this.canvasElement);if(!t)return;const e=this.value.rawValue.getComponents("hsv"),n=this.canvasElement.width,i=this.canvasElement.height,r=t.getImageData(0,0,n,i),s=r.data;for(let t=0;t<i;t++)for(let r=0;r<n;r++){const o=Pn(r,0,n,0,100),a=Pn(t,0,i,100,0),l=ai(e[0],o,a),c=4*(t*n+r);s[c]=l[0],s[c+1]=l[1],s[c+2]=l[2],s[c+3]=255}t.putImageData(r,0,0);const o=Pn(e[1],0,100,0,100);this.markerElem_.style.left=`${o}%`;const a=Pn(e[2],0,100,100,0);this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}}class tr{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Qi(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Tn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const n=Pn(t.point.x,0,t.bounds.width,0,100),i=Pn(t.point.y,0,t.bounds.height,100,0),[r,,,s]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new vi([r,n,i,s],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){Sn(t.key)&&t.preventDefault();const[e,n,i,r]=this.value.rawValue.getComponents("hsv"),s=_i(!1),o=_n(s,wn(t)),a=_n(s,bn(t));0===o&&0===a||this.value.setRawValue(new vi([e,n+o,i+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){const e=_i(!1),n=_n(e,wn(t)),i=_n(e,bn(t));0===n&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class er{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.hPaletteC_=new Ki(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new tr(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=e.supportsAlpha?{palette:new Ui(t,{value:this.value,viewProps:this.viewProps}),text:new Rn(t,{parser:an,baseStep:.1,props:L.fromObject({draggingScale:.01,formatter:un(2)}),value:E(0,{constraint:new pe({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&yn({primary:this.value,secondary:this.alphaIcs_.text.value,forward:t=>t.rawValue.getComponents()[3],backward:(t,e)=>{const n=t.rawValue.getComponents();return n[3]=e.rawValue,new vi(n,t.rawValue.mode)}}),this.textC_=new Xi(t,{parser:an,value:this.value,viewProps:this.viewProps}),this.view=new xi(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}get textController(){return this.textC_}}const nr=v("colsw");class ir{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(nr()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(nr("sw")),this.element.appendChild(n),this.swatchElem_=n;const i=t.createElement("button");i.classList.add(nr("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}update_(){const t=this.value.rawValue;this.swatchElem_.style.backgroundColor=Di(t)}onValueChange_(){this.update_()}}class rr{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new ir(t,{value:this.value,viewProps:this.viewProps})}}class sr{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=ut.create(e.expanded),this.swatchC_=new rr(t,{value:this.value,viewProps:this.viewProps});const n=this.swatchC_.view.buttonElement;n.addEventListener("blur",this.onButtonBlur_),n.addEventListener("click",this.onButtonClick_),this.textC_=new Me(t,{parser:e.parser,props:L.fromObject({formatter:e.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new ii(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===e.pickerLayout?new _e(t,{viewProps:this.viewProps}):null;const i=new er(t,{supportsAlpha:e.supportsAlpha,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),yn({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),pt(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,n=a(t.relatedTarget);n&&e.contains(n)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,n=nt(t);n&&e.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!q(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}}function or(t){return vi.isColorObject(t)?vi.fromObject(t):vi.black()}function ar(t){return ui(t.getComponents("rgb")).reduce(((t,e)=>t<<8|255&Math.floor(e)),0)}function lr(t){return t.getComponents("rgb").reduce(((t,e,n)=>t<<8|255&Math.floor(3===n?255*e:e)),0)>>>0}function cr(t){return new vi([t>>16&255,t>>8&255,255&t],"rgb")}function ur(t){return new vi([t>>24&255,t>>16&255,t>>8&255,Pn(255&t,0,255,0,1)],"rgb")}function hr(t){return"number"!=typeof t?vi.black():cr(t)}function dr(t){return"number"!=typeof t?vi.black():ur(t)}function pr(t){const e=Ni(t);return(t,n)=>{Un(t,e(n))}}function fr(t){const e=t?lr:ar;return(t,n)=>{Un(t,e(n))}}function mr(t,e){const n=e.toRgbaObject();t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b),t.writeProperty("a",n.a)}function vr(t,e){const n=e.toRgbaObject();t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b)}function gr(t){return t?mr:vr}function xr(t){return"alpha"in t&&!0===t.alpha}function yr(t){return t?t=>Di(t,"0x"):t=>Li(t,"0x")}const _r={id:"input-color-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;if(!("view"in e))return null;if("color"!==e.view)return null;const n=yi(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>xr(t.params)?dr:hr,equals:vi.equals,writer:t=>fr(xr(t.params))},controller:t=>{const e=xr(t.params),n="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0;return new sr(t.document,{expanded:null!=n&&n,formatter:yr(e),parser:Ti,pickerLayout:null!=i?i:"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}};function br(t){return vi.isRgbaColorObject(t)}const wr={id:"input-color-object",type:"input",accept:(t,e)=>{if(!vi.isColorObject(t))return null;const n=yi(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>or,equals:vi.equals,writer:t=>gr(br(t.initialValue))},controller:t=>{const e=vi.isRgbaColorObject(t.initialValue),n="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0,r=e?Di:Li;return new sr(t.document,{expanded:null!=n&&n,formatter:r,parser:Ti,pickerLayout:null!=i?i:"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}},Mr={id:"input-color-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;if("view"in e&&"text"===e.view)return null;if(!Ci(t))return null;const n=yi(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>Ai,equals:vi.equals,writer:t=>{const e=Ci(t.initialValue);if(!e)throw h.shouldNeverHappen();return pr(e)}},controller:t=>{const e=Ci(t.initialValue);if(!e)throw h.shouldNeverHappen();const n=Ni(e),i="expanded"in t.params?t.params.expanded:void 0,r="picker"in t.params?t.params.picker:void 0;return new sr(t.document,{expanded:null!=i&&i,formatter:n,parser:Ti,pickerLayout:null!=r?r:"popup",supportsAlpha:Pi(e),value:t.value,viewProps:t.viewProps})}};class Sr{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var n,i;return null!==(i=null===(n=this.components[e])||void 0===n?void 0:n.constrain(t))&&void 0!==i?i:t}));return this.asm_.fromComponents(e)}}const Cr=v("pndtxt");class Tr{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(Cr()),this.textViews.forEach((e=>{const n=t.createElement("div");n.classList.add(Cr("a")),n.appendChild(e.element),this.element.appendChild(n)}))}}function Pr(t,e,n){return new Rn(t,{arrayPosition:0===n?"fst":n===e.axes.length-1?"lst":"mid",baseStep:e.axes[n].baseStep,parser:e.parser,props:e.axes[n].textProps,value:E(0,{constraint:e.axes[n].constraint}),viewProps:e.viewProps})}class Ar{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((n,i)=>Pr(t,e,i))),this.acs_.forEach(((t,n)=>{yn({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[n],backward:(t,i)=>{const r=e.assembly.toComponents(t.rawValue);return r[n]=i.rawValue,e.assembly.fromComponents(r)}})})),this.view=new Tr(t,{textViews:this.acs_.map((t=>t.view))})}}function Er(t){return"step"in t&&!l(t.step)?new fe(t.step):null}function Lr(t){return"max"in t&&!l(t.max)||"min"in t&&!l(t.min)?new pe({max:t.max,min:t.min}):null}function Dr(t){const e=[],n=Er(t);n&&e.push(n);const i=Lr(t);i&&e.push(i);const r=Gn(t.options);return r&&e.push(r),new ue(e)}function kr(t){const e=t?he(t,pe):null;return e?[e.minValue,e.maxValue]:[void 0,void 0]}function Rr(t){const[e,n]=kr(t);return[null!=e?e:0,null!=n?n:100]}const Ir={id:"input-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;const n=O,i=N(e,{format:n.optional.function,max:n.optional.number,min:n.optional.number,options:n.optional.custom(Vn),step:n.optional.number});return i?{initialValue:t,params:i}:null},binding:{reader:t=>ln,constraint:t=>Dr(t.params),writer:t=>Un},controller:t=>{var e,n;const i=t.value,r=t.constraint;if(r&&he(r,de))return new ge(t.document,{props:L.fromObject({options:null!==(e=qn(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps});const s=null!==(n="format"in t.params?t.params.format:void 0)&&void 0!==n?n:un(Zn(r,i.rawValue));if(r&&he(r,pe)){const[e,n]=Rr(r);return new Bn(t.document,{baseStep:Yn(r),parser:an,sliderProps:L.fromObject({maxValue:n,minValue:e}),textProps:L.fromObject({draggingScale:Kn(r,i.rawValue),formatter:s}),value:i,viewProps:t.viewProps})}return new Rn(t.document,{baseStep:Yn(r),parser:an,props:L.fromObject({draggingScale:Kn(r,i.rawValue),formatter:s}),value:i,viewProps:t.viewProps})}};class zr{constructor(t=0,e=0){this.x=t,this.y=e}getComponents(){return[this.x,this.y]}static isObject(t){if(l(t))return!1;const e=t.x,n=t.y;return"number"==typeof e&&"number"==typeof n}static equals(t,e){return t.x===e.x&&t.y===e.y}toObject(){return{x:this.x,y:this.y}}}const Or={toComponents:t=>t.getComponents(),fromComponents:t=>new zr(...t)},Nr=v("p2d");class Fr{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Nr()),e.viewProps.bindClassModifiers(this.element),y(e.expanded,w(this.element,Nr(void 0,"expanded")));const n=t.createElement("div");n.classList.add(Nr("h")),this.element.appendChild(n);const i=t.createElement("button");i.classList.add(Nr("b")),i.appendChild(J(t,"p2dpad")),e.viewProps.bindDisabled(i),n.appendChild(i),this.buttonElement=i;const r=t.createElement("div");if(r.classList.add(Nr("t")),n.appendChild(r),this.textElement=r,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(Nr("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}const Br=v("p2dp");class Ur{constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=e.invertsY,this.maxValue_=e.maxValue,this.element=t.createElement("div"),this.element.classList.add(Br()),"popup"===e.layout&&this.element.classList.add(Br(void 0,"p"));const n=t.createElement("div");n.classList.add(Br("p")),e.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;const i=t.createElementNS(j,"svg");i.classList.add(Br("g")),this.padElement.appendChild(i),this.svgElem_=i;const r=t.createElementNS(j,"line");r.classList.add(Br("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const s=t.createElementNS(j,"line");s.classList.add(Br("ax")),s.setAttributeNS(null,"x1","50%"),s.setAttributeNS(null,"y1","0"),s.setAttributeNS(null,"x2","50%"),s.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(s);const o=t.createElementNS(j,"line");o.classList.add(Br("l")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(o),this.lineElem_=o;const a=t.createElement("div");a.classList.add(Br("m")),this.padElement.appendChild(a),this.markerElem_=a,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[t,e]=this.value.rawValue.getComponents(),n=this.maxValue_,i=Pn(t,-n,+n,0,100),r=Pn(e,-n,+n,0,100),s=this.invertsY_?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${i}%`),this.lineElem_.setAttributeNS(null,"y2",`${s}%`),this.markerElem_.style.left=`${i}%`,this.markerElem_.style.top=`${s}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function Vr(t,e,n){return[_n(e[0],wn(t)),_n(e[1],bn(t))*(n?1:-1)]}class Hr{constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.baseSteps_=e.baseSteps,this.maxValue_=e.maxValue,this.invertsY_=e.invertsY,this.view=new Ur(t,{invertsY:this.invertsY_,layout:e.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Tn(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const n=this.maxValue_,i=Pn(t.point.x,0,t.bounds.width,-n,+n),r=Pn(this.invertsY_?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-n,+n);this.value.setRawValue(new zr(i,r),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onPadKeyDown_(t){Sn(t.key)&&t.preventDefault();const[e,n]=Vr(t,this.baseSteps_,this.invertsY_);0===e&&0===n||this.value.setRawValue(new zr(this.value.rawValue.x+e,this.value.rawValue.y+n),{forceEmit:!1,last:!1})}onPadKeyUp_(t){const[e,n]=Vr(t,this.baseSteps_,this.invertsY_);0===e&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class jr{constructor(t,e){var n,i;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=ut.create(e.expanded),this.popC_="popup"===e.pickerLayout?new _e(t,{viewProps:this.viewProps}):null;const r=new Hr(t,{baseSteps:[e.axes[0].baseStep,e.axes[1].baseStep],invertsY:e.invertsY,layout:e.pickerLayout,maxValue:e.maxValue,value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=r,this.textC_=new Ar(t,{assembly:Or,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new Fr(t,{expanded:this.foldable_.value("expanded"),pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("blur",this.onPadButtonBlur_),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),yn({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),pt(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,n=a(t.relatedTarget);n&&e.contains(n)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,n=nt(t);n&&e.contains(n)||n&&n===this.view.buttonElement&&!q(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.view.buttonElement.focus()}}function Wr(t){return zr.isObject(t)?new zr(t.x,t.y):new zr}function Gr(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y)}function qr(t){if(!t)return;const e=[];return l(t.step)||e.push(new fe(t.step)),l(t.max)&&l(t.min)||e.push(new pe({max:t.max,min:t.min})),new ue(e)}function Xr(t){return new Sr({assembly:Or,components:[qr("x"in t?t.x:void 0),qr("y"in t?t.y:void 0)]})}function Zr(t,e){const n=t&&he(t,pe);if(n)return Math.max(Math.abs(n.minValue||0),Math.abs(n.maxValue||0));const i=Yn(t);return Math.max(10*Math.abs(i),10*Math.abs(e))}function Yr(t,e){const n=e instanceof Sr?e.components[0]:void 0,i=e instanceof Sr?e.components[1]:void 0,r=Zr(n,t.x),s=Zr(i,t.y);return Math.max(r,s)}function Kr(t,e){return{baseStep:Yn(e),constraint:e,textProps:L.fromObject({draggingScale:Kn(e,t),formatter:un(Zn(e,t))})}}function Jr(t){if(!("y"in t))return!1;const e=t.y;return!!e&&"inverted"in e&&!!e.inverted}const $r={id:"input-point2d",type:"input",accept:(t,e)=>{if(!zr.isObject(t))return null;const n=O,i=N(e,{expanded:n.optional.boolean,picker:n.optional.custom(Hn),x:n.optional.custom(jn),y:n.optional.object({inverted:n.optional.boolean,max:n.optional.number,min:n.optional.number,step:n.optional.number})});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Wr,constraint:t=>Xr(t.params),equals:zr.equals,writer:t=>Gr},controller:t=>{const e=t.document,n=t.value,i=t.constraint;if(!(i instanceof Sr))throw h.shouldNeverHappen();const r="expanded"in t.params?t.params.expanded:void 0,s="picker"in t.params?t.params.picker:void 0;return new jr(e,{axes:[Kr(n.rawValue.x,i.components[0]),Kr(n.rawValue.y,i.components[1])],expanded:null!=r&&r,invertsY:Jr(t.params),maxValue:Yr(n.rawValue,i),parser:an,pickerLayout:null!=s?s:"popup",value:n,viewProps:t.viewProps})}};class Qr{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}getComponents(){return[this.x,this.y,this.z]}static isObject(t){if(l(t))return!1;const e=t.x,n=t.y,i=t.z;return"number"==typeof e&&"number"==typeof n&&"number"==typeof i}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const ts={toComponents:t=>t.getComponents(),fromComponents:t=>new Qr(...t)};function es(t){return Qr.isObject(t)?new Qr(t.x,t.y,t.z):new Qr}function ns(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}function is(t){if(!t)return;const e=[];return l(t.step)||e.push(new fe(t.step)),l(t.max)&&l(t.min)||e.push(new pe({max:t.max,min:t.min})),new ue(e)}function rs(t){return new Sr({assembly:ts,components:[is("x"in t?t.x:void 0),is("y"in t?t.y:void 0),is("z"in t?t.z:void 0)]})}function ss(t,e){return{baseStep:Yn(e),constraint:e,textProps:L.fromObject({draggingScale:Kn(e,t),formatter:un(Zn(e,t))})}}const os={id:"input-point3d",type:"input",accept:(t,e)=>{if(!Qr.isObject(t))return null;const n=O,i=N(e,{x:n.optional.custom(jn),y:n.optional.custom(jn),z:n.optional.custom(jn)});return i?{initialValue:t,params:i}:null},binding:{reader:t=>es,constraint:t=>rs(t.params),equals:Qr.equals,writer:t=>ns},controller:t=>{const e=t.value,n=t.constraint;if(!(n instanceof Sr))throw h.shouldNeverHappen();return new Ar(t.document,{assembly:ts,axes:[ss(e.rawValue.x,n.components[0]),ss(e.rawValue.y,n.components[1]),ss(e.rawValue.z,n.components[2])],parser:an,value:e,viewProps:t.viewProps})}};class as{constructor(t=0,e=0,n=0,i=0){this.x=t,this.y=e,this.z=n,this.w=i}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(t){if(l(t))return!1;const e=t.x,n=t.y,i=t.z,r=t.w;return"number"==typeof e&&"number"==typeof n&&"number"==typeof i&&"number"==typeof r}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const ls={toComponents:t=>t.getComponents(),fromComponents:t=>new as(...t)};function cs(t){return as.isObject(t)?new as(t.x,t.y,t.z,t.w):new as}function us(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}function hs(t){if(!t)return;const e=[];return l(t.step)||e.push(new fe(t.step)),l(t.max)&&l(t.min)||e.push(new pe({max:t.max,min:t.min})),new ue(e)}function ds(t){return new Sr({assembly:ls,components:[hs("x"in t?t.x:void 0),hs("y"in t?t.y:void 0),hs("z"in t?t.z:void 0),hs("w"in t?t.w:void 0)]})}function ps(t,e){return{baseStep:Yn(e),constraint:e,textProps:L.fromObject({draggingScale:Kn(e,t),formatter:un(Zn(e,t))})}}const fs={id:"input-point4d",type:"input",accept:(t,e)=>{if(!as.isObject(t))return null;const n=O,i=N(e,{x:n.optional.custom(jn),y:n.optional.custom(jn),z:n.optional.custom(jn),w:n.optional.custom(jn)});return i?{initialValue:t,params:i}:null},binding:{reader:t=>cs,constraint:t=>ds(t.params),equals:as.equals,writer:t=>us},controller:t=>{const e=t.value,n=t.constraint;if(!(n instanceof Sr))throw h.shouldNeverHappen();return new Ar(t.document,{assembly:ls,axes:e.rawValue.getComponents().map(((t,e)=>ps(t,n.components[e]))),parser:an,value:e,viewProps:t.viewProps})}};function ms(t){const e=[],n=Gn(t.options);return n&&e.push(n),new ue(e)}const vs={id:"input-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;const n=N(e,{options:O.optional.custom(Vn)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>pn,constraint:t=>ms(t.params),writer:t=>Un},controller:t=>{var e;const n=t.document,i=t.value,r=t.constraint;return r&&he(r,de)?new ge(n,{props:L.fromObject({options:null!==(e=qn(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps}):new Me(n,{parser:t=>t,props:L.fromObject({formatter:fn}),value:i,viewProps:t.viewProps})}},gs={monitor:{defaultInterval:200,defaultLineCount:3}},xs=v("mll");class ys{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(xs()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("textarea");n.classList.add(xs("i")),n.style.height=`calc(var(--bld-us) * ${e.lineCount})`,n.readOnly=!0,e.viewProps.bindDisabled(n),this.element.appendChild(n),this.textareaElem_=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.textareaElem_,e=t.scrollTop===t.scrollHeight-t.clientHeight,n=[];this.value.rawValue.forEach((t=>{void 0!==t&&n.push(this.formatter_(t))})),t.textContent=n.join("\n"),e&&(t.scrollTop=t.scrollHeight)}onValueUpdate_(){this.update_()}}class _s{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new ys(t,{formatter:e.formatter,lineCount:e.lineCount,value:this.value,viewProps:this.viewProps})}}const bs=v("sgl");class ws{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(bs()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("input");n.classList.add(bs("i")),n.readOnly=!0,n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=void 0!==e?this.formatter_(e):""}onValueUpdate_(){this.update_()}}class Ms{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new ws(t,{formatter:e.formatter,value:this.value,viewProps:this.viewProps})}}const Ss={id:"monitor-bool",type:"monitor",accept:(t,e)=>{if("boolean"!=typeof t)return null;const n=N(e,{lineCount:O.optional.number});return n?{initialValue:t,params:n}:null},binding:{reader:t=>Ce},controller:t=>{var e;return 1===t.value.rawValue.length?new Ms(t.document,{formatter:Te,value:t.value,viewProps:t.viewProps}):new _s(t.document,{formatter:Te,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:gs.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}};class Cs{constructor(){this.emitter=new f,this.index_=-1}get index(){return this.index_}set index(t){this.index_!==t&&(this.index_=t,this.emitter.emit("change",{index:t,sender:this}))}}const Ts=v("grl");class Ps{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Ts()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.minValue_=e.minValue,this.maxValue_=e.maxValue,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=t.createElementNS(j,"svg");n.classList.add(Ts("g")),n.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(n),this.svgElem_=n;const i=t.createElementNS(j,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;const r=t.createElement("div");r.classList.add(Ts("t"),v("tt")()),this.element.appendChild(r),this.tooltipElem_=r,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,n=this.minValue_,i=this.maxValue_,r=[];this.value.rawValue.forEach(((s,o)=>{if(void 0===s)return;const a=Pn(o,0,e,0,t.width),l=Pn(s,n,i,t.height,0);r.push([a,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const s=this.tooltipElem_,o=this.value.rawValue[this.cursor_.index];if(void 0===o)return void s.classList.remove(Ts("t","a"));const a=Pn(this.cursor_.index,0,e,0,t.width),l=Pn(o,n,i,t.height,0);s.style.left=`${a}px`,s.style.top=`${l}px`,s.textContent=`${this.formatter_(o)}`,s.classList.contains(Ts("t","a"))||(s.classList.add(Ts("t","a"),Ts("t","in")),W(s),s.classList.remove(Ts("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class As{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.cursor_=new Cs,this.view=new Ps(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,maxValue:e.maxValue,minValue:e.minValue,value:this.value,viewProps:this.viewProps}),q(t)){const t=new Tn(this.view.element);t.emitter.on("down",this.onGraphPointerDown_),t.emitter.on("move",this.onGraphPointerMove_),t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.index=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(Pn(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){t.data.point?this.cursor_.index=Math.floor(Pn(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.index=-1}onGraphPointerUp_(){this.cursor_.index=-1}}function Es(t){return"format"in t&&!l(t.format)?t.format:un(2)}function Ls(t){var e;return 1===t.value.rawValue.length?new Ms(t.document,{formatter:Es(t.params),value:t.value,viewProps:t.viewProps}):new _s(t.document,{formatter:Es(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:gs.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}function Ds(t){var e,n,i;return new As(t.document,{formatter:Es(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:gs.monitor.defaultLineCount,maxValue:null!==(n="max"in t.params?t.params.max:null)&&void 0!==n?n:100,minValue:null!==(i="min"in t.params?t.params.min:null)&&void 0!==i?i:0,value:t.value,viewProps:t.viewProps})}function ks(t){return"view"in t&&"graph"===t.view}const Rs={id:"monitor-number",type:"monitor",accept:(t,e)=>{if("number"!=typeof t)return null;const n=O,i=N(e,{format:n.optional.function,lineCount:n.optional.number,max:n.optional.number,min:n.optional.number,view:n.optional.string});return i?{initialValue:t,params:i}:null},binding:{defaultBufferSize:t=>ks(t)?64:1,reader:t=>ln},controller:t=>ks(t.params)?Ds(t):Ls(t)},Is={id:"monitor-string",type:"monitor",accept:(t,e)=>{if("string"!=typeof t)return null;const n=O,i=N(e,{lineCount:n.optional.number,multiline:n.optional.boolean});return i?{initialValue:t,params:i}:null},binding:{reader:t=>pn},controller:t=>{var e;const n=t.value;return n.rawValue.length>1||"multiline"in t.params&&t.params.multiline?new _s(t.document,{formatter:fn,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:gs.monitor.defaultLineCount,value:n,viewProps:t.viewProps}):new Ms(t.document,{formatter:fn,value:n,viewProps:t.viewProps})}};class zs{constructor(t){this.onValueChange_=this.onValueChange_.bind(this),this.reader=t.reader,this.writer=t.writer,this.emitter=new f,this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.target=t.target,this.read()}read(){const t=this.target.read();void 0!==t&&(this.value.rawValue=this.reader(t))}write_(t){this.writer(this.target,t)}onValueChange_(t){this.write_(t.rawValue),this.emitter.emit("change",{options:t.options,rawValue:t.rawValue,sender:this})}}function Os(t,e){const n=t.accept(e.target.read(),e.params);if(l(n))return null;const i=O,r={target:e.target,initialValue:n.initialValue,params:n.params},s=t.binding.reader(r),o=t.binding.constraint?t.binding.constraint(r):void 0,a=E(s(n.initialValue),{constraint:o,equals:t.binding.equals}),c=new zs({reader:s,target:e.target,value:a,writer:t.binding.writer(r)}),u=i.optional.boolean(e.params.disabled).value,h=i.optional.boolean(e.params.hidden).value,d=t.controller({constraint:o,document:e.document,initialValue:n.initialValue,params:n.params,value:c.value,viewProps:Kt.create({disabled:u,hidden:h})}),p=i.optional.string(e.params.label).value;return new bt(e.document,{binding:c,blade:ct(),props:L.fromObject({label:p||e.target.key}),valueController:d})}class Ns{constructor(t){this.onTick_=this.onTick_.bind(this),this.reader_=t.reader,this.target=t.target,this.emitter=new f,this.value=t.value,this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const t=this.target.read();if(void 0===t)return;const e=this.value.rawValue,n=this.reader_(t);this.value.rawValue=xn(e,n),this.emitter.emit("update",{rawValue:n,sender:this})}onTick_(t){this.read()}}function Fs(t,e){return 0===e?new le:new ce(t,null!=e?e:gs.monitor.defaultInterval)}function Bs(t,e){var n,i,r;const s=O,o=t.accept(e.target.read(),e.params);if(l(o))return null;const a={target:e.target,initialValue:o.initialValue,params:o.params},c=t.binding.reader(a),u=null!==(i=null!==(n=s.optional.number(e.params.bufferSize).value)&&void 0!==n?n:t.binding.defaultBufferSize&&t.binding.defaultBufferSize(o.params))&&void 0!==i?i:1,h=s.optional.number(e.params.interval).value,d=new Ns({reader:c,target:e.target,ticker:Fs(e.document,h),value:vn(u)}),p=s.optional.boolean(e.params.disabled).value,f=s.optional.boolean(e.params.hidden).value,m=t.controller({document:e.document,params:o.params,value:d.value,viewProps:Kt.create({disabled:p,hidden:f})}),v=null!==(r=s.optional.string(e.params.label).value)&&void 0!==r?r:e.target.key;return new Mt(e.document,{binding:d,blade:ct(),props:L.fromObject({label:v}),valueController:m})}class Us{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(t){"blade"===t.type?this.pluginsMap_.blades.unshift(t):"input"===t.type?this.pluginsMap_.inputs.unshift(t):"monitor"===t.type&&this.pluginsMap_.monitors.unshift(t)}createInput(t,e,n){if(l(e.read()))throw new h({context:{key:e.key},type:"nomatchingcontroller"});const i=this.pluginsMap_.inputs.reduce(((i,r)=>i||Os(r,{document:t,target:e,params:n})),null);if(i)return i;throw new h({context:{key:e.key},type:"nomatchingcontroller"})}createMonitor(t,e,n){const i=this.pluginsMap_.monitors.reduce(((i,r)=>i||Bs(r,{document:t,params:n,target:e})),null);if(i)return i;throw new h({context:{key:e.key},type:"nomatchingcontroller"})}createBlade(t,e){const n=this.pluginsMap_.blades.reduce(((n,i)=>n||ae(i,{document:t,params:e})),null);if(!n)throw new h({type:"nomatchingview",context:{params:e}});return n}createBladeApi(t){if(t instanceof bt)return new _t(t);if(t instanceof Mt)return new wt(t);if(t instanceof Nt)return new Pt(t,this);const e=this.pluginsMap_.blades.reduce(((e,n)=>e||n.api({controller:t,pool:this})),null);if(!e)throw h.shouldNeverHappen();return e}}function Vs(){const t=new Us;return[$r,os,fs,vs,Ir,Mr,wr,_r,ei,Ss,Is,Rs,at,Vt,Xt,oe].forEach((e=>{t.register(e)})),t}class Hs extends n{constructor(t){super(t),this.emitter_=new f,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new r(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get options(){return this.controller_.valueController.props.get("options")}set options(t){this.controller_.valueController.props.set("options",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}}class js extends n{constructor(t){super(t),this.emitter_=new f,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new r(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(t){this.controller_.valueController.sliderController.props.set("maxValue",t)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(t){this.controller_.valueController.sliderController.props.set("minValue",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}}class Ws extends n{constructor(t){super(t),this.emitter_=new f,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new r(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(t){this.controller_.valueController.props.set("formatter",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}}const Gs={id:"list",type:"blade",accept(t){const e=O,n=N(t,{options:e.required.custom(Vn),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string});return n?{params:n}:null},controller(t){const e=new ge(t.document,{props:L.fromObject({options:Wn(t.params.options)}),value:E(t.params.value),viewProps:t.viewProps});return new Ht(t.document,{blade:t.blade,props:L.fromObject({label:t.params.label}),valueController:e})},api:t=>t.controller instanceof Ht&&t.controller.valueController instanceof ge?new Hs(t.controller):null};function qs(t){return t.reduce(((t,e)=>Object.assign(t,{[e.presetKey]:e.read()})),{})}function Xs(t,e){t.forEach((t=>{const n=e[t.presetKey];void 0!==n&&t.write(n)}))}class Zs extends At{constructor(t,e){super(t,e)}get element(){return this.controller_.view.element}importPreset(t){Xs(this.controller_.rackController.rack.find(bt).map((t=>t.binding.target)),t),this.refresh()}exportPreset(){return qs(this.controller_.rackController.rack.find(bt).map((t=>t.binding.target)))}refresh(){this.controller_.rackController.rack.find(bt).forEach((t=>{t.binding.read()})),this.controller_.rackController.rack.find(Mt).forEach((t=>{t.binding.read()}))}}class Ys extends Ut{constructor(t,e){super(t,{expanded:e.expanded,blade:e.blade,props:e.props,root:!0,viewProps:e.viewProps})}}const Ks={id:"slider",type:"blade",accept(t){const e=O,n=N(t,{max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number});return n?{params:n}:null},controller(t){var e,n;const i=null!==(e=t.params.value)&&void 0!==e?e:0,r=new Bn(t.document,{baseStep:1,parser:an,sliderProps:L.fromObject({maxValue:t.params.max,minValue:t.params.min}),textProps:L.fromObject({draggingScale:Kn(void 0,i),formatter:null!==(n=t.params.format)&&void 0!==n?n:cn}),value:E(i),viewProps:t.viewProps});return new Ht(t.document,{blade:t.blade,props:L.fromObject({label:t.params.label}),valueController:r})},api:t=>t.controller instanceof Ht&&t.controller.valueController instanceof Bn?new js(t.controller):null},Js={id:"text",type:"blade",accept(t){const e=O,n=N(t,{parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string});return n?{params:n}:null},controller(t){var e;const n=new Me(t.document,{parser:t.params.parse,props:L.fromObject({formatter:null!==(e=t.params.format)&&void 0!==e?e:t=>String(t)}),value:E(t.params.value),viewProps:t.viewProps});return new Ht(t.document,{blade:t.blade,props:L.fromObject({label:t.params.label}),valueController:n})},api:t=>t.controller instanceof Ht&&t.controller.valueController instanceof Me?new Ws(t.controller):null};function $s(t){const e=t.createElement("div");return e.classList.add(v("dfw")()),t.body&&t.body.appendChild(e),e}function Qs(t,e,n){if(t.querySelector(`style[data-tp-style=${e}]`))return;const i=t.createElement("style");i.dataset.tpStyle=e,i.textContent=n,t.head.appendChild(i)}class to extends Zs{constructor(t){var e;const n=t||{},i=null!==(e=n.document)&&void 0!==e?e:Z(),r=Vs();super(new Ys(i,{expanded:n.expanded,blade:ct(),props:L.fromObject({title:n.title}),viewProps:Kt.create()}),r),this.pool_=r,this.containerElem_=n.container||$s(i),this.containerElem_.appendChild(this.element),this.doc_=i,this.usesDefaultWrapper_=!n.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw h.alreadyDisposed();return this.doc_}dispose(){const t=this.containerElem_;if(!t)throw h.alreadyDisposed();if(this.usesDefaultWrapper_){const e=t.parentElement;e&&e.removeChild(t)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(t){("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach((t=>{this.pool_.register(t),this.embedPluginStyle_(t)}))}embedPluginStyle_(t){t.css&&Qs(this.document,`plugin-${t.id}`,t.css)}setUpDefaultPlugins_(){Qs(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor transparent;scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:transparent}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:transparent solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #28292e);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #28292e);--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i,.tp-fldv_c>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach((t=>{this.embedPluginStyle_(t)})),this.registerPlugin({plugins:[Ks,Gs,oe,Js]})}}const eo=new e("3.0.8");t.BladeApi=n,t.ButtonApi=p,t.FolderApi=At,t.InputBindingApi=_t,t.ListApi=Hs,t.MonitorBindingApi=wt,t.Pane=to,t.SeparatorApi=jt,t.SliderApi=js,t.TabApi=ne,t.TabPageApi=ee,t.TextApi=Ws,t.TpChangeEvent=r,t.VERSION=eo,Object.defineProperty(t,"__esModule",{value:!0})}(e)}},e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),window.$=window.jQuery=n(755),document.addEventListener("DOMContentLoaded",(function(t){window.myApp={},function(t){for(var e=0;e<t.length;e++)new(n(851)("./".concat(t[e])).default)}(function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n];-1===e.indexOf(i.toString())&&e.push(i)}return e}(function(){for(var t=document.querySelectorAll("[data-module]"),e=[],n=0;n<t.length;n++)for(var i=t[n].getAttribute("data-module").split(" "),r=0;r<i.length;r++)0!=i[r].trim().length&&e.push(i[r]);return e}()))}))}();